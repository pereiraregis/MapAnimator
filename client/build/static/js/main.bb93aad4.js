/*! For license information please see main.bb93aad4.js.LICENSE.txt */
(()=>{var e={43(e,t,n){"use strict";e.exports=n(202)},45(e,t,n){var r=n(738).default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},66(e,t,n){var r=n(897).default;e.exports=function(){"use strict";var e={},t={};function n(n,r,i){if(t[n]=i,"index"===n){var a="var sharedModule = {}; ("+t.shared+")(sharedModule); ("+t.worker+")(sharedModule);",o={};return t.shared(o),t.index(e,o),"undefined"!==typeof window&&e.setWorkerUrl(window.URL.createObjectURL(new Blob([a],{type:"text/javascript"}))),e}}return n("shared",["exports"],function(e){function t(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{l(r.next(e))}catch(e){a(e)}}function s(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}l((r=r.apply(e,t||[])).next())})}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}"function"==typeof SuppressedError&&SuppressedError;var i=a;function a(e,t){this.x=e,this.y=t}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,n=e.y-this.y;return t*t+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=n*this.x+t*this.y;return this.x=t*this.x-n*this.y,this.y=r,this},_rotateAround:function(e,t){var n=Math.cos(e),r=Math.sin(e),i=t.y+r*(this.x-t.x)+n*(this.y-t.y);return this.x=t.x+n*(this.x-t.x)-r*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(e){return e instanceof a?e:Array.isArray(e)?new a(e[0],e[1]):e};var o=n(i),s=l;function l(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r}l.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var i=this.sampleCurveX(n)-e;if(Math.abs(i)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=i/a}var o=0,s=1;for(n=e,r=0;r<20&&(i=this.sampleCurveX(n),!(Math.abs(i-e)<t));r++)e>i?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var u=n(s);let c,d;function h(){return null==c&&(c="undefined"!=typeof OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),c}function f(){if(null==d&&(d=!1,h())){const e=5,t=new OffscreenCanvas(e,e).getContext("2d",{willReadFrequently:!0});if(t){for(let r=0;r<e*e;r++){const n=4*r;t.fillStyle="rgb(".concat(n,",").concat(n+1,",").concat(n+2,")"),t.fillRect(r%e,Math.floor(r/e),1,1)}const n=t.getImageData(0,0,e,e).data;for(let t=0;t<e*e*4;t++)if(t%4!=3&&n[t]!==t){d=!0;break}}}return d||!1}function p(e,t,n,r){const i=new u(e,t,n,r);return e=>i.solve(e)}const m=p(.25,.1,.25,1);function g(e,t,n){return Math.min(n,Math.max(t,e))}function y(e,t,n){const r=n-t,i=((e-t)%r+r)%r+t;return i===t?n:i}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)for(const t in i)e[t]=i[t];return e}let _=1;function b(e,t,n){const r={};for(const i in e)r[i]=t.call(this,e[i],i,e);return r}function x(e,t,n){const r={};for(const i in e)t.call(this,e[i],i,e)&&(r[i]=e[i]);return r}function w(e){return Array.isArray(e)?e.map(w):"object"==typeof e&&e?b(e,w):e}const k={};function S(e){k[e]||("undefined"!=typeof console&&console.warn(e),k[e]=!0)}function E(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}function C(e){return"undefined"!=typeof WorkerGlobalScope&&void 0!==e&&e instanceof WorkerGlobalScope}let P=null;function D(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}const I="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function T(e,n,r,i,a){return t(this,void 0,void 0,function*(){if("undefined"==typeof VideoFrame)throw new Error("VideoFrame not supported");const t=new VideoFrame(e,{timestamp:0});try{const o=null==t?void 0:t.format;if(!o||!o.startsWith("BGR")&&!o.startsWith("RGB"))throw new Error("Unrecognized format ".concat(o));const s=o.startsWith("BGR"),l=new Uint8ClampedArray(i*a*4);if(yield t.copyTo(l,function(e,t,n,r,i){const a=4*Math.max(-t,0),o=(Math.max(0,n)-n)*r*4+a,s=4*r,l=Math.max(0,t),u=Math.max(0,n);return{rect:{x:l,y:u,width:Math.min(e.width,t+r)-l,height:Math.min(e.height,n+i)-u},layout:[{offset:o,stride:s}]}}(e,n,r,i,a)),s)for(let e=0;e<l.length;e+=4){const t=l[e];l[e]=l[e+2],l[e+2]=t}return l}finally{t.close()}})}let A,z;const O="AbortError";function F(){return new Error(O)}const M={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function j(e){return M.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))]}const B="global-dispatcher";class R extends Error{constructor(e,t,n,r){super("AJAXError: ".concat(t," (").concat(e,"): ").concat(n)),this.status=e,this.statusText=t,this.url=n,this.body=r}}const L=()=>C(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,N=function(e,n){if(/:\/\//.test(e.url)&&!/^https?:|^file:/.test(e.url)){const t=j(e.url);if(t)return t(e,n);if(C(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,targetMapId:B},n)}if(!(/^file:/.test(r=e.url)||/^file:/.test(L())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(e,n){return t(this,void 0,void 0,function*(){const t=new Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,cache:e.cache,referrer:L(),signal:n.signal});"json"!==e.type||t.headers.has("Accept")||t.headers.set("Accept","application/json");const r=yield fetch(t);if(!r.ok){const t=yield r.blob();throw new R(r.status,r.statusText,e.url,t)}let i;i="arrayBuffer"===e.type||"image"===e.type?r.arrayBuffer():"json"===e.type?r.json():r.text();const a=yield i;if(n.signal.aborted)throw F();return{data:a,cacheControl:r.headers.get("Cache-Control"),expires:r.headers.get("Expires")}})}(e,n);if(C(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:e,mustQueue:!0,targetMapId:B},n)}var r;return function(e,t){return new Promise((n,r)=>{var i;const a=new XMLHttpRequest;a.open(e.method||"GET",e.url,!0),"arrayBuffer"!==e.type&&"image"!==e.type||(a.responseType="arraybuffer");for(const t in e.headers)a.setRequestHeader(t,e.headers[t]);"json"===e.type&&(a.responseType="text",(null===(i=e.headers)||void 0===i?void 0:i.Accept)||a.setRequestHeader("Accept","application/json")),a.withCredentials="include"===e.credentials,a.onerror=()=>{r(new Error(a.statusText))},a.onload=()=>{if(!t.signal.aborted)if((a.status>=200&&a.status<300||0===a.status)&&null!==a.response){let t=a.response;if("json"===e.type)try{t=JSON.parse(a.response)}catch(e){return void r(e)}n({data:t,cacheControl:a.getResponseHeader("Cache-Control"),expires:a.getResponseHeader("Expires")})}else{const t=new Blob([a.response],{type:a.getResponseHeader("Content-Type")});r(new R(a.status,a.statusText,e.url,t))}},t.signal.addEventListener("abort",()=>{a.abort(),r(F())}),a.send(e.body)})}(e,n)};function U(e){if(!e||e.indexOf("://")<=0||0===e.indexOf("data:image/")||0===e.indexOf("blob:"))return!0;const t=new URL(e),n=window.location;return t.protocol===n.protocol&&t.host===n.host}function V(e,t,n){n[e]&&-1!==n[e].indexOf(t)||(n[e]=n[e]||[],n[e].push(t))}function q(e,t,n){if(n&&n[e]){const r=n[e].indexOf(t);-1!==r&&n[e].splice(r,1)}}class H{constructor(e){v(this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.type=e}}class W extends H{constructor(e){super("error",v({error:e},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}}class Z{on(e,t){return this._listeners=this._listeners||{},V(e,t,this._listeners),this}off(e,t){return q(e,t,this._listeners),q(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},V(e,t,this._oneTimeListeners),this):new Promise(t=>this.once(e,t))}fire(e,t){"string"==typeof e&&(e=new H(e,t||{}));const n=e.type;if(this.listens(n)){e.target=this;const t=this._listeners&&this._listeners[n]?this._listeners[n].slice():[];for(const n of t)n.call(this,e);const r=this._oneTimeListeners&&this._oneTimeListeners[n]?this._oneTimeListeners[n].slice():[];for(const a of r)q(n,a,this._oneTimeListeners),a.call(this,e);const i=this._eventedParent;i&&(v(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}else e instanceof W&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var K={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"enum",default:"mercator",values:{mercator:{},globe:{}}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const G=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(e,t){const n={};for(const r in e)"ref"!==r&&(n[r]=e[r]);return G.forEach(e=>{e in t&&(n[e]=t[e])}),n}function $(e,t){if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!$(e[n],t[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==t){if("object"!=typeof t)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!$(e[n],t[n]))return!1;return!0}return e===t}function Y(e,t){e.push(t)}function J(e,t,n){Y(n,{command:"addSource",args:[e,t[e]]})}function Q(e,t,n){Y(t,{command:"removeSource",args:[e]}),n[e]=!0}function ee(e,t,n,r){Q(e,n,r),J(e,t,n)}function te(e,t,n){let r;for(r in e[n])if(Object.prototype.hasOwnProperty.call(e[n],r)&&"data"!==r&&!$(e[n][r],t[n][r]))return!1;for(r in t[n])if(Object.prototype.hasOwnProperty.call(t[n],r)&&"data"!==r&&!$(e[n][r],t[n][r]))return!1;return!0}function ne(e,t,n,r,i,a){e=e||{},t=t||{};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&($(e[o],t[o])||n.push({command:a,args:[r,o,t[o],i]}));for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&!Object.prototype.hasOwnProperty.call(e,o)&&($(e[o],t[o])||n.push({command:a,args:[r,o,t[o],i]}))}function re(e){return e.id}function ie(e,t){return e[t.id]=t,e}class ae{constructor(e,t,n,r){this.message=(e?"".concat(e,": "):"")+n,r&&(this.identifier=r),null!=t&&t.__line__&&(this.line=t.__line__)}}function oe(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const i of n)for(const t in i)e[t]=i[t];return e}class se extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}class le{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.parent=e,this.bindings={};for(const[n,r]of t)this.bindings[n]=r}concat(e){return new le(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error("".concat(e," not found in scope."))}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const ue={kind:"null"},ce={kind:"number"},de={kind:"string"},he={kind:"boolean"},fe={kind:"color"},pe={kind:"object"},me={kind:"value"},ge={kind:"collator"},ye={kind:"formatted"},ve={kind:"padding"},_e={kind:"resolvedImage"},be={kind:"variableAnchorOffsetCollection"};function xe(e,t){return{kind:"array",itemType:e,N:t}}function we(e){if("array"===e.kind){const t=we(e.itemType);return"number"==typeof e.N?"array<".concat(t,", ").concat(e.N,">"):"value"===e.itemType.kind?"array":"array<".concat(t,">")}return e.kind}const ke=[ue,ce,de,he,fe,ye,pe,xe(me),ve,_e,be];function Se(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Se(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of ke)if(!Se(e,t))return null}return"Expected ".concat(we(e)," but found ").concat(we(t)," instead.")}function Ee(e,t){return t.some(t=>t.kind===e.kind)}function Ce(e,t){return t.some(t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e)}function Pe(e,t){return"array"===e.kind&&"array"===t.kind?e.itemType.kind===t.itemType.kind&&"number"==typeof e.N:e.kind===t.kind}const De=.96422,Ie=.82521,Te=4/29,Ae=6/29,ze=3*Ae*Ae,Oe=Ae*Ae*Ae,Fe=Math.PI/180,Me=180/Math.PI;function je(e){return(e%=360)<0&&(e+=360),e}function Be(e){let t,n,[r,i,a,o]=e;const s=Le((.2225045*(r=Re(r))+.7168786*(i=Re(i))+.0606169*(a=Re(a)))/1);r===i&&i===a?t=n=s:(t=Le((.4360747*r+.3850649*i+.1430804*a)/De),n=Le((.0139322*r+.0971045*i+.7141733*a)/Ie));const l=116*s-16;return[l<0?0:l,500*(t-s),200*(s-n),o]}function Re(e){return e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Le(e){return e>Oe?Math.pow(e,1/3):e/ze+Te}function Ne(e){let[t,n,r,i]=e,a=(t+16)/116,o=isNaN(n)?a:a+n/500,s=isNaN(r)?a:a-r/200;return a=1*Ve(a),o=De*Ve(o),s=Ie*Ve(s),[Ue(3.1338561*o-1.6168667*a-.4906146*s),Ue(-.9787684*o+1.9161415*a+.033454*s),Ue(.0719453*o-.2289914*a+1.4052427*s),i]}function Ue(e){return(e=e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055)<0?0:e>1?1:e}function Ve(e){return e>Ae?e*e*e:ze*(e-Te)}function qe(e){return parseInt(e.padEnd(2,e),16)/255}function He(e,t){return We(t?e/100:e,0,1)}function We(e,t,n){return Math.min(Math.max(t,e),n)}function Ze(e){return!e.some(Number.isNaN)}const Ke={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Ge{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];this.r=e,this.g=t,this.b=n,this.a=r,i||(this.r*=r,this.g*=r,this.b*=r,r||this.overwriteGetter("rgb",[e,t,n,r]))}static parse(e){if(e instanceof Ge)return e;if("string"!=typeof e)return;const t=function(e){if("transparent"===(e=e.toLowerCase().trim()))return[0,0,0,0];const t=Ke[e];if(t){const[e,n,r]=t;return[e/255,n/255,r/255,1]}if(e.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(e)){const t=e.length<6?1:2;let n=1;return[qe(e.slice(n,n+=t)),qe(e.slice(n,n+=t)),qe(e.slice(n,n+=t)),qe(e.slice(n,n+t)||"ff")]}if(e.startsWith("rgb")){const t=e.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(t){const[e,n,r,i,a,o,s,l,u,c,d,h]=t,f=[i||" ",s||" ",c].join("");if("  "===f||"  /"===f||",,"===f||",,,"===f){const e=[r,o,u].join(""),t="%%%"===e?100:""===e?255:0;if(t){const e=[We(+n/t,0,1),We(+a/t,0,1),We(+l/t,0,1),d?He(+d,h):1];if(Ze(e))return e}}return}}const n=e.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(n){const[e,t,r,i,a,o,s,l,u]=n,c=[r||" ",a||" ",s].join("");if("  "===c||"  /"===c||",,"===c||",,,"===c){const e=[+t,We(+i,0,100),We(+o,0,100),l?He(+l,u):1];if(Ze(e))return function(e){let[t,n,r,i]=e;function a(e){const i=(e+t/30)%12,a=n*Math.min(r,1-r);return r-a*Math.max(-1,Math.min(i-3,9-i,1))}return t=je(t),n/=100,r/=100,[a(0),a(8),a(4),i]}(e)}}}(e);return t?new Ge(...t,!1):void 0}get rgb(){const{r:e,g:t,b:n,a:r}=this,i=r||1/0;return this.overwriteGetter("rgb",[e/i,t/i,n/i,r])}get hcl(){return this.overwriteGetter("hcl",function(e){const[t,n,r,i]=Be(e),a=Math.sqrt(n*n+r*r);return[Math.round(1e4*a)?je(Math.atan2(r,n)*Me):NaN,a,t,i]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Be(this.rgb))}overwriteGetter(e,t){return Object.defineProperty(this,e,{value:t}),t}toString(){const[e,t,n,r]=this.rgb;return"rgba(".concat([e,t,n].map(e=>Math.round(255*e)).join(","),",").concat(r,")")}}Ge.black=new Ge(0,0,0,1),Ge.white=new Ge(1,1,1,1),Ge.transparent=new Ge(0,0,0,0),Ge.red=new Ge(1,0,0,1);class Xe{constructor(e,t,n){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=n,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $e{constructor(e,t,n,r,i){this.text=e,this.image=t,this.scale=n,this.fontStack=r,this.textColor=i}}class Ye{constructor(e){this.sections=e}static fromString(e){return new Ye([new $e(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ye?e:Ye.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}}class Je{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof Je)return e;if("number"==typeof e)return new Je([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const t of e)if("number"!=typeof t)return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new Je(e)}}toString(){return JSON.stringify(this.values)}}const Qe=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class et{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof et)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let t=0;t<e.length;t+=2){const n=e[t],r=e[t+1];if("string"!=typeof n||!Qe.has(n))return;if(!Array.isArray(r)||2!==r.length||"number"!=typeof r[0]||"number"!=typeof r[1])return}return new et(e)}}toString(){return JSON.stringify(this.values)}}class tt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new tt({name:e,available:!1}):null}}function nt(e,t,n,r){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===r||"number"==typeof r&&r>=0&&r<=1?null:"Invalid rgba value [".concat([e,t,n,r].join(", "),"]: 'a' must be between 0 and 1."):"Invalid rgba value [".concat(("number"==typeof r?[e,t,n,r]:[e,t,n]).join(", "),"]: 'r', 'g', and 'b' must be between 0 and 255.")}function rt(e){if(null===e||"string"==typeof e||"boolean"==typeof e||"number"==typeof e||e instanceof Ge||e instanceof Xe||e instanceof Ye||e instanceof Je||e instanceof et||e instanceof tt)return!0;if(Array.isArray(e)){for(const t of e)if(!rt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!rt(e[t]))return!1;return!0}return!1}function it(e){if(null===e)return ue;if("string"==typeof e)return de;if("boolean"==typeof e)return he;if("number"==typeof e)return ce;if(e instanceof Ge)return fe;if(e instanceof Xe)return ge;if(e instanceof Ye)return ye;if(e instanceof Je)return ve;if(e instanceof et)return be;if(e instanceof tt)return _e;if(Array.isArray(e)){const t=e.length;let n;for(const r of e){const e=it(r);if(n){if(n===e)continue;n=me;break}n=e}return xe(n||me,t)}return pe}function at(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Ge||e instanceof Ye||e instanceof Je||e instanceof et||e instanceof tt?e.toString():JSON.stringify(e)}class ot{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error("'literal' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(!rt(e[1]))return t.error("invalid value");const n=e[1];let r=it(n);const i=t.expectedType;return"array"!==r.kind||0!==r.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(r=i),new ot(r,n)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class st{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const lt={string:de,number:ce,boolean:he,object:pe};class ut{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let n,r=1;const i=e[0];if("array"===i){let i,a;if(e.length>2){const n=e[1];if("string"!=typeof n||!(n in lt)||"object"===n)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=lt[n],r++}else i=me;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);a=e[2],r++}n=xe(i,a)}else{if(!lt[i])throw new Error("Types doesn't contain name = ".concat(i));n=lt[i]}const a=[];for(;r<e.length;r++){const n=t.parse(e[r],r,me);if(!n)return null;a.push(n)}return new ut(n,a)}evaluate(e){for(let t=0;t<this.args.length;t++){const n=this.args[t].evaluate(e);if(!Se(this.type,it(n)))return n;if(t===this.args.length-1)throw new st("Expected value to be of type ".concat(we(this.type),", but found ").concat(we(it(n))," instead."))}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ct={"to-boolean":he,"to-color":fe,"to-number":ce,"to-string":de};class dt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[0];if(!ct[n])throw new Error("Can't parse ".concat(n," as it is not part of the known types"));if(("to-boolean"===n||"to-string"===n)&&2!==e.length)return t.error("Expected one argument.");const r=ct[n],i=[];for(let a=1;a<e.length;a++){const n=t.parse(e[a],a,me);if(!n)return null;i.push(n)}return new dt(r,i)}evaluate(e){switch(this.type.kind){case"boolean":return Boolean(this.args[0].evaluate(e));case"color":{let t,n;for(const r of this.args){if(t=r.evaluate(e),n=null,t instanceof Ge)return t;if("string"==typeof t){const n=e.parseColor(t);if(n)return n}else if(Array.isArray(t)&&(n=t.length<3||t.length>4?"Invalid rbga value ".concat(JSON.stringify(t),": expected an array containing either three or four numeric values."):nt(t[0],t[1],t[2],t[3]),!n))return new Ge(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new st(n||"Could not parse color from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"padding":{let t;for(const n of this.args){t=n.evaluate(e);const r=Je.parse(t);if(r)return r}throw new st("Could not parse padding from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"variableAnchorOffsetCollection":{let t;for(const n of this.args){t=n.evaluate(e);const r=et.parse(t);if(r)return r}throw new st("Could not parse variableAnchorOffsetCollection from value '".concat("string"==typeof t?t:JSON.stringify(t),"'"))}case"number":{let t=null;for(const n of this.args){if(t=n.evaluate(e),null===t)return 0;const r=Number(t);if(!isNaN(r))return r}throw new st("Could not convert ".concat(JSON.stringify(t)," to number."))}case"formatted":return Ye.fromString(at(this.args[0].evaluate(e)));case"resolvedImage":return tt.fromString(at(this.args[0].evaluate(e)));default:return at(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const ht=["Unknown","Point","LineString","Polygon"];class ft{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ht[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ge.parse(e)),t}}class pt{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new le,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];this.registry=e,this.path=n,this.key=n.map(e=>"[".concat(e,"]")).join(""),this.scope=i,this.errors=a,this.expectedType=r,this._isConstant=t}parse(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return t?this.concat(t,n,r)._parse(e,i):this._parse(e,i)}_parse(e,t){function n(e,t,n){return"assert"===n?new ut(t,[e]):"coerce"===n?new dt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const r=e[0];if("string"!=typeof r)return this.error("Expression name must be a string, but found ".concat(typeof r,' instead. If you wanted a literal array, use ["literal", [...]].'),0),null;const i=this.registry[r];if(i){let r=i.parse(e,this);if(!r)return null;if(this.expectedType){const e=this.expectedType,i=r.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==i.kind&&"string"!==i.kind)if("padding"!==e.kind||"value"!==i.kind&&"number"!==i.kind&&"array"!==i.kind)if("variableAnchorOffsetCollection"!==e.kind||"value"!==i.kind&&"array"!==i.kind){if(this.checkSubtype(e,i))return null}else r=n(r,e,t.typeAnnotation||"coerce");else r=n(r,e,t.typeAnnotation||"coerce");else r=n(r,e,t.typeAnnotation||"coerce");else r=n(r,e,t.typeAnnotation||"assert")}if(!(r instanceof ot)&&"resolvedImage"!==r.type.kind&&this._isConstant(r)){const t=new ft;try{r=new ot(r.type,r.evaluate(t))}catch(e){return this.error(e.message),null}}return r}return this.error('Unknown expression "'.concat(r,'". If you wanted a literal array, use ["literal", [...]].'),0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found ".concat(typeof e," instead."))}concat(e,t,n){const r="number"==typeof e?this.path.concat(e):this.path,i=n?this.scope.concat(n):this.scope;return new pt(this.registry,this._isConstant,r,t||null,i,this.errors)}error(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i="".concat(this.key).concat(n.map(e=>"[".concat(e,"]")).join(""));this.errors.push(new se(i,e))}checkSubtype(e,t){const n=Se(e,t);return n&&this.error(n),n}}class mt{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found ".concat(e.length-1," instead."));const n=[];for(let i=1;i<e.length-1;i+=2){const r=e[i];if("string"!=typeof r)return t.error("Expected string, but found ".concat(typeof r," instead."),i);if(/[^a-zA-Z0-9_]/.test(r))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);const a=t.parse(e[i+1],i+1);if(!a)return null;n.push([r,a])}const r=t.parse(e[e.length-1],e.length-1,t.expectedType,n);return r?new mt(n,r):null}outputDefined(){return this.result.outputDefined()}}class gt{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const n=e[1];return t.scope.has(n)?new gt(n,t.scope.get(n)):t.error('Unknown variable "'.concat(n,'". Make sure "').concat(n,'" has been bound in an enclosing "let" expression before using it.'),1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class yt{constructor(e,t,n){this.type=e,this.index=t,this.input=n}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,ce),r=t.parse(e[2],2,xe(t.expectedType||me));return n&&r?new yt(r.type.itemType,n,r):null}evaluate(e){const t=this.index.evaluate(e),n=this.input.evaluate(e);if(t<0)throw new st("Array index out of bounds: ".concat(t," < 0."));if(t>=n.length)throw new st("Array index out of bounds: ".concat(t," > ").concat(n.length-1,"."));if(t!==Math.floor(t))throw new st("Array index must be an integer, but found ".concat(t," instead."));return n[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class vt{constructor(e,t){this.type=he,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error("Expected 2 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,me),r=t.parse(e[2],2,me);return n&&r?Ee(n.type,[he,de,ce,ue,me])?new vt(n,r):t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(we(n.type)," instead")):null}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!n)return!1;if(!Ce(t,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found ".concat(we(it(t))," instead."));if(!Ce(n,["string","array"]))throw new st("Expected second argument to be of type array or string, but found ".concat(we(it(n))," instead."));return n.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class _t{constructor(e,t,n){this.type=ce,this.needle=e,this.haystack=t,this.fromIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,me),r=t.parse(e[2],2,me);if(!n||!r)return null;if(!Ee(n.type,[he,de,ce,ue,me]))return t.error("Expected first argument to be of type boolean, string, number or null, but found ".concat(we(n.type)," instead"));if(4===e.length){const i=t.parse(e[3],3,ce);return i?new _t(n,r,i):null}return new _t(n,r)}evaluate(e){const t=this.needle.evaluate(e),n=this.haystack.evaluate(e);if(!Ce(t,["boolean","string","number","null"]))throw new st("Expected first argument to be of type boolean, string, number or null, but found ".concat(we(it(t))," instead."));let r;if(this.fromIndex&&(r=this.fromIndex.evaluate(e)),Ce(n,["string"])){const e=n.indexOf(t,r);return-1===e?-1:[...n.slice(0,e)].length}if(Ce(n,["array"]))return n.indexOf(t,r);throw new st("Expected second argument to be of type array or string, but found ".concat(we(it(n))," instead."))}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class bt{constructor(e,t,n,r,i,a){this.inputType=e,this.type=t,this.input=n,this.cases=r,this.outputs=i,this.otherwise=a}static parse(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=1)return t.error("Expected an even number of arguments.");let n,r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const i={},a=[];for(let l=2;l<e.length-1;l+=2){let o=e[l];const s=e[l+1];Array.isArray(o)||(o=[o]);const u=t.concat(l);if(0===o.length)return u.error("Expected at least one branch label.");for(const e of o){if("number"!=typeof e&&"string"!=typeof e)return u.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return u.error("Branch labels must be integers no larger than ".concat(Number.MAX_SAFE_INTEGER,"."));if("number"==typeof e&&Math.floor(e)!==e)return u.error("Numeric branch labels must be integer values.");if(n){if(u.checkSubtype(n,it(e)))return null}else n=it(e);if(void 0!==i[String(e)])return u.error("Branch labels must be unique.");i[String(e)]=a.length}const c=t.parse(s,l,r);if(!c)return null;r=r||c.type,a.push(c)}const o=t.parse(e[1],1,me);if(!o)return null;const s=t.parse(e[e.length-1],e.length-1,r);return s?"value"!==o.type.kind&&t.concat(1).checkSubtype(n,o.type)?null:new bt(n,r,o,i,a,s):null}evaluate(e){const t=this.input.evaluate(e);return(it(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class xt{constructor(e,t,n){this.type=e,this.branches=t,this.otherwise=n}static parse(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only ".concat(e.length-1,"."));if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const r=[];for(let a=1;a<e.length-1;a+=2){const i=t.parse(e[a],a,he);if(!i)return null;const o=t.parse(e[a+1],a+1,n);if(!o)return null;r.push([i,o]),n=n||o.type}const i=t.parse(e[e.length-1],e.length-1,n);if(!i)return null;if(!n)throw new Error("Can't infer output type");return new xt(n,r,i)}evaluate(e){for(const[t,n]of this.branches)if(t.evaluate(e))return n.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,n]of this.branches)e(t),e(n);e(this.otherwise)}outputDefined(){return this.branches.every(e=>{let[t,n]=e;return n.outputDefined()})&&this.otherwise.outputDefined()}}class wt{constructor(e,t,n,r){this.type=e,this.input=t,this.beginIndex=n,this.endIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1,me),r=t.parse(e[2],2,ce);if(!n||!r)return null;if(!Ee(n.type,[xe(me),de,me]))return t.error("Expected first argument to be of type array or string, but found ".concat(we(n.type)," instead"));if(4===e.length){const i=t.parse(e[3],3,ce);return i?new wt(n.type,n,r,i):null}return new wt(n.type,n,r)}evaluate(e){const t=this.input.evaluate(e),n=this.beginIndex.evaluate(e);let r;if(this.endIndex&&(r=this.endIndex.evaluate(e)),Ce(t,["string"]))return[...t].slice(n,r).join("");if(Ce(t,["array"]))return t.slice(n,r);throw new st("Expected first argument to be of type array or string, but found ".concat(we(it(t))," instead."))}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function kt(e,t){const n=e.length-1;let r,i,a=0,o=n,s=0;for(;a<=o;)if(s=Math.floor((a+o)/2),r=e[s],i=e[s+1],r<=t){if(s===n||t<i)return s;a=s+1}else{if(!(r>t))throw new st("Input is not a number.");o=s-1}return 0}class St{constructor(e,t,n){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[r,i]of n)this.labels.push(r),this.outputs.push(i)}static parse(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const n=t.parse(e[1],1,ce);if(!n)return null;const r=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let a=1;a<e.length;a+=2){const n=1===a?-1/0:e[a],o=e[a+1],s=a,l=a+1;if("number"!=typeof n)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(r.length&&r[r.length-1][0]>=n)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const u=t.parse(o,l,i);if(!u)return null;i=i||u.type,r.push([n,u])}return new St(i,n,r)}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);const i=t.length;return r>=t[i-1]?n[i-1].evaluate(e):n[kt(t,r)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Et(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ct=Pt;function Pt(e,t,n,r){this.cx=3*e,this.bx=3*(n-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(r-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=n,this.p2y=r}Pt.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var n=e,r=0;r<8;r++){var i=this.sampleCurveX(n)-e;if(Math.abs(i)<t)return n;var a=this.sampleCurveDerivativeX(n);if(Math.abs(a)<1e-6)break;n-=i/a}var o=0,s=1;for(n=e,r=0;r<20&&(i=this.sampleCurveX(n),!(Math.abs(i-e)<t));r++)e>i?o=n:s=n,n=.5*(s-o)+o;return n},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var Dt=Et(Ct);function It(e,t,n){return e+n*(t-e)}function Tt(e,t,n){return e.map((e,r)=>It(e,t[r],n))}const At={number:It,color:function(e,t,n){switch(arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rgb"){case"rgb":{const[r,i,a,o]=Tt(e.rgb,t.rgb,n);return new Ge(r,i,a,o,!1)}case"hcl":{const[r,i,a,o]=e.hcl,[s,l,u,c]=t.hcl;let d,h;if(isNaN(r)||isNaN(s))isNaN(r)?isNaN(s)?d=NaN:(d=s,1!==a&&0!==a||(h=l)):(d=r,1!==u&&0!==u||(h=i));else{let e=s-r;s>r&&e>180?e-=360:s<r&&r-s>180&&(e+=360),d=r+n*e}const[f,p,m,g]=function(e){let[t,n,r,i]=e;return t=isNaN(t)?0:t*Fe,Ne([r,Math.cos(t)*n,Math.sin(t)*n,i])}([d,null!=h?h:It(i,l,n),It(a,u,n),It(o,c,n)]);return new Ge(f,p,m,g,!1)}case"lab":{const[r,i,a,o]=Ne(Tt(e.lab,t.lab,n));return new Ge(r,i,a,o,!1)}}},array:Tt,padding:function(e,t,n){return new Je(Tt(e.values,t.values,n))},variableAnchorOffsetCollection:function(e,t,n){const r=e.values,i=t.values;if(r.length!==i.length)throw new st("Cannot interpolate values of different length. from: ".concat(e.toString(),", to: ").concat(t.toString()));const a=[];for(let o=0;o<r.length;o+=2){if(r[o]!==i[o])throw new st("Cannot interpolate values containing mismatched anchors. from[".concat(o,"]: ").concat(r[o],", to[").concat(o,"]: ").concat(i[o]));a.push(r[o]);const[e,t]=r[o+1],[s,l]=i[o+1];a.push([It(e,s,n),It(t,l,n)])}return new et(a)}};class zt{constructor(e,t,n,r,i){this.type=e,this.operator=t,this.interpolation=n,this.input=r,this.labels=[],this.outputs=[];for(const[a,o]of i)this.labels.push(a),this.outputs.push(o)}static interpolationFactor(e,t,n,r){let i=0;if("exponential"===e.name)i=Ot(t,e.base,n,r);else if("linear"===e.name)i=Ot(t,1,n,r);else if("cubic-bezier"===e.name){const a=e.controlPoints;i=new Dt(a[0],a[1],a[2],a[3]).solve(Ot(t,1,n,r))}return i}static parse(e,t){let[n,r,i,...a]=e;if(!Array.isArray(r)||0===r.length)return t.error("Expected an interpolation type expression.",1);if("linear"===r[0])r={name:"linear"};else if("exponential"===r[0]){const e=r[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);r={name:"exponential",base:e}}else{if("cubic-bezier"!==r[0])return t.error("Unknown interpolation type ".concat(String(r[0])),1,0);{const e=r.slice(1);if(4!==e.length||e.some(e=>"number"!=typeof e||e<0||e>1))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);r={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only ".concat(e.length-1,"."));if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,ce),!i)return null;const o=[];let s=null;"interpolate-hcl"===n||"interpolate-lab"===n?s=fe:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let l=0;l<a.length;l+=2){const e=a[l],n=a[l+1],r=l+3,i=l+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',r);if(o.length&&o[o.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',r);const u=t.parse(n,i,s);if(!u)return null;s=s||u.type,o.push([e,u])}return Pe(s,ce)||Pe(s,fe)||Pe(s,ve)||Pe(s,be)||Pe(s,xe(ce))?new zt(s,n,r,i,o):t.error("Type ".concat(we(s)," is not interpolatable."))}evaluate(e){const t=this.labels,n=this.outputs;if(1===t.length)return n[0].evaluate(e);const r=this.input.evaluate(e);if(r<=t[0])return n[0].evaluate(e);const i=t.length;if(r>=t[i-1])return n[i-1].evaluate(e);const a=kt(t,r),o=zt.interpolationFactor(this.interpolation,r,t[a],t[a+1]),s=n[a].evaluate(e),l=n[a+1].evaluate(e);switch(this.operator){case"interpolate":return At[this.type.kind](s,l,o);case"interpolate-hcl":return At.color(s,l,o,"hcl");case"interpolate-lab":return At.color(s,l,o,"lab")}}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function Ot(e,t,n,r){const i=r-n,a=e-n;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}class Ft{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let n=null;const r=t.expectedType;r&&"value"!==r.kind&&(n=r);const i=[];for(const o of e.slice(1)){const e=t.parse(o,1+i.length,n,void 0,{typeAnnotation:"omit"});if(!e)return null;n=n||e.type,i.push(e)}if(!n)throw new Error("No output type");const a=r&&i.some(e=>Se(r,e.type));return new Ft(a?me:n,i)}evaluate(e){let t,n=null,r=0;for(const i of this.args)if(r++,n=i.evaluate(e),n&&n instanceof tt&&!n.available&&(t||(t=n.name),n=null,r===this.args.length&&(n=t)),null!==n)break;return n}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}function Mt(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function jt(e,t,n,r){return 0===r.compare(t,n)}function Bt(e,t,n){const r="=="!==e&&"!="!==e;return class i{constructor(e,t,n){this.type=he,this.lhs=e,this.rhs=t,this.collator=n,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const n=e[0];let a=t.parse(e[1],1,me);if(!a)return null;if(!Mt(n,a.type))return t.concat(1).error('"'.concat(n,"\" comparisons are not supported for type '").concat(we(a.type),"'."));let o=t.parse(e[2],2,me);if(!o)return null;if(!Mt(n,o.type))return t.concat(2).error('"'.concat(n,"\" comparisons are not supported for type '").concat(we(o.type),"'."));if(a.type.kind!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot compare types '".concat(we(a.type),"' and '").concat(we(o.type),"'."));r&&("value"===a.type.kind&&"value"!==o.type.kind?a=new ut(o.type,[a]):"value"!==a.type.kind&&"value"===o.type.kind&&(o=new ut(a.type,[o])));let s=null;if(4===e.length){if("string"!==a.type.kind&&"string"!==o.type.kind&&"value"!==a.type.kind&&"value"!==o.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,ge),!s)return null}return new i(a,o,s)}evaluate(i){const a=this.lhs.evaluate(i),o=this.rhs.evaluate(i);if(r&&this.hasUntypedArgument){const t=it(a),n=it(o);if(t.kind!==n.kind||"string"!==t.kind&&"number"!==t.kind)throw new st('Expected arguments for "'.concat(e,'" to be (string, string) or (number, number), but found (').concat(t.kind,", ").concat(n.kind,") instead."))}if(this.collator&&!r&&this.hasUntypedArgument){const e=it(a),n=it(o);if("string"!==e.kind||"string"!==n.kind)return t(i,a,o)}return this.collator?n(i,a,o,this.collator.evaluate(i)):t(i,a,o)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}}}const Rt=Bt("==",function(e,t,n){return t===n},jt),Lt=Bt("!=",function(e,t,n){return t!==n},function(e,t,n,r){return!jt(0,t,n,r)}),Nt=Bt("<",function(e,t,n){return t<n},function(e,t,n,r){return r.compare(t,n)<0}),Ut=Bt(">",function(e,t,n){return t>n},function(e,t,n,r){return r.compare(t,n)>0}),Vt=Bt("<=",function(e,t,n){return t<=n},function(e,t,n,r){return r.compare(t,n)<=0}),qt=Bt(">=",function(e,t,n){return t>=n},function(e,t,n,r){return r.compare(t,n)>=0});class Ht{constructor(e,t,n){this.type=ge,this.locale=n,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const n=e[1];if("object"!=typeof n||Array.isArray(n))return t.error("Collator options argument must be an object.");const r=t.parse(void 0!==n["case-sensitive"]&&n["case-sensitive"],1,he);if(!r)return null;const i=t.parse(void 0!==n["diacritic-sensitive"]&&n["diacritic-sensitive"],1,he);if(!i)return null;let a=null;return n.locale&&(a=t.parse(n.locale,1,de),!a)?null:new Ht(r,i,a)}evaluate(e){return new Xe(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}class Wt{constructor(e,t,n,r,i){this.type=de,this.number=e,this.locale=t,this.currency=n,this.minFractionDigits=r,this.maxFractionDigits=i}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,ce);if(!n)return null;const r=e[2];if("object"!=typeof r||Array.isArray(r))return t.error("NumberFormat options argument must be an object.");let i=null;if(r.locale&&(i=t.parse(r.locale,1,de),!i))return null;let a=null;if(r.currency&&(a=t.parse(r.currency,1,de),!a))return null;let o=null;if(r["min-fraction-digits"]&&(o=t.parse(r["min-fraction-digits"],1,ce),!o))return null;let s=null;return r["max-fraction-digits"]&&(s=t.parse(r["max-fraction-digits"],1,ce),!s)?null:new Wt(n,i,a,o,s)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Zt{constructor(e){this.type=ye,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const n=e[1];if(!Array.isArray(n)&&"object"==typeof n)return t.error("First argument must be an image or text section.");const r=[];let i=!1;for(let a=1;a<=e.length-1;++a){const n=e[a];if(i&&"object"==typeof n&&!Array.isArray(n)){i=!1;let e=null;if(n["font-scale"]&&(e=t.parse(n["font-scale"],1,ce),!e))return null;let a=null;if(n["text-font"]&&(a=t.parse(n["text-font"],1,xe(de)),!a))return null;let o=null;if(n["text-color"]&&(o=t.parse(n["text-color"],1,fe),!o))return null;const s=r[r.length-1];s.scale=e,s.font=a,s.textColor=o}else{const n=t.parse(e[a],1,me);if(!n)return null;const o=n.type.kind;if("string"!==o&&"value"!==o&&"null"!==o&&"resolvedImage"!==o)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,r.push({content:n,scale:null,font:null,textColor:null})}}return new Zt(r)}evaluate(e){return new Ye(this.sections.map(t=>{const n=t.content.evaluate(e);return it(n)===_e?new $e("",n,null,null,null):new $e(at(n),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}}class Kt{constructor(e){this.type=_e,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const n=t.parse(e[1],1,de);return n?new Kt(n):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),n=tt.fromString(t);return n&&e.availableImages&&(n.available=e.availableImages.indexOf(t)>-1),n}eachChild(e){e(this.input)}outputDefined(){return!1}}class Gt{constructor(e){this.type=ce,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected 1 argument, but found ".concat(e.length-1," instead."));const n=t.parse(e[1],1);return n?"array"!==n.type.kind&&"string"!==n.type.kind&&"value"!==n.type.kind?t.error("Expected argument of type string or array, but found ".concat(we(n.type)," instead.")):new Gt(n):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return[...t].length;if(Array.isArray(t))return t.length;throw new st("Expected value to be of type string or array, but found ".concat(we(it(t))," instead."))}eachChild(e){e(this.input)}outputDefined(){return!1}}const Xt=8192;function $t(e,t){const n=(180+e[0])/360,r=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(n*i*Xt),Math.round(r*i*Xt)]}function Yt(e,t){const n=Math.pow(2,t.z);return[(i=(e[0]/Xt+t.x)/n,360*i-180),(r=(e[1]/Xt+t.y)/n,360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90)];var r,i}function Jt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Qt(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function en(e,t,n){const r=e[0]-t[0],i=e[1]-t[1],a=e[0]-n[0],o=e[1]-n[1];return r*o-a*i==0&&r*a<=0&&i*o<=0}function tn(e,t,n,r){return 0!=(i=[r[0]-n[0],r[1]-n[1]])[0]*(a=[t[0]-e[0],t[1]-e[1]])[1]-i[1]*a[0]&&!(!ln(e,t,n,r)||!ln(n,r,e,t));var i,a}function nn(e,t,n){for(const r of n)for(let n=0;n<r.length-1;++n)if(tn(e,t,r[n],r[n+1]))return!0;return!1}function rn(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1;for(const s of t)for(let t=0;t<s.length-1;t++){if(en(e,s[t],s[t+1]))return n;(a=s[t])[1]>(i=e)[1]!=(o=s[t+1])[1]>i[1]&&i[0]<(o[0]-a[0])*(i[1]-a[1])/(o[1]-a[1])+a[0]&&(r=!r)}var i,a,o;return r}function an(e,t){for(const n of t)if(rn(e,n))return!0;return!1}function on(e,t){for(const n of e)if(!rn(n,t))return!1;for(let n=0;n<e.length-1;++n)if(nn(e[n],e[n+1],t))return!1;return!0}function sn(e,t){for(const n of t)if(on(e,n))return!0;return!1}function ln(e,t,n,r){const i=r[0]-n[0],a=r[1]-n[1],o=(e[0]-n[0])*a-i*(e[1]-n[1]),s=(t[0]-n[0])*a-i*(t[1]-n[1]);return o>0&&s<0||o<0&&s>0}function un(e,t,n){const r=[];for(let i=0;i<e.length;i++){const a=[];for(let r=0;r<e[i].length;r++){const o=$t(e[i][r],n);Jt(t,o),a.push(o)}r.push(a)}return r}function cn(e,t,n){const r=[];for(let i=0;i<e.length;i++){const a=un(e[i],t,n);r.push(a)}return r}function dn(e,t,n,r){if(e[0]<n[0]||e[0]>n[2]){const t=.5*r;let i=e[0]-n[0]>t?-r:n[0]-e[0]>t?r:0;0===i&&(i=e[0]-n[2]>t?-r:n[2]-e[0]>t?r:0),e[0]+=i}Jt(t,e)}function hn(e,t,n,r){const i=Math.pow(2,r.z)*Xt,a=[r.x*Xt,r.y*Xt],o=[];for(const s of e)for(const e of s){const r=[e.x+a[0],e.y+a[1]];dn(r,t,n,i),o.push(r)}return o}function fn(e,t,n,r){const i=Math.pow(2,r.z)*Xt,a=[r.x*Xt,r.y*Xt],o=[];for(const l of e){const e=[];for(const n of l){const r=[n.x+a[0],n.y+a[1]];Jt(t,r),e.push(r)}o.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of o)for(const r of e)dn(r,t,n,i)}var s;return o}class pn{constructor(e,t){this.type=he,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'within' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(rt(e[1])){const t=e[1];if("FeatureCollection"===t.type){const e=[];for(const n of t.features){const{type:t,coordinates:r}=n.geometry;"Polygon"===t&&e.push(r),"MultiPolygon"===t&&e.push(...r)}if(e.length)return new pn(t,{type:"MultiPolygon",coordinates:e})}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new pn(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new pn(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=un(t.coordinates,r,i),o=hn(e.geometry(),n,r,i);if(!Qt(n,r))return!1;for(const e of o)if(!rn(e,a))return!1}if("MultiPolygon"===t.type){const a=cn(t.coordinates,r,i),o=hn(e.geometry(),n,r,i);if(!Qt(n,r))return!1;for(const e of o)if(!an(e,a))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=[1/0,1/0,-1/0,-1/0],r=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if("Polygon"===t.type){const a=un(t.coordinates,r,i),o=fn(e.geometry(),n,r,i);if(!Qt(n,r))return!1;for(const e of o)if(!on(e,a))return!1}if("MultiPolygon"===t.type){const a=cn(t.coordinates,r,i),o=fn(e.geometry(),n,r,i);if(!Qt(n,r))return!1;for(const e of o)if(!sn(e,a))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let mn=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(n(r,a)>=0)break;t[e]=a,e=i}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,i=t[e];for(;e<r;){let r=1+(e<<1);const a=r+1;if(a<this.length&&n(t[a],t[r])<0&&(r=a),n(t[r],i)>=0)break;t[e]=t[r],e=r}t[e]=i}};function gn(e,t,n,r,i){yn(e,t,n,r||e.length-1,i||_n)}function yn(e,t,n,r,i){for(;r>n;){if(r-n>600){var a=r-n+1,o=t-n+1,s=Math.log(a),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(a-l)/a)*(o-a/2<0?-1:1);yn(e,t,Math.max(n,Math.floor(t-o*l/a+u)),Math.min(r,Math.floor(t+(a-o)*l/a+u)),i)}var c=e[t],d=n,h=r;for(vn(e,n,t),i(e[r],c)>0&&vn(e,n,r);d<h;){for(vn(e,d,h),d++,h--;i(e[d],c)<0;)d++;for(;i(e[h],c)>0;)h--}0===i(e[n],c)?vn(e,n,h):vn(e,++h,r),h<=t&&(n=h+1),t<=h&&(r=h-1)}}function vn(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function _n(e,t){return e<t?-1:e>t?1:0}function bn(e,t){if(e.length<=1)return[e];const n=[];let r,i;for(const a of e){const e=wn(a);0!==e&&(a.area=Math.abs(e),void 0===i&&(i=e<0),i===e<0?(r&&n.push(r),r=[a]):r.push(a))}if(r&&n.push(r),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(gn(n[a],t,1,n[a].length-1,xn),n[a]=n[a].slice(0,t));return n}function xn(e,t){return t.area-e.area}function wn(e){let t=0;for(let n,r,i=0,a=e.length,o=a-1;i<a;o=i++)n=e[i],r=e[o],t+=(r.x-n.x)*(n.y+r.y);return t}const kn=1/298.257223563,Sn=kn*(2-kn),En=Math.PI/180;class Cn{constructor(e){const t=6378.137*En*1e3,n=Math.cos(e*En),r=1/(1-Sn*(1-n*n)),i=Math.sqrt(r);this.kx=t*i*n,this.ky=t*i*r*(1-Sn)}distance(e,t){const n=this.wrap(e[0]-t[0])*this.kx,r=(e[1]-t[1])*this.ky;return Math.sqrt(n*n+r*r)}pointOnLine(e,t){let n,r,i,a,o=1/0;for(let s=0;s<e.length-1;s++){let l=e[s][0],u=e[s][1],c=this.wrap(e[s+1][0]-l)*this.kx,d=(e[s+1][1]-u)*this.ky,h=0;0===c&&0===d||(h=(this.wrap(t[0]-l)*this.kx*c+(t[1]-u)*this.ky*d)/(c*c+d*d),h>1?(l=e[s+1][0],u=e[s+1][1]):h>0&&(l+=c/this.kx*h,u+=d/this.ky*h)),c=this.wrap(t[0]-l)*this.kx,d=(t[1]-u)*this.ky;const f=c*c+d*d;f<o&&(o=f,n=l,r=u,i=s,a=h)}return{point:[n,r],index:i,t:Math.max(0,Math.min(1,a))}}wrap(e){for(;e<-180;)e+=360;for(;e>180;)e-=360;return e}}function Pn(e,t){return t[0]-e[0]}function Dn(e){return e[1]-e[0]+1}function In(e,t){return e[1]>=e[0]&&e[1]<t}function Tn(e,t){if(e[0]>e[1])return[null,null];const n=Dn(e);if(t){if(2===n)return[e,null];const t=Math.floor(n/2);return[[e[0],e[0]+t],[e[0]+t,e[1]]]}if(1===n)return[e,null];const r=Math.floor(n/2)-1;return[[e[0],e[0]+r],[e[0]+r+1,e[1]]]}function An(e,t){if(!In(t,e.length))return[1/0,1/0,-1/0,-1/0];const n=[1/0,1/0,-1/0,-1/0];for(let r=t[0];r<=t[1];++r)Jt(n,e[r]);return n}function zn(e){const t=[1/0,1/0,-1/0,-1/0];for(const n of e)for(const e of n)Jt(t,e);return t}function On(e){return e[0]!==-1/0&&e[1]!==-1/0&&e[2]!==1/0&&e[3]!==1/0}function Fn(e,t,n){if(!On(e)||!On(t))return NaN;let r=0,i=0;return e[2]<t[0]&&(r=t[0]-e[2]),e[0]>t[2]&&(r=e[0]-t[2]),e[1]>t[3]&&(i=e[1]-t[3]),e[3]<t[1]&&(i=t[1]-e[3]),n.distance([0,0],[r,i])}function Mn(e,t,n){const r=n.pointOnLine(t,e);return n.distance(e,r.point)}function jn(e,t,n,r,i){const a=Math.min(Mn(e,[n,r],i),Mn(t,[n,r],i)),o=Math.min(Mn(n,[e,t],i),Mn(r,[e,t],i));return Math.min(a,o)}function Bn(e,t,n,r,i){if(!In(t,e.length)||!In(r,n.length))return 1/0;let a=1/0;for(let o=t[0];o<t[1];++o){const t=e[o],s=e[o+1];for(let e=r[0];e<r[1];++e){const r=n[e],o=n[e+1];if(tn(t,s,r,o))return 0;a=Math.min(a,jn(t,s,r,o,i))}}return a}function Rn(e,t,n,r,i){if(!In(t,e.length)||!In(r,n.length))return NaN;let a=1/0;for(let o=t[0];o<=t[1];++o)for(let t=r[0];t<=r[1];++t)if(a=Math.min(a,i.distance(e[o],n[t])),0===a)return a;return a}function Ln(e,t,n){if(rn(e,t,!0))return 0;let r=1/0;for(const i of t){const t=i[0],a=i[i.length-1];if(t!==a&&(r=Math.min(r,Mn(e,[a,t],n)),0===r))return r;const o=n.pointOnLine(i,e);if(r=Math.min(r,n.distance(e,o.point)),0===r)return r}return r}function Nn(e,t,n,r){if(!In(t,e.length))return NaN;for(let a=t[0];a<=t[1];++a)if(rn(e[a],n,!0))return 0;let i=1/0;for(let a=t[0];a<t[1];++a){const t=e[a],o=e[a+1];for(const e of n)for(let n=0,a=e.length,s=a-1;n<a;s=n++){const a=e[s],l=e[n];if(tn(t,o,a,l))return 0;i=Math.min(i,jn(t,o,a,l,r))}}return i}function Un(e,t){for(const n of e)for(const e of n)if(rn(e,t,!0))return!0;return!1}function Vn(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;const i=zn(e),a=zn(t);if(r!==1/0&&Fn(i,a,n)>=r)return r;if(Qt(i,a)){if(Un(e,t))return 0}else if(Un(t,e))return 0;let o=1/0;for(const s of e)for(let e=0,r=s.length,i=r-1;e<r;i=e++){const r=s[i],a=s[e];for(const e of t)for(let t=0,i=e.length,s=i-1;t<i;s=t++){const i=e[s],l=e[t];if(tn(r,a,i,l))return 0;o=Math.min(o,jn(r,a,i,l,n))}}return o}function qn(e,t,n,r,i,a){if(!a)return;const o=Fn(An(r,a),i,n);o<t&&e.push([o,a,[0,0]])}function Hn(e,t,n,r,i,a,o){if(!a||!o)return;const s=Fn(An(r,a),An(i,o),n);s<t&&e.push([s,a,o])}function Wn(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1/0,a=Math.min(r.distance(e[0],n[0][0]),i);if(0===a)return a;const o=new mn([[0,[0,e.length-1],[0,0]]],Pn),s=zn(n);for(;o.length>0;){const i=o.pop();if(i[0]>=a)continue;const l=i[1],u=t?50:100;if(Dn(l)<=u){if(!In(l,e.length))return NaN;if(t){const t=Nn(e,l,n,r);if(isNaN(t)||0===t)return t;a=Math.min(a,t)}else for(let t=l[0];t<=l[1];++t){const i=Ln(e[t],n,r);if(a=Math.min(a,i),0===a)return 0}}else{const n=Tn(l,t);qn(o,a,r,e,s,n[0]),qn(o,a,r,e,s,n[1])}}return a}function Zn(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1/0,o=Math.min(a,i.distance(e[0],n[0]));if(0===o)return o;const s=new mn([[0,[0,e.length-1],[0,n.length-1]]],Pn);for(;s.length>0;){const a=s.pop();if(a[0]>=o)continue;const l=a[1],u=a[2],c=t?50:100,d=r?50:100;if(Dn(l)<=c&&Dn(u)<=d){if(!In(l,e.length)&&In(u,n.length))return NaN;let a;if(t&&r)a=Bn(e,l,n,u,i),o=Math.min(o,a);else if(t&&!r){const t=e.slice(l[0],l[1]+1);for(let e=u[0];e<=u[1];++e)if(a=Mn(n[e],t,i),o=Math.min(o,a),0===o)return o}else if(!t&&r){const t=n.slice(u[0],u[1]+1);for(let n=l[0];n<=l[1];++n)if(a=Mn(e[n],t,i),o=Math.min(o,a),0===o)return o}else a=Rn(e,l,n,u,i),o=Math.min(o,a)}else{const a=Tn(l,t),c=Tn(u,r);Hn(s,o,i,e,n,a[0],c[0]),Hn(s,o,i,e,n,a[0],c[1]),Hn(s,o,i,e,n,a[1],c[0]),Hn(s,o,i,e,n,a[1],c[1])}}return o}function Kn(e){return"MultiPolygon"===e.type?e.coordinates.map(e=>({type:"Polygon",coordinates:e})):"MultiLineString"===e.type?e.coordinates.map(e=>({type:"LineString",coordinates:e})):"MultiPoint"===e.type?e.coordinates.map(e=>({type:"Point",coordinates:e})):[e]}class Gn{constructor(e,t){this.type=ce,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error("'distance' expression requires exactly one argument, but found ".concat(e.length-1," instead."));if(rt(e[1])){const t=e[1];if("FeatureCollection"===t.type)return new Gn(t,t.features.map(e=>Kn(e.geometry)).flat());if("Feature"===t.type)return new Gn(t,Kn(t.geometry));if("type"in t&&"coordinates"in t)return new Gn(t,Kn(t))}return t.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const n=e.geometry(),r=n.flat().map(t=>Yt([t.x,t.y],e.canonical));if(0===n.length)return NaN;const i=new Cn(r[0][1]);let a=1/0;for(const o of t){switch(o.type){case"Point":a=Math.min(a,Zn(r,!1,[o.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Zn(r,!1,o.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,Wn(r,!1,o.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const n=e.geometry(),r=n.flat().map(t=>Yt([t.x,t.y],e.canonical));if(0===n.length)return NaN;const i=new Cn(r[0][1]);let a=1/0;for(const o of t){switch(o.type){case"Point":a=Math.min(a,Zn(r,!0,[o.coordinates],!1,i,a));break;case"LineString":a=Math.min(a,Zn(r,!0,o.coordinates,!0,i,a));break;case"Polygon":a=Math.min(a,Wn(r,!0,o.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries);if("Polygon"===e.geometryType())return function(e,t){const n=e.geometry();if(0===n.length||0===n[0].length)return NaN;const r=bn(n,0).map(t=>t.map(t=>t.map(t=>Yt([t.x,t.y],e.canonical)))),i=new Cn(r[0][0][0][1]);let a=1/0;for(const o of t)for(const e of r){switch(o.type){case"Point":a=Math.min(a,Wn([o.coordinates],!1,e,i,a));break;case"LineString":a=Math.min(a,Wn(o.coordinates,!0,e,i,a));break;case"Polygon":a=Math.min(a,Vn(e,o.coordinates,i,a))}if(0===a)return a}return a}(e,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Xn={"==":Rt,"!=":Lt,">":Ut,"<":Nt,">=":qt,"<=":Vt,array:ut,at:yt,boolean:ut,case:xt,coalesce:Ft,collator:Ht,format:Zt,image:Kt,in:vt,"index-of":_t,interpolate:zt,"interpolate-hcl":zt,"interpolate-lab":zt,length:Gt,let:mt,literal:ot,match:bt,number:ut,"number-format":Wt,object:ut,slice:wt,step:St,string:ut,"to-boolean":dt,"to-color":dt,"to-number":dt,"to-string":dt,var:gt,within:pn,distance:Gn};class $n{constructor(e,t,n,r){this.name=e,this.type=t,this._evaluate=n,this.args=r}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,t){const n=e[0],r=$n.definitions[n];if(!r)return t.error('Unknown expression "'.concat(n,'". If you wanted a literal array, use ["literal", [...]].'),0);const i=Array.isArray(r)?r[0]:r.type,a=Array.isArray(r)?[[r[1],r[2]]]:r.overloads,o=a.filter(t=>{let[n]=t;return!Array.isArray(n)||n.length===e.length-1});let s=null;for(const[l,u]of o){s=new pt(t.registry,tr,t.path,null,t.scope);const r=[];let a=!1;for(let t=1;t<e.length;t++){const n=e[t],i=Array.isArray(l)?l[t-1]:l.type,o=s.parse(n,1+r.length,i);if(!o){a=!0;break}r.push(o)}if(!a)if(Array.isArray(l)&&l.length!==r.length)s.error("Expected ".concat(l.length," arguments, but found ").concat(r.length," instead."));else{for(let e=0;e<r.length;e++){const t=Array.isArray(l)?l[e]:l.type,n=r[e];s.concat(e+1).checkSubtype(t,n.type)}if(0===s.errors.length)return new $n(n,i,u,r)}}if(1===o.length)t.errors.push(...s.errors);else{const n=(o.length?o:a).map(e=>{let[t]=e;return n=t,Array.isArray(n)?"(".concat(n.map(we).join(", "),")"):"(".concat(we(n.type),"...)");var n}).join(" | "),r=[];for(let i=1;i<e.length;i++){const n=t.parse(e[i],1+r.length);if(!n)return null;r.push(we(n.type))}t.error("Expected arguments of type ".concat(n,", but found (").concat(r.join(", "),") instead."))}return null}static register(e,t){$n.definitions=t;for(const n in t)e[n]=$n}}function Yn(e,t){let[n,r,i,a]=t;n=n.evaluate(e),r=r.evaluate(e),i=i.evaluate(e);const o=a?a.evaluate(e):1,s=nt(n,r,i,o);if(s)throw new st(s);return new Ge(n/255,r/255,i/255,o,!1)}function Jn(e,t){return e in t}function Qn(e,t){const n=t[e];return void 0===n?null:n}function er(e){return{type:e}}function tr(e){if(e instanceof gt)return tr(e.boundExpression);if(e instanceof $n&&"error"===e.name)return!1;if(e instanceof Ht)return!1;if(e instanceof pn)return!1;if(e instanceof Gn)return!1;const t=e instanceof dt||e instanceof ut;let n=!0;return e.eachChild(e=>{n=t?n&&tr(e):n&&e instanceof ot}),!!n&&nr(e)&&ir(e,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function nr(e){if(e instanceof $n){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof pn)return!1;if(e instanceof Gn)return!1;let t=!0;return e.eachChild(e=>{t&&!nr(e)&&(t=!1)}),t}function rr(e){if(e instanceof $n&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild(e=>{t&&!rr(e)&&(t=!1)}),t}function ir(e,t){if(e instanceof $n&&t.indexOf(e.name)>=0)return!1;let n=!0;return e.eachChild(e=>{n&&!ir(e,t)&&(n=!1)}),n}function ar(e){return{result:"success",value:e}}function or(e){return{result:"error",value:e}}function sr(e){return"data-driven"===e["property-type"]||"cross-faded-data-driven"===e["property-type"]}function lr(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function ur(e){return!!e.expression&&e.expression.interpolated}function cr(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function dr(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function hr(e){return e}function fr(e,t){const n="color"===t.type,r=e.stops&&"object"==typeof e.stops[0][0],i=r||!(r||void 0!==e.property),a=e.type||(ur(t)?"exponential":"interval");if(n||"padding"===t.type){const r=n?Ge.parse:Je.parse;(e=oe({},e)).stops&&(e.stops=e.stops.map(e=>[e[0],r(e[1])])),e.default=r(e.default?e.default:t.default)}if(e.colorSpace&&"rgb"!==(o=e.colorSpace)&&"hcl"!==o&&"lab"!==o)throw new Error('Unknown color space: "'.concat(e.colorSpace,'"'));var o;let s,l,u;if("exponential"===a)s=yr;else if("interval"===a)s=gr;else if("categorical"===a){s=mr,l=Object.create(null);for(const t of e.stops)l[t[0]]=t[1];u=typeof e.stops[0][0]}else{if("identity"!==a)throw new Error('Unknown function type "'.concat(a,'"'));s=vr}if(r){const n={},r=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],a=i[0].zoom;void 0===n[a]&&(n[a]={zoom:a,type:e.type,property:e.property,default:e.default,stops:[]},r.push(a)),n[a].stops.push([i[0].value,i[1]])}const i=[];for(const e of r)i.push([n[e].zoom,fr(n[e],t)]);const a={name:"linear"};return{kind:"composite",interpolationType:a,interpolationFactor:zt.interpolationFactor.bind(void 0,a),zoomStops:i.map(e=>e[0]),evaluate:(n,r)=>{let{zoom:a}=n;return yr({stops:i,base:e.base},t,a).evaluate(a,r)}}}if(i){const n="exponential"===a?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:n,interpolationFactor:zt.interpolationFactor.bind(void 0,n),zoomStops:e.stops.map(e=>e[0]),evaluate:n=>{let{zoom:r}=n;return s(e,t,r,l,u)}}}return{kind:"source",evaluate(n,r){const i=r&&r.properties?r.properties[e.property]:void 0;return void 0===i?pr(e.default,t.default):s(e,t,i,l,u)}}}function pr(e,t,n){return void 0!==e?e:void 0!==t?t:void 0!==n?n:void 0}function mr(e,t,n,r,i){return pr(typeof n===i?r[n]:void 0,e.default,t.default)}function gr(e,t,n){if("number"!==cr(n))return pr(e.default,t.default);const r=e.stops.length;if(1===r)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[r-1][0])return e.stops[r-1][1];const i=kt(e.stops.map(e=>e[0]),n);return e.stops[i][1]}function yr(e,t,n){const r=void 0!==e.base?e.base:1;if("number"!==cr(n))return pr(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(n<=e.stops[0][0])return e.stops[0][1];if(n>=e.stops[i-1][0])return e.stops[i-1][1];const a=kt(e.stops.map(e=>e[0]),n),o=function(e,t,n,r){const i=r-n,a=e-n;return 0===i?0:1===t?a/i:(Math.pow(t,a)-1)/(Math.pow(t,i)-1)}(n,r,e.stops[a][0],e.stops[a+1][0]),s=e.stops[a][1],l=e.stops[a+1][1],u=At[t.type]||hr;return"function"==typeof s.evaluate?{evaluate(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];const i=s.evaluate.apply(void 0,n),a=l.evaluate.apply(void 0,n);if(void 0!==i&&void 0!==a)return u(i,a,o,e.colorSpace)}}:u(s,l,o,e.colorSpace)}function vr(e,t,n){switch(t.type){case"color":n=Ge.parse(n);break;case"formatted":n=Ye.fromString(n.toString());break;case"resolvedImage":n=tt.fromString(n.toString());break;case"padding":n=Je.parse(n);break;default:cr(n)===t.type||"enum"===t.type&&t.values[n]||(n=void 0)}return pr(n,e.default,t.default)}$n.register(Xn,{error:[{kind:"error"},[de],(e,t)=>{let[n]=t;throw new st(n.evaluate(e))}],typeof:[de,[me],(e,t)=>{let[n]=t;return we(it(n.evaluate(e)))}],"to-rgba":[xe(ce,4),[fe],(e,t)=>{let[n]=t;const[r,i,a,o]=n.evaluate(e).rgb;return[255*r,255*i,255*a,o]}],rgb:[fe,[ce,ce,ce],Yn],rgba:[fe,[ce,ce,ce,ce],Yn],has:{type:he,overloads:[[[de],(e,t)=>{let[n]=t;return Jn(n.evaluate(e),e.properties())}],[[de,pe],(e,t)=>{let[n,r]=t;return Jn(n.evaluate(e),r.evaluate(e))}]]},get:{type:me,overloads:[[[de],(e,t)=>{let[n]=t;return Qn(n.evaluate(e),e.properties())}],[[de,pe],(e,t)=>{let[n,r]=t;return Qn(n.evaluate(e),r.evaluate(e))}]]},"feature-state":[me,[de],(e,t)=>{let[n]=t;return Qn(n.evaluate(e),e.featureState||{})}],properties:[pe,[],e=>e.properties()],"geometry-type":[de,[],e=>e.geometryType()],id:[me,[],e=>e.id()],zoom:[ce,[],e=>e.globals.zoom],"heatmap-density":[ce,[],e=>e.globals.heatmapDensity||0],"line-progress":[ce,[],e=>e.globals.lineProgress||0],accumulated:[me,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ce,er(ce),(e,t)=>{let n=0;for(const r of t)n+=r.evaluate(e);return n}],"*":[ce,er(ce),(e,t)=>{let n=1;for(const r of t)n*=r.evaluate(e);return n}],"-":{type:ce,overloads:[[[ce,ce],(e,t)=>{let[n,r]=t;return n.evaluate(e)-r.evaluate(e)}],[[ce],(e,t)=>{let[n]=t;return-n.evaluate(e)}]]},"/":[ce,[ce,ce],(e,t)=>{let[n,r]=t;return n.evaluate(e)/r.evaluate(e)}],"%":[ce,[ce,ce],(e,t)=>{let[n,r]=t;return n.evaluate(e)%r.evaluate(e)}],ln2:[ce,[],()=>Math.LN2],pi:[ce,[],()=>Math.PI],e:[ce,[],()=>Math.E],"^":[ce,[ce,ce],(e,t)=>{let[n,r]=t;return Math.pow(n.evaluate(e),r.evaluate(e))}],sqrt:[ce,[ce],(e,t)=>{let[n]=t;return Math.sqrt(n.evaluate(e))}],log10:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN10}],ln:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))}],log2:[ce,[ce],(e,t)=>{let[n]=t;return Math.log(n.evaluate(e))/Math.LN2}],sin:[ce,[ce],(e,t)=>{let[n]=t;return Math.sin(n.evaluate(e))}],cos:[ce,[ce],(e,t)=>{let[n]=t;return Math.cos(n.evaluate(e))}],tan:[ce,[ce],(e,t)=>{let[n]=t;return Math.tan(n.evaluate(e))}],asin:[ce,[ce],(e,t)=>{let[n]=t;return Math.asin(n.evaluate(e))}],acos:[ce,[ce],(e,t)=>{let[n]=t;return Math.acos(n.evaluate(e))}],atan:[ce,[ce],(e,t)=>{let[n]=t;return Math.atan(n.evaluate(e))}],min:[ce,er(ce),(e,t)=>Math.min(...t.map(t=>t.evaluate(e)))],max:[ce,er(ce),(e,t)=>Math.max(...t.map(t=>t.evaluate(e)))],abs:[ce,[ce],(e,t)=>{let[n]=t;return Math.abs(n.evaluate(e))}],round:[ce,[ce],(e,t)=>{let[n]=t;const r=n.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[ce,[ce],(e,t)=>{let[n]=t;return Math.floor(n.evaluate(e))}],ceil:[ce,[ce],(e,t)=>{let[n]=t;return Math.ceil(n.evaluate(e))}],"filter-==":[he,[de,me],(e,t)=>{let[n,r]=t;return e.properties()[n.value]===r.value}],"filter-id-==":[he,[me],(e,t)=>{let[n]=t;return e.id()===n.value}],"filter-type-==":[he,[de],(e,t)=>{let[n]=t;return e.geometryType()===n.value}],"filter-<":[he,[de,me],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],a=r.value;return typeof i==typeof a&&i<a}],"filter-id-<":[he,[me],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r<i}],"filter->":[he,[de,me],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],a=r.value;return typeof i==typeof a&&i>a}],"filter-id->":[he,[me],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r>i}],"filter-<=":[he,[de,me],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],a=r.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[he,[me],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r<=i}],"filter->=":[he,[de,me],(e,t)=>{let[n,r]=t;const i=e.properties()[n.value],a=r.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[he,[me],(e,t)=>{let[n]=t;const r=e.id(),i=n.value;return typeof r==typeof i&&r>=i}],"filter-has":[he,[me],(e,t)=>{let[n]=t;return n.value in e.properties()}],"filter-has-id":[he,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[he,[xe(de)],(e,t)=>{let[n]=t;return n.value.indexOf(e.geometryType())>=0}],"filter-id-in":[he,[xe(me)],(e,t)=>{let[n]=t;return n.value.indexOf(e.id())>=0}],"filter-in-small":[he,[de,xe(me)],(e,t)=>{let[n,r]=t;return r.value.indexOf(e.properties()[n.value])>=0}],"filter-in-large":[he,[de,xe(me)],(e,t)=>{let[n,r]=t;return function(e,t,n,r){for(;n<=r;){const i=n+r>>1;if(t[i]===e)return!0;t[i]>e?r=i-1:n=i+1}return!1}(e.properties()[n.value],r.value,0,r.value.length-1)}],all:{type:he,overloads:[[[he,he],(e,t)=>{let[n,r]=t;return n.evaluate(e)&&r.evaluate(e)}],[er(he),(e,t)=>{for(const n of t)if(!n.evaluate(e))return!1;return!0}]]},any:{type:he,overloads:[[[he,he],(e,t)=>{let[n,r]=t;return n.evaluate(e)||r.evaluate(e)}],[er(he),(e,t)=>{for(const n of t)if(n.evaluate(e))return!0;return!1}]]},"!":[he,[he],(e,t)=>{let[n]=t;return!n.evaluate(e)}],"is-supported-script":[he,[de],(e,t)=>{let[n]=t;const r=e.globals&&e.globals.isSupportedScript;return!r||r(n.evaluate(e))}],upcase:[de,[de],(e,t)=>{let[n]=t;return n.evaluate(e).toUpperCase()}],downcase:[de,[de],(e,t)=>{let[n]=t;return n.evaluate(e).toLowerCase()}],concat:[de,er(me),(e,t)=>t.map(t=>at(t.evaluate(e))).join("")],"resolved-locale":[de,[ge],(e,t)=>{let[n]=t;return n.evaluate(e).resolvedLocale()}]});class _r{constructor(e,t){var n;this.expression=e,this._warningHistory={},this._evaluator=new ft,this._defaultValue=t?"color"===(n=t).type&&dr(n.default)?new Ge(0,0,0,0):"color"===n.type?Ge.parse(n.default)||null:"padding"===n.type?Je.parse(n.default)||null:"variableAnchorOffsetCollection"===n.type?et.parse(n.default)||null:void 0===n.default?null:n.default:null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,n,r,i,a){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=n,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a,this.expression.evaluate(this._evaluator)}evaluate(e,t,n,r,i,a){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=n||null,this._evaluator.canonical=r,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=a||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new st("Expected value to be one of ".concat(Object.keys(this._enumValues).map(e=>JSON.stringify(e)).join(", "),", but found ").concat(JSON.stringify(e)," instead."));return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function br(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Xn}function xr(e,t){const n=new pt(Xn,tr,[],t?function(e){const t={color:fe,string:de,number:ce,enum:de,boolean:he,formatted:ye,padding:ve,resolvedImage:_e,variableAnchorOffsetCollection:be};return"array"===e.type?xe(t[e.value]||me,e.length):t[e.type]}(t):void 0),r=n.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return r?ar(new _r(r,t)):or(n.errors)}class wr{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!rr(t.expression)}evaluateWithoutErrorHandling(e,t,n,r,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,a)}evaluate(e,t,n,r,i,a){return this._styleExpression.evaluate(e,t,n,r,i,a)}}class kr{constructor(e,t,n,r){this.kind=e,this.zoomStops=n,this._styleExpression=t,this.isStateDependent="camera"!==e&&!rr(t.expression),this.interpolationType=r}evaluateWithoutErrorHandling(e,t,n,r,i,a){return this._styleExpression.evaluateWithoutErrorHandling(e,t,n,r,i,a)}evaluate(e,t,n,r,i,a){return this._styleExpression.evaluate(e,t,n,r,i,a)}interpolationFactor(e,t,n){return this.interpolationType?zt.interpolationFactor(this.interpolationType,e,t,n):0}}function Sr(e,t){const n=xr(e,t);if("error"===n.result)return n;const r=n.value.expression,i=nr(r);if(!i&&!sr(t))return or([new se("","data expressions not supported")]);const a=ir(r,["zoom"]);if(!a&&!lr(t))return or([new se("","zoom expressions not supported")]);const o=Cr(r);return o||a?o instanceof se?or([o]):o instanceof zt&&!ur(t)?or([new se("",'"interpolate" expressions cannot be used with this property')]):ar(o?new kr(i?"camera":"composite",n.value,o.labels,o instanceof zt?o.interpolation:void 0):new wr(i?"constant":"source",n.value)):or([new se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Er{constructor(e,t){this._parameters=e,this._specification=t,oe(this,fr(this._parameters,this._specification))}static deserialize(e){return new Er(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Cr(e){let t=null;if(e instanceof mt)t=Cr(e.result);else if(e instanceof Ft){for(const n of e.args)if(t=Cr(n),t)break}else(e instanceof St||e instanceof zt)&&e.input instanceof $n&&"zoom"===e.input.name&&(t=e);return t instanceof se||e.eachChild(e=>{const n=Cr(e);n instanceof se?t=n:!t&&n?t=new se("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&n&&t!==n&&(t=new se("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Pr(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!Pr(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const Dr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ir(e){if(null==e)return{filter:()=>!0,needGeometry:!1};Pr(e)||(e=zr(e));const t=xr(e,Dr);if("error"===t.result)throw new Error(t.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));return{filter:(e,n,r)=>t.value.evaluate(e,n,{},r),needGeometry:Ar(e)}}function Tr(e,t){return e<t?-1:e>t?1:0}function Ar(e){if(!Array.isArray(e))return!1;if("within"===e[0]||"distance"===e[0])return!0;for(let t=1;t<e.length;t++)if(Ar(e[t]))return!0;return!1}function zr(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?Or(e[1],e[2],"=="):"!="===t?jr(Or(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Or(e[1],e[2],t):"any"===t?(n=e.slice(1),["any"].concat(n.map(zr))):"all"===t?["all"].concat(e.slice(1).map(zr)):"none"===t?["all"].concat(e.slice(1).map(zr).map(jr)):"in"===t?Fr(e[1],e.slice(2)):"!in"===t?jr(Fr(e[1],e.slice(2))):"has"===t?Mr(e[1]):"!has"!==t||jr(Mr(e[1]));var n}function Or(e,t,n){switch(e){case"$type":return["filter-type-".concat(n),t];case"$id":return["filter-id-".concat(n),t];default:return["filter-".concat(n),e,t]}}function Fr(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(e=>typeof e!=typeof t[0])?["filter-in-large",e,["literal",t.sort(Tr)]]:["filter-in-small",e,["literal",t]]}}function Mr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function jr(e){return["!",e]}function Br(e){const t=typeof e;if("number"===t||"boolean"===t||"string"===t||null==e)return JSON.stringify(e);if(Array.isArray(e)){let t="[";for(const n of e)t+="".concat(Br(n),",");return"".concat(t,"]")}const n=Object.keys(e).sort();let r="{";for(let i=0;i<n.length;i++)r+="".concat(JSON.stringify(n[i]),":").concat(Br(e[n[i]]),",");return"".concat(r,"}")}function Rr(e){let t="";for(const n of G)t+="/".concat(Br(e[n]));return t}function Lr(e){const t=e.value;return t?[new ae(e.key,t,"constants have been deprecated as of v8")]:[]}function Nr(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Ur(e){if(Array.isArray(e))return e.map(Ur);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const n in e)t[n]=Ur(e[n]);return t}return Nr(e)}function Vr(e){const t=e.key,n=e.value,r=e.valueSpec||{},i=e.objectElementValidators||{},a=e.style,o=e.styleSpec,s=e.validateSpec;let l=[];const u=cr(n);if("object"!==u)return[new ae(t,n,"object expected, ".concat(u," found"))];for(const c in n){const e=c.split(".")[0],u=r[e]||r["*"];let d;if(i[e])d=i[e];else if(r[e])d=s;else if(i["*"])d=i["*"];else{if(!r["*"]){l.push(new ae(t,n[c],'unknown property "'.concat(c,'"')));continue}d=s}l=l.concat(d({key:(t?"".concat(t,"."):t)+c,value:n[c],valueSpec:u,style:a,styleSpec:o,object:n,objectKey:c,validateSpec:s},n))}for(const c in r)i[c]||r[c].required&&void 0===r[c].default&&void 0===n[c]&&l.push(new ae(t,n,'missing required property "'.concat(c,'"')));return l}function qr(e){const t=e.value,n=e.valueSpec,r=e.style,i=e.styleSpec,a=e.key,o=e.arrayElementValidator||e.validateSpec;if("array"!==cr(t))return[new ae(a,t,"array expected, ".concat(cr(t)," found"))];if(n.length&&t.length!==n.length)return[new ae(a,t,"array length ".concat(n.length," expected, length ").concat(t.length," found"))];if(n["min-length"]&&t.length<n["min-length"])return[new ae(a,t,"array length at least ".concat(n["min-length"]," expected, length ").concat(t.length," found"))];let s={type:n.value,values:n.values};i.$version<7&&(s.function=n.function),"object"===cr(n.value)&&(s=n.value);let l=[];for(let u=0;u<t.length;u++)l=l.concat(o({array:t,arrayIndex:u,value:t[u],valueSpec:s,validateSpec:e.validateSpec,style:r,styleSpec:i,key:"".concat(a,"[").concat(u,"]")}));return l}function Hr(e){const t=e.key,n=e.value,r=e.valueSpec;let i=cr(n);return"number"===i&&n!=n&&(i="NaN"),"number"!==i?[new ae(t,n,"number expected, ".concat(i," found"))]:"minimum"in r&&n<r.minimum?[new ae(t,n,"".concat(n," is less than the minimum value ").concat(r.minimum))]:"maximum"in r&&n>r.maximum?[new ae(t,n,"".concat(n," is greater than the maximum value ").concat(r.maximum))]:[]}function Wr(e){const t=e.valueSpec,n=Nr(e.value.type);let r,i,a,o={};const s="categorical"!==n&&void 0===e.value.property,l=!s,u="array"===cr(e.value.stops)&&"array"===cr(e.value.stops[0])&&"object"===cr(e.value.stops[0][0]),c=Vr({key:e.key,value:e.value,valueSpec:e.styleSpec.function,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===n)return[new ae(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const r=e.value;return t=t.concat(qr({key:e.key,value:r,valueSpec:e.valueSpec,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:d})),"array"===cr(r)&&0===r.length&&t.push(new ae(e.key,r,"array must have at least one stop")),t},default:function(e){return e.validateSpec({key:e.key,value:e.value,valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===n&&s&&c.push(new ae(e.key,e.value,'missing required property "property"')),"identity"===n||e.value.stops||c.push(new ae(e.key,e.value,'missing required property "stops"')),"exponential"===n&&e.valueSpec.expression&&!ur(e.valueSpec)&&c.push(new ae(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(l&&!sr(e.valueSpec)?c.push(new ae(e.key,e.value,"property functions not supported")):s&&!lr(e.valueSpec)&&c.push(new ae(e.key,e.value,"zoom functions not supported"))),"categorical"!==n&&!u||void 0!==e.value.property||c.push(new ae(e.key,e.value,'"property" property is required')),c;function d(e){let n=[];const r=e.value,s=e.key;if("array"!==cr(r))return[new ae(s,r,"array expected, ".concat(cr(r)," found"))];if(2!==r.length)return[new ae(s,r,"array length 2 expected, length ".concat(r.length," found"))];if(u){if("object"!==cr(r[0]))return[new ae(s,r,"object expected, ".concat(cr(r[0])," found"))];if(void 0===r[0].zoom)return[new ae(s,r,"object stop key must have zoom")];if(void 0===r[0].value)return[new ae(s,r,"object stop key must have value")];if(a&&a>Nr(r[0].zoom))return[new ae(s,r[0].zoom,"stop zoom values must appear in ascending order")];Nr(r[0].zoom)!==a&&(a=Nr(r[0].zoom),i=void 0,o={}),n=n.concat(Vr({key:"".concat(s,"[0]"),value:r[0],valueSpec:{zoom:{}},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:Hr,value:h}}))}else n=n.concat(h({key:"".concat(s,"[0]"),value:r[0],valueSpec:{},validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec},r));return br(Ur(r[1]))?n.concat([new ae("".concat(s,"[1]"),r[1],"expressions are not allowed in function stops.")]):n.concat(e.validateSpec({key:"".concat(s,"[1]"),value:r[1],valueSpec:t,validateSpec:e.validateSpec,style:e.style,styleSpec:e.styleSpec}))}function h(e,a){const s=cr(e.value),l=Nr(e.value),u=null!==e.value?e.value:a;if(r){if(s!==r)return[new ae(e.key,u,"".concat(s," stop domain type must match previous stop domain type ").concat(r))]}else r=s;if("number"!==s&&"string"!==s&&"boolean"!==s)return[new ae(e.key,u,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==n){let r="number expected, ".concat(s," found");return sr(t)&&void 0===n&&(r+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ae(e.key,u,r)]}return"categorical"!==n||"number"!==s||isFinite(l)&&Math.floor(l)===l?"categorical"!==n&&"number"===s&&void 0!==i&&l<i?[new ae(e.key,u,"stop domain values must appear in ascending order")]:(i=l,"categorical"===n&&l in o?[new ae(e.key,u,"stop domain values must be unique")]:(o[l]=!0,[])):[new ae(e.key,u,"integer expected, found ".concat(l))]}}function Zr(e){const t=("property"===e.expressionContext?Sr:xr)(Ur(e.value),e.valueSpec);if("error"===t.result)return t.value.map(t=>new ae("".concat(e.key).concat(t.key),e.value,t.message));const n=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!n.outputDefined())return[new ae(e.key,e.value,'Invalid data expression for "'.concat(e.propertyKey,'". Output values must be contained as literals within the expression.'))];if("property"===e.expressionContext&&"layout"===e.propertyType&&!rr(n))return[new ae(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext&&!rr(n))return[new ae(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!ir(n,["zoom","feature-state"]))return[new ae(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!nr(n))return[new ae(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Kr(e){const t=e.key,n=e.value,r=e.valueSpec,i=[];return Array.isArray(r.values)?-1===r.values.indexOf(Nr(n))&&i.push(new ae(t,n,"expected one of [".concat(r.values.join(", "),"], ").concat(JSON.stringify(n)," found"))):-1===Object.keys(r.values).indexOf(Nr(n))&&i.push(new ae(t,n,"expected one of [".concat(Object.keys(r.values).join(", "),"], ").concat(JSON.stringify(n)," found"))),i}function Gr(e){return Pr(Ur(e.value))?Zr(oe({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Xr(e)}function Xr(e){const t=e.value,n=e.key;if("array"!==cr(t))return[new ae(n,t,"array expected, ".concat(cr(t)," found"))];const r=e.styleSpec;let i,a=[];if(t.length<1)return[new ae(n,t,"filter array must have at least 1 element")];switch(a=a.concat(Kr({key:"".concat(n,"[0]"),value:t[0],valueSpec:r.filter_operator,style:e.style,styleSpec:e.styleSpec})),Nr(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===Nr(t[1])&&a.push(new ae(n,t,'"$type" cannot be use with operator "'.concat(t[0],'"')));case"==":case"!=":3!==t.length&&a.push(new ae(n,t,'filter array for operator "'.concat(t[0],'" must have 3 elements')));case"in":case"!in":t.length>=2&&(i=cr(t[1]),"string"!==i&&a.push(new ae("".concat(n,"[1]"),t[1],"string expected, ".concat(i," found"))));for(let o=2;o<t.length;o++)i=cr(t[o]),"$type"===Nr(t[1])?a=a.concat(Kr({key:"".concat(n,"[").concat(o,"]"),value:t[o],valueSpec:r.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&a.push(new ae("".concat(n,"[").concat(o,"]"),t[o],"string, number, or boolean expected, ".concat(i," found")));break;case"any":case"all":case"none":for(let r=1;r<t.length;r++)a=a.concat(Xr({key:"".concat(n,"[").concat(r,"]"),value:t[r],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=cr(t[1]),2!==t.length?a.push(new ae(n,t,'filter array for "'.concat(t[0],'" operator must have 2 elements'))):"string"!==i&&a.push(new ae("".concat(n,"[1]"),t[1],"string expected, ".concat(i," found")))}return a}function $r(e,t){const n=e.key,r=e.validateSpec,i=e.style,a=e.styleSpec,o=e.value,s=e.objectKey,l=a["".concat(t,"_").concat(e.layerType)];if(!l)return[];const u=s.match(/^(.*)-transition$/);if("paint"===t&&u&&l[u[1]]&&l[u[1]].transition)return r({key:n,value:o,valueSpec:a.transition,style:i,styleSpec:a});const c=e.valueSpec||l[s];if(!c)return[new ae(n,o,'unknown property "'.concat(s,'"'))];let d;if("string"===cr(o)&&sr(c)&&!c.tokens&&(d=/^{([^}]+)}$/.exec(o)))return[new ae(n,o,'"'.concat(s,'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": ').concat(JSON.stringify(d[1])," }`."))];const h=[];return"symbol"===e.layerType&&("text-field"===s&&i&&!i.glyphs&&h.push(new ae(n,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===s&&dr(Ur(o))&&"identity"===Nr(o.type)&&h.push(new ae(n,o,'"text-font" does not support identity functions'))),h.concat(r({key:e.key,value:o,valueSpec:c,style:i,styleSpec:a,expressionContext:"property",propertyType:t,propertyKey:s}))}function Yr(e){return $r(e,"paint")}function Jr(e){return $r(e,"layout")}function Qr(e){let t=[];const n=e.value,r=e.key,i=e.style,a=e.styleSpec;n.type||n.ref||t.push(new ae(r,n,'either "type" or "ref" is required'));let o=Nr(n.type);const s=Nr(n.ref);if(n.id){const a=Nr(n.id);for(let o=0;o<e.arrayIndex;o++){const e=i.layers[o];Nr(e.id)===a&&t.push(new ae(r,n.id,'duplicate layer id "'.concat(n.id,'", previously used at line ').concat(e.id.__line__)))}}if("ref"in n){let e;["type","source","source-layer","filter","layout"].forEach(e=>{e in n&&t.push(new ae(r,n[e],'"'.concat(e,'" is prohibited for ref layers')))}),i.layers.forEach(t=>{Nr(t.id)===s&&(e=t)}),e?e.ref?t.push(new ae(r,n.ref,"ref cannot reference another ref layer")):o=Nr(e.type):t.push(new ae(r,n.ref,'ref layer "'.concat(s,'" not found')))}else if("background"!==o)if(n.source){const e=i.sources&&i.sources[n.source],a=e&&Nr(e.type);e?"vector"===a&&"raster"===o?t.push(new ae(r,n.source,'layer "'.concat(n.id,'" requires a raster source'))):"raster-dem"!==a&&"hillshade"===o?t.push(new ae(r,n.source,'layer "'.concat(n.id,'" requires a raster-dem source'))):"raster"===a&&"raster"!==o?t.push(new ae(r,n.source,'layer "'.concat(n.id,'" requires a vector source'))):"vector"!==a||n["source-layer"]?"raster-dem"===a&&"hillshade"!==o?t.push(new ae(r,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==o||!n.paint||!n.paint["line-gradient"]||"geojson"===a&&e.lineMetrics||t.push(new ae(r,n,'layer "'.concat(n.id,'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.'))):t.push(new ae(r,n,'layer "'.concat(n.id,'" must specify a "source-layer"'))):t.push(new ae(r,n.source,'source "'.concat(n.source,'" not found')))}else t.push(new ae(r,n,'missing required property "source"'));return t=t.concat(Vr({key:r,value:n,valueSpec:a.layer,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":()=>[],type:()=>e.validateSpec({key:"".concat(r,".type"),value:n.type,valueSpec:a.layer.type,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,object:n,objectKey:"type"}),filter:Gr,layout:e=>Vr({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Jr(oe({layerType:o},e))}}),paint:e=>Vr({layer:n,key:e.key,value:e.value,style:e.style,styleSpec:e.styleSpec,validateSpec:e.validateSpec,objectElementValidators:{"*":e=>Yr(oe({layerType:o},e))}})}})),t}function ei(e){const t=e.value,n=e.key,r=cr(t);return"string"!==r?[new ae(n,t,"string expected, ".concat(r," found"))]:[]}const ti={promoteId:function(e){let{key:t,value:n}=e;if("string"===cr(n))return ei({key:t,value:n});{const e=[];for(const r in n)e.push(...ei({key:"".concat(t,".").concat(r),value:n[r]}));return e}}};function ni(e){const t=e.value,n=e.key,r=e.styleSpec,i=e.style,a=e.validateSpec;if(!t.type)return[new ae(n,t,'"type" is required')];const o=Nr(t.type);let s;switch(o){case"vector":case"raster":return s=Vr({key:n,value:t,valueSpec:r["source_".concat(o.replace("-","_"))],style:e.style,styleSpec:r,objectElementValidators:ti,validateSpec:a}),s;case"raster-dem":return s=function(e){var t;const n=null!==(t=e.sourceName)&&void 0!==t?t:"",r=e.value,i=e.styleSpec,a=i.source_raster_dem,o=e.style;let s=[];const l=cr(r);if(void 0===r)return s;if("object"!==l)return s.push(new ae("source_raster_dem",r,"object expected, ".concat(l," found"))),s;const u="custom"===Nr(r.encoding),c=["redFactor","greenFactor","blueFactor","baseShift"],d=e.value.encoding?'"'.concat(e.value.encoding,'"'):"Default";for(const h in r)!u&&c.includes(h)?s.push(new ae(h,r[h],'In "'.concat(n,'": "').concat(h,'" is only valid when "encoding" is set to "custom". ').concat(d," encoding found"))):a[h]?s=s.concat(e.validateSpec({key:h,value:r[h],valueSpec:a[h],validateSpec:e.validateSpec,style:o,styleSpec:i})):s.push(new ae(h,r[h],'unknown property "'.concat(h,'"')));return s}({sourceName:n,value:t,style:e.style,styleSpec:r,validateSpec:a}),s;case"geojson":if(s=Vr({key:n,value:t,valueSpec:r.source_geojson,style:i,styleSpec:r,validateSpec:a,objectElementValidators:ti}),t.cluster)for(const e in t.clusterProperties){const[r,i]=t.clusterProperties[e],o="string"==typeof r?[r,["accumulated"],["get",e]]:r;s.push(...Zr({key:"".concat(n,".").concat(e,".map"),value:i,validateSpec:a,expressionContext:"cluster-map"})),s.push(...Zr({key:"".concat(n,".").concat(e,".reduce"),value:o,validateSpec:a,expressionContext:"cluster-reduce"}))}return s;case"video":return Vr({key:n,value:t,valueSpec:r.source_video,style:i,validateSpec:a,styleSpec:r});case"image":return Vr({key:n,value:t,valueSpec:r.source_image,style:i,validateSpec:a,styleSpec:r});case"canvas":return[new ae(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Kr({key:"".concat(n,".type"),value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:i,validateSpec:a,styleSpec:r})}}function ri(e){const t=e.value,n=e.styleSpec,r=n.light,i=e.style;let a=[];const o=cr(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new ae("light",t,"object expected, ".concat(o," found"))]),a;for(const s in t){const o=s.match(/^(.*)-transition$/);a=a.concat(o&&r[o[1]]&&r[o[1]].transition?e.validateSpec({key:s,value:t[s],valueSpec:n.transition,validateSpec:e.validateSpec,style:i,styleSpec:n}):r[s]?e.validateSpec({key:s,value:t[s],valueSpec:r[s],validateSpec:e.validateSpec,style:i,styleSpec:n}):[new ae(s,t[s],'unknown property "'.concat(s,'"'))])}return a}function ii(e){const t=e.value,n=e.styleSpec,r=n.sky,i=e.style,a=cr(t);if(void 0===t)return[];if("object"!==a)return[new ae("sky",t,"object expected, ".concat(a," found"))];let o=[];for(const s in t)o=o.concat(r[s]?e.validateSpec({key:s,value:t[s],valueSpec:r[s],style:i,styleSpec:n}):[new ae(s,t[s],'unknown property "'.concat(s,'"'))]);return o}function ai(e){const t=e.value,n=e.styleSpec,r=n.terrain,i=e.style;let a=[];const o=cr(t);if(void 0===t)return a;if("object"!==o)return a=a.concat([new ae("terrain",t,"object expected, ".concat(o," found"))]),a;for(const s in t)a=a.concat(r[s]?e.validateSpec({key:s,value:t[s],valueSpec:r[s],validateSpec:e.validateSpec,style:i,styleSpec:n}):[new ae(s,t[s],'unknown property "'.concat(s,'"'))]);return a}function oi(e){let t=[];const n=e.value,r=e.key;if(Array.isArray(n)){const i=[],a=[];for(const o in n)n[o].id&&i.includes(n[o].id)&&t.push(new ae(r,n,"all the sprites' ids must be unique, but ".concat(n[o].id," is duplicated"))),i.push(n[o].id),n[o].url&&a.includes(n[o].url)&&t.push(new ae(r,n,"all the sprites' URLs must be unique, but ".concat(n[o].url," is duplicated"))),a.push(n[o].url),t=t.concat(Vr({key:"".concat(r,"[").concat(o,"]"),value:n[o],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:e.validateSpec}));return t}return ei({key:r,value:n})}const si={"*":()=>[],array:qr,boolean:function(e){const t=e.value,n=e.key,r=cr(t);return"boolean"!==r?[new ae(n,t,"boolean expected, ".concat(r," found"))]:[]},number:Hr,color:function(e){const t=e.key,n=e.value,r=cr(n);return"string"!==r?[new ae(t,n,"color expected, ".concat(r," found"))]:Ge.parse(String(n))?[]:[new ae(t,n,'color expected, "'.concat(n,'" found'))]},constants:Lr,enum:Kr,filter:Gr,function:Wr,layer:Qr,object:Vr,source:ni,light:ri,sky:ii,terrain:ai,projection:function(e){const t=e.value,n=e.styleSpec,r=n.projection,i=e.style,a=cr(t);if(void 0===t)return[];if("object"!==a)return[new ae("projection",t,"object expected, ".concat(a," found"))];let o=[];for(const s in t)o=o.concat(r[s]?e.validateSpec({key:s,value:t[s],valueSpec:r[s],style:i,styleSpec:n}):[new ae(s,t[s],'unknown property "'.concat(s,'"'))]);return o},string:ei,formatted:function(e){return 0===ei(e).length?[]:Zr(e)},resolvedImage:function(e){return 0===ei(e).length?[]:Zr(e)},padding:function(e){const t=e.key,n=e.value;if("array"===cr(n)){if(n.length<1||n.length>4)return[new ae(t,n,"padding requires 1 to 4 values; ".concat(n.length," values found"))];const r={type:"number"};let i=[];for(let a=0;a<n.length;a++)i=i.concat(e.validateSpec({key:"".concat(t,"[").concat(a,"]"),value:n[a],validateSpec:e.validateSpec,valueSpec:r}));return i}return Hr({key:t,value:n,valueSpec:{}})},variableAnchorOffsetCollection:function(e){const t=e.key,n=e.value,r=cr(n),i=e.styleSpec;if("array"!==r||n.length<1||n.length%2!=0)return[new ae(t,n,"variableAnchorOffsetCollection requires a non-empty array of even length")];let a=[];for(let o=0;o<n.length;o+=2)a=a.concat(Kr({key:"".concat(t,"[").concat(o,"]"),value:n[o],valueSpec:i.layout_symbol["text-anchor"]})),a=a.concat(qr({key:"".concat(t,"[").concat(o+1,"]"),value:n[o+1],valueSpec:{length:2,value:"number"},validateSpec:e.validateSpec,style:e.style,styleSpec:i}));return a},sprite:oi};function li(e){const t=e.value,n=e.valueSpec,r=e.styleSpec;return e.validateSpec=li,n.expression&&dr(Nr(t))?Wr(e):n.expression&&br(Ur(t))?Zr(e):n.type&&si[n.type]?si[n.type](e):Vr(oe({},e,{valueSpec:n.type?r[n.type]:n}))}function ui(e){const t=e.value,n=e.key,r=ei(e);return r.length||(-1===t.indexOf("{fontstack}")&&r.push(new ae(n,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&r.push(new ae(n,t,'"glyphs" url must include a "{range}" token'))),r}function ci(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:K,n=[];return n=n.concat(li({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,validateSpec:li,objectElementValidators:{glyphs:ui,"*":()=>[]}})),e.constants&&(n=n.concat(Lr({key:"constants",value:e.constants,style:e,styleSpec:t,validateSpec:li}))),hi(n)}function di(e){return function(t){return e(r(r({},t),{},{validateSpec:li}))}}function hi(e){return[].concat(e).sort((e,t)=>e.line-t.line)}function fi(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return hi(e.apply(this,n))}}ci.source=fi(di(ni)),ci.sprite=fi(di(oi)),ci.glyphs=fi(di(ui)),ci.light=fi(di(ri)),ci.sky=fi(di(ii)),ci.terrain=fi(di(ai)),ci.layer=fi(di(Qr)),ci.filter=fi(di(Gr)),ci.paintProperty=fi(di(Yr)),ci.layoutProperty=fi(di(Jr));const pi=ci,mi=pi.light,gi=pi.sky,yi=pi.paintProperty,vi=pi.layoutProperty;function _i(e,t){let n=!1;if(t&&t.length)for(const r of t)e.fire(new W(new Error(r.message))),n=!0;return n}class bi{constructor(e,t,n){const r=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(n=i[2]);for(let e=0;e<this.d*this.d;e++){const t=i[3+e],n=i[3+e+1];r.push(t===n?null:i.subarray(t,n))}const a=i[3+r.length+1];this.keys=i.subarray(i[3+r.length],a),this.bboxes=i.subarray(a),this.insert=this._insertReadonly}else{this.d=t+2*n;for(let e=0;e<this.d*this.d;e++)r.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=n,this.scale=t/e,this.uid=0;const i=n/t*e;this.min=-i,this.max=e+i}insert(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,t,n,r,i,a){this.cells[i].push(a)}query(e,t,n,r,i){const a=this.min,o=this.max;if(e<=a&&t<=a&&o<=n&&o<=r&&!i)return Array.prototype.slice.call(this.keys);{const a=[];return this._forEachCell(e,t,n,r,this._queryCell,a,{},i),a}}_queryCell(e,t,n,r,i,a,o,s){const l=this.cells[i];if(null!==l){const i=this.keys,u=this.bboxes;for(let c=0;c<l.length;c++){const d=l[c];if(void 0===o[d]){const l=4*d;(s?s(u[l+0],u[l+1],u[l+2],u[l+3]):e<=u[l+2]&&t<=u[l+3]&&n>=u[l+0]&&r>=u[l+1])?(o[d]=!0,a.push(i[d])):o[d]=!1}}}}_forEachCell(e,t,n,r,i,a,o,s){const l=this._convertToCellCoord(e),u=this._convertToCellCoord(t),c=this._convertToCellCoord(n),d=this._convertToCellCoord(r);for(let h=l;h<=c;h++)for(let l=u;l<=d;l++){const u=this.d*l+h;if((!s||s(this._convertFromCellCoord(h),this._convertFromCellCoord(l),this._convertFromCellCoord(h+1),this._convertFromCellCoord(l+1)))&&i.call(this,e,t,n,r,u,a,o,s))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,t=3+this.cells.length+1+1;let n=0;for(let a=0;a<this.cells.length;a++)n+=this.cells[a].length;const r=new Int32Array(t+n+this.keys.length+this.bboxes.length);r[0]=this.extent,r[1]=this.n,r[2]=this.padding;let i=t;for(let a=0;a<e.length;a++){const t=e[a];r[3+a]=i,r.set(t,i),i+=t.length}return r[3+e.length]=i,r.set(this.keys,i),i+=this.keys.length,r[3+e.length+1]=i,r.set(this.bboxes,i),i+=this.bboxes.length,r.buffer}static serialize(e,t){const n=e.toArrayBuffer();return t&&t.push(n),{buffer:n}}static deserialize(e){return new bi(e.buffer)}}const xi={};function wi(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(xi[e])throw new Error("".concat(e," is already registered."));Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),xi[e]={klass:t,omit:n.omit||[],shallow:n.shallow||[]}}wi("Object",Object),wi("TransferableGridIndex",bi),wi("Color",Ge),wi("Error",Error),wi("AJAXError",R),wi("ResolvedImage",tt),wi("StylePropertyFunction",Er),wi("StyleExpression",_r,{omit:["_evaluator"]}),wi("ZoomDependentExpression",kr),wi("ZoomConstantExpression",wr),wi("CompoundExpression",$n,{omit:["_evaluate"]});for(const r in Xn)Xn[r]._classRegistryKey||wi("Expression_".concat(r),Xn[r]);function ki(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Si(e){return e.$name||e.constructor._classRegistryKey}function Ei(e){return!function(e){if(null===e||"object"!=typeof e)return!1;const t=Si(e);return!(!t||"Object"===t)}(e)&&(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||e instanceof Blob||e instanceof Error||ki(e)||D(e)||ArrayBuffer.isView(e)||e instanceof ImageData)}function Ci(e,t){if(Ei(e))return(ki(e)||D(e))&&t&&t.push(e),ArrayBuffer.isView(e)&&t&&t.push(e.buffer),e instanceof ImageData&&t&&t.push(e.data.buffer),e;if(Array.isArray(e)){const n=[];for(const r of e)n.push(Ci(r,t));return n}if("object"!=typeof e)throw new Error("can't serialize object of type "+typeof e);const n=Si(e);if(!n)throw new Error("can't serialize object of unregistered class ".concat(e.constructor.name));if(!xi[n])throw new Error("".concat(n," is not registered."));const{klass:r}=xi[n],i=r.serialize?r.serialize(e,t):{};if(r.serialize){if(t&&i===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const r in e){if(!e.hasOwnProperty(r))continue;if(xi[n].omit.indexOf(r)>=0)continue;const a=e[r];i[r]=xi[n].shallow.indexOf(r)>=0?a:Ci(a,t)}e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(i.$name=n),i}function Pi(e){if(Ei(e))return e;if(Array.isArray(e))return e.map(Pi);if("object"!=typeof e)throw new Error("can't deserialize object of type "+typeof e);const t=Si(e)||"Object";if(!xi[t])throw new Error("can't deserialize unregistered class ".concat(t));const{klass:n}=xi[t];if(!n)throw new Error("can't deserialize unregistered class ".concat(t));if(n.deserialize)return n.deserialize(e);const r=Object.create(n.prototype);for(const i of Object.keys(e)){if("$name"===i)continue;const n=e[i];r[i]=xi[t].shallow.indexOf(i)>=0?n:Pi(n)}return r}class Di{constructor(){this.first=!0}update(e,t){const n=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=n,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=n,!0):(this.lastFloorZoom>n?(this.lastIntegerZoom=n+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<n&&(this.lastIntegerZoom=n,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=n,!0))}}const Ii={"Latin-1 Supplement":e=>e>=128&&e<=255,"Hangul Jamo":e=>e>=4352&&e<=4607,Khmer:e=>e>=6016&&e<=6143,"General Punctuation":e=>e>=8192&&e<=8303,"Letterlike Symbols":e=>e>=8448&&e<=8527,"Number Forms":e=>e>=8528&&e<=8591,"Miscellaneous Technical":e=>e>=8960&&e<=9215,"Control Pictures":e=>e>=9216&&e<=9279,"Optical Character Recognition":e=>e>=9280&&e<=9311,"Enclosed Alphanumerics":e=>e>=9312&&e<=9471,"Geometric Shapes":e=>e>=9632&&e<=9727,"Miscellaneous Symbols":e=>e>=9728&&e<=9983,"Miscellaneous Symbols and Arrows":e=>e>=11008&&e<=11263,"Ideographic Description Characters":e=>e>=12272&&e<=12287,"CJK Symbols and Punctuation":e=>e>=12288&&e<=12351,Katakana:e=>e>=12448&&e<=12543,Kanbun:e=>e>=12688&&e<=12703,"CJK Strokes":e=>e>=12736&&e<=12783,"Enclosed CJK Letters and Months":e=>e>=12800&&e<=13055,"CJK Compatibility":e=>e>=13056&&e<=13311,"Yijing Hexagram Symbols":e=>e>=19904&&e<=19967,"Private Use Area":e=>e>=57344&&e<=63743,"Vertical Forms":e=>e>=65040&&e<=65055,"CJK Compatibility Forms":e=>e>=65072&&e<=65103,"Small Form Variants":e=>e>=65104&&e<=65135,"Halfwidth and Fullwidth Forms":e=>e>=65280&&e<=65519};function Ti(e){for(const t of e)if(ji(t.charCodeAt(0)))return!0;return!1}function Ai(e){for(const t of e)if(!Fi(t.charCodeAt(0)))return!1;return!0}function zi(e){const t=e.map(e=>{try{return new RegExp("\\p{sc=".concat(e,"}"),"u").source}catch(e){return null}}).filter(e=>e);return new RegExp(t.join("|"),"u")}const Oi=zi(["Arab","Dupl","Mong","Ougr","Syrc"]);function Fi(e){return!Oi.test(String.fromCodePoint(e))}const Mi=zi(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function ji(e){return!(746!==e&&747!==e&&(e<4352||!(Ii["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||Ii["CJK Compatibility"](e)||Ii["CJK Strokes"](e)||!(!Ii["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||Ii["Enclosed CJK Letters and Months"](e)||Ii["Ideographic Description Characters"](e)||Ii.Kanbun(e)||Ii.Katakana(e)&&12540!==e||!(!Ii["Halfwidth and Fullwidth Forms"](e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!Ii["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||Ii["Vertical Forms"](e)||Ii["Yijing Hexagram Symbols"](e)||/(?:[\u1400-\u167F\u18B0-\u18F5]|\uD806[\uDEB0-\uDEBF])/.test(String.fromCodePoint(e))||/[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/.test(String.fromCodePoint(e))||Mi.test(String.fromCodePoint(e)))))}function Bi(e){return!(ji(e)||function(e){return!!(Ii["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||Ii["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||Ii["Letterlike Symbols"](e)||Ii["Number Forms"](e)||Ii["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ii["Control Pictures"](e)&&9251!==e||Ii["Optical Character Recognition"](e)||Ii["Enclosed Alphanumerics"](e)||Ii["Geometric Shapes"](e)||Ii["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ii["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ii["CJK Symbols and Punctuation"](e)||Ii.Katakana(e)||Ii["Private Use Area"](e)||Ii["CJK Compatibility Forms"](e)||Ii["Small Form Variants"](e)||Ii["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}const Ri=zi(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Li(e){return Ri.test(String.fromCodePoint(e))}function Ni(e,t){return!(!t&&Li(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||Ii.Khmer(e))}function Ui(e){for(const t of e)if(Li(t.charCodeAt(0)))return!0;return!1}const Vi=new class{constructor(){this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null}setState(e){this.pluginStatus=e.pluginStatus,this.pluginURL=e.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(e){this.applyArabicShaping=e.applyArabicShaping,this.processBidirectionalText=e.processBidirectionalText,this.processStyledBidirectionalText=e.processStyledBidirectionalText}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getPluginURL(){return this.pluginURL}getRTLTextPluginStatus(){return this.pluginStatus}};class qi{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Di,this.transition={})}isSupportedScript(e){return function(e,t){for(const n of e)if(!Ni(n.charCodeAt(0),t))return!1;return!0}(e,"loaded"===Vi.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,t=e-Math.floor(e),n=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*n}:{fromScale:.5,toScale:1,t:1-(1-n)*t}}}class Hi{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(dr(e))return new Er(e,t);if(br(e)){const n=Sr(e,t);if("error"===n.result)throw new Error(n.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));return n.value}{let n=e;return"color"===t.type&&"string"==typeof e?n=Ge.parse(e):"padding"!==t.type||"number"!=typeof e&&!Array.isArray(e)?"variableAnchorOffsetCollection"===t.type&&Array.isArray(e)&&(n=et.parse(e)):n=Je.parse(e),{kind:"constant",evaluate:()=>n}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,n){return this.property.possiblyEvaluate(this,e,t,n)}}class Wi{constructor(e){this.property=e,this.value=new Hi(e,void 0)}transitioned(e,t){return new Ki(this.property,this.value,t,v({},e.transition,this.transition),e.now)}untransitioned(){return new Ki(this.property,this.value,null,{},0)}}class Zi{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return w(this._values[e].value.value)}setValue(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Wi(this._values[e].property)),this._values[e].value=new Hi(this._values[e].property,null===t?void 0:w(t))}getTransition(e){return w(this._values[e].transition)}setTransition(e,t){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Wi(this._values[e].property)),this._values[e].transition=w(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n);const r=this.getTransition(t);void 0!==r&&(e["".concat(t,"-transition")]=r)}return e}transitioned(e,t){const n=new Gi(this._properties);for(const r of Object.keys(this._values))n._values[r]=this._values[r].transitioned(e,t._values[r]);return n}untransitioned(){const e=new Gi(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Ki{constructor(e,t,n,r,i){this.property=e,this.value=t,this.begin=i+r.delay||0,this.end=this.begin+r.duration||0,e.specification.transition&&(r.delay||r.duration)&&(this.prior=n)}possiblyEvaluate(e,t,n){const r=e.now||0,i=this.value.possiblyEvaluate(e,t,n),a=this.prior;if(a){if(r>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(r<this.begin)return a.possiblyEvaluate(e,t,n);{const o=(r-this.begin)/(this.end-this.begin);return this.property.interpolate(a.possiblyEvaluate(e,t,n),i,function(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,n=t*e;return 4*(e<.5?n:3*(e-t)+n-.75)}(o))}}return i}}class Gi{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,n){const r=new Yi(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(e,t,n);return r}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Xi{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return void 0!==this._values[e].value}getValue(e){return w(this._values[e].value)}setValue(e,t){this._values[e]=new Hi(this._values[e].property,null===t?void 0:w(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const n=this.getValue(t);void 0!==n&&(e[t]=n)}return e}possiblyEvaluate(e,t,n){const r=new Yi(this._properties);for(const i of Object.keys(this._values))r._values[i]=this._values[i].possiblyEvaluate(e,t,n);return r}}class $i{constructor(e,t,n){this.property=e,this.value=t,this.parameters=n}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,n,r){return this.property.evaluate(this.value,this.parameters,e,t,n,r)}}class Yi{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ji{constructor(e){this.specification=e}possiblyEvaluate(e,t){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(t)}interpolate(e,t,n){const r=At[this.specification.type];return r?r(e,t,n):e}}class Qi{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,n,r){return new $i(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},n,r)}:e.expression,t)}interpolate(e,t,n){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new $i(this,{kind:"constant",value:void 0},e.parameters);const r=At[this.specification.type];if(r){const i=r(e.value.value,t.value.value,n);return new $i(this,{kind:"constant",value:i},e.parameters)}return e}evaluate(e,t,n,r,i,a){return"constant"===e.kind?e.value:e.evaluate(t,n,r,i,a)}}class ea extends Qi{possiblyEvaluate(e,t,n,r){if(void 0===e.value)return new $i(this,{kind:"constant",value:void 0},t);if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},n,r),a="resolvedImage"===e.property.specification.type&&"string"!=typeof i?i.name:i,o=this._calculate(a,a,a,t);return new $i(this,{kind:"constant",value:o},t)}if("camera"===e.expression.kind){const n=this._calculate(e.expression.evaluate({zoom:t.zoom-1}),e.expression.evaluate({zoom:t.zoom}),e.expression.evaluate({zoom:t.zoom+1}),t);return new $i(this,{kind:"constant",value:n},t)}return new $i(this,e.expression,t)}evaluate(e,t,n,r,i,a){if("source"===e.kind){const o=e.evaluate(t,n,r,i,a);return this._calculate(o,o,o,t)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(t.zoom)-1},n,r),e.evaluate({zoom:Math.floor(t.zoom)},n,r),e.evaluate({zoom:Math.floor(t.zoom)+1},n,r),t):e.value}_calculate(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}}class ta{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,r){if(void 0!==e.value){if("constant"===e.expression.kind){const i=e.expression.evaluate(t,null,{},n,r);return this._calculate(i,i,i,t)}return this._calculate(e.expression.evaluate(new qi(Math.floor(t.zoom-1),t)),e.expression.evaluate(new qi(Math.floor(t.zoom),t)),e.expression.evaluate(new qi(Math.floor(t.zoom+1),t)),t)}}_calculate(e,t,n,r){return r.zoom>r.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:n,to:t}}interpolate(e){return e}}class na{constructor(e){this.specification=e}possiblyEvaluate(e,t,n,r){return!!e.expression.evaluate(t,null,{},n,r)}interpolate(){return!1}}class ra{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const t in e){const n=e[t];n.specification.overridable&&this.overridableProperties.push(t);const r=this.defaultPropertyValues[t]=new Hi(n,void 0),i=this.defaultTransitionablePropertyValues[t]=new Wi(n);this.defaultTransitioningPropertyValues[t]=i.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=r.possiblyEvaluate({})}}}wi("DataDrivenProperty",Qi),wi("DataConstantProperty",Ji),wi("CrossFadedDataDrivenProperty",ea),wi("CrossFadedProperty",ta),wi("ColorRampProperty",na);const ia="-transition";class aa extends Z{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Xi(t.layout)),t.paint)){this._transitionablePaint=new Zi(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Yi(t.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};null!=t&&this._validate(vi,"layers.".concat(this.id,".layout.").concat(e),e,t,n)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return e.endsWith(ia)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!=t&&this._validate(yi,"layers.".concat(this.id,".paint.").concat(e),e,t,n))return!1;if(e.endsWith(ia))return this._transitionablePaint.setTransition(e.slice(0,-11),t||void 0),!1;{const n=this._transitionablePaint._values[e],r="cross-faded-data-driven"===n.property.specification["property-type"],i=n.value.isDataDriven(),a=n.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value;return o.isDataDriven()||i||r||this._handleOverridablePaintPropertyUpdate(e,a,o)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,t,n){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),x(e,(e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length))}_validate(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!i||!1!==i.validate)&&_i(this,e.call(pi,{key:t,layerType:this.type,objectKey:n,value:r,styleSpec:K,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof $i&&sr(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}}const oa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class sa{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class la{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function ua(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=0,r=0;return{members:e.map(e=>{const i=oa[e.type].BYTES_PER_ELEMENT,a=n=ca(n,Math.max(t,i)),o=e.components||1;return r=Math.max(r,i),n+=i*o,{name:e.name,type:e.type,components:o,offset:a}}),size:ca(n,Math.max(r,t)),alignment:t}}function ca(e,t){return Math.ceil(e/t)*t}class da extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.int16[r+0]=t,this.int16[r+1]=n,e}}da.prototype.bytesPerElement=4,wi("StructArrayLayout2i4",da);class ha extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=n,this.int16[i+2]=r,e}}ha.prototype.bytesPerElement=6,wi("StructArrayLayout3i6",ha);class fa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const a=4*e;return this.int16[a+0]=t,this.int16[a+1]=n,this.int16[a+2]=r,this.int16[a+3]=i,e}}fa.prototype.bytesPerElement=8,wi("StructArrayLayout4i8",fa);class pa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i,a)}emplace(e,t,n,r,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}pa.prototype.bytesPerElement=12,wi("StructArrayLayout2i4i12",pa);class ma extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i,a)}emplace(e,t,n,r,i,a,o){const s=4*e,l=8*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.uint8[l+4]=r,this.uint8[l+5]=i,this.uint8[l+6]=a,this.uint8[l+7]=o,e}}ma.prototype.bytesPerElement=8,wi("StructArrayLayout2i4ub8",ma);class ga extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.float32[r+0]=t,this.float32[r+1]=n,e}}ga.prototype.bytesPerElement=8,wi("StructArrayLayout2f8",ga);class ya extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a,o,s,l,u){const c=this.length;return this.resize(c+1),this.emplace(c,e,t,n,r,i,a,o,s,l,u)}emplace(e,t,n,r,i,a,o,s,l,u,c){const d=10*e;return this.uint16[d+0]=t,this.uint16[d+1]=n,this.uint16[d+2]=r,this.uint16[d+3]=i,this.uint16[d+4]=a,this.uint16[d+5]=o,this.uint16[d+6]=s,this.uint16[d+7]=l,this.uint16[d+8]=u,this.uint16[d+9]=c,e}}ya.prototype.bytesPerElement=20,wi("StructArrayLayout10ui20",ya);class va extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a,o,s,l,u,c,d){const h=this.length;return this.resize(h+1),this.emplace(h,e,t,n,r,i,a,o,s,l,u,c,d)}emplace(e,t,n,r,i,a,o,s,l,u,c,d,h){const f=12*e;return this.int16[f+0]=t,this.int16[f+1]=n,this.int16[f+2]=r,this.int16[f+3]=i,this.uint16[f+4]=a,this.uint16[f+5]=o,this.uint16[f+6]=s,this.uint16[f+7]=l,this.int16[f+8]=u,this.int16[f+9]=c,this.int16[f+10]=d,this.int16[f+11]=h,e}}va.prototype.bytesPerElement=24,wi("StructArrayLayout4i4ui4i24",va);class _a extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=n,this.float32[i+2]=r,e}}_a.prototype.bytesPerElement=12,wi("StructArrayLayout3f12",_a);class ba extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}ba.prototype.bytesPerElement=4,wi("StructArrayLayout1ul4",ba);class xa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a,o,s,l){const u=this.length;return this.resize(u+1),this.emplace(u,e,t,n,r,i,a,o,s,l)}emplace(e,t,n,r,i,a,o,s,l,u){const c=10*e,d=5*e;return this.int16[c+0]=t,this.int16[c+1]=n,this.int16[c+2]=r,this.int16[c+3]=i,this.int16[c+4]=a,this.int16[c+5]=o,this.uint32[d+3]=s,this.uint16[c+8]=l,this.uint16[c+9]=u,e}}xa.prototype.bytesPerElement=20,wi("StructArrayLayout6i1ul2ui20",xa);class wa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i,a)}emplace(e,t,n,r,i,a,o){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=n,this.int16[s+2]=r,this.int16[s+3]=i,this.int16[s+4]=a,this.int16[s+5]=o,e}}wa.prototype.bytesPerElement=12,wi("StructArrayLayout2i2i2i12",wa);class ka extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,n,r,i)}emplace(e,t,n,r,i,a){const o=4*e,s=8*e;return this.float32[o+0]=t,this.float32[o+1]=n,this.float32[o+2]=r,this.int16[s+6]=i,this.int16[s+7]=a,e}}ka.prototype.bytesPerElement=16,wi("StructArrayLayout2f1f2i16",ka);class Sa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,n,r,i,a)}emplace(e,t,n,r,i,a,o){const s=16*e,l=4*e,u=8*e;return this.uint8[s+0]=t,this.uint8[s+1]=n,this.float32[l+1]=r,this.float32[l+2]=i,this.int16[u+6]=a,this.int16[u+7]=o,e}}Sa.prototype.bytesPerElement=16,wi("StructArrayLayout2ub2f2i16",Sa);class Ea extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=n,this.uint16[i+2]=r,e}}Ea.prototype.bytesPerElement=6,wi("StructArrayLayout3ui6",Ea);class Ca extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g){const y=this.length;return this.resize(y+1),this.emplace(y,e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g)}emplace(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y){const v=24*e,_=12*e,b=48*e;return this.int16[v+0]=t,this.int16[v+1]=n,this.uint16[v+2]=r,this.uint16[v+3]=i,this.uint32[_+2]=a,this.uint32[_+3]=o,this.uint32[_+4]=s,this.uint16[v+10]=l,this.uint16[v+11]=u,this.uint16[v+12]=c,this.float32[_+7]=d,this.float32[_+8]=h,this.uint8[b+36]=f,this.uint8[b+37]=p,this.uint8[b+38]=m,this.uint32[_+10]=g,this.int16[v+22]=y,e}}Ca.prototype.bytesPerElement=48,wi("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Ca);class Pa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,S,E,C,P){const D=this.length;return this.resize(D+1),this.emplace(D,e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,S,E,C,P)}emplace(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,S,E,C,P,D){const I=32*e,T=16*e;return this.int16[I+0]=t,this.int16[I+1]=n,this.int16[I+2]=r,this.int16[I+3]=i,this.int16[I+4]=a,this.int16[I+5]=o,this.int16[I+6]=s,this.int16[I+7]=l,this.uint16[I+8]=u,this.uint16[I+9]=c,this.uint16[I+10]=d,this.uint16[I+11]=h,this.uint16[I+12]=f,this.uint16[I+13]=p,this.uint16[I+14]=m,this.uint16[I+15]=g,this.uint16[I+16]=y,this.uint16[I+17]=v,this.uint16[I+18]=_,this.uint16[I+19]=b,this.uint16[I+20]=x,this.uint16[I+21]=w,this.uint16[I+22]=k,this.uint32[T+12]=S,this.float32[T+13]=E,this.float32[T+14]=C,this.uint16[I+30]=P,this.uint16[I+31]=D,e}}Pa.prototype.bytesPerElement=64,wi("StructArrayLayout8i15ui1ul2f2ui64",Pa);class Da extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Da.prototype.bytesPerElement=4,wi("StructArrayLayout1f4",Da);class Ia extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=3*e;return this.uint16[6*e+0]=t,this.float32[i+1]=n,this.float32[i+2]=r,e}}Ia.prototype.bytesPerElement=12,wi("StructArrayLayout1ui2f12",Ia);class Ta extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,n){const r=this.length;return this.resize(r+1),this.emplace(r,e,t,n)}emplace(e,t,n,r){const i=4*e;return this.uint32[2*e+0]=t,this.uint16[i+2]=n,this.uint16[i+3]=r,e}}Ta.prototype.bytesPerElement=8,wi("StructArrayLayout1ul2ui8",Ta);class Aa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const n=this.length;return this.resize(n+1),this.emplace(n,e,t)}emplace(e,t,n){const r=2*e;return this.uint16[r+0]=t,this.uint16[r+1]=n,e}}Aa.prototype.bytesPerElement=4,wi("StructArrayLayout2ui4",Aa);class za extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}za.prototype.bytesPerElement=2,wi("StructArrayLayout1ui2",za);class Oa extends la{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,n,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,n,r)}emplace(e,t,n,r,i){const a=4*e;return this.float32[a+0]=t,this.float32[a+1]=n,this.float32[a+2]=r,this.float32[a+3]=i,e}}Oa.prototype.bytesPerElement=16,wi("StructArrayLayout4f16",Oa);class Fa extends sa{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new o(this.anchorPointX,this.anchorPointY)}}Fa.prototype.size=20;class Ma extends xa{get(e){return new Fa(this,e)}}wi("CollisionBoxArray",Ma);class ja extends sa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}ja.prototype.size=48;class Ba extends Ca{get(e){return new ja(this,e)}}wi("PlacedSymbolArray",Ba);class Ra extends sa{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}Ra.prototype.size=64;class La extends Pa{get(e){return new Ra(this,e)}}wi("SymbolInstanceArray",La);class Na extends Da{getoffsetX(e){return this.float32[1*e+0]}}wi("GlyphOffsetArray",Na);class Ua extends ha{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}wi("SymbolLineVertexArray",Ua);class Va extends sa{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}Va.prototype.size=12;class qa extends Ia{get(e){return new Va(this,e)}}wi("TextAnchorOffsetArray",qa);class Ha extends sa{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Ha.prototype.size=8;class Wa extends Ta{get(e){return new Ha(this,e)}}wi("FeatureIndexArray",Wa);class Za extends da{}class Ka extends da{}class Ga extends da{}class Xa extends pa{}class $a extends ma{}class Ya extends ga{}class Ja extends ya{}class Qa extends va{}class eo extends _a{}class to extends ba{}class no extends wa{}class ro extends Sa{}class io extends Ea{}class ao extends Aa{}const oo=ua([{name:"a_pos",components:2,type:"Int16"}],4),{members:so}=oo;class lo{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.segments=e}prepareSegment(e,t,n,r){let i=this.segments[this.segments.length-1];return e>lo.MAX_VERTEX_ARRAY_LENGTH&&S("Max vertices per segment is ".concat(lo.MAX_VERTEX_ARRAY_LENGTH,": bucket requested ").concat(e)),(!i||i.vertexLength+e>lo.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==r)&&(i={vertexOffset:t.length,primitiveOffset:n.length,vertexLength:0,primitiveLength:0},void 0!==r&&(i.sortKey=r),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,n,r){return new lo([{vertexOffset:e,primitiveOffset:t,vertexLength:n,primitiveLength:r,vaos:{},sortKey:0}])}}function uo(e,t){return 256*(e=g(Math.floor(e),0,255))+g(Math.floor(t),0,255)}lo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,wi("SegmentVector",lo);const co=ua([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ho={exports:{}},fo={exports:{}};fo.exports=function(e,t){var n,r,i,a,o,s,l,u;for(r=e.length-(n=3&e.length),i=t,o=3432918353,s=461845907,u=0;u<r;)l=255&e.charCodeAt(u)|(255&e.charCodeAt(++u))<<8|(255&e.charCodeAt(++u))<<16|(255&e.charCodeAt(++u))<<24,++u,i=27492+(65535&(a=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(a>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&e.charCodeAt(u+2))<<16;case 2:l^=(255&e.charCodeAt(u+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&e.charCodeAt(u)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*s+(((l>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};var po=fo.exports,mo={exports:{}};mo.exports=function(e,t){for(var n,r=e.length,i=t^r,a=0;r>=4;)n=1540483477*(65535&(n=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+((1540483477*(n>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),r-=4,++a;switch(r){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};var go=po,yo=mo.exports;ho.exports=go,ho.exports.murmur3=go,ho.exports.murmur2=yo;var vo=n(ho.exports);class _o{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,n,r){this.ids.push(bo(e)),this.positions.push(t,n,r)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const t=bo(e);let n=0,r=this.ids.length-1;for(;n<r;){const e=n+r>>1;this.ids[e]>=t?r=e:n=e+1}const i=[];for(;this.ids[n]===t;)i.push({index:this.positions[3*n],start:this.positions[3*n+1],end:this.positions[3*n+2]}),n++;return i}static serialize(e,t){const n=new Float64Array(e.ids),r=new Uint32Array(e.positions);return xo(n,r,0,n.length-1),t&&t.push(n.buffer,r.buffer),{ids:n,positions:r}}static deserialize(e){const t=new _o;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function bo(e){const t=+e;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:vo(String(e))}function xo(e,t,n,r){for(;n<r;){const i=e[n+r>>1];let a=n-1,o=r+1;for(;;){do{a++}while(e[a]<i);do{o--}while(e[o]>i);if(a>=o)break;wo(e,a,o),wo(t,3*a,3*o),wo(t,3*a+1,3*o+1),wo(t,3*a+2,3*o+2)}o-n<r-o?(xo(e,t,n,o),n=o+1):(xo(e,t,o+1,r),r=o)}}function wo(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}wi("FeaturePositionMap",_o);class ko{constructor(e,t){this.gl=e.gl,this.location=t}}class So extends ko{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Eo extends ko{constructor(e,t){super(e,t),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Co extends ko{constructor(e,t){super(e,t),this.current=Ge.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Po=new Float32Array(16);function Do(e){return[uo(255*e.r,255*e.g),uo(255*e.b,255*e.a)]}class Io{constructor(e,t,n){this.value=e,this.uniformNames=t.map(e=>"u_".concat(e)),this.type=n}setUniform(e,t,n){e.set(n.constantOr(this.value))}getBinding(e,t,n){return"color"===this.type?new Co(e,t):new So(e,t)}}class To{constructor(e,t){this.uniformNames=t.map(e=>"u_".concat(e)),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr}setUniform(e,t,n,r){const i="u_pattern_to"===r?this.patternTo:"u_pattern_from"===r?this.patternFrom:"u_pixel_ratio_to"===r?this.pixelRatioTo:"u_pixel_ratio_from"===r?this.pixelRatioFrom:null;i&&e.set(i)}getBinding(e,t,n){return"u_pattern"===n.substr(0,9)?new Eo(e,t):new So(e,t)}}class Ao{constructor(e,t,n,r){this.expression=e,this.type=n,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_".concat(e),type:"Float32",components:"color"===n?2:1,offset:0})),this.paintVertexArray=new r}populatePaintArray(e,t,n,r,i){const a=this.paintVertexArray.length,o=this.expression.evaluate(new qi(0),t,{},r,[],i);this.paintVertexArray.resize(e),this._setPaintValue(a,e,o)}updatePaintArray(e,t,n,r){const i=this.expression.evaluate({zoom:0},n,r);this._setPaintValue(e,t,i)}_setPaintValue(e,t,n){if("color"===this.type){const r=Do(n);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r[0],r[1])}else{for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n);this.maxValue=Math.max(this.maxValue,Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zo{constructor(e,t,n,r,i,a){this.expression=e,this.uniformNames=t.map(e=>"u_".concat(e,"_t")),this.type=n,this.useIntegerZoom=r,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map(e=>({name:"a_".concat(e),type:"Float32",components:"color"===n?4:2,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,t,n,r,i){const a=this.expression.evaluate(new qi(this.zoom),t,{},r,[],i),o=this.expression.evaluate(new qi(this.zoom+1),t,{},r,[],i),s=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(s,e,a,o)}updatePaintArray(e,t,n,r){const i=this.expression.evaluate({zoom:this.zoom},n,r),a=this.expression.evaluate({zoom:this.zoom+1},n,r);this._setPaintValue(e,t,i,a)}_setPaintValue(e,t,n,r){if("color"===this.type){const i=Do(n),a=Do(r);for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,i[0],i[1],a[0],a[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,n,r);this.maxValue=Math.max(this.maxValue,Math.abs(n),Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t){const n=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,r=g(this.expression.interpolationFactor(n,this.zoom,this.zoom+1),0,1);e.set(r)}getBinding(e,t,n){return new So(e,t)}}class Oo{constructor(e,t,n,r,i,a){this.expression=e,this.type=t,this.useIntegerZoom=n,this.zoom=r,this.layerId=a,this.zoomInPaintVertexArray=new i,this.zoomOutPaintVertexArray=new i}populatePaintArray(e,t,n){const r=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(r,e,t.patterns&&t.patterns[this.layerId],n)}updatePaintArray(e,t,n,r,i){this._setPaintValues(e,t,n.patterns&&n.patterns[this.layerId],i)}_setPaintValues(e,t,n,r){if(!r||!n)return;const{min:i,mid:a,max:o}=n,s=r[i],l=r[a],u=r[o];if(s&&l&&u)for(let c=e;c<t;c++)this.zoomInPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],s.tl[0],s.tl[1],s.br[0],s.br[1],l.pixelRatio,s.pixelRatio),this.zoomOutPaintVertexArray.emplace(c,l.tl[0],l.tl[1],l.br[0],l.br[1],u.tl[0],u.tl[1],u.br[0],u.br[1],l.pixelRatio,u.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,co.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,co.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Fo{constructor(e,t,n){this.binders={},this._buffers=[];const r=[];for(const i in e.paint._values){if(!n(i))continue;const a=e.paint.get(i);if(!(a instanceof $i&&sr(a.property.specification)))continue;const o=jo(i,e.type),s=a.value,l=a.property.specification.type,u=a.property.useIntegerZoom,c=a.property.specification["property-type"],d="cross-faded"===c||"cross-faded-data-driven"===c;if("constant"===s.kind)this.binders[i]=d?new To(s.value,o):new Io(s.value,o,l),r.push("/u_".concat(i));else if("source"===s.kind||d){const n=Bo(i,l,"source");this.binders[i]=d?new Oo(s,l,u,t,n,e.id):new Ao(s,o,l,n),r.push("/a_".concat(i))}else{const e=Bo(i,l,"composite");this.binders[i]=new zo(s,o,l,u,t,e),r.push("/z_".concat(i))}}this.cacheKey=r.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof Ao||t instanceof zo?t.maxValue:0}populatePaintArrays(e,t,n,r,i){for(const a in this.binders){const o=this.binders[a];(o instanceof Ao||o instanceof zo||o instanceof Oo)&&o.populatePaintArray(e,t,n,r,i)}}setConstantPatternPositions(e,t){for(const n in this.binders){const r=this.binders[n];r instanceof To&&r.setConstantPatternPositions(e,t)}}updatePaintArrays(e,t,n,r,i){let a=!1;for(const o in e){const s=t.getPositions(o);for(const t of s){const s=n.feature(t.index);for(const n in this.binders){const l=this.binders[n];if((l instanceof Ao||l instanceof zo||l instanceof Oo)&&!0===l.expression.isStateDependent){const u=r.paint.get(n);l.expression=u.value,l.updatePaintArray(t.start,t.end,s,e[o],i),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const n=this.binders[t];(n instanceof Io||n instanceof To)&&e.push(...n.uniformNames.map(e=>"#define HAS_UNIFORM_".concat(e)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof Ao||n instanceof zo)for(let t=0;t<n.paintVertexAttributes.length;t++)e.push(n.paintVertexAttributes[t].name);else if(n instanceof Oo)for(let t=0;t<co.members.length;t++)e.push(co.members[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const n=this.binders[t];if(n instanceof Io||n instanceof To||n instanceof zo)for(const t of n.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,t){const n=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Io||i instanceof To||i instanceof zo)for(const a of i.uniformNames)if(t[a]){const o=i.getBinding(e,t[a],a);n.push({name:a,property:r,binding:o})}}return n}setUniforms(e,t,n,r){for(const{name:i,property:a,binding:o}of t)this.binders[a].setUniform(o,r,n.get(a),i)}updatePaintBuffers(e){this._buffers=[];for(const t in this.binders){const n=this.binders[t];if(e&&n instanceof Oo){const t=2===e.fromScale?n.zoomInPaintVertexBuffer:n.zoomOutPaintVertexBuffer;t&&this._buffers.push(t)}else(n instanceof Ao||n instanceof zo)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const t in this.binders){const n=this.binders[t];(n instanceof Ao||n instanceof zo||n instanceof Oo)&&n.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof Ao||t instanceof zo||t instanceof Oo)&&t.destroy()}}}class Mo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>!0;this.programConfigurations={};for(const r of e)this.programConfigurations[r.id]=new Fo(r,t,n);this.needsUpload=!1,this._featureMap=new _o,this._bufferOffset=0}populatePaintArrays(e,t,n,r,i,a){for(const o in this.programConfigurations)this.programConfigurations[o].populatePaintArrays(e,t,r,i,a);void 0!==t.id&&this._featureMap.add(t.id,n,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,n,r){for(const i of n)this.needsUpload=this.programConfigurations[i.id].updatePaintArrays(e,this._featureMap,t,i,r)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function jo(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace("".concat(t,"-"),"").replace(/-/g,"_")]}function Bo(e,t,n){const r={color:{source:ga,composite:Oa},number:{source:Da,composite:ga}},i=function(e){return{"line-pattern":{source:Ja,composite:Ja},"fill-pattern":{source:Ja,composite:Ja},"fill-extrusion-pattern":{source:Ja,composite:Ja}}[e]}(e);return i&&i[n]||r[t][n]}wi("ConstantBinder",Io),wi("CrossFadedConstantBinder",To),wi("SourceExpressionBinder",Ao),wi("CrossFadedCompositeBinder",Oo),wi("CompositeExpressionBinder",zo),wi("ProgramConfiguration",Fo,{omit:["_buffers"]}),wi("ProgramConfigurationSet",Mo);const Ro=8192,Lo=Math.pow(2,14)-1,No=-Lo-1;function Uo(e){const t=Ro/e.extent,n=e.loadGeometry();for(let r=0;r<n.length;r++){const e=n[r];for(let n=0;n<e.length;n++){const r=e[n],i=Math.round(r.x*t),a=Math.round(r.y*t);r.x=g(i,No,Lo),r.y=g(a,No,Lo),(i<r.x||i>r.x+1||a<r.y||a>r.y+1)&&S("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return n}function Vo(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?Uo(e):[]}}function qo(e,t,n,r,i){e.emplaceBack(2*t+(r+1)/2,2*n+(i+1)/2)}class Ho{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ka,this.indexArray=new io,this.segments=new lo,this.programConfigurations=new Mo(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,n){const r=this.layers[0],i=[];let a=null,o=!1;"circle"===r.type&&(a=r.layout.get("circle-sort-key"),o=!a.isConstant());for(const{feature:s,id:l,index:u,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Vo(s,e);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),t,n))continue;const r=o?a.evaluate(t,{},n):void 0,d={id:l,properties:s.properties,type:s.type,sourceLayerIndex:c,index:u,geometry:e?t.geometry:Uo(s),patterns:{},sortKey:r};i.push(d)}o&&i.sort((e,t)=>e.sortKey-t.sortKey);for(const s of i){const{geometry:r,index:i,sourceLayerIndex:a}=s,o=e[i].feature;this.addFeature(s,r,i,n),t.featureIndex.insert(o,r,i,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,so),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,n,r){for(const i of t)for(const t of i){const n=t.x,r=t.y;if(n<0||n>=Ro||r<0||r>=Ro)continue;const i=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),a=i.vertexLength;qo(this.layoutVertexArray,n,r,-1,-1),qo(this.layoutVertexArray,n,r,1,-1),qo(this.layoutVertexArray,n,r,1,1),qo(this.layoutVertexArray,n,r,-1,1),this.indexArray.emplaceBack(a,a+1,a+2),this.indexArray.emplaceBack(a,a+3,a+2),i.vertexLength+=4,i.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,{},r)}}function Wo(e,t){for(let n=0;n<e.length;n++)if(es(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(es(e,t[n]))return!0;return!!Xo(e,t)}function Zo(e,t,n){return!!es(e,t)||!!Yo(t,e,n)}function Ko(e,t){if(1===e.length)return Qo(t,e[0]);for(let n=0;n<t.length;n++){const r=t[n];for(let t=0;t<r.length;t++)if(es(e,r[t]))return!0}for(let n=0;n<e.length;n++)if(Qo(t,e[n]))return!0;for(let n=0;n<t.length;n++)if(Xo(e,t[n]))return!0;return!1}function Go(e,t,n){if(e.length>1){if(Xo(e,t))return!0;for(let r=0;r<t.length;r++)if(Yo(t[r],e,n))return!0}for(let r=0;r<e.length;r++)if(Yo(e[r],t,n))return!0;return!1}function Xo(e,t){if(0===e.length||0===t.length)return!1;for(let n=0;n<e.length-1;n++){const r=e[n],i=e[n+1];for(let e=0;e<t.length-1;e++)if($o(r,i,t[e],t[e+1]))return!0}return!1}function $o(e,t,n,r){return E(e,n,r)!==E(t,n,r)&&E(e,t,n)!==E(e,t,r)}function Yo(e,t,n){const r=n*n;if(1===t.length)return e.distSqr(t[0])<r;for(let i=1;i<t.length;i++)if(Jo(e,t[i-1],t[i])<r)return!0;return!1}function Jo(e,t,n){const r=t.distSqr(n);if(0===r)return e.distSqr(t);const i=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/r;return e.distSqr(i<0?t:i>1?n:n.sub(t)._mult(i)._add(t))}function Qo(e,t){let n,r,i,a=!1;for(let o=0;o<e.length;o++){n=e[o];for(let e=0,o=n.length-1;e<n.length;o=e++)r=n[e],i=n[o],r.y>t.y!=i.y>t.y&&t.x<(i.x-r.x)*(t.y-r.y)/(i.y-r.y)+r.x&&(a=!a)}return a}function es(e,t){let n=!1;for(let r=0,i=e.length-1;r<e.length;i=r++){const a=e[r],o=e[i];a.y>t.y!=o.y>t.y&&t.x<(o.x-a.x)*(t.y-a.y)/(o.y-a.y)+a.x&&(n=!n)}return n}function ts(e,t,n){const r=n[0],i=n[2];if(e.x<r.x&&t.x<r.x||e.x>i.x&&t.x>i.x||e.y<r.y&&t.y<r.y||e.y>i.y&&t.y>i.y)return!1;const a=E(e,t,n[0]);return a!==E(e,t,n[1])||a!==E(e,t,n[2])||a!==E(e,t,n[3])}function ns(e,t,n){const r=t.paint.get(e).value;return"constant"===r.kind?r.value:n.programConfigurations.get(t.id).getMaxValue(e)}function rs(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function is(e,t,n,r,i){if(!t[0]&&!t[1])return e;const a=o.convert(t)._mult(i);"viewport"===n&&a._rotate(-r);const s=[];for(let o=0;o<e.length;o++)s.push(e[o].sub(a));return s}let as,os;wi("CircleBucket",Ho,{omit:["layers"]});var ss={get paint(){return os=os||new ra({"circle-radius":new Qi(K.paint_circle["circle-radius"]),"circle-color":new Qi(K.paint_circle["circle-color"]),"circle-blur":new Qi(K.paint_circle["circle-blur"]),"circle-opacity":new Qi(K.paint_circle["circle-opacity"]),"circle-translate":new Ji(K.paint_circle["circle-translate"]),"circle-translate-anchor":new Ji(K.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ji(K.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ji(K.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qi(K.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qi(K.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qi(K.paint_circle["circle-stroke-opacity"])})},get layout(){return as=as||new ra({"circle-sort-key":new Qi(K.layout_circle["circle-sort-key"])})}},ls=1e-6,us="undefined"!=typeof Float32Array?Float32Array:Array;function cs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function ds(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],_=n[0],b=n[1],x=n[2],w=n[3];return e[0]=_*r+b*s+x*d+w*m,e[1]=_*i+b*l+x*h+w*g,e[2]=_*a+b*u+x*f+w*y,e[3]=_*o+b*c+x*p+w*v,e[4]=(_=n[4])*r+(b=n[5])*s+(x=n[6])*d+(w=n[7])*m,e[5]=_*i+b*l+x*h+w*g,e[6]=_*a+b*u+x*f+w*y,e[7]=_*o+b*c+x*p+w*v,e[8]=(_=n[8])*r+(b=n[9])*s+(x=n[10])*d+(w=n[11])*m,e[9]=_*i+b*l+x*h+w*g,e[10]=_*a+b*u+x*f+w*y,e[11]=_*o+b*c+x*p+w*v,e[12]=(_=n[12])*r+(b=n[13])*s+(x=n[14])*d+(w=n[15])*m,e[13]=_*i+b*l+x*h+w*g,e[14]=_*a+b*u+x*f+w*y,e[15]=_*o+b*c+x*p+w*v,e}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var hs,fs=ds;function ps(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3];return e[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*o,e[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*o,e[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*o,e[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*o,e}hs=new us(4),us!=Float32Array&&(hs[0]=0,hs[1]=0,hs[2]=0,hs[3]=0);class ms extends aa{constructor(e){super(e,ss)}createBucket(e){return new Ho(e)}queryRadius(e){const t=e;return ns("circle-radius",this,t)+ns("circle-stroke-width",this,t)+rs(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,n,r,i,a,o,s){const l=is(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),a.angle,o),u=this.paint.get("circle-radius").evaluate(t,n)+this.paint.get("circle-stroke-width").evaluate(t,n),c="map"===this.paint.get("circle-pitch-alignment"),d=c?l:function(e,t){return e.map(e=>gs(e,t))}(l,s),h=c?u*o:u;for(const f of r)for(const e of f){const t=c?e:gs(e,s);let n=h;const r=ps([],[e.x,e.y,0,1],s);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?n*=r[3]/a.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(n*=a.cameraToCenterDistance/r[3]),Zo(d,t,n))return!0}return!1}}function gs(e,t){const n=ps([],[e.x,e.y,0,1],t);return new o(n[0]/n[3],n[1]/n[3])}class ys extends Ho{}let vs;wi("HeatmapBucket",ys,{omit:["layers"]});var _s={get paint(){return vs=vs||new ra({"heatmap-radius":new Qi(K.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qi(K.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ji(K.paint_heatmap["heatmap-intensity"]),"heatmap-color":new na(K.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ji(K.paint_heatmap["heatmap-opacity"])})}};function bs(e,t,n,r){let{width:i,height:a}=t;if(r){if(r instanceof Uint8ClampedArray)r=new Uint8Array(r.buffer);else if(r.length!==i*a*n)throw new RangeError("mismatched image size. expected: ".concat(r.length," but got: ").concat(i*a*n))}else r=new Uint8Array(i*a*n);return e.width=i,e.height=a,e.data=r,e}function xs(e,t,n){let{width:r,height:i}=t;if(r===e.width&&i===e.height)return;const a=bs({},{width:r,height:i},n);ws(e,a,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,r),height:Math.min(e.height,i)},n),e.width=r,e.height=i,e.data=a.data}function ws(e,t,n,r,i,a){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||n.x>e.width-i.width||n.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||r.x>t.width-i.width||r.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const o=e.data,s=t.data;if(o===s)throw new Error("srcData equals dstData, so image is already copied");for(let l=0;l<i.height;l++){const u=((n.y+l)*e.width+n.x)*a,c=((r.y+l)*t.width+r.x)*a;for(let e=0;e<i.width*a;e++)s[c+e]=o[u+e]}return t}class ks{constructor(e,t){bs(this,e,1,t)}resize(e){xs(this,e,1)}clone(){return new ks({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,i){ws(e,t,n,r,i,1)}}class Ss{constructor(e,t){bs(this,e,4,t)}resize(e){xs(this,e,4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ss({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,n,r,i){ws(e,t,n,r,i,4)}}function Es(e){const t={},n=e.resolution||256,r=e.clips?e.clips.length:1,i=e.image||new Ss({width:n,height:r});if(Math.log(n)/Math.LN2%1!=0)throw new Error("width is not a power of 2 - ".concat(n));const a=(n,r,a)=>{t[e.evaluationKey]=a;const o=e.expression.evaluate(t);i.data[n+r+0]=Math.floor(255*o.r/o.a),i.data[n+r+1]=Math.floor(255*o.g/o.a),i.data[n+r+2]=Math.floor(255*o.b/o.a),i.data[n+r+3]=Math.floor(255*o.a)};if(e.clips)for(let o=0,s=0;o<r;++o,s+=4*n)for(let t=0,r=0;t<n;t++,r+=4){const i=t/(n-1),{start:l,end:u}=e.clips[o];a(s,r,l*(1-i)+u*i)}else for(let o=0,s=0;o<n;o++,s+=4)a(0,s,o/(n-1));return i}wi("AlphaImage",ks),wi("RGBAImage",Ss);const Cs="big-fb";class Ps extends aa{createBucket(e){return new ys(e)}constructor(e){super(e,_s),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Es({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Cs)&&this.heatmapFbos.delete(Cs)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Ds;var Is={get paint(){return Ds=Ds||new ra({"hillshade-illumination-direction":new Ji(K.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ji(K.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ji(K.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ji(K.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ji(K.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ji(K.paint_hillshade["hillshade-accent-color"])})}};class Ts extends aa{constructor(e){super(e,Is)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}const As=ua([{name:"a_pos",components:2,type:"Int16"}],4),{members:zs}=As;function Os(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=t&&t.length,i=r?t[0]*n:e.length;let a=Fs(e,0,i,n,!0);const o=[];if(!a||a.next===a.prev)return o;let s,l,u;if(r&&(a=function(e,t,n,r){const i=[];for(let a=0,o=t.length;a<o;a++){const n=Fs(e,t[a]*r,a<o-1?t[a+1]*r:e.length,r,!1);n===n.next&&(n.steiner=!0),i.push(Ws(n))}i.sort(Us);for(let a=0;a<i.length;a++)n=Vs(i[a],n);return n}(e,t,a,n)),e.length>80*n){s=1/0,l=1/0;let t=-1/0,r=-1/0;for(let a=n;a<i;a+=n){const n=e[a],i=e[a+1];n<s&&(s=n),i<l&&(l=i),n>t&&(t=n),i>r&&(r=i)}u=Math.max(t-s,r-l),u=0!==u?32767/u:0}return js(a,o,n,s,l,u,0),o}function Fs(e,t,n,r,i){let a;if(i===function(e,t,n,r){let i=0;for(let a=t,o=n-r;a<n;a+=r)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}(e,t,n,r)>0)for(let o=t;o<n;o+=r)a=tl(o/r|0,e[o],e[o+1],a);else for(let o=n-r;o>=t;o-=r)a=tl(o/r|0,e[o],e[o+1],a);return a&&Xs(a,a.next)&&(nl(a),a=a.next),a}function Ms(e,t){if(!e)return e;t||(t=e);let n,r=e;do{if(n=!1,r.steiner||!Xs(r,r.next)&&0!==Gs(r.prev,r,r.next))r=r.next;else{if(nl(r),r=t=r.prev,r===r.next)break;n=!0}}while(n||r!==t);return t}function js(e,t,n,r,i,a,o){if(!e)return;!o&&a&&function(e,t,n,r){let i=e;do{0===i.z&&(i.z=Hs(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){let t,n=1;do{let r,i=e;e=null;let a=null;for(t=0;i;){t++;let o=i,s=0;for(let e=0;e<n&&(s++,o=o.nextZ,o);e++);let l=n;for(;s>0||l>0&&o;)0!==s&&(0===l||!o||i.z<=o.z)?(r=i,i=i.nextZ,s--):(r=o,o=o.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=o}a.nextZ=null,n*=2}while(t>1)}(i)}(e,r,i,a);let s=e;for(;e.prev!==e.next;){const l=e.prev,u=e.next;if(a?Rs(e,r,i,a):Bs(e))t.push(l.i,e.i,u.i),nl(e),e=u.next,s=u.next;else if((e=u)===s){o?1===o?js(e=Ls(Ms(e),t),t,n,r,i,a,2):2===o&&Ns(e,t,n,r,i,a):js(Ms(e),t,n,r,i,a,1);break}}}function Bs(e){const t=e.prev,n=e,r=e.next;if(Gs(t,n,r)>=0)return!1;const i=t.x,a=n.x,o=r.x,s=t.y,l=n.y,u=r.y,c=i<a?i<o?i:o:a<o?a:o,d=s<l?s<u?s:u:l<u?l:u,h=i>a?i>o?i:o:a>o?a:o,f=s>l?s>u?s:u:l>u?l:u;let p=r.next;for(;p!==t;){if(p.x>=c&&p.x<=h&&p.y>=d&&p.y<=f&&Zs(i,s,a,l,o,u,p.x,p.y)&&Gs(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Rs(e,t,n,r){const i=e.prev,a=e,o=e.next;if(Gs(i,a,o)>=0)return!1;const s=i.x,l=a.x,u=o.x,c=i.y,d=a.y,h=o.y,f=s<l?s<u?s:u:l<u?l:u,p=c<d?c<h?c:h:d<h?d:h,m=s>l?s>u?s:u:l>u?l:u,g=c>d?c>h?c:h:d>h?d:h,y=Hs(f,p,t,n,r),v=Hs(m,g,t,n,r);let _=e.prevZ,b=e.nextZ;for(;_&&_.z>=y&&b&&b.z<=v;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&Zs(s,c,l,d,u,h,_.x,_.y)&&Gs(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&Zs(s,c,l,d,u,h,b.x,b.y)&&Gs(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=f&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==o&&Zs(s,c,l,d,u,h,_.x,_.y)&&Gs(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=v;){if(b.x>=f&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==o&&Zs(s,c,l,d,u,h,b.x,b.y)&&Gs(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Ls(e,t){let n=e;do{const r=n.prev,i=n.next.next;!Xs(r,i)&&$s(r,n,n.next,i)&&Qs(r,i)&&Qs(i,r)&&(t.push(r.i,n.i,i.i),nl(n),nl(n.next),n=e=i),n=n.next}while(n!==e);return Ms(n)}function Ns(e,t,n,r,i,a){let o=e;do{let e=o.next.next;for(;e!==o.prev;){if(o.i!==e.i&&Ks(o,e)){let s=el(o,e);return o=Ms(o,o.next),s=Ms(s,s.next),js(o,t,n,r,i,a,0),void js(s,t,n,r,i,a,0)}e=e.next}o=o.next}while(o!==e)}function Us(e,t){return e.x-t.x}function Vs(e,t){const n=function(e,t){let n=t;const r=e.x,i=e.y;let a,o=-1/0;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const e=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(e<=r&&e>o&&(o=e,a=n.x<n.next.x?n:n.next,e===r))return a}n=n.next}while(n!==t);if(!a)return null;const s=a,l=a.x,u=a.y;let c=1/0;n=a;do{if(r>=n.x&&n.x>=l&&r!==n.x&&Zs(i<u?r:o,i,l,u,i<u?o:r,i,n.x,n.y)){const t=Math.abs(i-n.y)/(r-n.x);Qs(n,e)&&(t<c||t===c&&(n.x>a.x||n.x===a.x&&qs(a,n)))&&(a=n,c=t)}n=n.next}while(n!==s);return a}(e,t);if(!n)return t;const r=el(n,e);return Ms(r,r.next),Ms(n,n.next)}function qs(e,t){return Gs(e.prev,e,t.prev)<0&&Gs(t.next,e,e.next)<0}function Hs(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-n)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Ws(e){let t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Zs(e,t,n,r,i,a,o,s){return(i-o)*(t-s)>=(e-o)*(a-s)&&(e-o)*(r-s)>=(n-o)*(t-s)&&(n-o)*(a-s)>=(i-o)*(r-s)}function Ks(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&$s(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Qs(e,t)&&Qs(t,e)&&function(e,t){let n=e,r=!1;const i=(e.x+t.x)/2,a=(e.y+t.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Gs(e.prev,e,t.prev)||Gs(e,t.prev,t))||Xs(e,t)&&Gs(e.prev,e,e.next)>0&&Gs(t.prev,t,t.next)>0)}function Gs(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Xs(e,t){return e.x===t.x&&e.y===t.y}function $s(e,t,n,r){const i=Js(Gs(e,t,n)),a=Js(Gs(e,t,r)),o=Js(Gs(n,r,e)),s=Js(Gs(n,r,t));return i!==a&&o!==s||!(0!==i||!Ys(e,n,t))||!(0!==a||!Ys(e,r,t))||!(0!==o||!Ys(n,e,r))||!(0!==s||!Ys(n,t,r))}function Ys(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Js(e){return e>0?1:e<0?-1:0}function Qs(e,t){return Gs(e.prev,e,e.next)<0?Gs(e,t,e.next)>=0&&Gs(e,e.prev,t)>=0:Gs(e,t,e.prev)<0||Gs(e,e.next,t)<0}function el(e,t){const n=rl(e.i,e.x,e.y),r=rl(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function tl(e,t,n,r){const i=rl(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function nl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function rl(e,t,n){return{i:e,x:t,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function il(e,t,n){const r=n.patternDependencies;let i=!1;for(const a of t){const t=a.paint.get("".concat(e,"-pattern"));t.isConstant()||(i=!0);const n=t.constantOr(null);n&&(i=!0,r[n.to]=!0,r[n.from]=!0)}return i}function al(e,t,n,r,i){const a=i.patternDependencies;for(const o of t){const t=o.paint.get("".concat(e,"-pattern")).value;if("constant"!==t.kind){let e=t.evaluate({zoom:r-1},n,{},i.availableImages),s=t.evaluate({zoom:r},n,{},i.availableImages),l=t.evaluate({zoom:r+1},n,{},i.availableImages);e=e&&e.name?e.name:e,s=s&&s.name?s.name:s,l=l&&l.name?l.name:l,a[e]=!0,a[s]=!0,a[l]=!0,n.patterns[o.id]={min:e,mid:s,max:l}}}return n}class ol{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ga,this.indexArray=new io,this.indexArray2=new ao,this.programConfigurations=new Mo(e.layers,e.zoom),this.segments=new lo,this.segments2=new lo,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,n){this.hasPattern=il("fill",this.layers,t);const r=this.layers[0].layout.get("fill-sort-key"),i=!r.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,c=Vo(o,e);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),c,n))continue;const d=i?r.evaluate(c,{},n,t.availableImages):void 0,h={id:s,properties:o.properties,type:o.type,sourceLayerIndex:u,index:l,geometry:e?c.geometry:Uo(o),patterns:{},sortKey:d};a.push(h)}i&&a.sort((e,t)=>e.sortKey-t.sortKey);for(const o of a){const{geometry:r,index:i,sourceLayerIndex:a}=o;if(this.hasPattern){const e=al("fill",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,r,i,n,{});t.featureIndex.insert(e[i].feature,r,i,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(const r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,t,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,zs),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,n,r,i){for(const a of bn(t,500)){let e=0;for(const s of a)e+=s.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),n=t.vertexLength,r=[],i=[];for(const s of a){if(0===s.length)continue;s!==a[0]&&i.push(r.length/2);const e=this.segments2.prepareSegment(s.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(s[0].x,s[0].y),this.indexArray2.emplaceBack(t+s.length-1,t),r.push(s[0].x),r.push(s[0].y);for(let n=1;n<s.length;n++)this.layoutVertexArray.emplaceBack(s[n].x,s[n].y),this.indexArray2.emplaceBack(t+n-1,t+n),r.push(s[n].x),r.push(s[n].y);e.vertexLength+=s.length,e.primitiveLength+=s.length}const o=Os(r,i);for(let a=0;a<o.length;a+=3)this.indexArray.emplaceBack(n+o[a],n+o[a+1],n+o[a+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,r)}}let sl,ll;wi("FillBucket",ol,{omit:["layers","patternFeatures"]});var ul={get paint(){return ll=ll||new ra({"fill-antialias":new Ji(K.paint_fill["fill-antialias"]),"fill-opacity":new Qi(K.paint_fill["fill-opacity"]),"fill-color":new Qi(K.paint_fill["fill-color"]),"fill-outline-color":new Qi(K.paint_fill["fill-outline-color"]),"fill-translate":new Ji(K.paint_fill["fill-translate"]),"fill-translate-anchor":new Ji(K.paint_fill["fill-translate-anchor"]),"fill-pattern":new ea(K.paint_fill["fill-pattern"])})},get layout(){return sl=sl||new ra({"fill-sort-key":new Qi(K.layout_fill["fill-sort-key"])})}};class cl extends aa{constructor(e){super(e,ul)}recalculate(e,t){super.recalculate(e,t);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new ol(e)}queryRadius(){return rs(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,n,r,i,a,o){return Ko(is(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),a.angle,o),r)}isTileClipped(){return!0}}const dl=ua([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),hl=ua([{name:"a_centroid",components:2,type:"Int16"}],4),{members:fl}=dl;var pl={},ml=i,gl=yl;function yl(e,t,n,r,i){this.properties={},this.extent=n,this.type=0,this._pbf=e,this._geometry=-1,this._keys=r,this._values=i,e.readFields(vl,this,t)}function vl(e,t,n){1==e?t.id=n.readVarint():2==e?function(e,t){for(var n=e.readVarint()+e.pos;e.pos<n;){var r=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[r]=i}}(n,t):3==e?t.type=n.readVarint():4==e&&(t._geometry=n.pos)}function _l(e){for(var t,n,r=0,i=0,a=e.length,o=a-1;i<a;o=i++)r+=((n=e[o]).x-(t=e[i]).x)*(t.y+n.y);return r}yl.types=["Unknown","Point","LineString","Polygon"],yl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,n=e.readVarint()+e.pos,r=1,i=0,a=0,o=0,s=[];e.pos<n;){if(i<=0){var l=e.readVarint();r=7&l,i=l>>3}if(i--,1===r||2===r)a+=e.readSVarint(),o+=e.readSVarint(),1===r&&(t&&s.push(t),t=[]),t.push(new ml(a,o));else{if(7!==r)throw new Error("unknown command "+r);t&&t.push(t[0].clone())}}return t&&s.push(t),s},yl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,n=1,r=0,i=0,a=0,o=1/0,s=-1/0,l=1/0,u=-1/0;e.pos<t;){if(r<=0){var c=e.readVarint();n=7&c,r=c>>3}if(r--,1===n||2===n)(i+=e.readSVarint())<o&&(o=i),i>s&&(s=i),(a+=e.readSVarint())<l&&(l=a),a>u&&(u=a);else if(7!==n)throw new Error("unknown command "+n)}return[o,l,s,u]},yl.prototype.toGeoJSON=function(e,t,n){var r,i,a=this.extent*Math.pow(2,n),o=this.extent*e,s=this.extent*t,l=this.loadGeometry(),u=yl.types[this.type];function c(e){for(var t=0;t<e.length;t++){var n=e[t];e[t]=[360*(n.x+o)/a-180,360/Math.PI*Math.atan(Math.exp((180-360*(n.y+s)/a)*Math.PI/180))-90]}}switch(this.type){case 1:var d=[];for(r=0;r<l.length;r++)d[r]=l[r][0];c(l=d);break;case 2:for(r=0;r<l.length;r++)c(l[r]);break;case 3:for(l=function(e){var t=e.length;if(t<=1)return[e];for(var n,r,i=[],a=0;a<t;a++){var o=_l(e[a]);0!==o&&(void 0===r&&(r=o<0),r===o<0?(n&&i.push(n),n=[e[a]]):n.push(e[a]))}return n&&i.push(n),i}(l),r=0;r<l.length;r++)for(i=0;i<l[r].length;i++)c(l[r][i])}1===l.length?l=l[0]:u="Multi"+u;var h={type:"Feature",geometry:{type:u,coordinates:l},properties:this.properties};return"id"in this&&(h.id=this.id),h};var bl=gl,xl=wl;function wl(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(kl,this,t),this.length=this._features.length}function kl(e,t,n){15===e?t.version=n.readVarint():1===e?t.name=n.readString():5===e?t.extent=n.readVarint():2===e?t._features.push(n.pos):3===e?t._keys.push(n.readString()):4===e&&t._values.push(function(e){for(var t=null,n=e.readVarint()+e.pos;e.pos<n;){var r=e.readVarint()>>3;t=1===r?e.readString():2===r?e.readFloat():3===r?e.readDouble():4===r?e.readVarint64():5===r?e.readVarint():6===r?e.readSVarint():7===r?e.readBoolean():null}return t}(n))}wl.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new bl(this._pbf,t,this.extent,this._keys,this._values)};var Sl=xl;function El(e,t,n){if(3===e){var r=new Sl(n,n.readVarint()+n.pos);r.length&&(t[r.name]=r)}}pl.VectorTile=function(e,t){this.layers=e.readFields(El,{},t)},pl.VectorTileFeature=gl,pl.VectorTileLayer=xl;const Cl=pl.VectorTileFeature.types,Pl=Math.pow(2,13);function Dl(e,t,n,r,i,a,o,s){e.emplaceBack(t,n,2*Math.floor(r*Pl)+o,i*Pl*2,a*Pl*2,Math.round(s))}class Il{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xa,this.centroidVertexArray=new Za,this.indexArray=new io,this.programConfigurations=new Mo(e.layers,e.zoom),this.segments=new lo,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,n){this.features=[],this.hasPattern=il("fill-extrusion",this.layers,t);for(const{feature:r,id:i,index:a,sourceLayerIndex:o}of e){const e=this.layers[0]._featureFilter.needGeometry,s=Vo(r,e);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),s,n))continue;const l={id:i,sourceLayerIndex:o,index:a,geometry:e?s.geometry:Uo(r),properties:r.properties,type:r.type,patterns:{}};this.hasPattern?this.features.push(al("fill-extrusion",this.layers,l,this.zoom,t)):this.addFeature(l,l.geometry,a,n,{}),t.featureIndex.insert(r,l.geometry,a,o,this.index,!0)}}addFeatures(e,t,n){for(const r of this.features){const{geometry:e}=r;this.addFeature(r,e,r.index,t,n)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fl),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,hl.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,t,n,r,i){for(const a of bn(t,500)){const t={x:0,y:0,vertexCount:0};let n=0;for(const e of a)n+=e.length;let r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const e of a){if(0===e.length)continue;if(Al(e))continue;let n=0;for(let i=0;i<e.length;i++){const a=e[i];if(i>=1){const o=e[i-1];if(!Tl(a,o)){r.vertexLength+4>lo.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const e=a.sub(o)._perp()._unit(),i=o.dist(a);n+i>32768&&(n=0),Dl(this.layoutVertexArray,a.x,a.y,e.x,e.y,0,0,n),Dl(this.layoutVertexArray,a.x,a.y,e.x,e.y,0,1,n),t.x+=2*a.x,t.y+=2*a.y,t.vertexCount+=2,n+=i,Dl(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,0,n),Dl(this.layoutVertexArray,o.x,o.y,e.x,e.y,0,1,n),t.x+=2*o.x,t.y+=2*o.y,t.vertexCount+=2;const s=r.vertexLength;this.indexArray.emplaceBack(s,s+2,s+1),this.indexArray.emplaceBack(s+1,s+2,s+3),r.vertexLength+=4,r.primitiveLength+=2}}}}if(r.vertexLength+n>lo.MAX_VERTEX_ARRAY_LENGTH&&(r=this.segments.prepareSegment(n,this.layoutVertexArray,this.indexArray)),"Polygon"!==Cl[e.type])continue;const i=[],o=[],s=r.vertexLength;for(const e of a)if(0!==e.length){e!==a[0]&&o.push(i.length/2);for(let n=0;n<e.length;n++){const r=e[n];Dl(this.layoutVertexArray,r.x,r.y,0,0,1,1,0),t.x+=r.x,t.y+=r.y,t.vertexCount+=1,i.push(r.x),i.push(r.y)}}const l=Os(i,o);for(let e=0;e<l.length;e+=3)this.indexArray.emplaceBack(s+l[e],s+l[e+2],s+l[e+1]);r.primitiveLength+=l.length/3,r.vertexLength+=n;for(let e=0;e<t.vertexCount;e++){const e=Math.floor(t.x/t.vertexCount),n=Math.floor(t.y/t.vertexCount);this.centroidVertexArray.emplaceBack(e,n)}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,r)}}function Tl(e,t){return e.x===t.x&&(e.x<0||e.x>Ro)||e.y===t.y&&(e.y<0||e.y>Ro)}function Al(e){return e.every(e=>e.x<0)||e.every(e=>e.x>Ro)||e.every(e=>e.y<0)||e.every(e=>e.y>Ro)}let zl;wi("FillExtrusionBucket",Il,{omit:["layers","features"]});var Ol={get paint(){return zl=zl||new ra({"fill-extrusion-opacity":new Ji(K["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qi(K["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ji(K["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ji(K["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ea(K["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qi(K["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qi(K["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ji(K["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Fl extends aa{constructor(e){super(e,Ol)}createBucket(e){return new Il(e)}queryRadius(){return rs(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,t,n,r,i,a,s,l){const u=is(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),a.angle,s),c=this.paint.get("fill-extrusion-height").evaluate(t,n),d=this.paint.get("fill-extrusion-base").evaluate(t,n),h=function(e,t){const n=[];for(const r of e){const e=[r.x,r.y,0,1];ps(e,e,t),n.push(new o(e[0]/e[3],e[1]/e[3]))}return n}(u,l),f=function(e,t,n,r){const i=[],a=[],s=r[8]*t,l=r[9]*t,u=r[10]*t,c=r[11]*t,d=r[8]*n,h=r[9]*n,f=r[10]*n,p=r[11]*n;for(const m of e){const e=[],t=[];for(const n of m){const i=n.x,a=n.y,m=r[0]*i+r[4]*a+r[12],g=r[1]*i+r[5]*a+r[13],y=r[2]*i+r[6]*a+r[14],v=r[3]*i+r[7]*a+r[15],_=y+u,b=v+c,x=m+d,w=g+h,k=y+f,S=v+p,E=new o((m+s)/b,(g+l)/b);E.z=_/b,e.push(E);const C=new o(x/S,w/S);C.z=k/S,t.push(C)}i.push(e),a.push(t)}return[i,a]}(r,d,c,l);return function(e,t,n){let r=1/0;Ko(n,t)&&(r=jl(n,t[0]));for(let i=0;i<t.length;i++){const a=t[i],o=e[i];for(let e=0;e<a.length-1;e++){const t=a[e],i=[t,a[e+1],o[e+1],o[e],t];Wo(n,i)&&(r=Math.min(r,jl(n,i)))}}return r!==1/0&&r}(f[0],f[1],h)}}function Ml(e,t){return e.x*t.x+e.y*t.y}function jl(e,t){if(1===e.length){let n=0;const r=t[n++];let i;for(;!i||r.equals(i);)if(i=t[n++],!i)return 1/0;for(;n<t.length;n++){const a=t[n],o=e[0],s=i.sub(r),l=a.sub(r),u=o.sub(r),c=Ml(s,s),d=Ml(s,l),h=Ml(l,l),f=Ml(u,s),p=Ml(u,l),m=c*h-d*d,g=(h*f-d*p)/m,y=(c*p-d*f)/m,v=r.z*(1-g-y)+i.z*g+a.z*y;if(isFinite(v))return v}return 1/0}{let e=1/0;for(const n of t)e=Math.min(e,n.z);return e}}const Bl=ua([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Rl}=Bl,Ll=ua([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Nl}=Ll,Ul=pl.VectorTileFeature.types,Vl=Math.cos(Math.PI/180*37.5),ql=Math.pow(2,14)/.5;class Hl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(e=>e.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(e=>{this.gradients[e.id]={}}),this.layoutVertexArray=new $a,this.layoutVertexArray2=new Ya,this.indexArray=new io,this.programConfigurations=new Mo(e.layers,e.zoom),this.segments=new lo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id)}populate(e,t,n){this.hasPattern=il("line",this.layers,t);const r=this.layers[0].layout.get("line-sort-key"),i=!r.isConstant(),a=[];for(const{feature:o,id:s,index:l,sourceLayerIndex:u}of e){const e=this.layers[0]._featureFilter.needGeometry,t=Vo(o,e);if(!this.layers[0]._featureFilter.filter(new qi(this.zoom),t,n))continue;const c=i?r.evaluate(t,{},n):void 0,d={id:s,properties:o.properties,type:o.type,sourceLayerIndex:u,index:l,geometry:e?t.geometry:Uo(o),patterns:{},sortKey:c};a.push(d)}i&&a.sort((e,t)=>e.sortKey-t.sortKey);for(const o of a){const{geometry:r,index:i,sourceLayerIndex:a}=o;if(this.hasPattern){const e=al("line",this.layers,o,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(o,r,i,n,{});t.featureIndex.insert(e[i].feature,r,i,a,this.index)}}update(e,t,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,n)}addFeatures(e,t,n){for(const r of this.patternFeatures)this.addFeature(r,r.geometry,r.index,t,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Nl)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rl),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,n,r,i){const a=this.layers[0].layout,o=a.get("line-join").evaluate(e,{}),s=a.get("line-cap"),l=a.get("line-miter-limit"),u=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const c of t)this.addLine(c,e,o,s,l,u);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,n,i,r)}addLine(e,t,n,r,i,a){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const o="Polygon"===Ul[t.type];let s=e.length;for(;s>=2&&e[s-1].equals(e[s-2]);)s--;let l=0;for(;l<s-1&&e[l].equals(e[l+1]);)l++;if(s<(o?3:2))return;"bevel"===n&&(i=1.05);const u=this.overscaling<=16?15*Ro/(512*this.overscaling):0,c=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let d,h,f,p,m;this.e1=this.e2=-1,o&&(d=e[s-2],m=e[l].sub(d)._unit()._perp());for(let g=l;g<s;g++){if(f=g===s-1?o?e[l+1]:void 0:e[g+1],f&&e[g].equals(f))continue;m&&(p=m),d&&(h=d),d=e[g],m=f?f.sub(d)._unit()._perp():p,p=p||m;let t=p.add(m);0===t.x&&0===t.y||t._unit();const y=p.x*m.x+p.y*m.y,v=t.x*m.x+t.y*m.y,_=0!==v?1/v:1/0,b=2*Math.sqrt(2-2*v),x=v<Vl&&h&&f,w=p.x*m.y-p.y*m.x>0;if(x&&g>l){const e=d.dist(h);if(e>2*u){const t=d.sub(d.sub(h)._mult(u/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,p,0,0,c),h=t}}const k=h&&f;let S=k?n:o?"butt":r;if(k&&"round"===S&&(_<a?S="miter":_<=2&&(S="fakeround")),"miter"===S&&_>i&&(S="bevel"),"bevel"===S&&(_>2&&(S="flipbevel"),_<i&&(S="miter")),h&&this.updateDistance(h,d),"miter"===S)t._mult(_),this.addCurrentVertex(d,t,0,0,c);else if("flipbevel"===S){if(_>100)t=m.mult(-1);else{const e=_*p.add(m).mag()/p.sub(m).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(d,t,0,0,c),this.addCurrentVertex(d,t.mult(-1),0,0,c)}else if("bevel"===S||"fakeround"===S){const e=-Math.sqrt(_*_-1),t=w?e:0,n=w?0:e;if(h&&this.addCurrentVertex(d,p,t,n,c),"fakeround"===S){const e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let n=t/e;if(.5!==n){const e=n-.5;n+=n*e*(n-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}const r=m.sub(p)._mult(n)._add(p)._unit()._mult(w?-1:1);this.addHalfVertex(d,r.x,r.y,!1,w,0,c)}}f&&this.addCurrentVertex(d,m,-t,-n,c)}else if("butt"===S)this.addCurrentVertex(d,t,0,0,c);else if("square"===S){const e=h?1:-1;this.addCurrentVertex(d,t,e,e,c)}else"round"===S&&(h&&(this.addCurrentVertex(d,p,0,0,c),this.addCurrentVertex(d,p,1,1,c,!0)),f&&(this.addCurrentVertex(d,m,-1,-1,c,!0),this.addCurrentVertex(d,m,0,0,c)));if(x&&g<s-1){const e=d.dist(f);if(e>2*u){const t=d.add(f.sub(d)._mult(u/e)._round());this.updateDistance(d,t),this.addCurrentVertex(t,m,0,0,c),d=t}}}}addCurrentVertex(e,t,n,r,i){let a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const o=t.y*r-t.x,s=-t.y-t.x*r;this.addHalfVertex(e,t.x+t.y*n,t.y-t.x*n,a,!1,n,i),this.addHalfVertex(e,o,s,a,!0,-r,i),this.distance>ql/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,t,n,r,i,a))}addHalfVertex(e,t,n,r,i,a,o){let{x:s,y:l}=e;const u=.5*(this.lineClips?this.scaledDistance*(ql-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((s<<1)+(r?1:0),(l<<1)+(i?1:0),Math.round(63*t)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1)|(63&u)<<2,u>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const c=o.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,c),o.primitiveLength++),i?this.e2=c:this.e1=c}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}let Wl,Zl;wi("LineBucket",Hl,{omit:["layers","patternFeatures"]});var Kl={get paint(){return Zl=Zl||new ra({"line-opacity":new Qi(K.paint_line["line-opacity"]),"line-color":new Qi(K.paint_line["line-color"]),"line-translate":new Ji(K.paint_line["line-translate"]),"line-translate-anchor":new Ji(K.paint_line["line-translate-anchor"]),"line-width":new Qi(K.paint_line["line-width"]),"line-gap-width":new Qi(K.paint_line["line-gap-width"]),"line-offset":new Qi(K.paint_line["line-offset"]),"line-blur":new Qi(K.paint_line["line-blur"]),"line-dasharray":new ta(K.paint_line["line-dasharray"]),"line-pattern":new ea(K.paint_line["line-pattern"]),"line-gradient":new na(K.paint_line["line-gradient"])})},get layout(){return Wl=Wl||new ra({"line-cap":new Ji(K.layout_line["line-cap"]),"line-join":new Qi(K.layout_line["line-join"]),"line-miter-limit":new Ji(K.layout_line["line-miter-limit"]),"line-round-limit":new Ji(K.layout_line["line-round-limit"]),"line-sort-key":new Qi(K.layout_line["line-sort-key"])})}};class Gl extends Qi{possiblyEvaluate(e,t){return t=new qi(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,n,r){return t=v({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,n,r)}}let Xl;class $l extends aa{constructor(e){super(e,Kl),this.gradientVersion=0,Xl||(Xl=new Gl(Kl.paint.properties["line-width"].specification),Xl.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this.gradientExpression();this.stepInterpolant=!!function(e){return void 0!==e._styleExpression}(e)&&e._styleExpression.expression instanceof St,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=Xl.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Hl(e)}queryRadius(e){const t=e,n=Yl(ns("line-width",this,t),ns("line-gap-width",this,t)),r=ns("line-offset",this,t);return n/2+Math.abs(r)+rs(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,n,r,i,a,s){const l=is(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),a.angle,s),u=s/2*Yl(this.paint.get("line-width").evaluate(t,n),this.paint.get("line-gap-width").evaluate(t,n)),c=this.paint.get("line-offset").evaluate(t,n);return c&&(r=function(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r],a=[];for(let e=0;e<i.length;e++){const n=i[e-1],r=i[e],s=i[e+1],l=0===e?new o(0,0):r.sub(n)._unit()._perp(),u=e===i.length-1?new o(0,0):s.sub(r)._unit()._perp(),c=l._add(u)._unit(),d=c.x*u.x+c.y*u.y;0!==d&&c._mult(1/d),a.push(c._mult(t)._add(r))}n.push(a)}return n}(r,c*s)),function(e,t,n){for(let r=0;r<t.length;r++){const i=t[r];if(e.length>=3)for(let t=0;t<i.length;t++)if(es(e,i[t]))return!0;if(Go(e,i,n))return!0}return!1}(l,r,u)}isTileClipped(){return!0}}function Yl(e,t){return t>0?t+2*e:e}const Jl=ua([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Ql=ua([{name:"a_projected_pos",components:3,type:"Float32"}],4);ua([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const eu=ua([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);ua([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const tu=ua([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),nu=ua([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function ru(e,t,n){return e.sections.forEach(e=>{e.text=function(e,t,n){const r=t.layout.get("text-transform").evaluate(n,{});return"uppercase"===r?e=e.toLocaleUpperCase():"lowercase"===r&&(e=e.toLocaleLowerCase()),Vi.applyArabicShaping&&(e=Vi.applyArabicShaping(e)),e}(e.text,t,n)}),e}ua([{name:"triangle",components:3,type:"Uint16"}]),ua([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),ua([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),ua([{type:"Float32",name:"offsetX"}]),ua([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),ua([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const iu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var au=24,ou=uu,su=function(e,t,n,r,i){var a,o,s=8*i-r-1,l=(1<<s)-1,u=l>>1,c=-7,d=n?i-1:0,h=n?-1:1,f=e[t+d];for(d+=h,a=f&(1<<-c)-1,f>>=-c,c+=s;c>0;a=256*a+e[t+d],d+=h,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+e[t+d],d+=h,c-=8);if(0===a)a=1-u;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),a-=u}return(f?-1:1)*o*Math.pow(2,a-r)},lu=function(e,t,n,r,i,a){var o,s,l,u=8*a-i-1,c=(1<<u)-1,d=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:a-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=c):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=c?(s=0,o=c):o+d>=1?(s=(t*l-1)*Math.pow(2,i),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&s,f+=p,s/=256,i-=8);for(o=o<<i|s,u+=i;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m};function uu(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}uu.Varint=0,uu.Fixed64=1,uu.Bytes=2,uu.Fixed32=5;var cu=4294967296,du=1/cu,hu="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8");function fu(e){return e.type===uu.Bytes?e.readVarint()+e.pos:e.pos+1}function pu(e,t,n){return n?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function mu(e,t,n){var r=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));n.realloc(r);for(var i=n.pos-1;i>=e;i--)n.buf[i+r]=n.buf[i]}function gu(e,t){for(var n=0;n<e.length;n++)t.writeVarint(e[n])}function yu(e,t){for(var n=0;n<e.length;n++)t.writeSVarint(e[n])}function vu(e,t){for(var n=0;n<e.length;n++)t.writeFloat(e[n])}function _u(e,t){for(var n=0;n<e.length;n++)t.writeDouble(e[n])}function bu(e,t){for(var n=0;n<e.length;n++)t.writeBoolean(e[n])}function xu(e,t){for(var n=0;n<e.length;n++)t.writeFixed32(e[n])}function wu(e,t){for(var n=0;n<e.length;n++)t.writeSFixed32(e[n])}function ku(e,t){for(var n=0;n<e.length;n++)t.writeFixed64(e[n])}function Su(e,t){for(var n=0;n<e.length;n++)t.writeSFixed64(e[n])}function Eu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Cu(e,t,n){e[n]=t,e[n+1]=t>>>8,e[n+2]=t>>>16,e[n+3]=t>>>24}function Pu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}uu.prototype={destroy:function(){this.buf=null},readFields:function(e,t,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,a=this.pos;this.type=7&r,e(i,t,this),this.pos===a&&this.skip(r)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Eu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Pu(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Eu(this.buf,this.pos)+Eu(this.buf,this.pos+4)*cu;return this.pos+=8,e},readSFixed64:function(){var e=Eu(this.buf,this.pos)+Pu(this.buf,this.pos+4)*cu;return this.pos+=8,e},readFloat:function(){var e=su(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=su(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,n,r=this.buf;return t=127&(n=r[this.pos++]),n<128?t:(t|=(127&(n=r[this.pos++]))<<7,n<128?t:(t|=(127&(n=r[this.pos++]))<<14,n<128?t:(t|=(127&(n=r[this.pos++]))<<21,n<128?t:function(e,t,n){var r,i,a=n.buf;if(r=(112&(i=a[n.pos++]))>>4,i<128)return pu(e,r,t);if(r|=(127&(i=a[n.pos++]))<<3,i<128)return pu(e,r,t);if(r|=(127&(i=a[n.pos++]))<<10,i<128)return pu(e,r,t);if(r|=(127&(i=a[n.pos++]))<<17,i<128)return pu(e,r,t);if(r|=(127&(i=a[n.pos++]))<<24,i<128)return pu(e,r,t);if(r|=(1&(i=a[n.pos++]))<<31,i<128)return pu(e,r,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(n=r[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&hu?function(e,t,n){return hu.decode(e.subarray(t,n))}(this.buf,t,e):function(e,t,n){for(var r="",i=t;i<n;){var a,o,s,l=e[i],u=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c>n)break;1===c?l<128&&(u=l):2===c?128==(192&(a=e[i+1]))&&(u=(31&l)<<6|63&a)<=127&&(u=null):3===c?(o=e[i+2],128==(192&(a=e[i+1]))&&128==(192&o)&&((u=(15&l)<<12|(63&a)<<6|63&o)<=2047||u>=55296&&u<=57343)&&(u=null)):4===c&&(o=e[i+2],s=e[i+3],128==(192&(a=e[i+1]))&&128==(192&o)&&128==(192&s)&&((u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)<=65535||u>=1114112)&&(u=null)),null===u?(u=65533,c=1):u>65535&&(u-=65536,r+=String.fromCharCode(u>>>10&1023|55296),u=56320|1023&u),r+=String.fromCharCode(u),i+=c}return r}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==uu.Bytes)return e.push(this.readVarint(t));var n=fu(this);for(e=e||[];this.pos<n;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==uu.Bytes)return e.push(this.readSVarint());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==uu.Bytes)return e.push(this.readBoolean());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==uu.Bytes)return e.push(this.readFloat());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==uu.Bytes)return e.push(this.readDouble());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==uu.Bytes)return e.push(this.readFixed32());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==uu.Bytes)return e.push(this.readSFixed32());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==uu.Bytes)return e.push(this.readFixed64());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==uu.Bytes)return e.push(this.readSFixed64());var t=fu(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===uu.Varint)for(;this.buf[this.pos++]>127;);else if(t===uu.Bytes)this.pos=this.readVarint()+this.pos;else if(t===uu.Fixed32)this.pos+=4;else{if(t!==uu.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var n=new Uint8Array(t);n.set(this.buf),this.buf=n,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Cu(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Cu(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Cu(this.buf,-1&e,this.pos),Cu(this.buf,Math.floor(e*du),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Cu(this.buf,-1&e,this.pos),Cu(this.buf,Math.floor(e*du),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var n,r;if(e>=0?(n=e%4294967296|0,r=e/4294967296|0):(r=~(-e/4294967296),4294967295^(n=~(-e%4294967296))?n=n+1|0:(n=0,r=r+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,n){n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,e>>>=7,n.buf[n.pos++]=127&e|128,n.buf[n.pos]=127&(e>>>=7)}(n,0,t),function(e,t){var n=(7&e)<<4;t.buf[t.pos++]|=n|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(r,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,n){for(var r,i,a=0;a<t.length;a++){if((r=t.charCodeAt(a))>55295&&r<57344){if(!i){r>56319||a+1===t.length?(e[n++]=239,e[n++]=191,e[n++]=189):i=r;continue}if(r<56320){e[n++]=239,e[n++]=191,e[n++]=189,i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&(e[n++]=239,e[n++]=191,e[n++]=189,i=null);r<128?e[n++]=r:(r<2048?e[n++]=r>>6|192:(r<65536?e[n++]=r>>12|224:(e[n++]=r>>18|240,e[n++]=r>>12&63|128),e[n++]=r>>6&63|128),e[n++]=63&r|128)}return n}(this.buf,e,this.pos);var n=this.pos-t;n>=128&&mu(t,n,this),this.pos=t-1,this.writeVarint(n),this.pos+=n},writeFloat:function(e){this.realloc(4),lu(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),lu(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var n=0;n<t;n++)this.buf[this.pos++]=e[n]},writeRawMessage:function(e,t){this.pos++;var n=this.pos;e(t,this);var r=this.pos-n;r>=128&&mu(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(e,t,n){this.writeTag(e,uu.Bytes),this.writeRawMessage(t,n)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,gu,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,yu,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,bu,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,vu,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,_u,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,xu,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,wu,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,ku,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Su,t)},writeBytesField:function(e,t){this.writeTag(e,uu.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,uu.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,uu.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,uu.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,uu.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,uu.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,uu.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,uu.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,uu.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,uu.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Du=n(ou);const Iu=3;function Tu(e,t,n){1===e&&n.readMessage(Au,t)}function Au(e,t,n){if(3===e){const{id:e,bitmap:r,width:i,height:a,left:o,top:s,advance:l}=n.readMessage(zu,{});t.push({id:e,bitmap:new ks({width:i+2*Iu,height:a+2*Iu},r),metrics:{width:i,height:a,left:o,top:s,advance:l}})}}function zu(e,t,n){1===e?t.id=n.readVarint():2===e?t.bitmap=n.readBytes():3===e?t.width=n.readVarint():4===e?t.height=n.readVarint():5===e?t.left=n.readSVarint():6===e?t.top=n.readSVarint():7===e&&(t.advance=n.readVarint())}const Ou=Iu;function Fu(e){let t=0,n=0;for(const o of e)t+=o.w*o.h,n=Math.max(n,o.w);e.sort((e,t)=>t.h-e.h);const r=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),n),h:1/0}];let i=0,a=0;for(const o of e)for(let e=r.length-1;e>=0;e--){const t=r[e];if(!(o.w>t.w||o.h>t.h)){if(o.x=t.x,o.y=t.y,a=Math.max(a,o.y+o.h),i=Math.max(i,o.x+o.w),o.w===t.w&&o.h===t.h){const t=r.pop();e<r.length&&(r[e]=t)}else o.h===t.h?(t.x+=o.w,t.w-=o.w):o.w===t.w?(t.y+=o.h,t.h-=o.h):(r.push({x:t.x+o.w,y:t.y,w:t.w-o.w,h:o.h}),t.y+=o.h,t.h-=o.h);break}}return{w:i,h:a,fill:t/(i*a)||0}}const Mu=1;class ju{constructor(e,t){let{pixelRatio:n,version:r,stretchX:i,stretchY:a,content:o,textFitWidth:s,textFitHeight:l}=t;this.paddedRect=e,this.pixelRatio=n,this.stretchX=i,this.stretchY=a,this.content=o,this.version=r,this.textFitWidth=s,this.textFitHeight=l}get tl(){return[this.paddedRect.x+Mu,this.paddedRect.y+Mu]}get br(){return[this.paddedRect.x+this.paddedRect.w-Mu,this.paddedRect.y+this.paddedRect.h-Mu]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Mu)/this.pixelRatio,(this.paddedRect.h-2*Mu)/this.pixelRatio]}}class Bu{constructor(e,t){const n={},r={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,n,i),this.addImages(t,r,i);const{w:a,h:o}=Fu(i),s=new Ss({width:a||1,height:o||1});for(const l in e){const t=e[l],r=n[l].paddedRect;Ss.copy(t.data,s,{x:0,y:0},{x:r.x+Mu,y:r.y+Mu},t.data)}for(const l in t){const e=t[l],n=r[l].paddedRect,i=n.x+Mu,a=n.y+Mu,o=e.data.width,u=e.data.height;Ss.copy(e.data,s,{x:0,y:0},{x:i,y:a},e.data),Ss.copy(e.data,s,{x:0,y:u-1},{x:i,y:a-1},{width:o,height:1}),Ss.copy(e.data,s,{x:0,y:0},{x:i,y:a+u},{width:o,height:1}),Ss.copy(e.data,s,{x:o-1,y:0},{x:i-1,y:a},{width:1,height:u}),Ss.copy(e.data,s,{x:0,y:0},{x:i+o,y:a},{width:1,height:u})}this.image=s,this.iconPositions=n,this.patternPositions=r}addImages(e,t,n){for(const r in e){const i=e[r],a={x:0,y:0,w:i.data.width+2*Mu,h:i.data.height+2*Mu};n.push(a),t[r]=new ju(a,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(r)}}patchUpdatedImages(e,t){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const n in e.updatedImages)this.patchUpdatedImage(this.iconPositions[n],e.getImage(n),t),this.patchUpdatedImage(this.patternPositions[n],e.getImage(n),t)}patchUpdatedImage(e,t,n){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[r,i]=e.tl;n.update(t.data,void 0,{x:r,y:i})}}var Ru;wi("ImagePosition",ju),wi("ImageAtlas",Bu),e.ah=void 0,(Ru=e.ah||(e.ah={}))[Ru.none=0]="none",Ru[Ru.horizontal=1]="horizontal",Ru[Ru.vertical=2]="vertical",Ru[Ru.horizontalOnly=3]="horizontalOnly";const Lu=-17;class Nu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const n=new Nu;return n.scale=e||1,n.fontStack=t,n}static forImage(e){const t=new Nu;return t.imageName=e,t}}class Uu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const n=new Uu;for(let r=0;r<e.sections.length;r++){const i=e.sections[r];i.image?n.addImageSection(i):n.addTextSection(i,t)}return n}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let t="";for(let n=0;n<e.length;n++){const r=e.charCodeAt(n+1)||null,i=e.charCodeAt(n-1)||null;t+=r&&Bi(r)&&!iu[e[n+1]]||i&&Bi(i)&&!iu[e[n-1]]||!iu[e[n]]?e[n]:iu[e[n]]}return t}(this.text)}trim(){let e=0;for(let n=0;n<this.text.length&&qu[this.text.charCodeAt(n)];n++)e++;let t=this.text.length;for(let n=this.text.length-1;n>=0&&n>=e&&qu[this.text.charCodeAt(n)];n--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const n=new Uu;return n.text=this.text.substring(e,t),n.sectionIndex=this.sectionIndex.slice(e,t),n.sections=this.sections,n}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,t)=>Math.max(e,this.sections[t].scale),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(Nu.forText(e.scale,e.fontStack||t));const n=this.sections.length-1;for(let r=0;r<e.text.length;++r)this.sectionIndex.push(n)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void S("Can't add FormattedSection with an empty image.");const n=this.getNextImageSectionCharCode();n?(this.text+=String.fromCharCode(n),this.sections.push(Nu.forImage(t)),this.sectionIndex.push(this.sections.length-1)):S("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Vu(t,n,r,i,a,o,s,l,u,c,d,h,f,p,m){const g=Uu.fromFeature(t,a);let y;h===e.ah.vertical&&g.verticalizePunctuation();const{processBidirectionalText:v,processStyledBidirectionalText:_}=Vi;if(v&&1===g.sections.length){y=[];const e=v(g.toString(),Yu(g,c,o,n,i,p));for(const t of e){const e=new Uu;e.text=t,e.sections=g.sections;for(let n=0;n<t.length;n++)e.sectionIndex.push(0);y.push(e)}}else if(_){y=[];const e=_(g.text,g.sectionIndex,Yu(g,c,o,n,i,p));for(const t of e){const e=new Uu;e.text=t[0],e.sectionIndex=t[1],e.sections=g.sections,y.push(e)}}else y=function(e,t){const n=[],r=e.text;let i=0;for(const a of t)n.push(e.substring(i,a)),i=a;return i<r.length&&n.push(e.substring(i,r.length)),n}(g,Yu(g,c,o,n,i,p));const b=[],x={positionedLines:b,text:g.toString(),top:d[1],bottom:d[1],left:d[0],right:d[0],writingMode:h,iconsInText:!1,verticalizable:!1};return function(t,n,r,i,a,o,s,l,u,c,d,h){let f=0,p=Lu,m=0,g=0;const y="right"===l?1:"left"===l?0:.5;let v=0;for(const k of a){k.trim();const a=k.getMaxScale(),s=(a-1)*au,l={positionedGlyphs:[],lineOffset:0};t.positionedLines[v]=l;const b=l.positionedGlyphs;let x=0;if(!k.length()){p+=o,++v;continue}for(let o=0;o<k.length();o++){const l=k.getSection(o),m=k.getSectionIndex(o),g=k.getCharCode(o);let y=0,v=null,w=null,S=null,E=au;const C=!(u===e.ah.horizontal||!d&&!ji(g)||d&&(qu[g]||(_=g,/(?:[\u0600-\u0604\u0606-\u060B\u060D-\u061A\u061C-\u061E\u0620-\u063F\u0641-\u064A\u0656-\u066F\u0671-\u06DC\u06DE-\u06FF\u0750-\u077F\u0870-\u0891\u0897-\u08E1\u08E3-\u08FF\uFB50-\uFD3D\uFD40-\uFDCF\uFDF0-\uFDFF\uFE70-\uFE74\uFE76-\uFEFC]|\uD803[\uDE60-\uDE7E\uDEC2-\uDEC7\uDED0-\uDED8\uDEFA-\uDEFF]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB\uDEF0\uDEF1])/.test(String.fromCodePoint(_)))));if(l.imageName){const e=i[l.imageName];if(!e)continue;S=l.imageName,t.iconsInText=t.iconsInText||!0,w=e.paddedRect;const n=e.displaySize;l.scale=l.scale*au/h,v={width:n[0],height:n[1],left:Mu,top:-Ou,advance:C?n[1]:n[0]},y=s+(au-n[1]*l.scale),E=v.advance;const r=C?n[0]*l.scale-au*a:n[1]*l.scale-au*a;r>0&&r>x&&(x=r)}else{const e=r[l.fontStack],t=e&&e[g];if(t&&t.rect)w=t.rect,v=t.metrics;else{const e=n[l.fontStack],t=e&&e[g];if(!t)continue;v=t.metrics}y=(a-l.scale)*au}C?(t.verticalizable=!0,b.push({glyph:g,imageName:S,x:f,y:p+y,vertical:C,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:v,rect:w}),f+=E*l.scale+c):(b.push({glyph:g,imageName:S,x:f,y:p+y,vertical:C,scale:l.scale,fontStack:l.fontStack,sectionIndex:m,metrics:v,rect:w}),f+=v.advance*l.scale+c)}0!==b.length&&(m=Math.max(f-c,m),Qu(b,0,b.length-1,y,x)),f=0;const w=o*a+x;l.lineOffset=Math.max(x,s),p+=w,g=Math.max(w,g),++v}var _;const b=p-Lu,{horizontalAlign:x,verticalAlign:w}=Ju(s);(function(e,t,n,r,i,a,o,s,l){const u=(t-n)*i;let c=0;c=a!==o?-s*r-Lu:(-r*l+.5)*o;for(const d of e)for(const e of d.positionedGlyphs)e.x+=u,e.y+=c})(t.positionedLines,y,x,w,m,g,o,b,a.length),t.top+=-w*b,t.bottom=t.top+b,t.left+=-x*m,t.right=t.left+m}(x,n,r,i,y,s,l,u,h,c,f,m),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(b)&&x}const qu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Hu={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},Wu={40:!0};function Zu(e,t,n,r,i,a){if(t.imageName){const e=r[t.imageName];return e?e.displaySize[0]*t.scale*au/a+i:0}{const r=n[t.fontStack],a=r&&r[e];return a?a.metrics.advance*t.scale+i:0}}function Ku(e,t,n,r){const i=Math.pow(e-t,2);return r?e<t?i/2:2*i:i+Math.abs(n)*n}function Gu(e,t,n){let r=0;return 10===e&&(r-=1e4),n&&(r+=150),40!==e&&65288!==e||(r+=50),41!==t&&65289!==t||(r+=50),r}function Xu(e,t,n,r,i,a){let o=null,s=Ku(t,n,i,a);for(const l of r){const e=Ku(t-l.x,n,i,a)+l.badness;e<=s&&(o=l,s=e)}return{index:e,x:t,priorBreak:o,badness:s}}function $u(e){return e?$u(e.priorBreak).concat(e.index):[]}function Yu(e,t,n,r,i,a){if(!e)return[];const o=[],s=function(e,t,n,r,i,a){let o=0;for(let s=0;s<e.length();s++){const n=e.getSection(s);o+=Zu(e.getCharCode(s),n,r,i,t,a)}return o/Math.max(1,Math.ceil(o/n))}(e,t,n,r,i,a),l=e.text.indexOf("\u200b")>=0;let u=0;for(let d=0;d<e.length();d++){const n=e.getSection(d),h=e.getCharCode(d);if(qu[h]||(u+=Zu(h,n,r,i,t,a)),d<e.length()-1){const t=!((c=h)<11904)&&(!!Ii["CJK Compatibility Forms"](c)||!!Ii["CJK Compatibility"](c)||!!Ii["CJK Strokes"](c)||!!Ii["CJK Symbols and Punctuation"](c)||!!Ii["Enclosed CJK Letters and Months"](c)||!!Ii["Halfwidth and Fullwidth Forms"](c)||!!Ii["Ideographic Description Characters"](c)||!!Ii["Vertical Forms"](c)||Mi.test(String.fromCodePoint(c)));(Hu[h]||t||n.imageName||d!==e.length()-2&&Wu[e.getCharCode(d+1)])&&o.push(Xu(d+1,u,s,o,Gu(h,e.getCharCode(d+1),t&&l),!1))}}var c;return $u(Xu(e.length(),u,s,o,0,!0))}function Ju(e){let t=.5,n=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:t,verticalAlign:n}}function Qu(e,t,n,r,i){if(!r&&!i)return;const a=e[n],o=(e[n].x+a.metrics.advance*a.scale)*r;for(let s=t;s<=n;s++)e[s].x-=o,e[s].y+=i}function ec(e,t,n){const{horizontalAlign:r,verticalAlign:i}=Ju(n),a=t[0]-e.displaySize[0]*r,o=t[1]-e.displaySize[1]*i;return{image:e,top:o,bottom:o+e.displaySize[1],left:a,right:a+e.displaySize[0]}}function tc(e){var t,n;let r=e.left,i=e.top,a=e.right-r,o=e.bottom-i;const s=null!==(t=e.image.textFitWidth)&&void 0!==t?t:"stretchOrShrink",l=null!==(n=e.image.textFitHeight)&&void 0!==n?n:"stretchOrShrink",u=(e.image.content[2]-e.image.content[0])/(e.image.content[3]-e.image.content[1]);if("proportional"===l){if("stretchOnly"===s&&a/o<u||"proportional"===s){const e=Math.ceil(o*u);r*=e/a,a=e}}else if("proportional"===s&&"stretchOnly"===l&&0!==u&&a/o>u){const e=Math.ceil(a/u);i*=e/o,o=e}return{x1:r,y1:i,x2:r+a,y2:i+o}}function nc(e,t,n,r,i,a){const o=e.image;let s;if(o.content){const e=o.content,t=o.pixelRatio||1;s=[e[0]/t,e[1]/t,o.displaySize[0]-e[2]/t,o.displaySize[1]-e[3]/t]}const l=t.left*a,u=t.right*a;let c,d,h,f;"width"===n||"both"===n?(f=i[0]+l-r[3],d=i[0]+u+r[1]):(f=i[0]+(l+u-o.displaySize[0])/2,d=f+o.displaySize[0]);const p=t.top*a,m=t.bottom*a;return"height"===n||"both"===n?(c=i[1]+p-r[0],h=i[1]+m+r[2]):(c=i[1]+(p+m-o.displaySize[1])/2,h=c+o.displaySize[1]),{image:o,top:c,right:d,bottom:h,left:f,collisionPadding:s}}const rc=255,ic=128,ac=rc*ic;function oc(e,t){const{expression:n}=t;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new qi(e+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:r}=n;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let a=i;for(;a<t.length&&t[a]<e+1;)a++;a=Math.min(t.length-1,a);const o=t[i],s=t[a];return"composite"===n.kind?{kind:"composite",minZoom:o,maxZoom:s,interpolationType:r}:{kind:"camera",minZoom:o,maxZoom:s,minSize:n.evaluate(new qi(o)),maxSize:n.evaluate(new qi(s)),interpolationType:r}}}function sc(e,t,n){let r="never";const i=e.get(t);return i?r=i:e.get(n)&&(r="always"),r}const lc=pl.VectorTileFeature.types,uc=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function cc(e,t,n,r,i,a,o,s,l,u,c,d,h){const f=s?Math.min(ac,Math.round(s[0])):0,p=s?Math.min(ac,Math.round(s[1])):0;e.emplaceBack(t,n,Math.round(32*r),Math.round(32*i),a,o,(f<<1)+(l?1:0),p,16*u,16*c,256*d,256*h)}function dc(e,t,n){e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n),e.emplaceBack(t.x,t.y,n)}function hc(e){for(const t of e.sections)if(Ui(t.text))return!0;return!1}class fc{constructor(e){this.layoutVertexArray=new Qa,this.indexArray=new io,this.programConfigurations=e,this.segments=new lo,this.dynamicLayoutVertexArray=new eo,this.opacityVertexArray=new to,this.hasVisibleVertices=!1,this.placedSymbolArray=new Ba}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,n,r){this.isEmpty()||(n&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jl.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Ql.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,uc,!0),this.opacityVertexBuffer.itemSize=1),(n||r)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}wi("SymbolBuffers",fc);class pc{constructor(e,t,n){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new n,this.segments=new lo,this.collisionVertexArray=new ro}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,eu.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}wi("CollisionBuffers",pc);class mc{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(e=>e.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=cs([]),this.placementViewportMatrix=cs([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=oc(this.zoom,n["text-size"]),this.iconSizeData=oc(this.zoom,n["icon-size"]);const r=this.layers[0].layout,i=r.get("symbol-sort-key"),a=r.get("symbol-z-order");this.canOverlap="never"!==sc(r,"text-overlap","text-allow-overlap")||"never"!==sc(r,"icon-overlap","icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==a&&!i.isConstant(),this.sortFeaturesByY=("viewport-y"===a||"auto"===a&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===r.get("symbol-placement")&&(this.writingModes=r.get("text-writing-mode").map(t=>e.ah[t])),this.stateDependentLayerIds=this.layers.filter(e=>e.isStateDependent()).map(e=>e.id),this.sourceID=t.sourceID}createArrays(){this.text=new fc(new Mo(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new fc(new Mo(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Na,this.lineVertexArray=new Ua,this.symbolInstances=new La,this.textAnchorOffsets=new qa}calculateGlyphDependencies(e,t,n,r,i){for(let a=0;a<e.length;a++)if(t[e.charCodeAt(a)]=!0,(n||r)&&i){const n=iu[e.charAt(a)];n&&(t[n.charCodeAt(0)]=!0)}}populate(t,n,r){const i=this.layers[0],a=i.layout,o=a.get("text-font"),s=a.get("text-field"),l=a.get("icon-image"),u=("constant"!==s.value.kind||s.value.value instanceof Ye&&!s.value.value.isEmpty()||s.value.value.toString().length>0)&&("constant"!==o.value.kind||o.value.value.length>0),c="constant"!==l.value.kind||!!l.value.value||Object.keys(l.parameters).length>0,d=a.get("symbol-sort-key");if(this.features=[],!u&&!c)return;const h=n.iconDependencies,f=n.glyphDependencies,p=n.availableImages,m=new qi(this.zoom);for(const{feature:g,id:y,index:v,sourceLayerIndex:_}of t){const t=i._featureFilter.needGeometry,n=Vo(g,t);if(!i._featureFilter.filter(m,n,r))continue;let s,l;if(t||(n.geometry=Uo(g)),u){const e=i.getValueAndResolveTokens("text-field",n,r,p),t=Ye.factory(e),a=this.hasRTLText=this.hasRTLText||hc(t);(!a||"unavailable"===Vi.getRTLTextPluginStatus()||a&&Vi.isParsed())&&(s=ru(t,i,n))}if(c){const e=i.getValueAndResolveTokens("icon-image",n,r,p);l=e instanceof tt?e:tt.fromString(e)}if(!s&&!l)continue;const b=this.sortFeaturesByKey?d.evaluate(n,{},r):void 0;if(this.features.push({id:y,text:s,icon:l,index:v,sourceLayerIndex:_,geometry:n.geometry,properties:g.properties,type:lc[g.type],sortKey:b}),l&&(h[l.name]=!0),s){const t=o.evaluate(n,{},r).join(","),i="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(e.ah.vertical)>=0;for(const e of s.sections)if(e.image)h[e.image.name]=!0;else{const n=Ti(s.toString()),r=e.fontStack||t,a=f[r]=f[r]||{};this.calculateGlyphDependencies(e.text,a,i,this.allowVerticalPlacement,n)}}}"line"===a.get("symbol-placement")&&(this.features=function(e){const t={},n={},r=[];let i=0;function a(t){r.push(e[t]),i++}function o(e,t,i){const a=n[e];return delete n[e],n[t]=a,r[a].geometry[0].pop(),r[a].geometry[0]=r[a].geometry[0].concat(i[0]),a}function s(e,n,i){const a=t[n];return delete t[n],t[e]=a,r[a].geometry[0].shift(),r[a].geometry[0]=i[0].concat(r[a].geometry[0]),a}function l(e,t,n){const r=n?t[0][t[0].length-1]:t[0][0];return"".concat(e,":").concat(r.x,":").concat(r.y)}for(let u=0;u<e.length;u++){const c=e[u],d=c.geometry,h=c.text?c.text.toString():null;if(!h){a(u);continue}const f=l(h,d),p=l(h,d,!0);if(f in n&&p in t&&n[f]!==t[p]){const e=s(f,p,d),i=o(f,p,r[e].geometry);delete t[f],delete n[p],n[l(h,r[i].geometry,!0)]=i,r[e].geometry=null}else f in n?o(f,p,d):p in t?s(f,p,d):(a(u),t[f]=i-1,n[p]=i-1)}return r.filter(e=>e.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((e,t)=>e.sortKey-t.sortKey)}update(e,t,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const n=this.lineVertexArray.length;if(void 0!==e.segment){let n=e.dist(t[e.segment+1]),r=e.dist(t[e.segment]);const i={};for(let a=e.segment+1;a<t.length;a++)i[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:n},a<t.length-1&&(n+=t[a+1].dist(t[a]));for(let a=e.segment||0;a>=0;a--)i[a]={x:t[a].x,y:t[a].y,tileUnitDistanceFromAnchor:r},a>0&&(r+=t[a-1].dist(t[a]));for(let e=0;e<t.length;e++){const t=i[e];this.lineVertexArray.emplaceBack(t.x,t.y,t.tileUnitDistanceFromAnchor)}}return{lineStartIndex:n,lineLength:this.lineVertexArray.length-n}}addSymbols(t,n,r,i,a,o,s,l,u,c,d,h){const f=t.indexArray,p=t.layoutVertexArray,m=t.segments.prepareSegment(4*n.length,p,f,this.canOverlap?o.sortKey:void 0),g=this.glyphOffsetArray.length,y=m.vertexLength,v=this.allowVerticalPlacement&&s===e.ah.vertical?Math.PI/2:0,_=o.text&&o.text.sections;for(let e=0;e<n.length;e++){const{tl:i,tr:a,bl:s,br:u,tex:c,pixelOffsetTL:d,pixelOffsetBR:g,minFontScaleX:y,minFontScaleY:b,glyphOffset:x,isSDF:w,sectionIndex:k}=n[e],S=m.vertexLength,E=x[1];cc(p,l.x,l.y,i.x,E+i.y,c.x,c.y,r,w,d.x,d.y,y,b),cc(p,l.x,l.y,a.x,E+a.y,c.x+c.w,c.y,r,w,g.x,d.y,y,b),cc(p,l.x,l.y,s.x,E+s.y,c.x,c.y+c.h,r,w,d.x,g.y,y,b),cc(p,l.x,l.y,u.x,E+u.y,c.x+c.w,c.y+c.h,r,w,g.x,g.y,y,b),dc(t.dynamicLayoutVertexArray,l,v),f.emplaceBack(S,S+1,S+2),f.emplaceBack(S+1,S+2,S+3),m.vertexLength+=4,m.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(x[0]),e!==n.length-1&&k===n[e+1].sectionIndex||t.programConfigurations.populatePaintArrays(p.length,o,o.index,{},h,_&&_[k])}t.placedSymbolArray.emplaceBack(l.x,l.y,g,this.glyphOffsetArray.length-g,y,u,c,l.segment,r?r[0]:0,r?r[1]:0,i[0],i[1],s,0,!1,0,d)}_addCollisionDebugVertex(e,t,n,r,i,a){return t.emplaceBack(0,0),e.emplaceBack(n.x,n.y,r,i,Math.round(a.x),Math.round(a.y))}addCollisionDebugVertices(e,t,n,r,i,a,s){const l=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),u=l.vertexLength,c=i.layoutVertexArray,d=i.collisionVertexArray,h=s.anchorX,f=s.anchorY;this._addCollisionDebugVertex(c,d,a,h,f,new o(e,t)),this._addCollisionDebugVertex(c,d,a,h,f,new o(n,t)),this._addCollisionDebugVertex(c,d,a,h,f,new o(n,r)),this._addCollisionDebugVertex(c,d,a,h,f,new o(e,r)),l.vertexLength+=4;const p=i.indexArray;p.emplaceBack(u,u+1),p.emplaceBack(u+1,u+2),p.emplaceBack(u+2,u+3),p.emplaceBack(u+3,u),l.primitiveLength+=4}addDebugCollisionBoxes(e,t,n,r){for(let i=e;i<t;i++){const e=this.collisionBoxArray.get(i);this.addCollisionDebugVertices(e.x1,e.y1,e.x2,e.y2,r?this.textCollisionBox:this.iconCollisionBox,e.anchorPoint,n)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pc(no,tu.members,ao),this.iconCollisionBox=new pc(no,tu.members,ao);for(let e=0;e<this.symbolInstances.length;e++){const t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}}_deserializeCollisionBoxesForSymbol(e,t,n,r,i,a,o,s,l){const u={};for(let c=t;c<n;c++){const t=e.get(c);u.textBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.textFeatureIndex=t.featureIndex;break}for(let c=r;c<i;c++){const t=e.get(c);u.verticalTextBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.verticalTextFeatureIndex=t.featureIndex;break}for(let c=a;c<o;c++){const t=e.get(c);u.iconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.iconFeatureIndex=t.featureIndex;break}for(let c=s;c<l;c++){const t=e.get(c);u.verticalIconBox={x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2,anchorPointX:t.anchorPointX,anchorPointY:t.anchorPointY},u.verticalIconFeatureIndex=t.featureIndex;break}return u}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const n=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,n.textBoxStartIndex,n.textBoxEndIndex,n.verticalTextBoxStartIndex,n.verticalTextBoxEndIndex,n.iconBoxStartIndex,n.iconBoxEndIndex,n.verticalIconBoxStartIndex,n.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const n=e.placedSymbolArray.get(t),r=n.vertexStartIndex+4*n.numGlyphs;for(let i=n.vertexStartIndex;i<r;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),n=Math.cos(e),r=[],i=[],a=[];for(let o=0;o<this.symbolInstances.length;++o){a.push(o);const e=this.symbolInstances.get(o);r.push(0|Math.round(t*e.anchorX+n*e.anchorY)),i.push(e.featureIndex)}return a.sort((e,t)=>r[e]-r[t]||i[t]-i[e]),a}addToSortKeyRanges(e,t){const n=this.sortKeyRanges[this.sortKeyRanges.length-1];n&&n.sortKey===t?n.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex),[t.rightJustifiedTextSymbolIndex,t.centerJustifiedTextSymbolIndex,t.leftJustifiedTextSymbolIndex].forEach((e,t,n)=>{e>=0&&n.indexOf(e)===t&&this.addIndicesForPlacedSymbol(this.text,e)}),t.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,t.verticalPlacedTextSymbolIndex),t.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.placedIconSymbolIndex),t.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,t.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let gc,yc;wi("SymbolBucket",mc,{omit:["layers","collisionBoxArray","features","compareText"]}),mc.MAX_GLYPHS=65535,mc.addDynamicAttributes=dc;var vc={get paint(){return yc=yc||new ra({"icon-opacity":new Qi(K.paint_symbol["icon-opacity"]),"icon-color":new Qi(K.paint_symbol["icon-color"]),"icon-halo-color":new Qi(K.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qi(K.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qi(K.paint_symbol["icon-halo-blur"]),"icon-translate":new Ji(K.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ji(K.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qi(K.paint_symbol["text-opacity"]),"text-color":new Qi(K.paint_symbol["text-color"],{runtimeType:fe,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Qi(K.paint_symbol["text-halo-color"]),"text-halo-width":new Qi(K.paint_symbol["text-halo-width"]),"text-halo-blur":new Qi(K.paint_symbol["text-halo-blur"]),"text-translate":new Ji(K.paint_symbol["text-translate"]),"text-translate-anchor":new Ji(K.paint_symbol["text-translate-anchor"])})},get layout(){return gc=gc||new ra({"symbol-placement":new Ji(K.layout_symbol["symbol-placement"]),"symbol-spacing":new Ji(K.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ji(K.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qi(K.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ji(K.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ji(K.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Ji(K.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Ji(K.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ji(K.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ji(K.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qi(K.layout_symbol["icon-size"]),"icon-text-fit":new Ji(K.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ji(K.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qi(K.layout_symbol["icon-image"]),"icon-rotate":new Qi(K.layout_symbol["icon-rotate"]),"icon-padding":new Qi(K.layout_symbol["icon-padding"]),"icon-keep-upright":new Ji(K.layout_symbol["icon-keep-upright"]),"icon-offset":new Qi(K.layout_symbol["icon-offset"]),"icon-anchor":new Qi(K.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ji(K.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ji(K.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ji(K.layout_symbol["text-rotation-alignment"]),"text-field":new Qi(K.layout_symbol["text-field"]),"text-font":new Qi(K.layout_symbol["text-font"]),"text-size":new Qi(K.layout_symbol["text-size"]),"text-max-width":new Qi(K.layout_symbol["text-max-width"]),"text-line-height":new Ji(K.layout_symbol["text-line-height"]),"text-letter-spacing":new Qi(K.layout_symbol["text-letter-spacing"]),"text-justify":new Qi(K.layout_symbol["text-justify"]),"text-radial-offset":new Qi(K.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ji(K.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Qi(K.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Qi(K.layout_symbol["text-anchor"]),"text-max-angle":new Ji(K.layout_symbol["text-max-angle"]),"text-writing-mode":new Ji(K.layout_symbol["text-writing-mode"]),"text-rotate":new Qi(K.layout_symbol["text-rotate"]),"text-padding":new Ji(K.layout_symbol["text-padding"]),"text-keep-upright":new Ji(K.layout_symbol["text-keep-upright"]),"text-transform":new Qi(K.layout_symbol["text-transform"]),"text-offset":new Qi(K.layout_symbol["text-offset"]),"text-allow-overlap":new Ji(K.layout_symbol["text-allow-overlap"]),"text-overlap":new Ji(K.layout_symbol["text-overlap"]),"text-ignore-placement":new Ji(K.layout_symbol["text-ignore-placement"]),"text-optional":new Ji(K.layout_symbol["text-optional"])})}};class _c{constructor(e){if(void 0===e.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:ue,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}wi("FormatSectionOverride",_c,{omit:["defaultValue"]});class bc extends aa{constructor(e){super(e,vc)}recalculate(e,t){if(super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const e=this.layout.get("text-writing-mode");if(e){const t=[];for(const n of e)t.indexOf(n)<0&&t.push(n);this.layout._values["text-writing-mode"]=t}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,t,n,r){const i=this.layout.get(e).evaluate(t,{},n,r),a=this._unevaluatedLayout._values[e];return a.isDataDriven()||br(a.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,(t,n)=>e&&n in e?String(e[n]):"")}(t.properties,i)}createBucket(e){return new mc(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of vc.paint.overridableProperties){if(!bc.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),n=new _c(t),r=new _r(n,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new wr("source",r):new kr("composite",r,t.value.zoomStops),this.paint._values[e]=new $i(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,n){return!(!this.layout||t.isDataDriven()||n.isDataDriven())&&bc.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const n=e.get("text-field"),r=vc.paint.properties[t];let i=!1;const a=e=>{for(const t of e)if(r.overrides&&r.overrides.hasOverride(t))return void(i=!0)};if("constant"===n.value.kind&&n.value.value instanceof Ye)a(n.value.value.sections);else if("source"===n.value.kind){const e=t=>{i||(t instanceof ot&&it(t.value)===ye?a(t.value.sections):t instanceof Zt?a(t.sections):t.eachChild(e))},t=n.value;t._styleExpression&&e(t._styleExpression.expression)}return i}}let xc;var wc={get paint(){return xc=xc||new ra({"background-color":new Ji(K.paint_background["background-color"]),"background-pattern":new ta(K.paint_background["background-pattern"]),"background-opacity":new Ji(K.paint_background["background-opacity"])})}};class kc extends aa{constructor(e){super(e,wc)}}let Sc;var Ec={get paint(){return Sc=Sc||new ra({"raster-opacity":new Ji(K.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ji(K.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ji(K.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ji(K.paint_raster["raster-brightness-max"]),"raster-saturation":new Ji(K.paint_raster["raster-saturation"]),"raster-contrast":new Ji(K.paint_raster["raster-contrast"]),"raster-resampling":new Ji(K.paint_raster["raster-resampling"]),"raster-fade-duration":new Ji(K.paint_raster["raster-fade-duration"])})}};class Cc extends aa{constructor(e){super(e,Ec)}}class Pc extends aa{constructor(e){super(e,{}),this.onAdd=e=>{this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)},this.onRemove=e=>{this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)},this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class Dc{constructor(e){this._methodToThrottle=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Ic=6371008.8;class Tc{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: (".concat(e,", ").concat(t,")"));if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Tc(y(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return"LngLat(".concat(this.lng,", ").concat(this.lat,")")}distanceTo(e){const t=Math.PI/180,n=this.lat*t,r=e.lat*t,i=Math.sin(n)*Math.sin(r)+Math.cos(n)*Math.cos(r)*Math.cos((e.lng-this.lng)*t);return Ic*Math.acos(Math.min(i,1))}static convert(e){if(e instanceof Tc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new Tc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new Tc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Ac=2*Math.PI*Ic;function zc(e){return Ac*Math.cos(e*Math.PI/180)}function Oc(e){return(180+e)/360}function Fc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function Mc(e,t){return e/zc(t)}function jc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}class Bc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.x=+e,this.y=+t,this.z=+n}static fromLngLat(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=Tc.convert(e);return new Bc(Oc(n.lng),Fc(n.lat),Mc(t,n.lat))}toLngLat(){return new Tc(360*this.x-180,jc(this.y))}toAltitude(){return this.z*zc(jc(this.y))}meterInMercatorCoordinateUnits(){return 1/Ac*(e=jc(this.y),1/Math.cos(e*Math.PI/180));var e}}function Rc(e,t,n){var r=2*Math.PI*6378137/256/Math.pow(2,n);return[e*r-2*Math.PI*6378137/2,t*r-2*Math.PI*6378137/2]}class Lc{constructor(e,t,n){if(!function(e,t,n){return!(e<0||e>25||n<0||n>=Math.pow(2,e)||t<0||t>=Math.pow(2,e))}(e,t,n))throw new Error("x=".concat(t,", y=").concat(n,", z=").concat(e," outside of bounds. 0<=x<").concat(Math.pow(2,e),", 0<=y<").concat(Math.pow(2,e)," 0<=z<=25 "));this.z=e,this.x=t,this.y=n,this.key=Vc(0,e,e,t,n)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t,n){const r=(a=this.y,o=this.z,s=Rc(256*(i=this.x),256*(a=Math.pow(2,o)-a-1),o),l=Rc(256*(i+1),256*(a+1),o),s[0]+","+s[1]+","+l[0]+","+l[1]);var i,a,o,s,l;const u=function(e,t,n){let r,i="";for(let a=e;a>0;a--)r=1<<a-1,i+=(t&r?1:0)+(n&r?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,t>1?"@2x":"").replace(/{quadkey}/g,u).replace(/{bbox-epsg-3857}/g,r)}isChildOf(e){const t=this.z-e.z;return t>0&&e.x===this.x>>t&&e.y===this.y>>t}getTilePoint(e){const t=Math.pow(2,this.z);return new o((e.x*t-this.x)*Ro,(e.y*t-this.y)*Ro)}toString(){return"".concat(this.z,"/").concat(this.x,"/").concat(this.y)}}class Nc{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Vc(e,t.z,t.z,t.x,t.y)}}class Uc{constructor(e,t,n,r,i){if(e<n)throw new Error("overscaledZ should be >= z; overscaledZ = ".concat(e,"; z = ").concat(n));this.overscaledZ=e,this.wrap=t,this.canonical=new Lc(n,+r,+i),this.key=Vc(t,e,n,r,i)}clone(){return new Uc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));const t=this.canonical.z-e;return e>this.canonical.z?new Uc(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uc(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t){if(e>this.overscaledZ)throw new Error("targetZ > this.overscaledZ; targetZ = ".concat(e,"; overscaledZ = ").concat(this.overscaledZ));const n=this.canonical.z-e;return e>this.canonical.z?Vc(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):Vc(this.wrap*+t,e,e,this.canonical.x>>n,this.canonical.y>>n)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Uc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,n=2*this.canonical.x,r=2*this.canonical.y;return[new Uc(t,this.wrap,t,n,r),new Uc(t,this.wrap,t,n+1,r),new Uc(t,this.wrap,t,n,r+1),new Uc(t,this.wrap,t,n+1,r+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Uc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Uc(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Nc(this.wrap,this.canonical)}toString(){return"".concat(this.overscaledZ,"/").concat(this.canonical.x,"/").concat(this.canonical.y)}getTilePoint(e){return this.canonical.getTilePoint(new Bc(e.x-this.wrap,e.y))}}function Vc(e,t,n,r,i){(e*=2)<0&&(e=-1*e-1);const a=1<<n;return(a*a*e+a*i+r).toString(36)+n.toString(36)+t.toString(36)}wi("CanonicalTileID",Lc),wi("OverscaledTileID",Uc,{omit:["posMatrix"]});class qc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0;if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(n&&!["mapbox","terrarium","custom"].includes(n))return void S('"'.concat(n,'" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".'));this.stride=t.height;const s=this.dim=t.height-2;switch(this.data=new Uint32Array(t.data.buffer),n){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=r,this.greenFactor=i,this.blueFactor=a,this.baseShift=o;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let l=0;l<s;l++)this.data[this._idx(-1,l)]=this.data[this._idx(0,l)],this.data[this._idx(s,l)]=this.data[this._idx(s-1,l)],this.data[this._idx(l,-1)]=this.data[this._idx(l,0)],this.data[this._idx(l,s)]=this.data[this._idx(l,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let l=0;l<s;l++)for(let e=0;e<s;e++){const t=this.get(l,e);t>this.max&&(this.max=t),t<this.min&&(this.min=t)}}get(e,t){const n=new Uint8Array(this.data.buffer),r=4*this._idx(e,t);return this.unpack(n[r],n[r+1],n[r+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}unpack(e,t,n){return e*this.redFactor+t*this.greenFactor+n*this.blueFactor-this.baseShift}getPixels(){return new Ss({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,t,n){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let r=t*this.dim,i=t*this.dim+this.dim,a=n*this.dim,o=n*this.dim+this.dim;switch(t){case-1:r=i-1;break;case 1:i=r+1}switch(n){case-1:a=o-1;break;case 1:o=a+1}const s=-t*this.dim,l=-n*this.dim;for(let u=a;u<o;u++)for(let t=r;t<i;t++)this.data[this._idx(t,u)]=e.data[this._idx(t+s,u+l)]}}wi("DEMData",qc);class Hc{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const n=e[t];this._stringToNumber[n]=t,this._numberToString[t]=n}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error("Out of bounds. Index requested n=".concat(e," can't be >= this._numberToString.length ").concat(this._numberToString.length));return this._numberToString[e]}}class Wc{constructor(e,t,n,r,i){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=n,e._y=r,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const t in this)"_geometry"!==t&&"_vectorTileFeature"!==t&&(e[t]=this[t]);return e}}class Zc{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new bi(Ro,16,0),this.grid3D=new bi(Ro,16,0),this.featureIndexArray=new Wa,this.promoteId=t}insert(e,t,n,r,i,a){const o=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(n,r,i);const s=a?this.grid3D:this.grid;for(let l=0;l<t.length;l++){const e=t[l],n=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const r=e[t];n[0]=Math.min(n[0],r.x),n[1]=Math.min(n[1],r.y),n[2]=Math.max(n[2],r.x),n[3]=Math.max(n[3],r.y)}n[0]<Ro&&n[1]<Ro&&n[2]>=0&&n[3]>=0&&s.insert(o,n[0],n[1],n[2],n[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new pl.VectorTile(new Du(this.rawTileData)).layers,this.sourceLayerCoder=new Hc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,t,n,r){this.loadVTLayers();const i=e.params||{},a=Ro/e.tileSize/e.scale,s=Ir(i.filter),l=e.queryGeometry,u=e.queryPadding*a,c=Gc(l),d=this.grid.query(c.minX-u,c.minY-u,c.maxX+u,c.maxY+u),h=Gc(e.cameraQueryGeometry),f=this.grid3D.query(h.minX-u,h.minY-u,h.maxX+u,h.maxY+u,(t,n,r,i)=>function(e,t,n,r,i){for(const o of e)if(t<=o.x&&n<=o.y&&r>=o.x&&i>=o.y)return!0;const a=[new o(t,n),new o(t,i),new o(r,i),new o(r,n)];if(e.length>2)for(const o of a)if(es(e,o))return!0;for(let o=0;o<e.length-1;o++)if(ts(e[o],e[o+1],a))return!0;return!1}(e.cameraQueryGeometry,t-u,n-u,r+u,i+u));for(const o of f)d.push(o);d.sort(Xc);const p={};let m;for(let o=0;o<d.length;o++){const u=d[o];if(u===m)continue;m=u;const c=this.featureIndexArray.get(u);let h=null;this.loadMatchingFeature(p,c.bucketIndex,c.sourceLayerIndex,c.featureIndex,s,i.layers,i.availableImages,t,n,r,(t,n,r)=>(h||(h=Uo(t)),n.queryIntersectsFeature(l,t,r,h,this.z,e.transform,a,e.pixelPosMatrix)))}return p}loadMatchingFeature(e,t,n,r,i,a,o,s,l,u,c){const d=this.bucketLayerIDs[t];if(a&&!function(e,t){for(let n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return!0;return!1}(a,d))return;const h=this.sourceLayerCoder.decode(n),f=this.vtLayers[h].feature(r);if(i.needGeometry){const e=Vo(f,!0);if(!i.filter(new qi(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!i.filter(new qi(this.tileID.overscaledZ),f))return;const p=this.getId(f,h);for(let m=0;m<d.length;m++){const t=d[m];if(a&&a.indexOf(t)<0)continue;const n=s[t];if(!n)continue;let i={};p&&u&&(i=u.getState(n.sourceLayer||"_geojsonTileLayer",p));const h=v({},l[t]);h.paint=Kc(h.paint,n.paint,f,i,o),h.layout=Kc(h.layout,n.layout,f,i,o);const g=!c||c(f,n,i);if(!g)continue;const y=new Wc(f,this.z,this.x,this.y,p);y.layer=h;let _=e[t];void 0===_&&(_=e[t]=[]),_.push({featureIndex:r,feature:y,intersectionZ:g})}}lookupSymbolFeatures(e,t,n,r,i,a,o,s){const l={};this.loadVTLayers();const u=Ir(i);for(const c of e)this.loadMatchingFeature(l,n,r,c,u,a,o,s,t);return l}hasLayer(e){for(const t of this.bucketLayerIDs)for(const n of t)if(e===n)return!0;return!1}getId(e,t){let n=e.id;return this.promoteId&&(n=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[t]],"boolean"==typeof n&&(n=Number(n))),n}}function Kc(e,t,n,r,i){return b(e,(e,a)=>{const o=t instanceof Yi?t.get(a):null;return o&&o.evaluate?o.evaluate(n,r,i):o})}function Gc(e){let t=1/0,n=1/0,r=-1/0,i=-1/0;for(const a of e)t=Math.min(t,a.x),n=Math.min(n,a.y),r=Math.max(r,a.x),i=Math.max(i,a.y);return{minX:t,minY:n,maxX:r,maxY:i}}function Xc(e,t){return t-e}function $c(e,t,n,r,i){const a=[];for(let s=0;s<e.length;s++){const l=e[s];let u;for(let e=0;e<l.length-1;e++){let s=l[e],c=l[e+1];s.x<t&&c.x<t||(s.x<t?s=new o(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x<t&&(c=new o(t,s.y+(t-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y<n&&c.y<n||(s.y<n?s=new o(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round():c.y<n&&(c=new o(s.x+(n-s.y)/(c.y-s.y)*(c.x-s.x),n)._round()),s.x>=r&&c.x>=r||(s.x>=r?s=new o(r,s.y+(r-s.x)/(c.x-s.x)*(c.y-s.y))._round():c.x>=r&&(c=new o(r,s.y+(r-s.x)/(c.x-s.x)*(c.y-s.y))._round()),s.y>=i&&c.y>=i||(s.y>=i?s=new o(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round():c.y>=i&&(c=new o(s.x+(i-s.y)/(c.y-s.y)*(c.x-s.x),i)._round()),u&&s.equals(u[u.length-1])||(u=[s],a.push(u)),u.push(c)))))}}return a}wi("FeatureIndex",Zc,{omit:["rawTileData","sourceLayerCoder"]});class Yc extends o{constructor(e,t,n,r){super(e,t),this.angle=n,void 0!==r&&(this.segment=r)}clone(){return new Yc(this.x,this.y,this.angle,this.segment)}}function Jc(e,t,n,r,i){if(void 0===t.segment||0===n)return!0;let a=t,o=t.segment+1,s=0;for(;s>-n/2;){if(o--,o<0)return!1;s-=e[o].dist(a),a=e[o]}s+=e[o].dist(e[o+1]),o++;const l=[];let u=0;for(;s<n/2;){const t=e[o],n=e[o+1];if(!n)return!1;let a=e[o-1].angleTo(t)-t.angleTo(n);for(a=Math.abs((a+3*Math.PI)%(2*Math.PI)-Math.PI),l.push({distance:s,angleDelta:a}),u+=a;s-l[0].distance>r;)u-=l.shift().angleDelta;if(u>i)return!1;o++,s+=t.dist(n)}return!0}function Qc(e){let t=0;for(let n=0;n<e.length-1;n++)t+=e[n].dist(e[n+1]);return t}function ed(e,t,n){return e?.6*t*n:0}function td(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function nd(e,t,n,r,i,a){const o=ed(n,i,a),s=td(n,r)*a;let l=0;const u=Qc(e)/2;for(let c=0;c<e.length-1;c++){const n=e[c],r=e[c+1],i=n.dist(r);if(l+i>u){const a=(u-l)/i,d=At.number(n.x,r.x,a),h=At.number(n.y,r.y,a),f=new Yc(d,h,r.angleTo(n),c);return f._round(),!o||Jc(e,f,s,o,t)?f:void 0}l+=i}}function rd(e,t,n,r,i,a,o,s,l){const u=ed(r,a,o),c=td(r,i),d=c*o,h=0===e[0].x||e[0].x===l||0===e[0].y||e[0].y===l;return t-d<t/4&&(t=d+t/4),id(e,h?t/2*s%t:(c/2+2*a)*o*s%t,t,u,n,d,h,!1,l)}function id(e,t,n,r,i,a,o,s,l){const u=a/2,c=Qc(e);let d=0,h=t-n,f=[];for(let p=0;p<e.length-1;p++){const t=e[p],o=e[p+1],s=t.dist(o),m=o.angleTo(t);for(;h+n<d+s;){h+=n;const g=(h-d)/s,y=At.number(t.x,o.x,g),v=At.number(t.y,o.y,g);if(y>=0&&y<l&&v>=0&&v<l&&h-u>=0&&h+u<=c){const t=new Yc(y,v,m,p);t._round(),r&&!Jc(e,t,a,r,i)||f.push(t)}}d+=s}return s||f.length||o||(f=id(e,d/2,n,r,i,a,o,!0,l)),f}wi("Anchor",Yc);const ad=Mu;function od(e,t,n,r){const i=[],a=e.image,s=a.pixelRatio,l=a.paddedRect.w-2*ad,u=a.paddedRect.h-2*ad;let c={x1:e.left,y1:e.top,x2:e.right,y2:e.bottom};const d=a.stretchX||[[0,l]],h=a.stretchY||[[0,u]],f=(e,t)=>e+t[1]-t[0],p=d.reduce(f,0),m=h.reduce(f,0),g=l-p,y=u-m;let v=0,_=p,b=0,x=m,w=0,k=g,S=0,E=y;if(a.content&&r){const t=a.content,n=t[2]-t[0],r=t[3]-t[1];(a.textFitWidth||a.textFitHeight)&&(c=tc(e)),v=sd(d,0,t[0]),b=sd(h,0,t[1]),_=sd(d,t[0],t[2]),x=sd(h,t[1],t[3]),w=t[0]-v,S=t[1]-b,k=n-_,E=r-x}const C=c.x1,P=c.y1,D=c.x2-C,I=c.y2-P,T=(e,r,i,l)=>{const u=ud(e.stretch-v,_,D,C),c=cd(e.fixed-w,k,e.stretch,p),d=ud(r.stretch-b,x,I,P),h=cd(r.fixed-S,E,r.stretch,m),f=ud(i.stretch-v,_,D,C),g=cd(i.fixed-w,k,i.stretch,p),y=ud(l.stretch-b,x,I,P),T=cd(l.fixed-S,E,l.stretch,m),A=new o(u,d),z=new o(f,d),O=new o(f,y),F=new o(u,y),M=new o(c/s,h/s),j=new o(g/s,T/s),B=t*Math.PI/180;if(B){const e=Math.sin(B),t=Math.cos(B),n=[t,-e,e,t];A._matMult(n),z._matMult(n),F._matMult(n),O._matMult(n)}const R=e.stretch+e.fixed,L=r.stretch+r.fixed;return{tl:A,tr:z,bl:F,br:O,tex:{x:a.paddedRect.x+ad+R,y:a.paddedRect.y+ad+L,w:i.stretch+i.fixed-R,h:l.stretch+l.fixed-L},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:M,pixelOffsetBR:j,minFontScaleX:k/s/D,minFontScaleY:E/s/I,isSDF:n}};if(r&&(a.stretchX||a.stretchY)){const e=ld(d,g,p),t=ld(h,y,m);for(let n=0;n<e.length-1;n++){const r=e[n],a=e[n+1];for(let e=0;e<t.length-1;e++)i.push(T(r,t[e],a,t[e+1]))}}else i.push(T({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:l+1},{fixed:0,stretch:u+1}));return i}function sd(e,t,n){let r=0;for(const i of e)r+=Math.max(t,Math.min(n,i[1]))-Math.max(t,Math.min(n,i[0]));return r}function ld(e,t,n){const r=[{fixed:-ad,stretch:0}];for(const[i,a]of e){const e=r[r.length-1];r.push({fixed:i-e.stretch,stretch:e.stretch}),r.push({fixed:i-e.stretch,stretch:e.stretch+(a-i)})}return r.push({fixed:t+ad,stretch:n}),r}function ud(e,t,n,r){return e/t*n+r}function cd(e,t,n,r){return e-t*n/r}class dd{constructor(e,t,n,r,i,a,s,l,u,c){var d;if(this.boxStartIndex=e.length,u){let e=a.top,t=a.bottom;const n=a.collisionPadding;n&&(e-=n[1],t+=n[3]);let r=t-e;r>0&&(r=Math.max(10,r),this.circleDiameter=r)}else{const u=(null===(d=a.image)||void 0===d?void 0:d.content)&&(a.image.textFitWidth||a.image.textFitHeight)?tc(a):{x1:a.left,y1:a.top,x2:a.right,y2:a.bottom};u.y1=u.y1*s-l[0],u.y2=u.y2*s+l[2],u.x1=u.x1*s-l[3],u.x2=u.x2*s+l[1];const h=a.collisionPadding;if(h&&(u.x1-=h[0]*s,u.y1-=h[1]*s,u.x2+=h[2]*s,u.y2+=h[3]*s),c){const e=new o(u.x1,u.y1),t=new o(u.x2,u.y1),n=new o(u.x1,u.y2),r=new o(u.x2,u.y2),i=c*Math.PI/180;e._rotate(i),t._rotate(i),n._rotate(i),r._rotate(i),u.x1=Math.min(e.x,t.x,n.x,r.x),u.x2=Math.max(e.x,t.x,n.x,r.x),u.y1=Math.min(e.y,t.y,n.y,r.y),u.y2=Math.max(e.y,t.y,n.y,r.y)}e.emplaceBack(t.x,t.y,u.x1,u.y1,u.x2,u.y2,n,r,i)}this.boxEndIndex=e.length}}class hd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e,t)=>e<t?-1:e>t?1:0;if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let n=(this.length>>1)-1;n>=0;n--)this._down(n)}push(e){this.data.push(e),this._up(this.length++)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:n}=this,r=t[e];for(;e>0;){const i=e-1>>1,a=t[i];if(n(r,a)>=0)break;t[e]=a,e=i}t[e]=r}_down(e){const{data:t,compare:n}=this,r=this.length>>1,i=t[e];for(;e<r;){let r=1+(e<<1);const a=r+1;if(a<this.length&&n(t[a],t[r])<0&&(r=a),n(t[r],i)>=0)break;t[e]=t[r],e=r}t[e]=i}}function fd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=1/0,i=1/0,a=-1/0,s=-1/0;const l=e[0];for(let o=0;o<l.length;o++){const e=l[o];(!o||e.x<r)&&(r=e.x),(!o||e.y<i)&&(i=e.y),(!o||e.x>a)&&(a=e.x),(!o||e.y>s)&&(s=e.y)}const u=Math.min(a-r,s-i);let c=u/2;const d=new hd([],pd);if(0===u)return new o(r,i);for(let o=r;o<a;o+=u)for(let t=i;t<s;t+=u)d.push(new md(o+c,t+c,c,e));let h=function(e){let t=0,n=0,r=0;const i=e[0];for(let a=0,o=i.length,s=o-1;a<o;s=a++){const e=i[a],o=i[s],l=e.x*o.y-o.x*e.y;n+=(e.x+o.x)*l,r+=(e.y+o.y)*l,t+=3*l}return new md(n/t,r/t,0,e)}(e),f=d.length;for(;d.length;){const r=d.pop();(r.d>h.d||!h.d)&&(h=r,n&&console.log("found best %d after %d probes",Math.round(1e4*r.d)/1e4,f)),r.max-h.d<=t||(c=r.h/2,d.push(new md(r.p.x-c,r.p.y-c,c,e)),d.push(new md(r.p.x+c,r.p.y-c,c,e)),d.push(new md(r.p.x-c,r.p.y+c,c,e)),d.push(new md(r.p.x+c,r.p.y+c,c,e)),f+=4)}return n&&(console.log("num probes: ".concat(f)),console.log("best distance: ".concat(h.d))),h.p}function pd(e,t){return t.max-e.max}function md(e,t,n,r){this.p=new o(e,t),this.h=n,this.d=function(e,t){let n=!1,r=1/0;for(let i=0;i<t.length;i++){const a=t[i];for(let t=0,i=a.length,o=i-1;t<i;o=t++){const i=a[t],s=a[o];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(n=!n),r=Math.min(r,Jo(e,i,s))}}return(n?1:-1)*Math.sqrt(r)}(this.p,r),this.max=this.d+this.h*Math.SQRT2}var gd;e.aq=void 0,(gd=e.aq||(e.aq={}))[gd.center=1]="center",gd[gd.left=2]="left",gd[gd.right=3]="right",gd[gd.top=4]="top",gd[gd.bottom=5]="bottom",gd[gd["top-left"]=6]="top-left",gd[gd["top-right"]=7]="top-right",gd[gd["bottom-left"]=8]="bottom-left",gd[gd["bottom-right"]=9]="bottom-right";const yd=7,vd=Number.POSITIVE_INFINITY;function _d(e,t){return t[1]!==vd?function(e,t,n){let r=0,i=0;switch(t=Math.abs(t),n=Math.abs(n),e){case"top-right":case"top-left":case"top":i=n-yd;break;case"bottom-right":case"bottom-left":case"bottom":i=-n+yd}switch(e){case"top-right":case"bottom-right":case"right":r=-t;break;case"top-left":case"bottom-left":case"left":r=t}return[r,i]}(e,t[0],t[1]):function(e,t){let n=0,r=0;t<0&&(t=0);const i=t/Math.SQRT2;switch(e){case"top-right":case"top-left":r=i-yd;break;case"bottom-right":case"bottom-left":r=-i+yd;break;case"bottom":r=-t+yd;break;case"top":r=t-yd}switch(e){case"top-right":case"bottom-right":n=-i;break;case"top-left":case"bottom-left":n=i;break;case"left":n=t;break;case"right":n=-t}return[n,r]}(e,t[0])}function bd(e,t,n){var r;const i=e.layout,a=null===(r=i.get("text-variable-anchor-offset"))||void 0===r?void 0:r.evaluate(t,{},n);if(a){const e=a.values,t=[];for(let n=0;n<e.length;n+=2){const r=t[n]=e[n],i=e[n+1].map(e=>e*au);r.startsWith("top")?i[1]-=yd:r.startsWith("bottom")&&(i[1]+=yd),t[n+1]=i}return new et(t)}const o=i.get("text-variable-anchor");if(o){let r;r=void 0!==e._unevaluatedLayout.getValue("text-radial-offset")?[i.get("text-radial-offset").evaluate(t,{},n)*au,vd]:i.get("text-offset").evaluate(t,{},n).map(e=>e*au);const a=[];for(const e of o)a.push(e,_d(e,r));return new et(a)}return null}function xd(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function wd(t,n,r,i,a,o,s,l,u,c,d){let h=o.textMaxSize.evaluate(n,{});void 0===h&&(h=s);const f=t.layers[0].layout,p=f.get("icon-offset").evaluate(n,{},d),m=Sd(r.horizontal),g=s/24,y=t.tilePixelRatio*g,v=t.tilePixelRatio*h/24,_=t.tilePixelRatio*l,b=t.tilePixelRatio*f.get("symbol-spacing"),x=f.get("text-padding")*t.tilePixelRatio,w=function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=e.get("icon-padding").evaluate(t,{},n),a=i&&i.values;return[a[0]*r,a[1]*r,a[2]*r,a[3]*r]}(f,n,d,t.tilePixelRatio),k=f.get("text-max-angle")/180*Math.PI,E="viewport"!==f.get("text-rotation-alignment")&&"point"!==f.get("symbol-placement"),C="map"===f.get("icon-rotation-alignment")&&"point"!==f.get("symbol-placement"),P=f.get("symbol-placement"),D=b/2,I=f.get("icon-text-fit");let T;i&&"none"!==I&&(t.allowVerticalPlacement&&r.vertical&&(T=nc(i,r.vertical,I,f.get("icon-text-fit-padding"),p,g)),m&&(i=nc(i,m,I,f.get("icon-text-fit-padding"),p,g)));const A=(l,h)=>{h.x<0||h.x>=Ro||h.y<0||h.y>=Ro||function(t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,E,C){const P=t.addToLineVertexArray(n,r);let D,I,T,A,z=0,O=0,F=0,M=0,j=-1,B=-1;const R={};let L=vo("");if(t.allowVerticalPlacement&&i.vertical){const e=l.layout.get("text-rotate").evaluate(x,{},E)+90;T=new dd(u,n,c,d,h,i.vertical,f,p,m,e),s&&(A=new dd(u,n,c,d,h,s,y,v,m,e))}if(a){const r=l.layout.get("icon-rotate").evaluate(x,{}),i="none"!==l.layout.get("icon-text-fit"),o=od(a,r,k,i),f=s?od(s,r,k,i):void 0;I=new dd(u,n,c,d,h,a,y,v,!1,r),z=4*o.length;const p=t.iconSizeData;let m=null;"source"===p.kind?(m=[ic*l.layout.get("icon-size").evaluate(x,{})],m[0]>ac&&S("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(rc,'. Reduce your "icon-size".'))):"composite"===p.kind&&(m=[ic*w.compositeIconSizes[0].evaluate(x,{},E),ic*w.compositeIconSizes[1].evaluate(x,{},E)],(m[0]>ac||m[1]>ac)&&S("".concat(t.layerIds[0],': Value for "icon-size" is >= ').concat(rc,'. Reduce your "icon-size".'))),t.addSymbols(t.icon,o,m,b,_,x,e.ah.none,n,P.lineStartIndex,P.lineLength,-1,E),j=t.icon.placedSymbolArray.length-1,f&&(O=4*f.length,t.addSymbols(t.icon,f,m,b,_,x,e.ah.vertical,n,P.lineStartIndex,P.lineLength,-1,E),B=t.icon.placedSymbolArray.length-1)}const N=Object.keys(i.horizontal);for(const S of N){const r=i.horizontal[S];if(!D){L=vo(r.text);const e=l.layout.get("text-rotate").evaluate(x,{},E);D=new dd(u,n,c,d,h,r,f,p,m,e)}const a=1===r.positionedLines.length;if(F+=kd(t,n,r,o,l,m,x,g,P,i.vertical?e.ah.horizontal:e.ah.horizontalOnly,a?N:[S],R,j,w,E),a)break}i.vertical&&(M+=kd(t,n,i.vertical,o,l,m,x,g,P,e.ah.vertical,["vertical"],R,B,w,E));const U=D?D.boxStartIndex:t.collisionBoxArray.length,V=D?D.boxEndIndex:t.collisionBoxArray.length,q=T?T.boxStartIndex:t.collisionBoxArray.length,H=T?T.boxEndIndex:t.collisionBoxArray.length,W=I?I.boxStartIndex:t.collisionBoxArray.length,Z=I?I.boxEndIndex:t.collisionBoxArray.length,K=A?A.boxStartIndex:t.collisionBoxArray.length,G=A?A.boxEndIndex:t.collisionBoxArray.length;let X=-1;const $=(e,t)=>e&&e.circleDiameter?Math.max(e.circleDiameter,t):t;X=$(D,X),X=$(T,X),X=$(I,X),X=$(A,X);const Y=X>-1?1:0;Y&&(X*=C/au),t.glyphOffsetArray.length>=mc.MAX_GLYPHS&&S("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==x.sortKey&&t.addToSortKeyRanges(t.symbolInstances.length,x.sortKey);const J=bd(l,x,E),[Q,ee]=function(t,n){const r=t.length,i=null==n?void 0:n.values;if((null==i?void 0:i.length)>0)for(let a=0;a<i.length;a+=2){const n=i[a+1];t.emplaceBack(e.aq[i[a]],n[0],n[1])}return[r,t.length]}(t.textAnchorOffsets,J);t.symbolInstances.emplaceBack(n.x,n.y,R.right>=0?R.right:-1,R.center>=0?R.center:-1,R.left>=0?R.left:-1,R.vertical||-1,j,B,L,U,V,q,H,W,Z,K,G,c,F,M,z,O,Y,0,f,X,Q,ee)}(t,h,l,r,i,a,T,t.layers[0],t.collisionBoxArray,n.index,n.sourceLayerIndex,t.index,y,[x,x,x,x],E,u,_,w,C,p,n,o,c,d,s)};if("line"===P)for(const e of $c(n.geometry,0,0,Ro,Ro)){const n=rd(e,b,k,r.vertical||m,i,24,v,t.overscaling,Ro);for(const r of n)m&&Ed(t,m.text,D,r)||A(e,r)}else if("line-center"===P){for(const e of n.geometry)if(e.length>1){const t=nd(e,k,r.vertical||m,i,24,v);t&&A(e,t)}}else if("Polygon"===n.type)for(const e of bn(n.geometry,0)){const t=fd(e,16);A(e[0],new Yc(t.x,t.y,0))}else if("LineString"===n.type)for(const e of n.geometry)A(e,new Yc(e[0].x,e[0].y,0));else if("Point"===n.type)for(const e of n.geometry)for(const t of e)A([t],new Yc(t.x,t.y,0))}function kd(e,t,n,r,i,a,s,l,u,c,d,h,f,p,m){const g=function(e,t,n,r,i,a,s,l){const u=r.layout.get("text-rotate").evaluate(a,{})*Math.PI/180,c=[];for(const d of t.positionedLines)for(const e of d.positionedGlyphs){if(!e.rect)continue;const r=e.rect||{};let a=Ou+1,h=!0,f=1,p=0;const m=(i||l)&&e.vertical,g=e.metrics.advance*e.scale/2;if(l&&t.verticalizable&&(p=d.lineOffset/2-(e.imageName?-(au-e.metrics.width*e.scale)/2:(e.scale-1)*au)),e.imageName){const t=s[e.imageName];h=t.sdf,f=t.pixelRatio,a=Mu/f}const y=i?[e.x+g,e.y]:[0,0];let v=i?[0,0]:[e.x+g+n[0],e.y+n[1]-p],_=[0,0];m&&(_=v,v=[0,0]);const b=e.metrics.isDoubleResolution?2:1,x=(e.metrics.left-a)*e.scale-g+v[0],w=(-e.metrics.top-a)*e.scale+v[1],k=x+r.w/b*e.scale/f,S=w+r.h/b*e.scale/f,E=new o(x,w),C=new o(k,w),P=new o(x,S),D=new o(k,S);if(m){const t=new o(-g,g-Lu),n=-Math.PI/2,r=au/2-g,i=new o(5-Lu-r,-(e.imageName?r:0)),a=new o(..._);E._rotateAround(n,t)._add(i)._add(a),C._rotateAround(n,t)._add(i)._add(a),P._rotateAround(n,t)._add(i)._add(a),D._rotateAround(n,t)._add(i)._add(a)}if(u){const e=Math.sin(u),t=Math.cos(u),n=[t,-e,e,t];E._matMult(n),C._matMult(n),P._matMult(n),D._matMult(n)}const I=new o(0,0),T=new o(0,0);c.push({tl:E,tr:C,bl:P,br:D,tex:r,writingMode:t.writingMode,glyphOffset:y,sectionIndex:e.sectionIndex,isSDF:h,pixelOffsetTL:I,pixelOffsetBR:T,minFontScaleX:0,minFontScaleY:0})}return c}(0,n,l,i,a,s,r,e.allowVerticalPlacement),y=e.textSizeData;let v=null;"source"===y.kind?(v=[ic*i.layout.get("text-size").evaluate(s,{})],v[0]>ac&&S("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(rc,'. Reduce your "text-size".'))):"composite"===y.kind&&(v=[ic*p.compositeTextSizes[0].evaluate(s,{},m),ic*p.compositeTextSizes[1].evaluate(s,{},m)],(v[0]>ac||v[1]>ac)&&S("".concat(e.layerIds[0],': Value for "text-size" is >= ').concat(rc,'. Reduce your "text-size".'))),e.addSymbols(e.text,g,v,l,a,s,c,t,u.lineStartIndex,u.lineLength,f,m);for(const o of d)h[o]=e.text.placedSymbolArray.length-1;return 4*g.length}function Sd(e){for(const t in e)return e[t];return null}function Ed(e,t,n,r){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(r.dist(e[t])<n)return!0}else i[t]=[];return i[t].push(r),!1}const Cd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Pd{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[t,n]=new Uint8Array(e,0,2);if(219!==t)throw new Error("Data does not appear to be in a KDBush format.");const r=n>>4;if(1!==r)throw new Error("Got v".concat(r," data when expected v1."));const i=Cd[15&n];if(!i)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[o]=new Uint32Array(e,4,1);return new Pd(o,a,i,e)}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Float64Array,r=arguments.length>3?arguments[3]:void 0;if(isNaN(e)||e<0)throw new Error("Unpexpected numItems value: ".concat(e,"."));this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.ArrayType=n,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const i=Cd.indexOf(this.ArrayType),a=2*e*this.ArrayType.BYTES_PER_ELEMENT,o=e*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-o%8)%8;if(i<0)throw new Error("Unexpected typed array class: ".concat(n,"."));r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+a+o+s),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+o+s,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+i]),new Uint16Array(this.data,2,1)[0]=t,new Uint32Array(this.data,4,1)[0]=e)}add(e,t){const n=this._pos>>1;return this.ids[n]=n,this.coords[this._pos++]=e,this.coords[this._pos++]=t,n}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error("Added ".concat(e," items when expected ").concat(this.numItems,"."));return Dd(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,t,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:a,nodeSize:o}=this,s=[0,i.length-1,0],l=[];for(;s.length;){const u=s.pop()||0,c=s.pop()||0,d=s.pop()||0;if(c-d<=o){for(let o=d;o<=c;o++){const s=a[2*o],u=a[2*o+1];s>=e&&s<=n&&u>=t&&u<=r&&l.push(i[o])}continue}const h=d+c>>1,f=a[2*h],p=a[2*h+1];f>=e&&f<=n&&p>=t&&p<=r&&l.push(i[h]),(0===u?e<=f:t<=p)&&(s.push(d),s.push(h-1),s.push(1-u)),(0===u?n>=f:r>=p)&&(s.push(h+1),s.push(c),s.push(1-u))}return l}within(e,t,n){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:i,nodeSize:a}=this,o=[0,r.length-1,0],s=[],l=n*n;for(;o.length;){const u=o.pop()||0,c=o.pop()||0,d=o.pop()||0;if(c-d<=a){for(let n=d;n<=c;n++)zd(i[2*n],i[2*n+1],e,t)<=l&&s.push(r[n]);continue}const h=d+c>>1,f=i[2*h],p=i[2*h+1];zd(f,p,e,t)<=l&&s.push(r[h]),(0===u?e-n<=f:t-n<=p)&&(o.push(d),o.push(h-1),o.push(1-u)),(0===u?e+n>=f:t+n>=p)&&(o.push(h+1),o.push(c),o.push(1-u))}return s}}function Dd(e,t,n,r,i,a){if(i-r<=n)return;const o=r+i>>1;Id(e,t,o,r,i,a),Dd(e,t,n,r,o-1,1-a),Dd(e,t,n,o+1,i,1-a)}function Id(e,t,n,r,i,a){for(;i>r;){if(i-r>600){const o=i-r+1,s=n-r+1,l=Math.log(o),u=.5*Math.exp(2*l/3),c=.5*Math.sqrt(l*u*(o-u)/o)*(s-o/2<0?-1:1);Id(e,t,n,Math.max(r,Math.floor(n-s*u/o+c)),Math.min(i,Math.floor(n+(o-s)*u/o+c)),a)}const o=t[2*n+a];let s=r,l=i;for(Td(e,t,r,n),t[2*i+a]>o&&Td(e,t,r,i);s<l;){for(Td(e,t,s,l),s++,l--;t[2*s+a]<o;)s++;for(;t[2*l+a]>o;)l--}t[2*r+a]===o?Td(e,t,r,l):(l++,Td(e,t,l,i)),l<=n&&(r=l+1),n<=l&&(i=l-1)}}function Td(e,t,n,r){Ad(e,n,r),Ad(t,2*n,2*r),Ad(t,2*n+1,2*r+1)}function Ad(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function zd(e,t,n,r){const i=e-n,a=t-r;return i*i+a*a}var Od;e.bg=void 0,(Od=e.bg||(e.bg={})).create="create",Od.load="load",Od.fullLoad="fullLoad";let Fd=null,Md=[];const jd=1e3/60,Bd="loadTime",Rd="fullLoadTime",Ld={mark(e){performance.mark(e)},frame(e){const t=e;null!=Fd&&Md.push(t-Fd),Fd=t},clearMetrics(){Fd=null,Md=[],performance.clearMeasures(Bd),performance.clearMeasures(Rd);for(const t in e.bg)performance.clearMarks(e.bg[t])},getPerformanceMetrics(){performance.measure(Bd,e.bg.create,e.bg.load),performance.measure(Rd,e.bg.create,e.bg.fullLoad);const t=performance.getEntriesByName(Bd)[0].duration,n=performance.getEntriesByName(Rd)[0].duration,r=Md.length,i=1/(Md.reduce((e,t)=>e+t,0)/r/1e3),a=Md.filter(e=>e>jd).reduce((e,t)=>e+(t-jd)/jd,0);return{loadTime:t,fullLoadTime:n,fps:i,percentDroppedFrames:a/(r+a)*100,totalFrames:r}}};e.$=class extends fa{},e.A=us,e.B=gi,e.C=function(e){if(null==P){const t=e.navigator?e.navigator.userAgent:null;P=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return P},e.D=Ji,e.E=Z,e.F=class{constructor(e,t){this.target=e,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new Dc(()=>this.process()),this.subscription=function(e,t,n){return e.addEventListener(t,n,!1),{unsubscribe:()=>{e.removeEventListener(t,n,!1)}}}(this.target,"message",e=>this.receive(e)),this.globalScope=C(self)?e:window}registerMessageHandler(e,t){this.messageHandlers[e]=t}sendAsync(e,t){return new Promise((n,r)=>{const i=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[i]={resolve:n,reject:r},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[i];const t={id:i,type:"<cancel>",origin:location.origin,targetMapId:e.targetMapId,sourceMapId:this.mapId};this.target.postMessage(t)},{once:!0});const a=[],o=Object.assign(Object.assign({},e),{id:i,sourceMapId:this.mapId,origin:location.origin,data:Ci(e.data,a)});this.target.postMessage(o,{transfer:a})})}receive(e){const t=e.data,n=t.id;if(!("file://"!==t.origin&&"file://"!==location.origin&&"resource://android"!==t.origin&&"resource://android"!==location.origin&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if("<cancel>"===t.type){delete this.tasks[n];const e=this.abortControllers[n];return delete this.abortControllers[n],void(e&&e.abort())}if(C(self)||t.mustQueue)return this.tasks[n]=t,this.taskQueue.push(n),void this.invoker.trigger();this.processTask(n,t)}}process(){if(0===this.taskQueue.length)return;const e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(e,t)}processTask(e,n){return t(this,void 0,void 0,function*(){if("<response>"===n.type){const t=this.resolveRejects[e];if(delete this.resolveRejects[e],!t)return;return void(n.error?t.reject(Pi(n.error)):t.resolve(Pi(n.data)))}if(!this.messageHandlers[n.type])return void this.completeTask(e,new Error("Could not find a registered handler for ".concat(n.type,", map ID: ").concat(this.mapId,", available handlers: ").concat(Object.keys(this.messageHandlers).join(", "))));const t=Pi(n.data),r=new AbortController;this.abortControllers[e]=r;try{const i=yield this.messageHandlers[n.type](n.sourceMapId,t,r);this.completeTask(e,null,i)}catch(t){this.completeTask(e,t)}})}completeTask(e,t,n){const r=[];delete this.abortControllers[e];const i={id:e,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?Ci(t):null,data:Ci(n,r)};this.target.postMessage(i,{transfer:r})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},e.G=B,e.H=function(){var e=new us(16);return us!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.I=ju,e.J=function(e,t,n){var r,i,a,o,s,l,u,c,d,h,f,p,m=n[0],g=n[1],y=n[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=r=t[0],e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=r*m+s*g+d*y+t[12],e[13]=i*m+l*g+h*y+t[13],e[14]=a*m+u*g+f*y+t[14],e[15]=o*m+c*g+p*y+t[15]),e},e.K=function(e,t,n){var r=n[0],i=n[1],a=n[2];return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.L=ds,e.M=function(e,t){const n={};for(let r=0;r<t.length;r++){const i=t[r];i in e&&(n[i]=e[i])}return n},e.N=Tc,e.O=Oc,e.P=o,e.Q=Fc,e.R=Ss,e.S=Uc,e.T=Zi,e.U=h,e.V=f,e.W=T,e.X=Ro,e.Y=ua,e.Z=Bc,e._=t,e.a=M,e.a$=function(e,t){var n=e[0],r=e[1],i=e[2],a=e[3],o=e[4],s=e[5],l=e[6],u=e[7],c=e[8],d=e[9],h=e[10],f=e[11],p=e[12],m=e[13],g=e[14],y=e[15],v=t[0],_=t[1],b=t[2],x=t[3],w=t[4],k=t[5],S=t[6],E=t[7],C=t[8],P=t[9],D=t[10],I=t[11],T=t[12],A=t[13],z=t[14],O=t[15];return Math.abs(n-v)<=ls*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-_)<=ls*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-b)<=ls*Math.max(1,Math.abs(i),Math.abs(b))&&Math.abs(a-x)<=ls*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(o-w)<=ls*Math.max(1,Math.abs(o),Math.abs(w))&&Math.abs(s-k)<=ls*Math.max(1,Math.abs(s),Math.abs(k))&&Math.abs(l-S)<=ls*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-E)<=ls*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-C)<=ls*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(d-P)<=ls*Math.max(1,Math.abs(d),Math.abs(P))&&Math.abs(h-D)<=ls*Math.max(1,Math.abs(h),Math.abs(D))&&Math.abs(f-I)<=ls*Math.max(1,Math.abs(f),Math.abs(I))&&Math.abs(p-T)<=ls*Math.max(1,Math.abs(p),Math.abs(T))&&Math.abs(m-A)<=ls*Math.max(1,Math.abs(m),Math.abs(A))&&Math.abs(g-z)<=ls*Math.max(1,Math.abs(g),Math.abs(z))&&Math.abs(y-O)<=ls*Math.max(1,Math.abs(y),Math.abs(O))},e.a0=lo,e.a1=Lc,e.a2=ae,e.a3=e=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(n=>{t.onloadstart=()=>{n(t)};for(const r of e){const e=window.document.createElement("source");U(r)||(t.crossOrigin="Anonymous"),e.src=r,t.appendChild(e)}})},e.a4=function(){return _++},e.a5=Ma,e.a6=mc,e.a7=Ir,e.a8=Vo,e.a9=Wc,e.aA=function(e){if("custom"===e.type)return new Pc(e);switch(e.type){case"background":return new kc(e);case"circle":return new ms(e);case"fill":return new cl(e);case"fill-extrusion":return new Fl(e);case"heatmap":return new Ps(e);case"hillshade":return new Ts(e);case"line":return new $l(e);case"raster":return new Cc(e);case"symbol":return new bc(e)}},e.aB=w,e.aC=function(e,t){if(!e)return[{command:"setStyle",args:[t]}];let n=[];try{if(!$(e.version,t.version))return[{command:"setStyle",args:[t]}];$(e.center,t.center)||n.push({command:"setCenter",args:[t.center]}),$(e.zoom,t.zoom)||n.push({command:"setZoom",args:[t.zoom]}),$(e.bearing,t.bearing)||n.push({command:"setBearing",args:[t.bearing]}),$(e.pitch,t.pitch)||n.push({command:"setPitch",args:[t.pitch]}),$(e.sprite,t.sprite)||n.push({command:"setSprite",args:[t.sprite]}),$(e.glyphs,t.glyphs)||n.push({command:"setGlyphs",args:[t.glyphs]}),$(e.transition,t.transition)||n.push({command:"setTransition",args:[t.transition]}),$(e.light,t.light)||n.push({command:"setLight",args:[t.light]}),$(e.terrain,t.terrain)||n.push({command:"setTerrain",args:[t.terrain]}),$(e.sky,t.sky)||n.push({command:"setSky",args:[t.sky]}),$(e.projection,t.projection)||n.push({command:"setProjection",args:[t.projection]});const r={},i=[];!function(e,t,n,r){let i;for(i in t=t||{},e=e||{})Object.prototype.hasOwnProperty.call(e,i)&&(Object.prototype.hasOwnProperty.call(t,i)||Q(i,n,r));for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(Object.prototype.hasOwnProperty.call(e,i)?$(e[i],t[i])||("geojson"===e[i].type&&"geojson"===t[i].type&&te(e,t,i)?Y(n,{command:"setGeoJSONSourceData",args:[i,t[i].data]}):ee(i,t,n,r)):J(i,t,n))}(e.sources,t.sources,i,r);const a=[];e.layers&&e.layers.forEach(e=>{"source"in e&&r[e.source]?n.push({command:"removeLayer",args:[e.id]}):a.push(e)}),n=n.concat(i),function(e,t,n){t=t||[];const r=(e=e||[]).map(re),i=t.map(re),a=e.reduce(ie,{}),o=t.reduce(ie,{}),s=r.slice(),l=Object.create(null);let u,c,d,h,f;for(let p=0,m=0;p<r.length;p++)u=r[p],Object.prototype.hasOwnProperty.call(o,u)?m++:(Y(n,{command:"removeLayer",args:[u]}),s.splice(s.indexOf(u,m),1));for(let p=0,m=0;p<i.length;p++)u=i[i.length-1-p],s[s.length-1-p]!==u&&(Object.prototype.hasOwnProperty.call(a,u)?(Y(n,{command:"removeLayer",args:[u]}),s.splice(s.lastIndexOf(u,s.length-m),1)):m++,h=s[s.length-p],Y(n,{command:"addLayer",args:[o[u],h]}),s.splice(s.length-p,0,u),l[u]=!0);for(let p=0;p<i.length;p++)if(u=i[p],c=a[u],d=o[u],!l[u]&&!$(c,d))if($(c.source,d.source)&&$(c["source-layer"],d["source-layer"])&&$(c.type,d.type)){for(f in ne(c.layout,d.layout,n,u,null,"setLayoutProperty"),ne(c.paint,d.paint,n,u,null,"setPaintProperty"),$(c.filter,d.filter)||Y(n,{command:"setFilter",args:[u,d.filter]}),$(c.minzoom,d.minzoom)&&$(c.maxzoom,d.maxzoom)||Y(n,{command:"setLayerZoomRange",args:[u,d.minzoom,d.maxzoom]}),c)Object.prototype.hasOwnProperty.call(c,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?ne(c[f],d[f],n,u,f.slice(6),"setPaintProperty"):$(c[f],d[f])||Y(n,{command:"setLayerProperty",args:[u,f,d[f]]}));for(f in d)Object.prototype.hasOwnProperty.call(d,f)&&!Object.prototype.hasOwnProperty.call(c,f)&&"layout"!==f&&"paint"!==f&&"filter"!==f&&"metadata"!==f&&"minzoom"!==f&&"maxzoom"!==f&&(0===f.indexOf("paint.")?ne(c[f],d[f],n,u,f.slice(6),"setPaintProperty"):$(c[f],d[f])||Y(n,{command:"setLayerProperty",args:[u,f,d[f]]}))}else Y(n,{command:"removeLayer",args:[u]}),h=s[s.lastIndexOf(u)+1],Y(n,{command:"addLayer",args:[d,h]})}(a,t.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:"setStyle",args:[t]}]}return n},e.aD=function(e){const t=[],n=e.id;return void 0===n&&t.push({message:"layers.".concat(n,': missing required property "id"')}),void 0===e.render&&t.push({message:"layers.".concat(n,': missing required method "render"')}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:"layers.".concat(n,': property "renderingMode" must be either "2d" or "3d"')}),t},e.aE=function e(t,n){if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==n){if("object"!=typeof n)return!1;if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(!e(t[r],n[r]))return!1;return!0}return t===n},e.aF=b,e.aG=x,e.aH=class extends ko{constructor(e,t){super(e,t),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1i(this.location,e))}},e.aI=So,e.aJ=class extends ko{constructor(e,t){super(e,t),this.current=Po}set(e){if(e[12]!==this.current[12]||e[0]!==this.current[0])return this.current=e,void this.gl.uniformMatrix4fv(this.location,!1,e);for(let t=1;t<16;t++)if(e[t]!==this.current[t]){this.current=e,this.gl.uniformMatrix4fv(this.location,!1,e);break}}},e.aK=Eo,e.aL=Co,e.aM=Ge,e.aN=class extends ko{constructor(e,t){super(e,t),this.current=[0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]||(this.current=e,this.gl.uniform3f(this.location,e[0],e[1],e[2]))}},e.aO=class extends ko{constructor(e,t){super(e,t),this.current=[0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]||(this.current=e,this.gl.uniform2f(this.location,e[0],e[1]))}},e.aP=function(e,t,n,r,i,a,o){var s=1/(t-n),l=1/(r-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(i+r)*l,e[14]=(o+a)*u,e[15]=1,e},e.aQ=fs,e.aR=class extends ka{},e.aS=nu,e.aT=class extends Ea{},e.aU=Cs,e.aV=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},e.aW=Es,e.aX=Za,e.aY=io,e.aZ=class extends za{},e.a_=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]},e.aa=function(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(e,n,r,i)=>{const a=r||i;return t[n]=!a||a.toLowerCase(),""}),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t},e.ab=function(e,t){const n=[];for(const r in e)r in t||n.push(r);return n},e.ac=g,e.ad=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*r,e[1]=o*i+c*r,e[2]=s*i+d*r,e[3]=l*i+h*r,e[4]=u*i-a*r,e[5]=c*i-o*r,e[6]=d*i-s*r,e[7]=h*i-l*r,e},e.ae=function(e){var t=new us(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.af=ps,e.ag=function(e,t){let n=0,r=0;if("constant"===e.kind)r=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:a,maxZoom:o}=e,s=i?g(zt.interpolationFactor(i,t,a,o),0,1):0;"camera"===e.kind?r=At.number(e.minSize,e.maxSize,s):n=s}return{uSizeT:n,uSize:r}},e.ai=function(e,t,n){let{uSize:r,uSizeT:i}=t,{lowerSize:a,upperSize:o}=n;return"source"===e.kind?a/ic:"composite"===e.kind?At.number(a/ic,o/ic,i):r},e.aj=dc,e.ak=function(e,t,n,r){const i=t.y-e.y,a=t.x-e.x,s=r.y-n.y,l=r.x-n.x,u=s*a-l*i;if(0===u)return null;const c=(l*(e.y-n.y)-s*(e.x-n.x))/u;return new o(e.x+c*a,e.y+c*i)},e.al=$c,e.am=Wo,e.an=cs,e.ao=function(e){let t=1/0,n=1/0,r=-1/0,i=-1/0;for(const a of e)t=Math.min(t,a.x),n=Math.min(n,a.y),r=Math.max(r,a.x),i=Math.max(i,a.y);return[t,n,r,i]},e.ap=au,e.ar=sc,e.as=function(e,t){var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=n*s-r*o,_=n*l-i*o,b=n*u-a*o,x=r*l-i*s,w=r*u-a*s,k=i*u-a*l,S=c*m-d*p,E=c*g-h*p,C=c*y-f*p,P=d*g-h*m,D=d*y-f*m,I=h*y-f*g,T=v*I-_*D+b*P+x*C-w*E+k*S;return T?(e[0]=(s*I-l*D+u*P)*(T=1/T),e[1]=(i*D-r*I-a*P)*T,e[2]=(m*k-g*w+y*x)*T,e[3]=(h*w-d*k-f*x)*T,e[4]=(l*C-o*I-u*E)*T,e[5]=(n*I-i*C+a*E)*T,e[6]=(g*b-p*k-y*_)*T,e[7]=(c*k-h*b+f*_)*T,e[8]=(o*D-s*C+u*S)*T,e[9]=(r*C-n*D-a*S)*T,e[10]=(p*w-m*b+y*v)*T,e[11]=(d*b-c*w-f*v)*T,e[12]=(s*E-o*P-l*S)*T,e[13]=(n*P-r*E+i*S)*T,e[14]=(m*_-p*x-g*v)*T,e[15]=(c*x-d*_+h*v)*T,e):null},e.at=xd,e.au=Ju,e.av=Pd,e.aw=function(){const e={},t=K.$version;for(const n in K.$root){const r=K.$root[n];if(r.required){let i=null;i="version"===n?t:"array"===r.type?[]:{},null!=i&&(e[n]=i)}}return e},e.ax=Di,e.ay=L,e.az=function(e){e=e.slice();const t=Object.create(null);for(let n=0;n<e.length;n++)t[e[n].id]=e[n];for(let n=0;n<e.length;n++)"ref"in e[n]&&(e[n]=X(e[n],t[e[n].ref]));return e},e.b=D,e.b0=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.b1=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e},e.b2=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},e.b3=y,e.b4=Nc,e.b5=Mc,e.b6=function(e,t,n,r,i){var a,o=1/Math.tan(t/2);return e[0]=o/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+r)*(a=1/(r-i)),e[14]=2*i*r*a):(e[10]=-1,e[14]=-2*r),e},e.b7=function(e,t,n){var r=Math.sin(n),i=Math.cos(n),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*r,e[5]=o*i+c*r,e[6]=s*i+d*r,e[7]=l*i+h*r,e[8]=u*i-a*r,e[9]=c*i-o*r,e[10]=d*i-s*r,e[11]=h*i-l*r,e},e.b8=p,e.b9=m,e.bA=ou,e.bB=function(e){return e.message===O},e.bC=xr,e.bD=Vi,e.ba=function(e){return e*Math.PI/180},e.bb=function(e,t){const{x:n,y:r}=Bc.fromLngLat(t);return!(e<0||e>25||r<0||r>=1||n<0||n>=1)},e.bc=function(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.bd=class extends ha{},e.be=Ic,e.bf=Ld,e.bh=R,e.bi=function(e,t){M.REGISTERED_PROTOCOLS[e]=t},e.bj=function(e){delete M.REGISTERED_PROTOCOLS[e]},e.bk=function(e,t){const n={};for(let i=0;i<e.length;i++){const r=t&&t[e[i].id]||Rr(e[i]);t&&(t[e[i].id]=r);let a=n[r];a||(a=n[r]=[]),a.push(e[i])}const r=[];for(const i in n)r.push(n[i]);return r},e.bl=wi,e.bm=Hc,e.bn=Zc,e.bo=Bu,e.bp=function(t){t.bucket.createArrays(),t.bucket.tilePixelRatio=Ro/(512*t.bucket.overscaling),t.bucket.compareText={},t.bucket.iconsNeedLinear=!1;const n=t.bucket.layers[0],r=n.layout,i=n._unevaluatedLayout._values,a={layoutIconSize:i["icon-size"].possiblyEvaluate(new qi(t.bucket.zoom+1),t.canonical),layoutTextSize:i["text-size"].possiblyEvaluate(new qi(t.bucket.zoom+1),t.canonical),textMaxSize:i["text-size"].possiblyEvaluate(new qi(18))};if("composite"===t.bucket.textSizeData.kind){const{minZoom:e,maxZoom:n}=t.bucket.textSizeData;a.compositeTextSizes=[i["text-size"].possiblyEvaluate(new qi(e),t.canonical),i["text-size"].possiblyEvaluate(new qi(n),t.canonical)]}if("composite"===t.bucket.iconSizeData.kind){const{minZoom:e,maxZoom:n}=t.bucket.iconSizeData;a.compositeIconSizes=[i["icon-size"].possiblyEvaluate(new qi(e),t.canonical),i["icon-size"].possiblyEvaluate(new qi(n),t.canonical)]}const o=r.get("text-line-height")*au,s="viewport"!==r.get("text-rotation-alignment")&&"point"!==r.get("symbol-placement"),l=r.get("text-keep-upright"),u=r.get("text-size");for(const c of t.bucket.features){const i=r.get("text-font").evaluate(c,{},t.canonical).join(","),d=u.evaluate(c,{},t.canonical),h=a.layoutTextSize.evaluate(c,{},t.canonical),f=a.layoutIconSize.evaluate(c,{},t.canonical),p={horizontal:{},vertical:void 0},m=c.text;let g,y=[0,0];if(m){const a=m.toString(),u=r.get("text-letter-spacing").evaluate(c,{},t.canonical)*au,f=Ai(a)?u:0,g=r.get("text-anchor").evaluate(c,{},t.canonical),v=bd(n,c,t.canonical);if(!v){const e=r.get("text-radial-offset").evaluate(c,{},t.canonical);y=e?_d(g,[e*au,vd]):r.get("text-offset").evaluate(c,{},t.canonical).map(e=>e*au)}let _=s?"center":r.get("text-justify").evaluate(c,{},t.canonical);const b="point"===r.get("symbol-placement")?r.get("text-max-width").evaluate(c,{},t.canonical)*au:1/0,x=()=>{t.bucket.allowVerticalPlacement&&Ti(a)&&(p.vertical=Vu(m,t.glyphMap,t.glyphPositions,t.imagePositions,i,b,o,g,"left",f,y,e.ah.vertical,!0,h,d))};if(!s&&v){const n=new Set;if("auto"===_)for(let e=0;e<v.values.length;e+=2)n.add(xd(v.values[e]));else n.add(_);let r=!1;for(const a of n)if(!p.horizontal[a])if(r)p.horizontal[a]=p.horizontal[0];else{const n=Vu(m,t.glyphMap,t.glyphPositions,t.imagePositions,i,b,o,"center",a,f,y,e.ah.horizontal,!1,h,d);n&&(p.horizontal[a]=n,r=1===n.positionedLines.length)}x()}else{"auto"===_&&(_=xd(g));const n=Vu(m,t.glyphMap,t.glyphPositions,t.imagePositions,i,b,o,g,_,f,y,e.ah.horizontal,!1,h,d);n&&(p.horizontal[_]=n),x(),Ti(a)&&s&&l&&(p.vertical=Vu(m,t.glyphMap,t.glyphPositions,t.imagePositions,i,b,o,g,_,f,y,e.ah.vertical,!1,h,d))}}let v=!1;if(c.icon&&c.icon.name){const e=t.imageMap[c.icon.name];e&&(g=ec(t.imagePositions[c.icon.name],r.get("icon-offset").evaluate(c,{},t.canonical),r.get("icon-anchor").evaluate(c,{},t.canonical)),v=!!e.sdf,void 0===t.bucket.sdfIcons?t.bucket.sdfIcons=v:t.bucket.sdfIcons!==v&&S("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(e.pixelRatio!==t.bucket.pixelRatio||0!==r.get("icon-rotate").constantOr(1))&&(t.bucket.iconsNeedLinear=!0))}const _=Sd(p.horizontal)||p.vertical;t.bucket.iconsInText=!!_&&_.iconsInText,(_||g)&&wd(t.bucket,c,p,g,t.imageMap,a,h,f,y,v,t.canonical)}t.showCollisionBoxes&&t.bucket.generateCollisionDebugBuffers()},e.bq=Hl,e.br=ol,e.bs=Il,e.bt=pl,e.bu=Du,e.bv=class{constructor(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let e=performance.getEntriesByName(this._marks.measure);return 0===e.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),e=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),e}},e.bw=function(e,n,r,i,a){return t(this,void 0,void 0,function*(){if(f())try{return yield T(e,n,r,i,a)}catch(e){}return function(e,t,n,r,i){const a=e.width,o=e.height;A&&z||(A=new OffscreenCanvas(a,o),z=A.getContext("2d",{willReadFrequently:!0})),A.width=a,A.height=o,z.drawImage(e,0,0,a,o);const s=z.getImageData(t,n,r,i);return z.clearRect(0,0,a,o),s.data}(e,n,r,i,a)})},e.bx=qc,e.by=n,e.bz=i,e.c=F,e.d=e=>t(void 0,void 0,void 0,function*(){if(0===e.byteLength)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(e)],{type:"image/png"});try{return createImageBitmap(t)}catch(e){throw new Error("Could not load image because of ".concat(e.message,". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}}),e.e=v,e.f=e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>{t(r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=I})},r.onerror=()=>n(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?URL.createObjectURL(i):I}),e.g=j,e.h=(e,t)=>N(v(e,{type:"json"}),t),e.i=C,e.j=W,e.k=H,e.l=(e,t)=>N(v(e,{type:"arrayBuffer"}),t),e.m=N,e.n=function(e){return new Du(e).readFields(Tu,[])},e.o=ks,e.p=Fu,e.q=ra,e.r=mi,e.s=U,e.t=_i,e.u=pi,e.v=K,e.w=S,e.x=function(e){let[t,n,r]=e;return n+=90,n*=Math.PI/180,r*=Math.PI/180,{x:t*Math.cos(n)*Math.sin(r),y:t*Math.sin(n)*Math.sin(r),z:t*Math.cos(r)}},e.y=At,e.z=qi}),n("worker",["./shared"],function(e){class t{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const i of t){this._layerConfigs[i.id]=i;const t=this._layers[i.id]=e.aA(i);t._featureFilter=e.a7(t.filter),this.keyCache[i.id]&&delete this.keyCache[i.id]}for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const r=e.bk(Object.values(this._layerConfigs),this.keyCache);for(const e of r){const t=e.map(e=>this._layers[e.id]),n=t[0];if("none"===n.visibility)continue;const r=n.source||"";let i=this.familiesBySource[r];i||(i=this.familiesBySource[r]={});const a=n.sourceLayer||"_geojsonTileLayer";let o=i[a];o||(o=i[a]=[]),o.push(t)}}}class n{constructor(t){const n={},r=[];for(const e in t){const i=t[e],a=n[e]={};for(const e in i){const t=i[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const n={x:0,y:0,w:t.bitmap.width+2,h:t.bitmap.height+2};r.push(n),a[e]={rect:n,metrics:t.metrics}}}const{w:i,h:a}=e.p(r),o=new e.o({width:i||1,height:a||1});for(const s in t){const r=t[s];for(const t in r){const i=r[+t];if(!i||0===i.bitmap.width||0===i.bitmap.height)continue;const a=n[s][t].rect;e.o.copy(i.bitmap,o,{x:0,y:0},{x:a.x+1,y:a.y+1},i.bitmap)}}this.image=o,this.positions=n}}e.bl("GlyphAtlas",n);class r{constructor(t){this.tileID=new e.S(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.uid=t.uid,this.zoom=t.zoom,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.inFlightDependencies=[]}parse(t,r,a,o){return e._(this,void 0,void 0,function*(){this.status="parsing",this.data=t,this.collisionBoxArray=new e.a5;const s=new e.bm(Object.keys(t.layers).sort()),l=new e.bn(this.tileID,this.promoteId);l.bucketLayerIDs=[];const u={},c={featureIndex:l,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:a},d=r.familiesBySource[this.source];for(const n in d){const r=t.layers[n];if(!r)continue;1===r.version&&e.w('Vector tile source "'.concat(this.source,'" layer "').concat(n,'" does not use vector tile spec v2 and therefore may have some rendering errors.'));const o=s.encode(n),h=[];for(let e=0;e<r.length;e++){const t=r.feature(e),i=l.getId(t,n);h.push({feature:t,id:i,index:e,sourceLayerIndex:o})}for(const t of d[n]){const n=t[0];n.source!==this.source&&e.w("layer.source = ".concat(n.source," does not equal this.source = ").concat(this.source)),n.minzoom&&this.zoom<Math.floor(n.minzoom)||n.maxzoom&&this.zoom>=n.maxzoom||"none"!==n.visibility&&(i(t,this.zoom,a),(u[n.id]=n.createBucket({index:l.bucketLayerIDs.length,layers:t,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:o,sourceID:this.source})).populate(h,c,this.tileID.canonical),l.bucketLayerIDs.push(t.map(e=>e.id)))}}const h=e.aF(c.glyphDependencies,e=>Object.keys(e).map(Number));this.inFlightDependencies.forEach(e=>null==e?void 0:e.abort()),this.inFlightDependencies=[];let f=Promise.resolve({});if(Object.keys(h).length){const e=new AbortController;this.inFlightDependencies.push(e),f=o.sendAsync({type:"GG",data:{stacks:h,source:this.source,tileID:this.tileID,type:"glyphs"}},e)}const p=Object.keys(c.iconDependencies);let m=Promise.resolve({});if(p.length){const e=new AbortController;this.inFlightDependencies.push(e),m=o.sendAsync({type:"GI",data:{icons:p,source:this.source,tileID:this.tileID,type:"icons"}},e)}const g=Object.keys(c.patternDependencies);let y=Promise.resolve({});if(g.length){const e=new AbortController;this.inFlightDependencies.push(e),y=o.sendAsync({type:"GI",data:{icons:g,source:this.source,tileID:this.tileID,type:"patterns"}},e)}const[v,_,b]=yield Promise.all([f,m,y]),x=new n(v),w=new e.bo(_,b);for(const t in u){const n=u[t];n instanceof e.a6?(i(n.layers,this.zoom,a),e.bp({bucket:n,glyphMap:v,glyphPositions:x.positions,imageMap:_,imagePositions:w.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):n.hasPattern&&(n instanceof e.bq||n instanceof e.br||n instanceof e.bs)&&(i(n.layers,this.zoom,a),n.addFeatures(c,this.tileID.canonical,w.patternPositions))}return this.status="done",{buckets:Object.values(u).filter(e=>!e.isEmpty()),featureIndex:l,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:x.image,imageAtlas:w,glyphMap:this.returnDependencies?v:null,iconMap:this.returnDependencies?_:null,glyphPositions:this.returnDependencies?x.positions:null}})}}function i(t,n,r){const i=new e.z(n);for(const e of t)e.recalculate(i,r)}class a{constructor(e,t,n){this.actor=e,this.layerIndex=t,this.availableImages=n,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(t,n){return e._(this,void 0,void 0,function*(){const r=yield e.l(t.request,n);try{return{vectorTile:new e.bt.VectorTile(new e.bu(r.data)),rawData:r.data,cacheControl:r.cacheControl,expires:r.expires}}catch(e){const i=new Uint8Array(r.data);let a="Unable to parse the tile at ".concat(t.request.url,", ");throw a+=31===i[0]&&139===i[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":"got error: ".concat(e.message),new Error(a)}})}loadTile(t){return e._(this,void 0,void 0,function*(){const n=t.uid,i=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bv(t.request),a=new r(t);this.loading[n]=a;const o=new AbortController;a.abort=o;try{const r=yield this.loadVectorTile(t,o);if(delete this.loading[n],!r)return null;const s=r.rawData,l={};r.expires&&(l.expires=r.expires),r.cacheControl&&(l.cacheControl=r.cacheControl);const u={};if(i){const e=i.finish();e&&(u.resourceTiming=JSON.parse(JSON.stringify(e)))}a.vectorTile=r.vectorTile;const c=a.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor);this.loaded[n]=a,this.fetching[n]={rawTileData:s,cacheControl:l,resourceTiming:u};try{const t=yield c;return e.e({rawTileData:s.slice(0)},t,l,u)}finally{delete this.fetching[n]}}catch(e){throw delete this.loading[n],a.status="done",this.loaded[n]=a,e}})}reloadTile(t){return e._(this,void 0,void 0,function*(){const n=t.uid;if(!this.loaded||!this.loaded[n])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const r=this.loaded[n];if(r.showCollisionBoxes=t.showCollisionBoxes,"parsing"===r.status){const t=yield r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor);let i;if(this.fetching[n]){const{rawTileData:r,cacheControl:a,resourceTiming:o}=this.fetching[n];delete this.fetching[n],i=e.e({rawTileData:r.slice(0)},t,a,o)}else i=t;return i}if("done"===r.status&&r.vectorTile)return r.parse(r.vectorTile,this.layerIndex,this.availableImages,this.actor)})}abortTile(t){return e._(this,void 0,void 0,function*(){const e=this.loading,n=t.uid;e&&e[n]&&e[n].abort&&(e[n].abort.abort(),delete e[n])})}removeTile(t){return e._(this,void 0,void 0,function*(){this.loaded&&this.loaded[t.uid]&&delete this.loaded[t.uid]})}}class o{constructor(){this.loaded={}}loadTile(t){return e._(this,void 0,void 0,function*(){const{uid:n,encoding:r,rawImageData:i,redFactor:a,greenFactor:o,blueFactor:s,baseShift:l}=t,u=i.width+2,c=i.height+2,d=e.b(i)?new e.R({width:u,height:c},yield e.bw(i,-1,-1,u,c)):i,h=new e.bx(n,d,r,a,o,s,l);return this.loaded=this.loaded||{},this.loaded[n]=h,h})}removeTile(e){const t=this.loaded,n=e.uid;t&&t[n]&&delete t[n]}}function s(e,t){if(0!==e.length){l(e[0],t);for(var n=1;n<e.length;n++)l(e[n],!t)}}function l(e,t){for(var n=0,r=0,i=0,a=e.length,o=a-1;i<a;o=i++){var s=(e[i][0]-e[o][0])*(e[o][1]+e[i][1]),l=n+s;r+=Math.abs(n)>=Math.abs(s)?n-l+s:s-l+n,n=l}n+r>=0!=!!t&&e.reverse()}var u=e.by(function e(t,n){var r,i=t&&t.type;if("FeatureCollection"===i)for(r=0;r<t.features.length;r++)e(t.features[r],n);else if("GeometryCollection"===i)for(r=0;r<t.geometries.length;r++)e(t.geometries[r],n);else if("Feature"===i)e(t.geometry,n);else if("Polygon"===i)s(t.coordinates,n);else if("MultiPolygon"===i)for(r=0;r<t.coordinates.length;r++)s(t.coordinates[r],n);return t});const c=e.bt.VectorTileFeature.prototype.toGeoJSON;var d={exports:{}},h=e.bz,f=e.bt.VectorTileFeature,p=m;function m(e,t){this.options=t||{},this.features=e,this.length=e.length}function g(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}m.prototype.feature=function(e){return new g(this.features[e],this.options.extent)},g.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var n=e[t],r=[],i=0;i<n.length;i++)r.push(new h(n[i][0],n[i][1]));this.geometry.push(r)}return this.geometry},g.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,n=-1/0,r=1/0,i=-1/0,a=0;a<e.length;a++)for(var o=e[a],s=0;s<o.length;s++){var l=o[s];t=Math.min(t,l.x),n=Math.max(n,l.x),r=Math.min(r,l.y),i=Math.max(i,l.y)}return[t,r,n,i]},g.prototype.toGeoJSON=f.prototype.toGeoJSON;var y=e.bA,v=p;function _(e){var t=new y;return function(e,t){for(var n in e.layers)t.writeMessage(3,b,e.layers[n])}(e,t),t.finish()}function b(e,t){var n;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var r={keys:[],values:[],keycache:{},valuecache:{}};for(n=0;n<e.length;n++)r.feature=e.feature(n),t.writeMessage(2,x,r);var i=r.keys;for(n=0;n<i.length;n++)t.writeStringField(3,i[n]);var a=r.values;for(n=0;n<a.length;n++)t.writeMessage(4,C,a[n])}function x(e,t){var n=e.feature;void 0!==n.id&&t.writeVarintField(1,n.id),t.writeMessage(2,w,e),t.writeVarintField(3,n.type),t.writeMessage(4,E,n)}function w(e,t){var n=e.feature,r=e.keys,i=e.values,a=e.keycache,o=e.valuecache;for(var s in n.properties){var l=n.properties[s],u=a[s];if(null!==l){void 0===u&&(r.push(s),a[s]=u=r.length-1),t.writeVarint(u);var c=typeof l;"string"!==c&&"boolean"!==c&&"number"!==c&&(l=JSON.stringify(l));var d=c+":"+l,h=o[d];void 0===h&&(i.push(l),o[d]=h=i.length-1),t.writeVarint(h)}}}function k(e,t){return(t<<3)+(7&e)}function S(e){return e<<1^e>>31}function E(e,t){for(var n=e.loadGeometry(),r=e.type,i=0,a=0,o=n.length,s=0;s<o;s++){var l=n[s],u=1;1===r&&(u=l.length),t.writeVarint(k(1,u));for(var c=3===r?l.length-1:l.length,d=0;d<c;d++){1===d&&1!==r&&t.writeVarint(k(2,c-1));var h=l[d].x-i,f=l[d].y-a;t.writeVarint(S(h)),t.writeVarint(S(f)),i+=h,a+=f}3===r&&t.writeVarint(k(7,1))}}function C(e,t){var n=typeof e;"string"===n?t.writeStringField(1,e):"boolean"===n?t.writeBooleanField(7,e):"number"===n&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}d.exports=_,d.exports.fromVectorTileJs=_,d.exports.fromGeojsonVt=function(e,t){t=t||{};var n={};for(var r in e)n[r]=new v(e[r].features,t),n[r].name=r,n[r].version=t.version,n[r].extent=t.extent;return _({layers:n})},d.exports.GeoJSONWrapper=v;var P=e.by(d.exports);const D={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},I=Math.fround||(T=new Float32Array(1),e=>(T[0]=+e,T[0]));var T;const A=3,z=5,O=6;class F{constructor(e){this.options=Object.assign(Object.create(D),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:t,minZoom:n,maxZoom:r}=this.options;t&&console.time("total time");const i="prepare ".concat(e.length," points");t&&console.time(i),this.points=e;const a=[];for(let s=0;s<e.length;s++){const t=e[s];if(!t.geometry)continue;const[n,r]=t.geometry.coordinates,i=I(B(n)),o=I(R(r));a.push(i,o,1/0,s,-1,1),this.options.reduce&&a.push(0)}let o=this.trees[r+1]=this._createTree(a);t&&console.timeEnd(i);for(let s=r;s>=n;s--){const e=+Date.now();o=this.trees[s]=this._createTree(this._cluster(o,s)),t&&console.log("z%d: %d clusters in %dms",s,o.numItems,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let n=((e[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)n=-180,i=180;else if(n>i){const e=this.getClusters([n,r,180,a],t),o=this.getClusters([-180,r,i,a],t);return e.concat(o)}const o=this.trees[this._limitZoom(t)],s=o.range(B(n),R(a),B(i),R(r)),l=o.data,u=[];for(const c of s){const e=this.stride*c;u.push(l[e+z]>1?M(l,e,this.clusterProps):this.points[l[e+A]])}return u}getChildren(e){const t=this._getOriginId(e),n=this._getOriginZoom(e),r="No cluster with the specified id.",i=this.trees[n];if(!i)throw new Error(r);const a=i.data;if(t*this.stride>=a.length)throw new Error(r);const o=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=i.within(a[t*this.stride],a[t*this.stride+1],o),l=[];for(const u of s){const t=u*this.stride;a[t+4]===e&&l.push(a[t+z]>1?M(a,t,this.clusterProps):this.points[a[t+A]])}if(0===l.length)throw new Error(r);return l}getLeaves(e,t,n){const r=[];return this._appendLeaves(r,e,t=t||10,n=n||0,0),r}getTile(e,t,n){const r=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:a,radius:o}=this.options,s=o/a,l=(n-s)/i,u=(n+1+s)/i,c={features:[]};return this._addTileFeatures(r.range((t-s)/i,l,(t+1+s)/i,u),r.data,t,n,i,c),0===t&&this._addTileFeatures(r.range(1-s/i,l,1,u),r.data,i,n,i,c),t===i-1&&this._addTileFeatures(r.range(0,l,s/i,u),r.data,-1,n,i,c),c.features.length?c:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const n=this.getChildren(e);if(t++,1!==n.length)break;e=n[0].properties.cluster_id}return t}_appendLeaves(e,t,n,r,i){const a=this.getChildren(t);for(const o of a){const t=o.properties;if(t&&t.cluster?i+t.point_count<=r?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,n,r,i):i<r?i++:e.push(o),e.length===n)break}return i}_createTree(t){const n=new e.av(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let e=0;e<t.length;e+=this.stride)n.add(t[e],t[e+1]);return n.finish(),n.data=t,n}_addTileFeatures(e,t,n,r,i,a){for(const o of e){const e=o*this.stride,s=t[e+z]>1;let l,u,c;if(s)l=j(t,e,this.clusterProps),u=t[e],c=t[e+1];else{const n=this.points[t[e+A]];l=n.properties;const[r,i]=n.geometry.coordinates;u=B(r),c=R(i)}const d={type:1,geometry:[[Math.round(this.options.extent*(u*i-n)),Math.round(this.options.extent*(c*i-r))]],tags:l};let h;h=s||this.options.generateId?t[e+A]:this.points[t[e+A]].id,void 0!==h&&(d.id=h),a.features.push(d)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const{radius:n,extent:r,reduce:i,minPoints:a}=this.options,o=n/(r*Math.pow(2,t)),s=e.data,l=[],u=this.stride;for(let c=0;c<s.length;c+=u){if(s[c+2]<=t)continue;s[c+2]=t;const n=s[c],r=s[c+1],d=e.within(s[c],s[c+1],o),h=s[c+z];let f=h;for(const e of d){const n=e*u;s[n+2]>t&&(f+=s[n+z])}if(f>h&&f>=a){let e,a=n*h,o=r*h,p=-1;const m=(c/u<<5)+(t+1)+this.points.length;for(const n of d){const r=n*u;if(s[r+2]<=t)continue;s[r+2]=t;const l=s[r+z];a+=s[r]*l,o+=s[r+1]*l,s[r+4]=m,i&&(e||(e=this._map(s,c,!0),p=this.clusterProps.length,this.clusterProps.push(e)),i(e,this._map(s,r)))}s[c+4]=m,l.push(a/f,o/f,1/0,m,-1,f),i&&l.push(p)}else{for(let e=0;e<u;e++)l.push(s[c+e]);if(f>1)for(const e of d){const n=e*u;if(!(s[n+2]<=t)){s[n+2]=t;for(let e=0;e<u;e++)l.push(s[n+e])}}}}return l}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t,n){if(e[t+z]>1){const r=this.clusterProps[e[t+O]];return n?Object.assign({},r):r}const r=this.points[e[t+A]].properties,i=this.options.map(r);return n&&i===r?Object.assign({},i):i}}function M(e,t,n){return{type:"Feature",id:e[t+A],properties:j(e,t,n),geometry:{type:"Point",coordinates:[(r=e[t],360*(r-.5)),L(e[t+1])]}};var r}function j(e,t,n){const r=e[t+z],i=r>=1e4?"".concat(Math.round(r/1e3),"k"):r>=1e3?Math.round(r/100)/10+"k":r,a=e[t+O],o=-1===a?{}:Object.assign({},n[a]);return Object.assign(o,{cluster:!0,cluster_id:e[t+A],point_count:r,point_count_abbreviated:i})}function B(e){return e/360+.5}function R(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function L(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function N(e,t,n,r){let i=r;const a=t+(n-t>>1);let o,s=n-t;const l=e[t],u=e[t+1],c=e[n],d=e[n+1];for(let h=t+3;h<n;h+=3){const t=U(e[h],e[h+1],l,u,c,d);if(t>i)o=h,i=t;else if(t===i){const e=Math.abs(h-a);e<s&&(o=h,s=e)}}i>r&&(o-t>3&&N(e,t,o,r),e[o+2]=i,n-o>3&&N(e,o,n,r))}function U(e,t,n,r,i,a){let o=i-n,s=a-r;if(0!==o||0!==s){const l=((e-n)*o+(t-r)*s)/(o*o+s*s);l>1?(n=i,r=a):l>0&&(n+=o*l,r+=s*l)}return o=e-n,s=t-r,o*o+s*s}function V(e,t,n,r){const i={id:null==e?null:e,type:t,geometry:n,tags:r,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===t||"MultiPoint"===t||"LineString"===t)q(i,n);else if("Polygon"===t)q(i,n[0]);else if("MultiLineString"===t)for(const a of n)q(i,a);else if("MultiPolygon"===t)for(const a of n)q(i,a[0]);return i}function q(e,t){for(let n=0;n<t.length;n+=3)e.minX=Math.min(e.minX,t[n]),e.minY=Math.min(e.minY,t[n+1]),e.maxX=Math.max(e.maxX,t[n]),e.maxY=Math.max(e.maxY,t[n+1])}function H(e,t,n,r){if(!t.geometry)return;const i=t.geometry.coordinates;if(i&&0===i.length)return;const a=t.geometry.type,o=Math.pow(n.tolerance/((1<<n.maxZoom)*n.extent),2);let s=[],l=t.id;if(n.promoteId?l=t.properties[n.promoteId]:n.generateId&&(l=r||0),"Point"===a)W(i,s);else if("MultiPoint"===a)for(const u of i)W(u,s);else if("LineString"===a)Z(i,s,o,!1);else if("MultiLineString"===a){if(n.lineMetrics){for(const n of i)s=[],Z(n,s,o,!1),e.push(V(l,"LineString",s,t.properties));return}K(i,s,o,!1)}else if("Polygon"===a)K(i,s,o,!0);else{if("MultiPolygon"!==a){if("GeometryCollection"===a){for(const i of t.geometry.geometries)H(e,{id:l,geometry:i,properties:t.properties},n,r);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const e of i){const t=[];K(e,t,o,!0),s.push(t)}}e.push(V(l,a,s,t.properties))}function W(e,t){t.push(G(e[0]),X(e[1]),0)}function Z(e,t,n,r){let i,a,o=0;for(let l=0;l<e.length;l++){const n=G(e[l][0]),s=X(e[l][1]);t.push(n,s,0),l>0&&(o+=r?(i*s-n*a)/2:Math.sqrt(Math.pow(n-i,2)+Math.pow(s-a,2))),i=n,a=s}const s=t.length-3;t[2]=1,N(t,0,s,n),t[s+2]=1,t.size=Math.abs(o),t.start=0,t.end=t.size}function K(e,t,n,r){for(let i=0;i<e.length;i++){const a=[];Z(e[i],a,n,r),t.push(a)}}function G(e){return e/360+.5}function X(e){const t=Math.sin(e*Math.PI/180),n=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return n<0?0:n>1?1:n}function $(e,t,n,r,i,a,o,s){if(r/=t,a>=(n/=t)&&o<r)return e;if(o<n||a>=r)return null;const l=[];for(const u of e){const e=u.geometry;let t=u.type;const a=0===i?u.minX:u.minY,o=0===i?u.maxX:u.maxY;if(a>=n&&o<r){l.push(u);continue}if(o<n||a>=r)continue;let c=[];if("Point"===t||"MultiPoint"===t)Y(e,c,n,r,i);else if("LineString"===t)J(e,c,n,r,i,!1,s.lineMetrics);else if("MultiLineString"===t)ee(e,c,n,r,i,!1);else if("Polygon"===t)ee(e,c,n,r,i,!0);else if("MultiPolygon"===t)for(const s of e){const e=[];ee(s,e,n,r,i,!0),e.length&&c.push(e)}if(c.length){if(s.lineMetrics&&"LineString"===t){for(const e of c)l.push(V(u.id,t,e,u.tags));continue}"LineString"!==t&&"MultiLineString"!==t||(1===c.length?(t="LineString",c=c[0]):t="MultiLineString"),"Point"!==t&&"MultiPoint"!==t||(t=3===c.length?"Point":"MultiPoint"),l.push(V(u.id,t,c,u.tags))}}return l.length?l:null}function Y(e,t,n,r,i){for(let a=0;a<e.length;a+=3){const o=e[a+i];o>=n&&o<=r&&te(t,e[a],e[a+1],e[a+2])}}function J(e,t,n,r,i,a,o){let s=Q(e);const l=0===i?ne:re;let u,c,d=e.start;for(let g=0;g<e.length-3;g+=3){const h=e[g],f=e[g+1],p=e[g+2],m=e[g+3],y=e[g+4],v=0===i?h:f,_=0===i?m:y;let b=!1;o&&(u=Math.sqrt(Math.pow(h-m,2)+Math.pow(f-y,2))),v<n?_>n&&(c=l(s,h,f,m,y,n),o&&(s.start=d+u*c)):v>r?_<r&&(c=l(s,h,f,m,y,r),o&&(s.start=d+u*c)):te(s,h,f,p),_<n&&v>=n&&(c=l(s,h,f,m,y,n),b=!0),_>r&&v<=r&&(c=l(s,h,f,m,y,r),b=!0),!a&&b&&(o&&(s.end=d+u*c),t.push(s),s=Q(e)),o&&(d+=u)}let h=e.length-3;const f=e[h],p=e[h+1],m=0===i?f:p;m>=n&&m<=r&&te(s,f,p,e[h+2]),h=s.length-3,a&&h>=3&&(s[h]!==s[0]||s[h+1]!==s[1])&&te(s,s[0],s[1],s[2]),s.length&&t.push(s)}function Q(e){const t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function ee(e,t,n,r,i,a){for(const o of e)J(o,t,n,r,i,a,!1)}function te(e,t,n,r){e.push(t,n,r)}function ne(e,t,n,r,i,a){const o=(a-t)/(r-t);return te(e,a,n+(i-n)*o,1),o}function re(e,t,n,r,i,a){const o=(a-n)/(i-n);return te(e,t+(r-t)*o,a,1),o}function ie(e,t){const n=[];for(let r=0;r<e.length;r++){const i=e[r],a=i.type;let o;if("Point"===a||"MultiPoint"===a||"LineString"===a)o=ae(i.geometry,t);else if("MultiLineString"===a||"Polygon"===a){o=[];for(const e of i.geometry)o.push(ae(e,t))}else if("MultiPolygon"===a){o=[];for(const e of i.geometry){const n=[];for(const r of e)n.push(ae(r,t));o.push(n)}}n.push(V(i.id,a,o,i.tags))}return n}function ae(e,t){const n=[];n.size=e.size,void 0!==e.start&&(n.start=e.start,n.end=e.end);for(let r=0;r<e.length;r+=3)n.push(e[r]+t,e[r+1],e[r+2]);return n}function oe(e,t){if(e.transformed)return e;const n=1<<e.z,r=e.x,i=e.y;for(const a of e.features){const e=a.geometry,o=a.type;if(a.geometry=[],1===o)for(let s=0;s<e.length;s+=2)a.geometry.push(se(e[s],e[s+1],t,n,r,i));else for(let s=0;s<e.length;s++){const o=[];for(let a=0;a<e[s].length;a+=2)o.push(se(e[s][a],e[s][a+1],t,n,r,i));a.geometry.push(o)}}return e.transformed=!0,e}function se(e,t,n,r,i,a){return[Math.round(n*(e*r-i)),Math.round(n*(t*r-a))]}function le(e,t,n,r,i){const a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),o={features:[],numPoints:0,numSimplified:0,numFeatures:e.length,source:null,x:n,y:r,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const s of e)ue(o,s,a,i);return o}function ue(e,t,n,r){const i=t.geometry,a=t.type,o=[];if(e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),"Point"===a||"MultiPoint"===a)for(let s=0;s<i.length;s+=3)o.push(i[s],i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===a)ce(o,i,e,n,!1,!1);else if("MultiLineString"===a||"Polygon"===a)for(let s=0;s<i.length;s++)ce(o,i[s],e,n,"Polygon"===a,0===s);else if("MultiPolygon"===a)for(let s=0;s<i.length;s++){const t=i[s];for(let r=0;r<t.length;r++)ce(o,t[r],e,n,!0,0===r)}if(o.length){let n=t.tags||null;if("LineString"===a&&r.lineMetrics){n={};for(const e in t.tags)n[e]=t.tags[e];n.mapbox_clip_start=i.start/i.size,n.mapbox_clip_end=i.end/i.size}const s={geometry:o,type:"Polygon"===a||"MultiPolygon"===a?3:"LineString"===a||"MultiLineString"===a?2:1,tags:n};null!==t.id&&(s.id=t.id),e.features.push(s)}}function ce(e,t,n,r,i,a){const o=r*r;if(r>0&&t.size<(i?o:r))return void(n.numPoints+=t.length/3);const s=[];for(let l=0;l<t.length;l+=3)(0===r||t[l+2]>o)&&(n.numSimplified++,s.push(t[l],t[l+1])),n.numPoints++;i&&function(e,t){let n=0;for(let r=0,i=e.length,a=i-2;r<i;a=r,r+=2)n+=(e[r]-e[a])*(e[r+1]+e[a+1]);if(n>0===t)for(let r=0,i=e.length;r<i/2;r+=2){const t=e[r],n=e[r+1];e[r]=e[i-2-r],e[r+1]=e[i-1-r],e[i-2-r]=t,e[i-1-r]=n}}(s,a),e.push(s)}const de={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class he{constructor(e,t){const n=(t=this.options=function(e,t){for(const n in t)e[n]=t[n];return e}(Object.create(de),t)).debug;if(n&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");let r=function(e,t){const n=[];if("FeatureCollection"===e.type)for(let r=0;r<e.features.length;r++)H(n,e.features[r],t,r);else H(n,"Feature"===e.type?e:{geometry:e},t);return n}(e,t);this.tiles={},this.tileCoords=[],n&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),r=function(e,t){const n=t.buffer/t.extent;let r=e;const i=$(e,1,-1-n,n,0,-1,2,t),a=$(e,1,1-n,2+n,0,-1,2,t);return(i||a)&&(r=$(e,1,-n,1+n,0,-1,2,t)||[],i&&(r=ie(i,1).concat(r)),a&&(r=r.concat(ie(a,-1)))),r}(r,t),r.length&&this.splitTile(r,0,0,0),n&&(r.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(e,t,n,r,i,a,o){const s=[e,t,n,r],l=this.options,u=l.debug;for(;s.length;){r=s.pop(),n=s.pop(),t=s.pop(),e=s.pop();const c=1<<t,d=fe(t,n,r);let h=this.tiles[d];if(!h&&(u>1&&console.time("creation"),h=this.tiles[d]=le(e,t,n,r,l),this.tileCoords.push({z:t,x:n,y:r}),u)){u>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,n,r,h.numFeatures,h.numPoints,h.numSimplified),console.timeEnd("creation"));const e="z".concat(t);this.stats[e]=(this.stats[e]||0)+1,this.total++}if(h.source=e,null==i){if(t===l.indexMaxZoom||h.numPoints<=l.indexMaxPoints)continue}else{if(t===l.maxZoom||t===i)continue;if(null!=i){const e=i-t;if(n!==a>>e||r!==o>>e)continue}}if(h.source=null,0===e.length)continue;u>1&&console.time("clipping");const f=.5*l.buffer/l.extent,p=.5-f,m=.5+f,g=1+f;let y=null,v=null,_=null,b=null,x=$(e,c,n-f,n+m,0,h.minX,h.maxX,l),w=$(e,c,n+p,n+g,0,h.minX,h.maxX,l);e=null,x&&(y=$(x,c,r-f,r+m,1,h.minY,h.maxY,l),v=$(x,c,r+p,r+g,1,h.minY,h.maxY,l),x=null),w&&(_=$(w,c,r-f,r+m,1,h.minY,h.maxY,l),b=$(w,c,r+p,r+g,1,h.minY,h.maxY,l),w=null),u>1&&console.timeEnd("clipping"),s.push(y||[],t+1,2*n,2*r),s.push(v||[],t+1,2*n,2*r+1),s.push(_||[],t+1,2*n+1,2*r),s.push(b||[],t+1,2*n+1,2*r+1)}}getTile(e,t,n){e=+e,t=+t,n=+n;const r=this.options,{extent:i,debug:a}=r;if(e<0||e>24)return null;const o=1<<e,s=fe(e,t=t+o&o-1,n);if(this.tiles[s])return oe(this.tiles[s],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,n);let l,u=e,c=t,d=n;for(;!l&&u>0;)u--,c>>=1,d>>=1,l=this.tiles[fe(u,c,d)];return l&&l.source?(a>1&&(console.log("found parent tile z%d-%d-%d",u,c,d),console.time("drilling down")),this.splitTile(l.source,u,c,d,e,t,n),a>1&&console.timeEnd("drilling down"),this.tiles[s]?oe(this.tiles[s],i):null):null}}function fe(e,t,n){return 32*((1<<e)*n+t)+e}function pe(e,t){return t?e.properties[t]:e.id}function me(e,t){if(null==e)return!0;if("Feature"===e.type)return null!=pe(e,t);if("FeatureCollection"===e.type){const n=new Set;for(const r of e.features){const e=pe(r,t);if(null==e)return!1;if(n.has(e))return!1;n.add(e)}return!0}return!1}function ge(e,t){const n=new Map;if(null==e);else if("Feature"===e.type)n.set(pe(e,t),e);else for(const r of e.features)n.set(pe(r,t),r);return n}class ye extends a{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(t,n){return e._(this,void 0,void 0,function*(){const n=t.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const r=this._geoJSONIndex.getTile(n.z,n.x,n.y);if(!r)return null;const i=new class{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.X,this.length=t.length,this._features=t}feature(t){return new class{constructor(t){this._feature=t,this.extent=e.X,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const n of this._feature.geometry)t.push([new e.P(n[0],n[1])]);return t}{const t=[];for(const n of this._feature.geometry){const r=[];for(const t of n)r.push(new e.P(t[0],t[1]));t.push(r)}return t}}toGeoJSON(e,t,n){return c.call(this,e,t,n)}}(this._features[t])}}(r.features);let a=P(i);return 0===a.byteOffset&&a.byteLength===a.buffer.byteLength||(a=new Uint8Array(a)),{vectorTile:i,rawData:a.buffer}})}loadData(t){return e._(this,void 0,void 0,function*(){var n;null===(n=this._pendingRequest)||void 0===n||n.abort();const r=!!(t&&t.request&&t.request.collectResourceTiming)&&new e.bv(t.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(t,this._pendingRequest),this._geoJSONIndex=t.cluster?new F(function(t){let{superclusterOptions:n,clusterProperties:r}=t;if(!r||!n)return n;const i={},a={},o={accumulated:null,zoom:0},s={properties:null},l=Object.keys(r);for(const u of l){const[t,n]=r[u],o=e.bC(n),s=e.bC("string"==typeof t?[t,["accumulated"],["get",u]]:t);i[u]=o.value,a[u]=s.value}return n.map=e=>{s.properties=e;const t={};for(const n of l)t[n]=i[n].evaluate(o,s);return t},n.reduce=(e,t)=>{s.properties=t;for(const n of l)o.accumulated=e[n],e[n]=a[n].evaluate(o,s)},n}(t)).load((yield this._pendingData).features):(i=yield this._pendingData,new he(i,t.geojsonVtOptions)),this.loaded={};const n={};if(r){const e=r.finish();e&&(n.resourceTiming={},n.resourceTiming[t.source]=JSON.parse(JSON.stringify(e)))}return n}catch(t){if(delete this._pendingRequest,e.bB(t))return{abandoned:!0};throw t}var i})}getData(){return e._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(e){const t=this.loaded;return t&&t[e.uid]?super.reloadTile(e):this.loadTile(e)}loadAndProcessGeoJSON(t,n){return e._(this,void 0,void 0,function*(){let r=yield this.loadGeoJSON(t,n);if(delete this._pendingRequest,"object"!=typeof r)throw new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object."));if(u(r,!0),t.filter){const n=e.bC(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===n.result)throw new Error(n.value.map(e=>"".concat(e.key,": ").concat(e.message)).join(", "));const i=r.features.filter(e=>n.value.evaluate({zoom:0},e));r={type:"FeatureCollection",features:i}}return r})}loadGeoJSON(t,n){return e._(this,void 0,void 0,function*(){const{promoteId:r}=t;if(t.request){const i=yield e.h(t.request,n);return this._dataUpdateable=me(i.data,r)?ge(i.data,r):void 0,i.data}if("string"==typeof t.data)try{const e=JSON.parse(t.data);return this._dataUpdateable=me(e,r)?ge(e,r):void 0,e}catch(e){throw new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object."))}if(!t.dataDiff)throw new Error("Input data given to '".concat(t.source,"' is not a valid GeoJSON object."));if(!this._dataUpdateable)throw new Error("Cannot update existing geojson data in ".concat(t.source));return function(e,t,n){var r,i,a,o;if(t.removeAll&&e.clear(),t.remove)for(const s of t.remove)e.delete(s);if(t.add)for(const s of t.add){const t=pe(s,n);null!=t&&e.set(t,s)}if(t.update)for(const s of t.update){let t=e.get(s.id);if(null==t)continue;const n=!s.removeAllProperties&&((null===(r=s.removeProperties)||void 0===r?void 0:r.length)>0||(null===(i=s.addOrUpdateProperties)||void 0===i?void 0:i.length)>0);if((s.newGeometry||s.removeAllProperties||n)&&(t=Object.assign({},t),e.set(s.id,t),n&&(t.properties=Object.assign({},t.properties))),s.newGeometry&&(t.geometry=s.newGeometry),s.removeAllProperties)t.properties={};else if((null===(a=s.removeProperties)||void 0===a?void 0:a.length)>0)for(const e of s.removeProperties)Object.prototype.hasOwnProperty.call(t.properties,e)&&delete t.properties[e];if((null===(o=s.addOrUpdateProperties)||void 0===o?void 0:o.length)>0)for(const{key:e,value:r}of s.addOrUpdateProperties)t.properties[e]=r}}(this._dataUpdateable,t.dataDiff,r),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(t){return e._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(e){return this._geoJSONIndex.getClusterExpansionZoom(e.clusterId)}getClusterChildren(e){return this._geoJSONIndex.getChildren(e.clusterId)}getClusterLeaves(e){return this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset)}}class ve{constructor(t){this.self=t,this.actor=new e.F(t),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(e,t)=>{if(this.externalWorkerSourceTypes[e])throw new Error('Worker source with name "'.concat(e,'" already registered.'));this.externalWorkerSourceTypes[e]=t},this.self.addProtocol=e.bi,this.self.removeProtocol=e.bj,this.self.registerRTLTextPlugin=t=>{if(e.bD.isParsed())throw new Error("RTL text plugin already registered.");e.bD.setMethods(t)},this.actor.registerMessageHandler("LDT",(e,t)=>this._getDEMWorkerSource(e,t.source).loadTile(t)),this.actor.registerMessageHandler("RDT",(t,n)=>e._(this,void 0,void 0,function*(){this._getDEMWorkerSource(t,n.source).removeTile(n)})),this.actor.registerMessageHandler("GCEZ",(t,n)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,n.type,n.source).getClusterExpansionZoom(n)})),this.actor.registerMessageHandler("GCC",(t,n)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,n.type,n.source).getClusterChildren(n)})),this.actor.registerMessageHandler("GCL",(t,n)=>e._(this,void 0,void 0,function*(){return this._getWorkerSource(t,n.type,n.source).getClusterLeaves(n)})),this.actor.registerMessageHandler("LD",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadData(t)),this.actor.registerMessageHandler("GD",(e,t)=>this._getWorkerSource(e,t.type,t.source).getData()),this.actor.registerMessageHandler("LT",(e,t)=>this._getWorkerSource(e,t.type,t.source).loadTile(t)),this.actor.registerMessageHandler("RT",(e,t)=>this._getWorkerSource(e,t.type,t.source).reloadTile(t)),this.actor.registerMessageHandler("AT",(e,t)=>this._getWorkerSource(e,t.type,t.source).abortTile(t)),this.actor.registerMessageHandler("RMT",(e,t)=>this._getWorkerSource(e,t.type,t.source).removeTile(t)),this.actor.registerMessageHandler("RS",(t,n)=>e._(this,void 0,void 0,function*(){if(!this.workerSources[t]||!this.workerSources[t][n.type]||!this.workerSources[t][n.type][n.source])return;const e=this.workerSources[t][n.type][n.source];delete this.workerSources[t][n.type][n.source],void 0!==e.removeSource&&e.removeSource(n)})),this.actor.registerMessageHandler("RM",t=>e._(this,void 0,void 0,function*(){delete this.layerIndexes[t],delete this.availableImages[t],delete this.workerSources[t],delete this.demWorkerSources[t]})),this.actor.registerMessageHandler("SR",(t,n)=>e._(this,void 0,void 0,function*(){this.referrer=n})),this.actor.registerMessageHandler("SRPS",(e,t)=>this._syncRTLPluginState(e,t)),this.actor.registerMessageHandler("IS",(t,n)=>e._(this,void 0,void 0,function*(){this.self.importScripts(n)})),this.actor.registerMessageHandler("SI",(e,t)=>this._setImages(e,t)),this.actor.registerMessageHandler("UL",(t,n)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).update(n.layers,n.removedIds)})),this.actor.registerMessageHandler("SL",(t,n)=>e._(this,void 0,void 0,function*(){this._getLayerIndex(t).replace(n)}))}_setImages(t,n){return e._(this,void 0,void 0,function*(){this.availableImages[t]=n;for(const e in this.workerSources[t]){const r=this.workerSources[t][e];for(const e in r)r[e].availableImages=n}})}_syncRTLPluginState(t,n){return e._(this,void 0,void 0,function*(){if(e.bD.isParsed())return e.bD.getState();if("loading"!==n.pluginStatus)return e.bD.setState(n),n;const t=n.pluginURL;if(this.self.importScripts(t),e.bD.isParsed()){const n={pluginStatus:"loaded",pluginURL:t};return e.bD.setState(n),n}throw e.bD.setState({pluginStatus:"error",pluginURL:""}),new Error("RTL Text Plugin failed to import scripts from ".concat(t))})}_getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}_getLayerIndex(e){let n=this.layerIndexes[e];return n||(n=this.layerIndexes[e]=new t),n}_getWorkerSource(e,t,n){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][n]){const r={sendAsync:(t,n)=>(t.targetMapId=e,this.actor.sendAsync(t,n))};switch(t){case"vector":this.workerSources[e][t][n]=new a(r,this._getLayerIndex(e),this._getAvailableImages(e));break;case"geojson":this.workerSources[e][t][n]=new ye(r,this._getLayerIndex(e),this._getAvailableImages(e));break;default:this.workerSources[e][t][n]=new this.externalWorkerSourceTypes[t](r,this._getLayerIndex(e),this._getAvailableImages(e))}}return this.workerSources[e][t][n]}_getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new o),this.demWorkerSources[e][t]}}return e.i(self)&&(self.worker=new ve(self)),ve}),n("index",["exports","./shared"],function(e,t){var n="4.7.1";let r,i;const a={now:"undefined"!=typeof performance&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frameAsync:e=>new Promise((n,r)=>{const i=requestAnimationFrame(n);e.signal.addEventListener("abort",()=>{cancelAnimationFrame(i),r(t.c())})}),getImageData(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getImageCanvasContext(e).getImageData(-t,-t,e.width+2*t,e.height+2*t)},getImageCanvasContext(e){const t=window.document.createElement("canvas"),n=t.getContext("2d",{willReadFrequently:!0});if(!n)throw new Error("failed to create canvas 2d context");return t.width=e.width,t.height=e.height,n.drawImage(e,0,0,e.width,e.height),n},resolveURL:e=>(r||(r=document.createElement("a")),r.href=e,r.href),hardwareConcurrency:"undefined"!=typeof navigator&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==i&&(i=matchMedia("(prefers-reduced-motion: reduce)")),i.matches)}};class o{static testProp(e){if(!o.docStyle)return e[0];for(let t=0;t<e.length;t++)if(e[t]in o.docStyle)return e[t];return e[0]}static create(e,t,n){const r=window.document.createElement(e);return void 0!==t&&(r.className=t),n&&n.appendChild(r),r}static createNS(e,t){return window.document.createElementNS(e,t)}static disableDrag(){o.docStyle&&o.selectProp&&(o.userSelect=o.docStyle[o.selectProp],o.docStyle[o.selectProp]="none")}static enableDrag(){o.docStyle&&o.selectProp&&(o.docStyle[o.selectProp]=o.userSelect)}static setTransform(e,t){e.style[o.transformProp]=t}static addEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.addEventListener(t,n,"passive"in r?r:r.capture)}static removeEventListener(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.removeEventListener(t,n,"passive"in r?r:r.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",o.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",o.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",o.suppressClickInternal,!0)},0)}static getScale(e){const t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}static getPoint(e,n,r){const i=n.boundingClientRect;return new t.P((r.clientX-i.left)/n.x-e.clientLeft,(r.clientY-i.top)/n.y-e.clientTop)}static mousePos(e,t){const n=o.getScale(e);return o.getPoint(e,n,t)}static touchPos(e,t){const n=[],r=o.getScale(e);for(let i=0;i<t.length;i++)n.push(o.getPoint(e,r,t[i]));return n}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}}o.docStyle="undefined"!=typeof window&&window.document&&window.document.documentElement.style,o.selectProp=o.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),o.transformProp=o.testProp(["transform","WebkitTransform"]);const s={supported:!1,testSupport:function(e){!c&&u&&(d?h(e):l=e)}};let l,u,c=!1,d=!1;function h(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,u),e.isContextLost())return;s.supported=!0}catch(e){}e.deleteTexture(t),c=!0}var f;"undefined"!=typeof document&&(u=document.createElement("img"),u.onload=()=>{l&&h(l),l=null,d=!0},u.onerror=()=>{c=!0,l=null},u.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(e){let n,r,i,a;e.resetRequestQueue=()=>{n=[],r=0,i=0,a={}},e.addThrottleControl=e=>{const t=i++;return a[t]=e,t},e.removeThrottleControl=e=>{delete a[e],l()},e.getImage=function(e,r){let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return new Promise((a,o)=>{s.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),t.e(e,{type:"image"}),n.push({abortController:r,requestParameters:e,supportImageRefresh:i,state:"queued",onError:e=>{o(e)},onSuccess:e=>{a(e)}}),l()})};const o=e=>t._(this,void 0,void 0,function*(){e.state="running";const{requestParameters:n,supportImageRefresh:i,onError:a,onSuccess:o,abortController:s}=e,c=!1===i&&!t.i(self)&&!t.g(n.url)&&(!n.headers||Object.keys(n.headers).reduce((e,t)=>e&&"accept"===t,!0));r++;const d=c?u(n,s):t.m(n,s);try{const n=yield d;delete e.abortController,e.state="completed",n.data instanceof HTMLImageElement||t.b(n.data)?o(n):n.data&&o({data:yield(h=n.data,"function"==typeof createImageBitmap?t.d(h):t.f(h)),cacheControl:n.cacheControl,expires:n.expires})}catch(t){delete e.abortController,a(t)}finally{r--,l()}var h}),l=()=>{const e=(()=>{for(const e of Object.keys(a))if(a[e]())return!0;return!1})()?t.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:t.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let t=r;t<e&&n.length>0;t++){const e=n.shift();e.abortController.signal.aborted?t--:o(e)}},u=(e,n)=>new Promise((r,i)=>{const a=new Image,o=e.url,s=e.credentials;s&&"include"===s?a.crossOrigin="use-credentials":(s&&"same-origin"===s||!t.s(o))&&(a.crossOrigin="anonymous"),n.signal.addEventListener("abort",()=>{a.src="",i(t.c())}),a.fetchPriority="high",a.onload=()=>{a.onerror=a.onload=null,r({data:a})},a.onerror=()=>{a.onerror=a.onload=null,n.signal.aborted||i(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},a.src=o})}(f||(f={})),f.resetRequestQueue();class p{constructor(e){this._transformRequestFn=e}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function m(e){var n=new t.A(3);return n[0]=e[0],n[1]=e[1],n[2]=e[2],n}var g,y=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e};g=new t.A(3),t.A!=Float32Array&&(g[0]=0,g[1]=0,g[2]=0);var v=function(e){var t=e[0],n=e[1];return t*t+n*n};function _(e){const t=[];if("string"==typeof e)t.push({id:"default",url:e});else if(e&&e.length>0){const n=[];for(const{id:r,url:i}of e){const e="".concat(r).concat(i);-1===n.indexOf(e)&&(n.push(e),t.push({id:r,url:i}))}}return t}function b(e,t,n){const r=e.split("?");return r[0]+="".concat(t).concat(n),r.join("?")}!function(){var e=new t.A(2);t.A!=Float32Array&&(e[0]=0,e[1]=0)}();class x{constructor(e,t,n,r){this.context=e,this.format=n,this.texture=e.gl.createTexture(),this.update(t,r)}update(e,n,r){const{width:i,height:a}=e,o=!(this.size&&this.size[0]===i&&this.size[1]===a||r),{context:s}=this,{gl:l}=s;if(this.useMipmap=Boolean(n&&n.useMipmap),l.bindTexture(l.TEXTURE_2D,this.texture),s.pixelStoreUnpackFlipY.set(!1),s.pixelStoreUnpack.set(1),s.pixelStoreUnpackPremultiplyAlpha.set(this.format===l.RGBA&&(!n||!1!==n.premultiply)),o)this.size=[i,a],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texImage2D(l.TEXTURE_2D,0,this.format,this.format,l.UNSIGNED_BYTE,e):l.texImage2D(l.TEXTURE_2D,0,this.format,i,a,0,this.format,l.UNSIGNED_BYTE,e.data);else{const{x:n,y:o}=r||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||t.b(e)?l.texSubImage2D(l.TEXTURE_2D,0,n,o,l.RGBA,l.UNSIGNED_BYTE,e):l.texSubImage2D(l.TEXTURE_2D,0,n,o,i,a,l.RGBA,l.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&l.generateMipmap(l.TEXTURE_2D)}bind(e,t,n){const{context:r}=this,{gl:i}=r;i.bindTexture(i.TEXTURE_2D,this.texture),n!==i.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(n=i.LINEAR),e!==this.filter&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,n||e),this.filter=e),t!==this.wrap&&(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function w(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class k extends t.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new t.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,promiseResolve:t}of this.requestors)t(this._getImagesForIds(e));this.requestors=[]}}getImage(e){const n=this.images[e];if(n&&!n.data&&n.spriteData){const e=n.spriteData;n.data=new t.R({width:e.width,height:e.height},e.context.getImageData(e.x,e.y,e.width,e.height).data),n.spriteData=null}return n}addImage(e,t){if(this.images[e])throw new Error("Image id ".concat(e," already exist, use updateImage instead"));this._validate(e,t)&&(this.images[e]=t)}_validate(e,n){let r=!0;const i=n.data||n.spriteData;return this._validateStretch(n.stretchX,i&&i.width)||(this.fire(new t.j(new Error('Image "'.concat(e,'" has invalid "stretchX" value')))),r=!1),this._validateStretch(n.stretchY,i&&i.height)||(this.fire(new t.j(new Error('Image "'.concat(e,'" has invalid "stretchY" value')))),r=!1),this._validateContent(n.content,n)||(this.fire(new t.j(new Error('Image "'.concat(e,'" has invalid "content" value')))),r=!1),r}_validateStretch(e,t){if(!e)return!0;let n=0;for(const r of e){if(r[0]<n||r[1]<r[0]||t<r[1])return!1;n=r[1]}return!0}_validateContent(e,t){if(!e)return!0;if(4!==e.length)return!1;const n=t.spriteData,r=n&&n.width||t.data.width,i=n&&n.height||t.data.height;return!(e[0]<0||r<e[0]||e[1]<0||i<e[1]||e[2]<0||r<e[2]||e[3]<0||i<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this.getImage(e);if(n&&(r.data.width!==t.data.width||r.data.height!==t.data.height))throw new Error("size mismatch between old image (".concat(r.data.width,"x").concat(r.data.height,") and new image (").concat(t.data.width,"x").concat(t.data.height,")."));t.version=r.version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((t,n)=>{let r=!0;if(!this.isLoaded())for(const i of e)this.images[i]||(r=!1);this.isLoaded()||r?t(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:t})})}_getImagesForIds(e){const n={};for(const r of e){let e=this.getImage(r);e||(this.fire(new t.k("styleimagemissing",{id:r})),e=this.getImage(r)),e?n[r]={data:e.data.clone(),pixelRatio:e.pixelRatio,sdf:e.sdf,version:e.version,stretchX:e.stretchX,stretchY:e.stretchY,content:e.content,textFitWidth:e.textFitWidth,textFitHeight:e.textFitHeight,hasRenderCallback:Boolean(e.userImage&&e.userImage.render)}:t.w('Image "'.concat(r,'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.'))}return n}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(e){const n=this.patterns[e],r=this.getImage(e);if(!r)return null;if(n&&n.position.version===r.version)return n.position;if(n)n.position.version=r.version;else{const n={w:r.data.width+2,h:r.data.height+2,x:0,y:0},i=new t.I(n,r);this.patterns[e]={bin:n,position:i}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const t=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new x(e,this.atlasImage,t.RGBA),this.atlasTexture.bind(t.LINEAR,t.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const t in this.patterns)e.push(this.patterns[t].bin);const{w:n,h:r}=t.p(e),i=this.atlasImage;i.resize({width:n||1,height:r||1});for(const a in this.patterns){const{bin:e}=this.patterns[a],n=e.x+1,r=e.y+1,o=this.getImage(a).data,s=o.width,l=o.height;t.R.copy(o,i,{x:0,y:0},{x:n,y:r},{width:s,height:l}),t.R.copy(o,i,{x:0,y:l-1},{x:n,y:r-1},{width:s,height:1}),t.R.copy(o,i,{x:0,y:0},{x:n,y:r+l},{width:s,height:1}),t.R.copy(o,i,{x:s-1,y:0},{x:n-1,y:r},{width:1,height:l}),t.R.copy(o,i,{x:0,y:0},{x:n+s,y:r},{width:1,height:l})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const n of e){if(this.callbackDispatchedThisFrame[n])continue;this.callbackDispatchedThisFrame[n]=!0;const e=this.getImage(n);e||t.w('Image with ID: "'.concat(n,'" was not found')),w(e)&&this.updateImage(n,e)}}}const S=1e20;function E(e,t,n,r,i,a,o,s,l){for(let u=t;u<t+r;u++)C(e,n*a+u,a,i,o,s,l);for(let u=n;u<n+i;u++)C(e,u*a+t,1,r,o,s,l)}function C(e,t,n,r,i,a,o){a[0]=0,o[0]=-S,o[1]=S,i[0]=e[t];for(let s=1,l=0,u=0;s<r;s++){i[s]=e[t+s*n];const r=s*s;do{const e=a[l];u=(i[s]-i[e]+r-e*e)/(s-e)/2}while(u<=o[l]&&--l>-1);l++,a[l]=s,o[l]=u,o[l+1]=S}for(let s=0,l=0;s<r;s++){for(;o[l+1]<s;)l++;const r=a[l],u=s-r;e[t+s*n]=i[r]+u*u}}class P{constructor(e,t){this.requestManager=e,this.localIdeographFontFamily=t,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return t._(this,void 0,void 0,function*(){const t=[];for(const i in e)for(const n of e[i])t.push(this._getAndCacheGlyphsPromise(i,n));const n=yield Promise.all(t),r={};for(const{stack:e,id:i,glyph:a}of n)r[e]||(r[e]={}),r[e][i]=a&&{id:a.id,bitmap:a.bitmap.clone(),metrics:a.metrics};return r})}_getAndCacheGlyphsPromise(e,n){return t._(this,void 0,void 0,function*(){let t=this.entries[e];t||(t=this.entries[e]={glyphs:{},requests:{},ranges:{}});let r=t.glyphs[n];if(void 0!==r)return{stack:e,id:n,glyph:r};if(r=this._tinySDF(t,e,n),r)return t.glyphs[n]=r,{stack:e,id:n,glyph:r};const i=Math.floor(n/256);if(256*i>65535)throw new Error("glyphs > 65535 not supported");if(t.ranges[i])return{stack:e,id:n,glyph:r};if(!this.url)throw new Error("glyphsUrl is not set");if(!t.requests[i]){const n=P.loadGlyphRange(e,i,this.url,this.requestManager);t.requests[i]=n}const a=yield t.requests[i];for(const e in a)this._doesCharSupportLocalGlyph(+e)||(t.glyphs[+e]=a[+e]);return t.ranges[i]=!0,{stack:e,id:n,glyph:a[n]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&/(?:[\u3006\u3007\u3021-\u3029\u3038-\u303A\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFE4\uDFF2-\uDFF6]|[\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82C[\uDD70-\uDEFB]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])|[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|(?:[\u3041-\u3096\u309D-\u309F]|\uD82C[\uDC01-\uDD1F\uDD32\uDD50-\uDD52]|\uD83C\uDE00)|(?:[\u30A1-\u30FA\u30FD-\u30FF\u31F0-\u31FF\u32D0-\u32FE\u3300-\u3357\uFF66-\uFF6F\uFF71-\uFF9D]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00\uDD20-\uDD22\uDD55\uDD64-\uDD67])/.test(String.fromCodePoint(e))}_tinySDF(e,n,r){const i=this.localIdeographFontFamily;if(!i)return;if(!this._doesCharSupportLocalGlyph(r))return;let a=e.tinySDF;if(!a){let t="400";/bold/i.test(n)?t="900":/medium/i.test(n)?t="500":/light/i.test(n)&&(t="200"),a=e.tinySDF=new P.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:i,fontWeight:t})}const o=a.draw(String.fromCharCode(r));return{id:r,bitmap:new t.o({width:o.width||60,height:o.height||60},o.data),metrics:{width:o.glyphWidth/2||24,height:o.glyphHeight/2||24,left:o.glyphLeft/2+.5||0,top:o.glyphTop/2-27.5||-8,advance:o.glyphAdvance/2||24,isDoubleResolution:!0}}}}P.loadGlyphRange=function(e,n,r,i){return t._(this,void 0,void 0,function*(){const a=256*n,o=a+255,s=i.transformRequest(r.replace("{fontstack}",e).replace("{range}","".concat(a,"-").concat(o)),"Glyphs"),l=yield t.l(s,new AbortController);if(!l||!l.data)throw new Error("Could not load glyph range. range: ".concat(n,", ").concat(a,"-").concat(o));const u={};for(const e of t.n(l.data))u[e.id]=e;return u})},P.TinySDF=class{constructor(){let{fontSize:e=24,buffer:t=3,radius:n=8,cutoff:r=.25,fontFamily:i="sans-serif",fontWeight:a="normal",fontStyle:o="normal"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.buffer=t,this.cutoff=r,this.radius=n;const s=this.size=e+4*t,l=this._createCanvas(s),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font="".concat(o," ").concat(a," ").concat(e,"px ").concat(i),u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:n,actualBoundingBoxDescent:r,actualBoundingBoxLeft:i,actualBoundingBoxRight:a}=this.ctx.measureText(e),o=Math.ceil(n),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-i))),l=Math.min(this.size-this.buffer,o+Math.ceil(r)),u=s+2*this.buffer,c=l+2*this.buffer,d=Math.max(u*c,0),h=new Uint8ClampedArray(d),f={data:h,width:u,height:c,glyphWidth:s,glyphHeight:l,glyphTop:o,glyphLeft:0,glyphAdvance:t};if(0===s||0===l)return f;const{ctx:p,buffer:m,gridInner:g,gridOuter:y}=this;p.clearRect(m,m,s,l),p.fillText(e,m,m+o);const v=p.getImageData(m,m,s,l);y.fill(S,0,d),g.fill(0,0,d);for(let _=0;_<l;_++)for(let e=0;e<s;e++){const t=v.data[4*(_*s+e)+3]/255;if(0===t)continue;const n=(_+m)*u+e+m;if(1===t)y[n]=0,g[n]=S;else{const e=.5-t;y[n]=e>0?e*e:0,g[n]=e<0?e*e:0}}E(y,0,0,u,c,u,this.f,this.v,this.z),E(g,m,m,s,l,u,this.f,this.v,this.z);for(let _=0;_<d;_++){const e=Math.sqrt(y[_])-Math.sqrt(g[_]);h[_]=Math.round(255-255*(e/this.radius+this.cutoff))}return f}};class D{constructor(){this.specification=t.v.light.position}possiblyEvaluate(e,n){return t.x(e.expression.evaluate(n))}interpolate(e,n,r){return{x:t.y.number(e.x,n.x,r),y:t.y.number(e.y,n.y,r),z:t.y.number(e.z,n.z,r)}}}let I;class T extends t.E{constructor(e){super(),I=I||new t.q({anchor:new t.D(t.v.light.anchor),position:new D,color:new t.D(t.v.light.color),intensity:new t.D(t.v.light.intensity)}),this._transitionable=new t.T(I),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.r,e,n))for(const t in e){const n=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),n):this._transitionable.setValue(t,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n,r){return(!r||!1!==r.validate)&&t.t(this,e.call(t.u,{value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.v}))}}const A=new t.q({"sky-color":new t.D(t.v.sky["sky-color"]),"horizon-color":new t.D(t.v.sky["horizon-color"]),"fog-color":new t.D(t.v.sky["fog-color"]),"fog-ground-blend":new t.D(t.v.sky["fog-ground-blend"]),"horizon-fog-blend":new t.D(t.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new t.D(t.v.sky["sky-horizon-blend"]),"atmosphere-blend":new t.D(t.v.sky["atmosphere-blend"])});class z extends t.E{constructor(e){super(),this._transitionable=new t.T(A),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new t.z(0))}setSky(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this._validate(t.B,e,n)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const t in e){const n=e[t];t.endsWith("-transition")?this._transitionable.setTransition(t.slice(0,-11),n):this._transitionable.setValue(t,n)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return!1!==(null==r?void 0:r.validate)&&t.t(this,e.call(t.u,t.e({value:n,style:{glyphs:!0,sprite:!0},styleSpec:t.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class O{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,t){const n=e.join(",")+String(t);return this.dashEntry[n]||(this.dashEntry[n]=this.addDash(e,t)),this.dashEntry[n]}getDashRanges(e,t,n){const r=[];let i=e.length%2==1?-e[e.length-1]*n:0,a=e[0]*n,o=!0;r.push({left:i,right:a,isDash:o,zeroLength:0===e[0]});let s=e[0];for(let l=1;l<e.length;l++){o=!o;const t=e[l];i=s*n,s+=t,a=s*n,r.push({left:i,right:a,isDash:o,zeroLength:0===t})}return r}addRoundDash(e,t,n){const r=t/2;for(let i=-n;i<=n;i++){const t=this.width*(this.nextRow+n+i);let a=0,o=e[a];for(let s=0;s<this.width;s++){s/o.right>1&&(o=e[++a]);const l=Math.abs(s-o.left),u=Math.abs(s-o.right),c=Math.min(l,u);let d;const h=i/n*(r+1);if(o.isDash){const e=r-Math.abs(h);d=Math.sqrt(c*c+e*e)}else d=r-Math.sqrt(c*c+h*h);this.data[t+s]=Math.max(0,Math.min(255,d+128))}}}addRegularDash(e){for(let o=e.length-1;o>=0;--o){const t=e[o],n=e[o+1];t.zeroLength?e.splice(o,1):n&&n.isDash===t.isDash&&(n.left=t.left,e.splice(o,1))}const t=e[0],n=e[e.length-1];t.isDash===n.isDash&&(t.left=n.left-this.width,n.right=t.right+this.width);const r=this.width*this.nextRow;let i=0,a=e[i];for(let o=0;o<this.width;o++){o/a.right>1&&(a=e[++i]);const t=Math.abs(o-a.left),n=Math.abs(o-a.right),s=Math.min(t,n);this.data[r+o]=Math.max(0,Math.min(255,(a.isDash?s:-s)+128))}}addDash(e,n){const r=n?7:0,i=2*r+1;if(this.nextRow+i>this.height)return t.w("LineAtlas out of space"),null;let a=0;for(let t=0;t<e.length;t++)a+=e[t];if(0!==a){const t=this.width/a,i=this.getDashRanges(e,this.width,t);n?this.addRoundDash(i,t,r):this.addRegularDash(i)}const o={y:(this.nextRow+r+.5)/this.height,height:2*r/this.height,width:a};return this.nextRow+=i,this.dirty=!0,o}bind(e){const t=e.gl;this.texture?(t.bindTexture(t.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,t.texSubImage2D(t.TEXTURE_2D,0,0,0,this.width,this.height,t.ALPHA,t.UNSIGNED_BYTE,this.data))):(this.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.ALPHA,this.width,this.height,0,t.ALPHA,t.UNSIGNED_BYTE,this.data))}}const F="maplibre_preloaded_worker_pool";class M{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<M.workerCount;)this.workers.push(new Worker(t.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach(e=>{e.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[F]}numActive(){return Object.keys(this.active).length}}const j=Math.floor(a.hardwareConcurrency/2);let B,R;function L(){return B||(B=new M),B}M.workerCount=t.C(globalThis)?Math.max(Math.min(j,3),1):1;class N{constructor(e,n){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=n;const r=this.workerPool.acquire(n);for(let i=0;i<r.length;i++){const e=new t.F(r[i],n);e.name="Worker ".concat(i),this.actors.push(e)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,t){const n=[];for(const r of this.actors)n.push(r.sendAsync({type:e,data:t}));return Promise.all(n)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.actors.forEach(e=>{e.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,t){for(const n of this.actors)n.registerMessageHandler(e,t)}}function U(){return R||(R=new N(L(),t.G),R.registerMessageHandler("GR",(e,n,r)=>t.m(n,r))),R}function V(e,n){const r=t.H();return t.J(r,r,[1,1,0]),t.K(r,r,[.5*e.width,.5*e.height,1]),t.L(r,r,e.calculatePosMatrix(n.toUnwrapped()))}function q(e,t,n,r,i,a){const o=function(e,t,n){if(e)for(const r of e){const e=t[r];if(e&&e.source===n&&"fill-extrusion"===e.type)return!0}else for(const r in t){const e=t[r];if(e.source===n&&"fill-extrusion"===e.type)return!0}return!1}(i&&i.layers,t,e.id),s=a.maxPitchScaleFactor(),l=e.tilesIn(r,s,o);l.sort(H);const u=[];for(const d of l)u.push({wrappedTileID:d.tileID.wrapped().key,queryResults:d.tile.queryRenderedFeatures(t,n,e._state,d.queryGeometry,d.cameraQueryGeometry,d.scale,i,a,s,V(e.transform,d.tileID))});const c=function(e){const t={},n={};for(const r of e){const e=r.queryResults,i=r.wrappedTileID,a=n[i]=n[i]||{};for(const n in e){const r=e[n],i=a[n]=a[n]||{},o=t[n]=t[n]||[];for(const e of r)i[e.featureIndex]||(i[e.featureIndex]=!0,o.push(e))}}return t}(u);for(const d in c)c[d].forEach(t=>{const n=t.feature,r=e.getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=r});return c}function H(e,t){const n=e.tileID,r=t.tileID;return n.overscaledZ-r.overscaledZ||n.canonical.y-r.canonical.y||n.wrap-r.wrap||n.canonical.x-r.canonical.x}function W(e,n,r){return t._(this,void 0,void 0,function*(){let i=e;if(e.url?i=(yield t.h(n.transformRequest(e.url,"Source"),r)).data:yield a.frameAsync(r),!i)return null;const o=t.M(t.e(i,e),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in i&&i.vector_layers&&(o.vectorLayerIds=i.vector_layers.map(e=>e.id)),o})}class Z{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):Array.isArray(e)&&(4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof t.N?new t.N(e.lng,e.lat):t.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof t.N?new t.N(e.lng,e.lat):t.N.convert(e),this}extend(e){const n=this._sw,r=this._ne;let i,a;if(e instanceof t.N)i=e,a=e;else{if(!(e instanceof Z))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Z.convert(e)):this.extend(t.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(t.N.convert(e)):this;if(i=e._sw,a=e._ne,!i||!a)return this}return n||r?(n.lng=Math.min(i.lng,n.lng),n.lat=Math.min(i.lat,n.lat),r.lng=Math.max(a.lng,r.lng),r.lat=Math.max(a.lat,r.lat)):(this._sw=new t.N(i.lng,i.lat),this._ne=new t.N(a.lng,a.lat)),this}getCenter(){return new t.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new t.N(this.getWest(),this.getNorth())}getSouthEast(){return new t.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return"LngLatBounds(".concat(this._sw.toString(),", ").concat(this._ne.toString(),")")}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:r}=t.N.convert(e);let i=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(i=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&i}static convert(e){return e instanceof Z?e:e?new Z(e):e}static fromLngLat(e){const n=360*(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)/40075017,r=n/Math.cos(Math.PI/180*e.lat);return new Z(new t.N(e.lng-r,e.lat-n),new t.N(e.lng+r,e.lat+n))}adjustAntiMeridian(){const e=new t.N(this._sw.lng,this._sw.lat),n=new t.N(this._ne.lng,this._ne.lat);return new Z(e,e.lng>n.lng?new t.N(n.lng+360,n.lat):n)}}class K{constructor(e,t,n){this.bounds=Z.convert(this.validateBounds(e)),this.minzoom=t||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const n=Math.pow(2,e.z),r=Math.floor(t.O(this.bounds.getWest())*n),i=Math.floor(t.Q(this.bounds.getNorth())*n),a=Math.ceil(t.O(this.bounds.getEast())*n),o=Math.ceil(t.Q(this.bounds.getSouth())*n);return e.x>=r&&e.x<a&&e.y>=i&&e.y<o}}class G extends t.E{constructor(e,n,r,i){if(super(),this.id=e,this.dispatcher=r,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,t.e(this,t.M(n,["url","scheme","tileSize","promoteId"])),this._options=t.e({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i)}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield W(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(t.e(this,e),e.bounds&&(this.tileBounds=new K(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return t.e({},this._options)}loadTile(e){return t._(this,void 0,void 0,function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),n={request:this.map._requestManager.transformRequest(t,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request.collectResourceTiming=this._collectResourceTiming;let r="RT";if(e.actor&&"expired"!==e.state){if("loading"===e.state)return new Promise((t,n)=>{e.reloadPromise={resolve:t,reject:n}})}else e.actor=this.dispatcher.getActor(),r="LT";e.abortController=new AbortController;try{const t=yield e.actor.sendAsync({type:r,data:n},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,t)}catch(t){if(delete e.abortController,e.aborted)return;if(t&&404!==t.status)throw t;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,t){if(t&&t.resourceTiming&&(e.resourceTiming=t.resourceTiming),t&&this.map._refreshExpiredTiles&&e.setExpiryData(t),e.loadVectorData(t,this.map.painter),e.reloadPromise){const t=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(t.resolve).catch(t.reject)}}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class X extends t.E{constructor(e,n,r,i){super(),this.id=e,this.dispatcher=r,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=t.e({type:"raster"},n),t.e(this,t.M(n,["url","scheme","tileSize"]))}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield W(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,e&&(t.e(this,e),e.bounds&&(this.tileBounds=new K(e.bounds,this.minzoom,this.maxzoom)),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new t.j(e))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return t.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return t._(this,void 0,void 0,function*(){const t=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const n=yield f.getImage(this.map._requestManager.transformRequest(t,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const t=this.map.painter.context,r=t.gl,i=n.data;e.texture=this.map.painter.getTileTexture(i.width),e.texture?e.texture.update(i,{useMipmap:!0}):(e.texture=new x(t,i,r.RGBA,{useMipmap:!0}),e.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE,r.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class $ extends X{constructor(e,n,r,i){super(e,n,r,i),this.type="raster-dem",this.maxzoom=22,this._options=t.e({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox",this.redFactor=n.redFactor,this.greenFactor=n.greenFactor,this.blueFactor=n.blueFactor,this.baseShift=n.baseShift}loadTile(e){return t._(this,void 0,void 0,function*(){const n=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),r=this.map._requestManager.transformRequest(n,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const n=yield f.getImage(r,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(n&&n.data){const r=n.data;this.map._refreshExpiredTiles&&n.cacheControl&&n.expires&&e.setExpiryData({cacheControl:n.cacheControl,expires:n.expires});const i=t.b(r)&&t.U()?r:yield this.readImageNow(r),a={type:this.type,uid:e.uid,source:this.id,rawImageData:i,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||"expired"===e.state){e.actor=this.dispatcher.getActor();const t=yield e.actor.sendAsync({type:"LDT",data:a});e.dem=t,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(t){if(delete e.abortController,e.aborted)e.state="unloaded";else if(t)throw e.state="errored",t}})}readImageNow(e){return t._(this,void 0,void 0,function*(){if("undefined"!=typeof VideoFrame&&t.V()){const n=e.width+2,r=e.height+2;try{return new t.R({width:n,height:r},yield t.W(e,-1,-1,n,r))}catch(e){}}return a.getImageData(e,1)})}_getNeighboringTiles(e){const n=e.canonical,r=Math.pow(2,n.z),i=(n.x-1+r)%r,a=0===n.x?e.wrap-1:e.wrap,o=(n.x+1+r)%r,s=n.x+1===r?e.wrap+1:e.wrap,l={};return l[new t.S(e.overscaledZ,a,n.z,i,n.y).key]={backfilled:!1},l[new t.S(e.overscaledZ,s,n.z,o,n.y).key]={backfilled:!1},n.y>0&&(l[new t.S(e.overscaledZ,a,n.z,i,n.y-1).key]={backfilled:!1},l[new t.S(e.overscaledZ,e.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},l[new t.S(e.overscaledZ,s,n.z,o,n.y-1).key]={backfilled:!1}),n.y+1<r&&(l[new t.S(e.overscaledZ,a,n.z,i,n.y+1).key]={backfilled:!1},l[new t.S(e.overscaledZ,e.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},l[new t.S(e.overscaledZ,s,n.z,o,n.y+1).key]={backfilled:!1}),l}unloadTile(e){return t._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Y extends t.E{constructor(e,n,r,i){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=r.getActor(),this.setEventedParent(i),this._data=n.data,this._options=t.e({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const a=t.X/this.tileSize;void 0!==n.clusterMaxZoom&&this.maxzoom<=n.clusterMaxZoom&&t.w('The maxzoom value "'.concat(this.maxzoom,'" is expected to be greater than the clusterMaxZoom value "').concat(n.clusterMaxZoom,'".')),this.workerOptions=t.e({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*a,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*a,extent:t.X,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:t.X,radius:(n.clusterRadius||50)*a,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){return t._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return t._(this,void 0,void 0,function*(){const e=t.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(void 0!==e.clusterRadius&&(this.workerOptions.superclusterOptions.radius=e.clusterRadius),void 0!==e.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,t,n){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:t,offset:n}})}_updateWorkerData(e){return t._(this,void 0,void 0,function*(){const n=t.e({type:this.type},this.workerOptions);e?n.dataDiff=e:"string"==typeof this._data?(n.request=this.map._requestManager.transformRequest(a.resolveURL(this._data),"Source"),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new t.k("dataloading",{dataType:"source"}));try{const e=yield this.actor.sendAsync({type:"LD",data:n});if(this._pendingLoads--,this._removed||e.abandoned)return void this.fire(new t.k("dataabort",{dataType:"source"}));let r=null;e.resourceTiming&&e.resourceTiming[this.id]&&(r=e.resourceTiming[this.id].slice(0));const i={dataType:"source"};this._collectResourceTiming&&r&&r.length>0&&t.e(i,{resourceTiming:r}),this.fire(new t.k("data",Object.assign(Object.assign({},i),{sourceDataType:"metadata"}))),this.fire(new t.k("data",Object.assign(Object.assign({},i),{sourceDataType:"content"})))}catch(e){if(this._pendingLoads--,this._removed)return void this.fire(new t.k("dataabort",{dataType:"source"}));this.fire(new t.j(e))}})}loaded(){return 0===this._pendingLoads}loadTile(e){return t._(this,void 0,void 0,function*(){const t=e.actor?"RT":"LT";e.actor=this.actor;const n={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};e.abortController=new AbortController;const r=yield this.actor.sendAsync({type:t,data:n},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(r,this.map.painter,"RT"===t)})}abortTile(e){return t._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return t._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return t.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var J=t.Y([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Q extends t.E{constructor(e,t,n,r){super(),this.id=e,this.dispatcher=n,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(r),this.options=t}load(e){return t._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new t.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const t=yield f.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,t&&t.data&&(this.image=t.data,e&&(this.coordinates=e),this._finishLoading())}catch(e){this._request=null,this._loaded=!0,this.fire(new t.j(e))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new t.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const n=e.map(t.Z.fromLngLat);this.tileID=function(e){let n=1/0,r=1/0,i=-1/0,a=-1/0;for(const t of e)n=Math.min(n,t.x),r=Math.min(r,t.y),i=Math.max(i,t.x),a=Math.max(a,t.y);const o=Math.max(i-n,a-r),s=Math.max(0,Math.floor(-Math.log(o)/Math.LN2)),l=Math.pow(2,s);return new t.a1(s,Math.floor((n+i)/2*l),Math.floor((r+a)/2*l))}(n),this.minzoom=this.maxzoom=this.tileID.z;const r=n.map(e=>this.tileID.getTilePoint(e)._round());return this._boundsArray=new t.$,this._boundsArray.emplaceBack(r[0].x,r[0].y,0,0),this._boundsArray.emplaceBack(r[1].x,r[1].y,t.X,0),this._boundsArray.emplaceBack(r[3].x,r[3].y,0,t.X),this._boundsArray.emplaceBack(r[2].x,r[2].y,t.X,t.X),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new t.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,J.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture||(this.texture=new x(e,this.image,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return t._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ee extends Q{constructor(e,t,n,r){super(e,t,n,r),this.roundZoom=!0,this.type="video",this.options=t}load(){return t._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const t of e.urls)this.urls.push(this.map._requestManager.transformRequest(t,"Source").url);try{const e=yield t.a3(this.urls);if(this._loaded=!0,!e)return;this.video=e,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(e){this.fire(new t.j(e))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const n=this.video.seekable;e<n.start(0)||e>n.end(0)?this.fire(new t.j(new t.a2("sources.".concat(this.id),null,"Playback for this video can be set only between the ".concat(n.start(0)," and ").concat(n.end(0),"-second mark.")))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const e=this.map.painter.context,n=e.gl;this.boundsBuffer||(this.boundsBuffer=e.createVertexBuffer(this._boundsArray,J.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new x(e,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE));let r=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,r=!0)}r&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class te extends Q{constructor(e,n,r,i){super(e,n,r,i),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(e=>!Array.isArray(e)||2!==e.length||e.some(e=>"number"!=typeof e))||this.fire(new t.j(new t.a2("sources.".concat(e),null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new t.j(new t.a2("sources.".concat(e),null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new t.j(new t.a2("sources.".concat(e),null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof HTMLCanvasElement||this.fire(new t.j(new t.a2("sources.".concat(e),null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new t.j(new t.a2("sources.".concat(e),null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){return t._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new t.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,r=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,J.members)),this.boundsSegments||(this.boundsSegments=t.a0.simpleSegment(0,0,4,2)),this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new x(n,this.canvas,r.RGBA,{premultiply:!0});let i=!1;for(const t in this.tiles){const e=this.tiles[t];"loaded"!==e.state&&(e.state="loaded",e.texture=this.texture,i=!0)}i&&this.fire(new t.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const ne={},re=e=>{switch(e){case"geojson":return Y;case"image":return Q;case"raster":return X;case"raster-dem":return $;case"vector":return G;case"video":return ee;case"canvas":return te}return ne[e]},ie="RTLPluginLoaded";class ae extends t.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=U()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(e=>{throw this.status="error",e})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return t._(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){if(t.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(t.url=a.resolveURL(e),!t.url)throw new Error("requested url ".concat(e," is invalid"));if("unavailable"===t.status){if(!n)return t._requestImport();t.status="deferred",t._syncState(t.status)}else if("requested"===t.status)return t._requestImport()}()})}_requestImport(){return t._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new t.k(ie))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let oe=null;function se(){return oe||(oe=new ae),oe}class le{constructor(e,n){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=t.a4(),this.uses=0,this.tileSize=n,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const t=e+this.timeAdded;t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,n,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const n={};if(!t)return n;for(const r of e){const e=r.layerIds.map(e=>t.getLayer(e)).filter(Boolean);if(0!==e.length){r.layers=e,r.stateDependentLayerIds&&(r.stateDependentLayers=r.stateDependentLayerIds.map(t=>e.filter(e=>e.id===t)[0]));for(const t of e)n[t.id]=r}}return n}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.a6){if(this.hasSymbolBuckets=!0,!r)break;n.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const n=this.buckets[e];if(n instanceof t.a6&&n.hasRTLText){this.hasRTLText=!0,se().lazyLoad();break}}this.queryPadding=0;for(const e in this.buckets){const t=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(e).queryRadius(t))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new t.a5}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const n in this.buckets){const t=this.buckets[n];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new x(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new x(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,n,r,i,a,o,s,l,u){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:r,cameraQueryGeometry:i,scale:a,tileSize:this.tileSize,pixelPosMatrix:u,transform:s,params:o,queryPadding:this.queryPadding*l},e,t,n):{}}querySourceFeatures(e,n){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const i=r.loadVTLayers(),a=n&&n.sourceLayer?n.sourceLayer:"",o=i._geojsonTileLayer||i[a];if(!o)return;const s=t.a7(n&&n.filter),{z:l,x:u,y:c}=this.tileID.canonical,d={z:l,x:u,y:c};for(let h=0;h<o.length;h++){const n=o.feature(h);if(s.needGeometry){const e=t.a8(n,!0);if(!s.filter(new t.z(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!s.filter(new t.z(this.tileID.overscaledZ),n))continue;const i=r.getId(n,a),f=new t.a9(n,l,u,c,i);f.tile=d,e.push(f)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const n=t.aa(e.cacheControl);n["max-age"]&&(this.expirationTime=Date.now()+1e3*n["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let t=!1;if(this.expirationTime>e)t=!1;else if(n)if(this.expirationTime<n)t=!0;else{const r=this.expirationTime-n;r?this.expirationTime=e+Math.max(r,3e4):t=!0}else t=!0;t?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const n=this.latestFeatureIndex.loadVTLayers();for(const r in this.buckets){if(!t.style.hasLayer(r))continue;const i=this.buckets[r],a=i.layers[0].sourceLayer||"_geojsonTileLayer",o=n[a],s=e[a];if(!o||!s||0===Object.keys(s).length)continue;i.update(s,o,this.imageAtlas&&this.imageAtlas.patternPositions||{});const l=t&&t.style&&t.style.getLayer(r);l&&(this.queryPadding=Math.max(this.queryPadding,l.queryRadius(i)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<a.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=a.now()+e}setDependencies(e,t){const n={};for(const r of t)n[r]=!0;this.dependencies[e]=n}hasDependency(e,t){for(const n of e){const e=this.dependencies[n];if(e)for(const n of t)if(e[n])return!0}return!1}}class ue{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,n){const r=e.wrapped().key;void 0===this.data[r]&&(this.data[r]=[]);const i={value:t,timeout:void 0};if(void 0!==n&&(i.timeout=setTimeout(()=>{this.remove(e,i)},n)),this.data[r].push(i),this.order.push(r),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const n=e.wrapped().key,r=void 0===t?0:this.data[n].indexOf(t),i=this.data[n][r];return this.data[n].splice(r,1),i.timeout&&clearTimeout(i.timeout),0===this.data[n].length&&delete this.data[n],this.onRemove(i.value),this.order.splice(this.order.indexOf(n),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const n in this.data)for(const r of this.data[n])e(r.value)||t.push(r);for(const n of t)this.remove(n.value.tileID,n)}}class ce{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,r){const i=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][i]=this.stateChanges[e][i]||{},t.e(this.stateChanges[e][i],r),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==i&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][i]){this.deletedStates[e][i]={};for(const t in this.state[e][i])r[t]||(this.deletedStates[e][i][t]=null)}else for(const t in r)this.deletedStates[e]&&this.deletedStates[e][i]&&null===this.deletedStates[e][i][t]&&delete this.deletedStates[e][i][t]}removeFeatureState(e,t,n){if(null===this.deletedStates[e])return;const r=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},n&&void 0!==t)null!==this.deletedStates[e][r]&&(this.deletedStates[e][r]=this.deletedStates[e][r]||{},this.deletedStates[e][r][n]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][r])for(n in this.deletedStates[e][r]={},this.stateChanges[e][r])this.deletedStates[e][r][n]=null;else this.deletedStates[e][r]=null;else this.deletedStates[e]=null}getState(e,n){const r=String(n),i=t.e({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const t=this.deletedStates[e][n];if(null===t)return{};for(const e in t)delete i[e]}return i}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,n){const r={};for(const i in this.stateChanges){this.state[i]=this.state[i]||{};const e={};for(const n in this.stateChanges[i])this.state[i][n]||(this.state[i][n]={}),t.e(this.state[i][n],this.stateChanges[i][n]),e[n]=this.state[i][n];r[i]=e}for(const i in this.deletedStates){this.state[i]=this.state[i]||{};const e={};if(null===this.deletedStates[i])for(const t in this.state[i])e[t]={},this.state[i][t]={};else for(const t in this.deletedStates[i]){if(null===this.deletedStates[i][t])this.state[i][t]={};else for(const e of Object.keys(this.deletedStates[i][t]))delete this.state[i][t][e];e[t]=this.state[i][t]}r[i]=r[i]||{},t.e(r[i],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const t in e)e[t].setFeatureState(r,n)}}class de extends t.E{constructor(e,t,n){super(),this.id=e,this.dispatcher=n,this.on("data",e=>this._dataHandler(e)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((e,t,n,r)=>{const i=new(re(t.type))(e,t,n,r);if(i.id!==e)throw new Error("Expected Source id to be ".concat(e," instead of ").concat(i.id));return i})(e,t,n,this),this._tiles={},this._cache=new ue(0,e=>this._unloadTile(e)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ce,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,n,r){return t._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,n,r)}catch(n){e.state="errored",404!==n.status?this._source.fire(new t.j(n,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new t.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const n=this._tiles[t];n.upload(e),n.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(he).map(e=>e.key)}getRenderableIds(e){const n=[];for(const t in this._tiles)this._isIdRenderable(t,e)&&n.push(this._tiles[t]);return e?n.sort((e,n)=>{const r=e.tileID,i=n.tileID,a=new t.P(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),o=new t.P(i.canonical.x,i.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-i.overscaledZ||o.y-a.y||o.x-a.x}).map(e=>e.tileID.key):n.map(e=>e.tileID).sort(he).map(e=>e.key)}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(e,"reloading")}}_reloadTile(e,n){return t._(this,void 0,void 0,function*(){const t=this._tiles[e];t&&("loading"!==t.state&&(t.state=n),yield this._loadTile(t,e,n))})}_tileLoaded(e,n,r){e.timeAdded=a.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new t.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const t=this.getRenderableIds();for(let r=0;r<t.length;r++){const i=t[r];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);n(e,t),n(t,e)}}function n(e,t){e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0;let n=t.tileID.canonical.x-e.tileID.canonical.x;const r=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),a=t.tileID.key;0===n&&0===r||Math.abs(r)>1||(Math.abs(n)>1&&(1===Math.abs(n+i)?n+=i:1===Math.abs(n-i)&&(n-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,n,r),e.neighboringTiles&&e.neighboringTiles[a]&&(e.neighboringTiles[a].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,n,r){for(const i in this._tiles){let a=this._tiles[i];if(r[i]||!a.hasData()||a.tileID.overscaledZ<=t||a.tileID.overscaledZ>n)continue;let o=a.tileID;for(;a&&a.tileID.overscaledZ>t+1;){const e=a.tileID.scaledTo(a.tileID.overscaledZ-1);a=this._tiles[e.key],a&&a.hasData()&&(o=e)}let s=o;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]){r[o.key]=o;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const n=this._loadedParentTiles[e.key];return n&&n.tileID.overscaledZ>=t?n:null}for(let n=e.overscaledZ-1;n>=t;n--){const t=e.scaledTo(n),r=this._getLoadedTile(t);if(r)return r}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const n=Math.ceil(e.width/this._source.tileSize)+1,r=Math.ceil(e.height/this._source.tileSize)+1,i=Math.floor(n*r*(null===this._maxTileCacheZoomLevels?t.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,i):i;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const n in this._tiles){const r=this._tiles[n];r.tileID=r.tileID.unwrapTo(r.tileID.wrap+t),e[r.tileID.key]=r}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(t,this._tiles[t])}}_updateCoveredAndRetainedTiles(e,t,n,r,i,o){const s={},l={},u=Object.keys(e),c=a.now();for(const a of u){const n=e[a],r=this._tiles[a];if(!r||0!==r.fadeEndTime&&r.fadeEndTime<=c)continue;const i=this.findLoadedParent(n,t),o=this.findLoadedSibling(n),u=i||o||null;u&&(this._addTile(u.tileID),s[u.tileID.key]=u.tileID),l[a]=n}this._retainLoadedChildren(l,r,n,e);for(const a in s)e[a]||(this._coveredTiles[a]=!0,e[a]=s[a]);if(o){const t={},n={};for(const e of i)this._tiles[e.key].hasData()?t[e.key]=e:n[e.key]=e;for(const r in n){const i=n[r].children(this._source.maxzoom);this._tiles[i[0].key]&&this._tiles[i[1].key]&&this._tiles[i[2].key]&&this._tiles[i[3].key]&&(t[i[0].key]=e[i[0].key]=i[0],t[i[1].key]=e[i[1].key]=i[1],t[i[2].key]=e[i[2].key]=i[2],t[i[3].key]=e[i[3].key]=i[3],delete n[r])}for(const r in n){const i=n[r],a=this.findLoadedParent(i,this._source.minzoom),o=this.findLoadedSibling(i),s=a||o||null;if(s){t[s.tileID.key]=e[s.tileID.key]=s.tileID;for(const e in t)t[e].isChildOf(s.tileID)&&delete t[e]}}for(const e in this._tiles)t[e]||(this._coveredTiles[e]=!0)}}update(e,n){if(!this._sourceLoaded||this._paused)return;let r;this.transform=e,this.terrain=n,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?r=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(e=>new t.S(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y)):(r=e.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:n}),this._source.hasTile&&(r=r.filter(e=>this._source.hasTile(e)))):r=[];const i=e.coveringZoomLevel(this._source),a=Math.max(i-de.maxOverzooming,this._source.minzoom),o=Math.max(i+de.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const e={};for(const t of r)if(t.canonical.z>this._source.minzoom){const n=t.scaledTo(t.canonical.z-1);e[n.key]=n;const r=t.scaledTo(Math.max(this._source.minzoom,Math.min(t.canonical.z,5)));e[r.key]=r}r=r.concat(Object.values(e))}const s=0===r.length&&!this._updated&&this._didEmitContent;this._updated=!0,s&&this.fire(new t.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const l=this._updateRetainedTiles(r,i);fe(this._source.type)&&this._updateCoveredAndRetainedTiles(l,a,o,i,r,n);for(const t in l)this._tiles[t].clearFadeHold();const u=t.ab(this._tiles,l);for(const t of u){const e=this._tiles[t];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(t)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,t){var n;const r={},i={},a=Math.max(t-de.maxOverzooming,this._source.minzoom),o=Math.max(t+de.maxUnderzooming,this._source.minzoom),s={};for(const l of e){const e=this._addTile(l);r[l.key]=l,e.hasData()||t<this._source.maxzoom&&(s[l.key]=l)}this._retainLoadedChildren(s,t,o,r);for(const l of e){let e=this._tiles[l.key];if(e.hasData())continue;if(t+1>this._source.maxzoom){const e=l.children(this._source.maxzoom)[0],t=this.getTile(e);if(t&&t.hasData()){r[e.key]=e;continue}}else{const e=l.children(this._source.maxzoom);if(r[e[0].key]&&r[e[1].key]&&r[e[2].key]&&r[e[3].key])continue}let o=e.wasRequested();for(let t=l.overscaledZ-1;t>=a;--t){const a=l.scaledTo(t);if(i[a.key])break;if(i[a.key]=!0,e=this.getTile(a),!e&&o&&(e=this._addTile(a)),e){const t=e.hasData();if((t||!(null===(n=this.map)||void 0===n?void 0:n.cancelPendingTileRequestsWhileZooming)||o)&&(r[a.key]=a),o=e.wasRequested(),t)break}}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let n,r=this._tiles[e].tileID;for(;r.overscaledZ>0;){if(r.key in this._loadedParentTiles){n=this._loadedParentTiles[r.key];break}t.push(r.key);const e=r.scaledTo(r.overscaledZ-1);if(n=this._getLoadedTile(e),n)break;r=e}for(const e of t)this._loadedParentTiles[e]=n}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const t=this._tiles[e].tileID,n=this._getLoadedTile(t);this._loadedSiblingTiles[t.key]=n}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const r=n;return n||(n=new le(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(n,e.key,n.state)),n.uses++,this._tiles[e.key]=n,r||this._source.fire(new t.k("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const n=t.getExpiryTimeout();n&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},n))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}_dataHandler(e){const t=e.sourceDataType;"source"===e.dataType&&"metadata"===t&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===t&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,n,r){const i=[],a=this.transform;if(!a)return i;const o=r?a.getCameraQueryGeometry(e):e,s=e.map(e=>a.pointCoordinate(e,this.terrain)),l=o.map(e=>a.pointCoordinate(e,this.terrain)),u=this.getIds();let c=1/0,d=1/0,h=-1/0,f=-1/0;for(const t of l)c=Math.min(c,t.x),d=Math.min(d,t.y),h=Math.max(h,t.x),f=Math.max(f,t.y);for(let p=0;p<u.length;p++){const e=this._tiles[u[p]];if(e.holdingForFade())continue;const r=e.tileID,o=Math.pow(2,a.zoom-e.tileID.overscaledZ),m=n*e.queryPadding*t.X/e.tileSize/o,g=[r.getTilePoint(new t.Z(c,d)),r.getTilePoint(new t.Z(h,f))];if(g[0].x-m<t.X&&g[0].y-m<t.X&&g[1].x+m>=0&&g[1].y+m>=0){const t=s.map(e=>r.getTilePoint(e)),n=l.map(e=>r.getTilePoint(e));i.push({tile:e,tileID:r,queryGeometry:t,cameraQueryGeometry:n,scale:o})}}return i}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map(e=>this._tiles[e].tileID);for(const n of t)n.posMatrix=this.transform.calculatePosMatrix(n.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(fe(this._source.type)){const e=a.now();for(const t in this._tiles)if(this._tiles[t].fadeEndTime>=e)return!0}return!1}setFeatureState(e,t,n){this._state.updateState(e=e||"_geojsonTileLayer",t,n)}removeFeatureState(e,t,n){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,n)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,n){const r=this._tiles[e];r&&r.setDependencies(t,n)}reloadTilesForDependencies(e,t){for(const n in this._tiles)this._tiles[n].hasDependency(e,t)&&this._reloadTile(n,"reloading");this._cache.filter(n=>!n.hasDependency(e,t))}}function he(e,t){const n=Math.abs(2*e.wrap)-+(e.wrap<0),r=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||r-n||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function fe(e){return"raster"===e||"image"===e||"video"===e}de.maxOverzooming=10,de.maxUnderzooming=3;class pe{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let n=1;n<this.points.length;n++)this._distances[n]=this._distances[n-1]+this.points[n].dist(this.points[n-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(1===this.points.length)return this.points[0];e=t.ac(e,0,1);let n=1,r=this._distances[n];const i=e*this.paddedLength+this.padding;for(;r<i&&n<this._distances.length;)r=this._distances[++n];const a=n-1,o=this._distances[a],s=r-o,l=s>0?(i-o)/s:0;return this.points[a].mult(1-l).add(this.points[n].mult(l))}}function me(e,t){let n=!0;return"always"===e||"never"!==e&&"never"!==t||(n=!1),n}class ge{constructor(e,t,n){const r=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/n),this.yCellCount=Math.ceil(t/n);for(let a=0;a<this.xCellCount*this.yCellCount;a++)r.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,n,r,i){this._forEachCell(t,n,r,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(n),this.bboxes.push(r),this.bboxes.push(i)}insertCircle(e,t,n,r){this._forEachCell(t-r,n-r,t+r,n+r,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(n),this.circles.push(r)}_insertBoxCell(e,t,n,r,i,a){this.boxCells[i].push(a)}_insertCircleCell(e,t,n,r,i,a){this.circleCells[i].push(a)}_query(e,t,n,r,i,a,o){if(n<0||e>this.width||r<0||t>this.height)return[];const s=[];if(e<=0&&t<=0&&this.width<=n&&this.height<=r){if(i)return[{key:null,x1:e,y1:t,x2:n,y2:r}];for(let e=0;e<this.boxKeys.length;e++)s.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],n=this.circles[3*e+1],r=this.circles[3*e+2];s.push({key:this.circleKeys[e],x1:t-r,y1:n-r,x2:t+r,y2:n+r})}}else this._forEachCell(e,t,n,r,this._queryCell,s,{hitTest:i,overlapMode:a,seenUids:{box:{},circle:{}}},o);return s}query(e,t,n,r){return this._query(e,t,n,r,!1,null)}hitTest(e,t,n,r,i,a){return this._query(e,t,n,r,!0,i,a).length>0}hitTestCircle(e,t,n,r,i){const a=e-n,o=e+n,s=t-n,l=t+n;if(o<0||a>this.width||l<0||s>this.height)return!1;const u=[];return this._forEachCell(a,s,o,l,this._queryCellCircle,u,{hitTest:!0,overlapMode:r,circle:{x:e,y:t,radius:n},seenUids:{box:{},circle:{}}},i),u.length>0}_queryCell(e,t,n,r,i,a,o,s){const{seenUids:l,hitTest:u,overlapMode:c}=o,d=this.boxCells[i];if(null!==d){const i=this.bboxes;for(const o of d)if(!l.box[o]){l.box[o]=!0;const d=4*o,h=this.boxKeys[o];if(e<=i[d+2]&&t<=i[d+3]&&n>=i[d+0]&&r>=i[d+1]&&(!s||s(h))&&(!u||!me(c,h.overlapMode))&&(a.push({key:h,x1:i[d],y1:i[d+1],x2:i[d+2],y2:i[d+3]}),u))return!0}}const h=this.circleCells[i];if(null!==h){const i=this.circles;for(const o of h)if(!l.circle[o]){l.circle[o]=!0;const d=3*o,h=this.circleKeys[o];if(this._circleAndRectCollide(i[d],i[d+1],i[d+2],e,t,n,r)&&(!s||s(h))&&(!u||!me(c,h.overlapMode))){const e=i[d],t=i[d+1],n=i[d+2];if(a.push({key:h,x1:e-n,y1:t-n,x2:e+n,y2:t+n}),u)return!0}}}return!1}_queryCellCircle(e,t,n,r,i,a,o,s){const{circle:l,seenUids:u,overlapMode:c}=o,d=this.boxCells[i];if(null!==d){const e=this.bboxes;for(const t of d)if(!u.box[t]){u.box[t]=!0;const n=4*t,r=this.boxKeys[t];if(this._circleAndRectCollide(l.x,l.y,l.radius,e[n+0],e[n+1],e[n+2],e[n+3])&&(!s||s(r))&&!me(c,r.overlapMode))return a.push(!0),!0}}const h=this.circleCells[i];if(null!==h){const e=this.circles;for(const t of h)if(!u.circle[t]){u.circle[t]=!0;const n=3*t,r=this.circleKeys[t];if(this._circlesCollide(e[n],e[n+1],e[n+2],l.x,l.y,l.radius)&&(!s||s(r))&&!me(c,r.overlapMode))return a.push(!0),!0}}}_forEachCell(e,t,n,r,i,a,o,s){const l=this._convertToXCellCoord(e),u=this._convertToYCellCoord(t),c=this._convertToXCellCoord(n),d=this._convertToYCellCoord(r);for(let h=l;h<=c;h++)for(let l=u;l<=d;l++)if(i.call(this,e,t,n,r,this.xCellCount*l+h,a,o,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,n,r,i,a){const o=r-e,s=i-t,l=n+a;return l*l>o*o+s*s}_circleAndRectCollide(e,t,n,r,i,a,o){const s=(a-r)/2,l=Math.abs(e-(r+s));if(l>s+n)return!1;const u=(o-i)/2,c=Math.abs(t-(i+u));if(c>u+n)return!1;if(l<=s||c<=u)return!0;const d=l-s,h=c-u;return d*d+h*h<=n*n}}function ye(e,n,r,i,a){const o=t.H();return n?(t.K(o,o,[1/a,1/a,1]),r||t.ad(o,o,i.angle)):t.L(o,i.labelPlaneMatrix,e),o}function ve(e,n,r,i,a){if(n){const n=t.ae(e);return t.K(n,n,[a,a,1]),r||t.ad(n,n,-i.angle),n}return i.glCoordMatrix}function _e(e,n,r,i){let a;i?(a=[e,n,i(e,n),1],t.af(a,a,r)):(a=[e,n,0,1],Fe(a,a,r));const o=a[3];return{point:new t.P(a[0]/o,a[1]/o),signedDistanceFromCamera:o,isOccluded:!1}}function be(e,t){return.5+e/t*.5}function xe(e,t){return e.x>=-t[0]&&e.x<=t[0]&&e.y>=-t[1]&&e.y<=t[1]}function we(e,n,r,i,a,o,s,l,u,c,d,h,f,p,m){const g=i?e.textSizeData:e.iconSizeData,y=t.ag(g,r.transform.zoom),v=[256/r.width*2+1,256/r.height*2+1],_=i?e.text.dynamicLayoutVertexArray:e.icon.dynamicLayoutVertexArray;_.clear();const b=e.lineVertexArray,x=i?e.text.placedSymbolArray:e.icon.placedSymbolArray,w=r.transform.width/r.transform.height;let k=!1;for(let S=0;S<x.length;S++){const i=x.get(S);if(i.hidden||i.writingMode===t.ah.vertical&&!k){Oe(i.numGlyphs,_);continue}k=!1;const E=_e(i.anchorX,i.anchorY,n,m);if(!xe(E.point,v)){Oe(i.numGlyphs,_);continue}const C=be(r.transform.cameraToCenterDistance,E.signedDistanceFromCamera),P=t.ai(g,y,i),D=s?P/C:P*C,I={getElevation:m,labelPlaneMatrix:a,lineVertexArray:b,pitchWithMap:s,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:c,tileAnchorPoint:new t.P(i.anchorX,i.anchorY),unwrappedTileID:d,width:h,height:f,translation:p},T=Ee(I,i,D,!1,l,n,o,e.glyphOffsetArray,_,w,u);k=T.useVertical,(T.notEnoughRoom||k||T.needsFlipping&&Ee(I,i,D,!0,l,n,o,e.glyphOffsetArray,_,w,u).notEnoughRoom)&&Oe(i.numGlyphs,_)}i?e.text.dynamicLayoutVertexBuffer.updateData(_):e.icon.dynamicLayoutVertexBuffer.updateData(_)}function ke(e,t,n,r,i,a,o,s){const l=a.glyphStartIndex+a.numGlyphs,u=a.lineStartIndex,c=a.lineStartIndex+a.lineLength,d=t.getoffsetX(a.glyphStartIndex),h=t.getoffsetX(l-1),f=Ae(e*d,n,r,i,a.segment,u,c,s,o);if(!f)return null;const p=Ae(e*h,n,r,i,a.segment,u,c,s,o);return p?s.projectionCache.anyProjectionOccluded?null:{first:f,last:p}:null}function Se(e,n,r,i){return e===t.ah.horizontal&&Math.abs(r.y-n.y)>Math.abs(r.x-n.x)*i?{useVertical:!0}:(e===t.ah.vertical?n.y<r.y:n.x>r.x)?{needsFlipping:!0}:null}function Ee(e,n,r,i,a,o,s,l,u,c,d){const h=r/24,f=n.lineOffsetX*h,p=n.lineOffsetY*h;let m;if(n.numGlyphs>1){const t=n.glyphStartIndex+n.numGlyphs,r=n.lineStartIndex,o=n.lineStartIndex+n.lineLength,u=ke(h,l,f,p,i,n,d,e);if(!u)return{notEnoughRoom:!0};const g=_e(u.first.point.x,u.first.point.y,s,e.getElevation).point,y=_e(u.last.point.x,u.last.point.y,s,e.getElevation).point;if(a&&!i){const e=Se(n.writingMode,g,y,c);if(e)return e}m=[u.first];for(let a=n.glyphStartIndex+1;a<t-1;a++)m.push(Ae(h*l.getoffsetX(a),f,p,i,n.segment,r,o,e,d));m.push(u.last)}else{if(a&&!i){const r=_e(e.tileAnchorPoint.x,e.tileAnchorPoint.y,o,e.getElevation).point,i=n.lineStartIndex+n.segment+1,a=new t.P(e.lineVertexArray.getx(i),e.lineVertexArray.gety(i)),s=_e(a.x,a.y,o,e.getElevation),l=s.signedDistanceFromCamera>0?s.point:function(e,t,n,r,i,a){return Ce(e,t,n,1,i,a)}(e.tileAnchorPoint,a,r,0,o,e),u=Se(n.writingMode,r,l,c);if(u)return u}const r=Ae(h*l.getoffsetX(n.glyphStartIndex),f,p,i,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,e,d);if(!r||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};m=[r]}for(const g of m)t.aj(u,g.point,g.angle);return{}}function Ce(e,t,n,r,i,a){const o=e.add(e.sub(t)._unit()),s=void 0!==i?_e(o.x,o.y,i,a.getElevation).point:De(o.x,o.y,a).point,l=n.sub(s);return n.add(l._mult(r/l.mag()))}function Pe(e,n,r){const i=n.projectionCache;if(i.projections[e])return i.projections[e];const a=new t.P(n.lineVertexArray.getx(e),n.lineVertexArray.gety(e)),o=De(a.x,a.y,n);if(o.signedDistanceFromCamera>0)return i.projections[e]=o.point,i.anyProjectionOccluded=i.anyProjectionOccluded||o.isOccluded,o.point;const s=e-r.direction;return function(e,t,n,r,i){return Ce(e,t,n,r,void 0,i)}(0===r.distanceFromAnchor?n.tileAnchorPoint:new t.P(n.lineVertexArray.getx(s),n.lineVertexArray.gety(s)),a,r.previousVertex,r.absOffsetX-r.distanceFromAnchor+1,n)}function De(e,t,n){const r=e+n.translation[0],i=t+n.translation[1];let a;return!n.pitchWithMap&&n.projection.useSpecialProjectionForSymbols?(a=n.projection.projectTileCoordinates(r,i,n.unwrappedTileID,n.getElevation),a.point.x=(.5*a.point.x+.5)*n.width,a.point.y=(.5*-a.point.y+.5)*n.height):(a=_e(r,i,n.labelPlaneMatrix,n.getElevation),a.isOccluded=!1),a}function Ie(e,t,n){return e._unit()._perp()._mult(t*n)}function Te(e,n,r,i,a,o,s,l,u){if(l.projectionCache.offsets[e])return l.projectionCache.offsets[e];const c=r.add(n);if(e+u.direction<i||e+u.direction>=a)return l.projectionCache.offsets[e]=c,c;const d=Pe(e+u.direction,l,u),h=Ie(d.sub(r),s,u.direction),f=r.add(h),p=d.add(h);return l.projectionCache.offsets[e]=t.ak(o,c,f,p)||c,l.projectionCache.offsets[e]}function Ae(e,t,n,r,i,a,o,s,l){const u=r?e-t:e+t;let c=u>0?1:-1,d=0;r&&(c*=-1,d=Math.PI),c<0&&(d+=Math.PI);let h,f=c>0?a+i:a+i+1;s.projectionCache.cachedAnchorPoint?h=s.projectionCache.cachedAnchorPoint:(h=De(s.tileAnchorPoint.x,s.tileAnchorPoint.y,s).point,s.projectionCache.cachedAnchorPoint=h);let p,m,g=h,y=h,v=0,_=0;const b=Math.abs(u),x=[];let w;for(;v+_<=b;){if(f+=c,f<a||f>=o)return null;v+=_,y=g,m=p;const e={absOffsetX:b,direction:c,distanceFromAnchor:v,previousVertex:y};if(g=Pe(f,s,e),0===n)x.push(y),w=g.sub(y);else{let t;const r=g.sub(y);t=0===r.mag()?Ie(Pe(f+c,s,e).sub(g),n,c):Ie(r,n,c),m||(m=y.add(t)),p=Te(f,t,g,a,o,m,n,s,e),x.push(m),w=p.sub(m)}_=w.mag()}const k=w._mult((b-v)/_)._add(m||y),S=d+Math.atan2(g.y-y.y,g.x-y.x);return x.push(k),{point:k,angle:l?S:0,path:x}}const ze=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Oe(e,t){for(let n=0;n<e;n++){const e=t.length;t.resize(e+4),t.float32.set(ze,3*e)}}function Fe(e,t,n){const r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e[3]=n[3]*r+n[7]*i+n[15],e}const Me=100;class je{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ge(e.width+200,e.height+200,25),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ge(e.width+200,e.height+200,25);this.transform=e,this.mapProjection=t,this.grid=n,this.ignoredGrid=r,this.pitchFactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Me,this.screenBottomBoundary=e.height+Me,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,t,n,r,i,a,o,s,l,u,c){const d=e.anchorPointX+s[0],h=e.anchorPointY+s[1],f=this.projectAndGetPerspectiveRatio(r,d,h,i,u),p=n*f.perspectiveRatio;let m;if(a||o)m=this._projectCollisionBox(e,p,r,i,a,o,s,f,u,c);else{const t=f.point.x+(c?c.x*p:0),n=f.point.y+(c?c.y*p:0);m={allPointsOccluded:!1,box:[t+e.x1*p,n+e.y1*p,t+e.x2*p,n+e.y2*p]}}const[g,y,v,_]=m.box;return this.mapProjection.useSpecialProjectionForSymbols&&(a?m.allPointsOccluded:this.mapProjection.isOccluded(d,h,i))||f.perspectiveRatio<this.perspectiveRatioCutoff||!this.isInsideGrid(g,y,v,_)||"always"!==t&&this.grid.hitTest(g,y,v,_,t,l)?{box:[g,y,v,_],placeable:!1,offscreen:!1}:{box:[g,y,v,_],placeable:!0,offscreen:this.isOffscreen(g,y,v,_)}}placeCollisionCircles(e,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g){const y=[],v=new t.P(n.anchorX,n.anchorY),_=this.getPerspectiveRatio(o,v.x,v.y,s,g),b=(d?a/_:a*_)/t.ap,x={getElevation:g,labelPlaneMatrix:l,lineVertexArray:r,pitchWithMap:d,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},projection:this.mapProjection,tileAnchorPoint:v,unwrappedTileID:s,width:this.transform.width,height:this.transform.height,translation:m},w=ke(b,i,n.lineOffsetX*b,n.lineOffsetY*b,!1,n,!1,x);let k=!1,S=!1,E=!0;if(w){const n=.5*f*_+p,r=new t.P(-100,-100),i=new t.P(this.screenRightBoundary,this.screenBottomBoundary),a=new pe,o=w.first,s=w.last;let l=[];for(let e=o.path.length-1;e>=1;e--)l.push(o.path[e]);for(let e=1;e<s.path.length;e++)l.push(s.path[e]);const d=2.5*n;if(u){const e=this.projectPathToScreenSpace(l,x,u);l=e.some(e=>e.signedDistanceFromCamera<=0)?[]:e.map(e=>e.point)}let m=[];if(l.length>0){const e=l[0].clone(),n=l[0].clone();for(let t=1;t<l.length;t++)e.x=Math.min(e.x,l[t].x),e.y=Math.min(e.y,l[t].y),n.x=Math.max(n.x,l[t].x),n.y=Math.max(n.y,l[t].y);m=e.x>=r.x&&n.x<=i.x&&e.y>=r.y&&n.y<=i.y?[l]:n.x<r.x||e.x>i.x||n.y<r.y||e.y>i.y?[]:t.al([l],r.x,r.y,i.x,i.y)}for(const t of m){a.reset(t,.25*n);let r=0;r=a.length<=.5*n?1:Math.ceil(a.paddedLength/d)+1;for(let t=0;t<r;t++){const i=t/Math.max(r-1,1),o=a.lerp(i),s=o.x+Me,l=o.y+Me;y.push(s,l,n,0);const u=s-n,d=l-n,f=s+n,p=l+n;if(E=E&&this.isOffscreen(u,d,f,p),S=S||this.isInsideGrid(u,d,f,p),"always"!==e&&this.grid.hitTestCircle(s,l,n,e,h)&&(k=!0,!c))return{circles:[],offscreen:!1,collisionDetected:k}}}}return{circles:!c&&k||!S||_<this.perspectiveRatioCutoff?[]:y,offscreen:E,collisionDetected:k}}projectPathToScreenSpace(e,t,n){return e.map(e=>_e(e.x,e.y,n,t.getElevation))}queryRenderedSymbols(e){if(0===e.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const n=[];let r=1/0,i=1/0,a=-1/0,o=-1/0;for(const c of e){const e=new t.P(c.x+Me,c.y+Me);r=Math.min(r,e.x),i=Math.min(i,e.y),a=Math.max(a,e.x),o=Math.max(o,e.y),n.push(e)}const s=this.grid.query(r,i,a,o).concat(this.ignoredGrid.query(r,i,a,o)),l={},u={};for(const c of s){const e=c.key;if(void 0===l[e.bucketInstanceId]&&(l[e.bucketInstanceId]={}),l[e.bucketInstanceId][e.featureIndex])continue;const r=[new t.P(c.x1,c.y1),new t.P(c.x2,c.y1),new t.P(c.x2,c.y2),new t.P(c.x1,c.y2)];t.am(n,r)&&(l[e.bucketInstanceId][e.featureIndex]=!0,void 0===u[e.bucketInstanceId]&&(u[e.bucketInstanceId]=[]),u[e.bucketInstanceId].push(e.featureIndex))}return u}insertCollisionBox(e,t,n,r,i,a){(n?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:i,collisionGroupID:a,overlapMode:t},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,n,r,i,a){const o=n?this.ignoredGrid:this.grid,s={bucketInstanceId:r,featureIndex:i,collisionGroupID:a,overlapMode:t};for(let l=0;l<e.length;l+=4)o.insertCircle(s,e[l],e[l+1],e[l+2])}projectAndGetPerspectiveRatio(e,n,r,i,a){let o;a?(o=[n,r,a(n,r),1],t.af(o,o,e)):(o=[n,r,0,1],Fe(o,o,e));const s=o[3];return{point:new t.P((o[0]/s+1)/2*this.transform.width+Me,(-o[1]/s+1)/2*this.transform.height+Me),perspectiveRatio:.5+this.transform.cameraToCenterDistance/s*.5,isOccluded:!1,signedDistanceFromCamera:s}}getPerspectiveRatio(e,t,n,r,i){const a=this.mapProjection.useSpecialProjectionForSymbols?this.mapProjection.projectTileCoordinates(t,n,r,i):_e(t,n,e,i);return.5+this.transform.cameraToCenterDistance/a.signedDistanceFromCamera*.5}isOffscreen(e,t,n,r){return n<Me||e>=this.screenRightBoundary||r<Me||t>this.screenBottomBoundary}isInsideGrid(e,t,n,r){return n>=0&&e<this.gridRightBoundary&&r>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const e=t.an([]);return t.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,n,r,i,a,o,s,l,u,c){let d=new t.P(1,0),h=new t.P(0,1);const f=new t.P(e.anchorPointX+s[0],e.anchorPointY+s[1]);if(o&&!a){const e=this.projectAndGetPerspectiveRatio(r,f.x+1,f.y,i,u).point.sub(l.point).unit(),n=Math.atan(e.y/e.x)+(e.x<0?Math.PI:0),a=Math.sin(n),o=Math.cos(n);d=new t.P(o,a),h=new t.P(-a,o)}else if(!o&&a){const e=-this.transform.angle,n=Math.sin(e),r=Math.cos(e);d=new t.P(r,n),h=new t.P(-n,r)}let p=l.point,m=n;if(a){p=f;const e=this.transform.zoom-Math.floor(this.transform.zoom);m=Math.pow(2,-e),m*=this.mapProjection.getPitchedTextCorrection(this.transform,f,i),c||(m*=t.ac(.5+l.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))}c&&(p=p.add(d.mult(c.x*m)).add(h.mult(c.y*m)));const g=e.x1*m,y=e.x2*m,v=(g+y)/2,_=e.y1*m,b=e.y2*m,x=(_+b)/2,w=[{offsetX:g,offsetY:_},{offsetX:v,offsetY:_},{offsetX:y,offsetY:_},{offsetX:y,offsetY:x},{offsetX:y,offsetY:b},{offsetX:v,offsetY:b},{offsetX:g,offsetY:b},{offsetX:g,offsetY:x}];let k=[];for(const{offsetX:E,offsetY:C}of w)k.push(new t.P(p.x+d.x*E+h.x*C,p.y+d.y*E+h.y*C));let S=!1;if(a){const e=k.map(e=>this.projectAndGetPerspectiveRatio(r,e.x,e.y,i,u));S=e.some(e=>!e.isOccluded),k=e.map(e=>e.point)}else S=!0;return{box:t.ao(k),allPointsOccluded:!S}}}function Be(e,n,r){return n*(t.X/(e.tileSize*Math.pow(2,r-e.tileID.overscaledZ)))}class Re{constructor(e,t,n,r){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):r&&n?1:0,this.placed=n}isHidden(){return 0===this.opacity&&!this.placed}}class Le{constructor(e,t,n,r,i){this.text=new Re(e?e.text:null,t,n,i),this.icon=new Re(e?e.icon:null,t,r,i)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ne{constructor(e,t,n){this.text=e,this.icon=t,this.skipFade=n}}class Ue{constructor(){this.invProjMatrix=t.H(),this.viewportMatrix=t.H(),this.circles=[]}}class Ve{constructor(e,t,n,r,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=n,this.bucketIndex=r,this.tileID=i}}class qe{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function He(e,n,r,i,a){const{horizontalAlign:o,verticalAlign:s}=t.au(e);return new t.P(-(o-.5)*n+i[0]*a,-(s-.5)*r+i[1]*a)}class We{constructor(e,t,n,r,i,a){this.transform=e.clone(),this.terrain=n,this.collisionIndex=new je(this.transform,t),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new qe(i),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const t=this.terrain;return t?(n,r)=>t.getElevation(e,n,r):null}getBucketParts(e,n,r,i){const a=r.getBucket(n),o=r.latestFeatureIndex;if(!a||!o||n.id!==a.layerIds[0])return;const s=r.collisionBoxArray,l=a.layers[0].layout,u=a.layers[0].paint,c=Math.pow(2,this.transform.zoom-r.tileID.overscaledZ),d=r.tileSize/t.X,h=r.tileID.toUnwrapped(),f=this.transform.calculatePosMatrix(h),p="map"===l.get("text-pitch-alignment"),m="map"===l.get("text-rotation-alignment"),g=Be(r,1,this.transform.zoom),y=this.collisionIndex.mapProjection.translatePosition(this.transform,r,u.get("text-translate"),u.get("text-translate-anchor")),v=this.collisionIndex.mapProjection.translatePosition(this.transform,r,u.get("icon-translate"),u.get("icon-translate-anchor")),_=ye(f,p,m,this.transform,g);let b=null;if(p){const e=ve(f,p,m,this.transform,g);b=t.L([],this.transform.labelPlaneMatrix,e)}this.retainedQueryData[a.bucketInstanceId]=new Ve(a.bucketInstanceId,o,a.sourceLayerIndex,a.index,r.tileID);const x={bucket:a,layout:l,translationText:y,translationIcon:v,posMatrix:f,unwrappedTileID:h,textLabelPlaneMatrix:_,labelToScreenMatrix:b,scale:c,textPixelRatio:d,holdingForFade:r.holdingForFade(),collisionBoxArray:s,partiallyEvaluatedTextSize:t.ag(a.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(a.sourceID)};if(i)for(const t of a.sortKeyRanges){const{sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i}=t;e.push({sortKey:n,symbolInstanceStart:r,symbolInstanceEnd:i,parameters:x})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:a.symbolInstances.length,parameters:x})}attemptAnchorPlacement(e,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_){const b=t.aq[e.textAnchor],x=[e.textOffset0,e.textOffset1],w=He(b,r,i,x,a),k=this.collisionIndex.placeCollisionBox(n,h,l,u,c,s,o,g,d.predicate,_,w);if((!v||this.collisionIndex.placeCollisionBox(v,h,l,u,c,s,o,y,d.predicate,_,w).placeable)&&k.placeable){let e;if(this.prevPlacement&&this.prevPlacement.variableOffsets[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID]&&this.prevPlacement.placements[f.crossTileID].text&&(e=this.prevPlacement.variableOffsets[f.crossTileID].anchor),0===f.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[f.crossTileID]={textOffset:x,width:r,height:i,anchor:b,textBoxScale:a,prevAnchor:e},this.markUsedJustification(p,b,f,m),p.allowVerticalPlacement&&(this.markUsedOrientation(p,m,f),this.placedOrientations[f.crossTileID]=m),{shift:w,placedGlyphBoxes:k}}}placeLayerBucketPart(e,n,r){const{bucket:i,layout:a,translationText:o,translationIcon:s,posMatrix:l,unwrappedTileID:u,textLabelPlaneMatrix:c,labelToScreenMatrix:d,textPixelRatio:h,holdingForFade:f,collisionBoxArray:p,partiallyEvaluatedTextSize:m,collisionGroup:g}=e.parameters,y=a.get("text-optional"),v=a.get("icon-optional"),_=t.ar(a,"text-overlap","text-allow-overlap"),b="always"===_,x=t.ar(a,"icon-overlap","icon-allow-overlap"),w="always"===x,k="map"===a.get("text-rotation-alignment"),S="map"===a.get("text-pitch-alignment"),E="none"!==a.get("icon-text-fit"),C="viewport-y"===a.get("symbol-z-order"),P=b&&(w||!i.hasIconData()||v),D=w&&(b||!i.hasTextData()||y);!i.collisionArrays&&p&&i.deserializeCollisionBoxes(p);const I=this._getTerrainElevationFunc(this.retainedQueryData[i.bucketInstanceId].tileID),T=(e,p,w)=>{var C,T;if(n[e.crossTileID])return;if(f)return void(this.placements[e.crossTileID]=new Ne(!1,!1,!1));let A=!1,z=!1,O=!0,F=null,M={box:null,placeable:!1,offscreen:null},j={box:null,placeable:!1,offscreen:null},B=null,R=null,L=null,N=0,U=0,V=0;p.textFeatureIndex?N=p.textFeatureIndex:e.useRuntimeCollisionCircles&&(N=e.featureIndex),p.verticalTextFeatureIndex&&(U=p.verticalTextFeatureIndex);const q=p.textBox;if(q){const n=n=>{let r=t.ah.horizontal;if(i.allowVerticalPlacement&&!n&&this.prevPlacement){const t=this.prevPlacement.placedOrientations[e.crossTileID];t&&(this.placedOrientations[e.crossTileID]=t,r=t,this.markUsedOrientation(i,r,e))}return r},a=(n,r)=>{if(i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&p.verticalTextBox){for(const e of i.writingModes)if(e===t.ah.vertical?(M=r(),j=M):M=n(),M&&M.placeable)break}else M=n()},c=e.textAnchorOffsetStartIndex,d=e.textAnchorOffsetEndIndex;if(d===c){const r=(t,n)=>{const r=this.collisionIndex.placeCollisionBox(t,_,h,l,u,S,k,o,g.predicate,I);return r&&r.placeable&&(this.markUsedOrientation(i,n,e),this.placedOrientations[e.crossTileID]=n),r};a(()=>r(q,t.ah.horizontal),()=>{const n=p.verticalTextBox;return i.allowVerticalPlacement&&e.numVerticalGlyphVertices>0&&n?r(n,t.ah.vertical):{box:null,offscreen:null}}),n(M&&M.placeable)}else{let f=t.aq[null===(T=null===(C=this.prevPlacement)||void 0===C?void 0:C.variableOffsets[e.crossTileID])||void 0===T?void 0:T.anchor];const m=(n,a,p)=>{const m=n.x2-n.x1,y=n.y2-n.y1,v=e.textBoxScale,b=E&&"never"===x?a:null;let w=null,C="never"===_?1:2,P="never";f&&C++;for(let t=0;t<C;t++){for(let t=c;t<d;t++){const r=i.textAnchorOffsets.get(t);if(f&&r.textAnchor!==f)continue;const a=this.attemptAnchorPlacement(r,n,m,y,v,k,S,h,l,u,g,P,e,i,p,o,s,b,I);if(a&&(w=a.placedGlyphBoxes,w&&w.placeable))return A=!0,F=a.shift,w}f?f=null:P=_}return r&&!w&&(w={box:this.collisionIndex.placeCollisionBox(q,"always",h,l,u,S,k,o,g.predicate,I,new t.P(0,0)).box,offscreen:!1,placeable:!1}),w};a(()=>m(q,p.iconBox,t.ah.horizontal),()=>{const n=p.verticalTextBox;return i.allowVerticalPlacement&&(!M||!M.placeable)&&e.numVerticalGlyphVertices>0&&n?m(n,p.verticalIconBox,t.ah.vertical):{box:null,occluded:!0,offscreen:null}}),M&&(A=M.placeable,O=M.offscreen);const y=n(M&&M.placeable);if(!A&&this.prevPlacement){const t=this.prevPlacement.variableOffsets[e.crossTileID];t&&(this.variableOffsets[e.crossTileID]=t,this.markUsedJustification(i,t.anchor,e,y))}}}if(B=M,A=B&&B.placeable,O=B&&B.offscreen,e.useRuntimeCollisionCircles){const n=i.text.placedSymbolArray.get(e.centerJustifiedTextSymbolIndex),s=t.ai(i.textSizeData,m,n),h=a.get("text-padding");R=this.collisionIndex.placeCollisionCircles(_,n,i.lineVertexArray,i.glyphOffsetArray,s,l,u,c,d,r,S,g.predicate,e.collisionCircleDiameter,h,o,I),R.circles.length&&R.collisionDetected&&!r&&t.w("Collisions detected, but collision boxes are not shown"),A=b||R.circles.length>0&&!R.collisionDetected,O=O&&R.offscreen}if(p.iconFeatureIndex&&(V=p.iconFeatureIndex),p.iconBox){const e=e=>this.collisionIndex.placeCollisionBox(e,x,h,l,u,S,k,s,g.predicate,I,E&&F?F:void 0);j&&j.placeable&&p.verticalIconBox?(L=e(p.verticalIconBox),z=L.placeable):(L=e(p.iconBox),z=L.placeable),O=O&&L.offscreen}const H=y||0===e.numHorizontalGlyphVertices&&0===e.numVerticalGlyphVertices,W=v||0===e.numIconVertices;H||W?W?H||(z=z&&A):A=z&&A:z=A=z&&A;const Z=z&&L.placeable;if(A&&B.placeable&&this.collisionIndex.insertCollisionBox(B.box,_,a.get("text-ignore-placement"),i.bucketInstanceId,j&&j.placeable&&U?U:N,g.ID),Z&&this.collisionIndex.insertCollisionBox(L.box,x,a.get("icon-ignore-placement"),i.bucketInstanceId,V,g.ID),R&&A&&this.collisionIndex.insertCollisionCircles(R.circles,_,a.get("text-ignore-placement"),i.bucketInstanceId,N,g.ID),r&&this.storeCollisionData(i.bucketInstanceId,w,p,B,L,R),0===e.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===i.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[e.crossTileID]=new Ne(A||P,z||D,O||i.justReloaded),n[e.crossTileID]=!0};if(C){if(0!==e.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const t=i.getSortedSymbolIndexes(this.transform.angle);for(let e=t.length-1;e>=0;--e){const n=t[e];T(i.symbolInstances.get(n),i.collisionArrays[n],n)}}else for(let t=e.symbolInstanceStart;t<e.symbolInstanceEnd;t++)T(i.symbolInstances.get(t),i.collisionArrays[t],t);if(r&&i.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[i.bucketInstanceId];t.as(e.invProjMatrix,l),e.viewportMatrix=this.collisionIndex.getViewportMatrix()}i.justReloaded=!1}storeCollisionData(e,t,n,r,i,a){if(n.textBox||n.iconBox){let a,o;this.collisionBoxArrays.has(e)?a=this.collisionBoxArrays.get(e):(a=new Map,this.collisionBoxArrays.set(e,a)),a.has(t)?o=a.get(t):(o={text:null,icon:null},a.set(t,o)),n.textBox&&(o.text=r.box),n.iconBox&&(o.icon=i.box)}if(a){let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Ue);for(let e=0;e<a.circles.length;e+=4)t.circles.push(a.circles[e+0]),t.circles.push(a.circles[e+1]),t.circles.push(a.circles[e+2]),t.circles.push(a.collisionDetected?1:0)}}markUsedJustification(e,n,r,i){let a;a=i===t.ah.vertical?r.verticalPlacedTextSymbolIndex:{left:r.leftJustifiedTextSymbolIndex,center:r.centerJustifiedTextSymbolIndex,right:r.rightJustifiedTextSymbolIndex}[t.at(n)];const o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex,r.verticalPlacedTextSymbolIndex];for(const t of o)t>=0&&(e.text.placedSymbolArray.get(t).crossTileID=a>=0&&t!==a?0:r.crossTileID)}markUsedOrientation(e,n,r){const i=n===t.ah.horizontal||n===t.ah.horizontalOnly?n:0,a=n===t.ah.vertical?n:0,o=[r.leftJustifiedTextSymbolIndex,r.centerJustifiedTextSymbolIndex,r.rightJustifiedTextSymbolIndex];for(const t of o)e.text.placedSymbolArray.get(t).placedOrientation=i;r.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(r.verticalPlacedTextSymbolIndex).placedOrientation=a)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let n=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const r=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},a=t?t.variableOffsets:{},o=t?t.placedOrientations:{};for(const s in this.placements){const e=this.placements[s],t=i[s];t?(this.opacities[s]=new Le(t,r,e.text,e.icon),n=n||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[s]=new Le(null,r,e.text,e.icon,e.skipFade),n=n||e.text||e.icon)}for(const s in i){const e=i[s];if(!this.opacities[s]){const t=new Le(e,r,!1,!1);t.isHidden()||(this.opacities[s]=t,n=n||e.text.placed||e.icon.placed)}}for(const s in a)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=a[s]);for(const s in o)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=o[s]);if(t&&void 0===t.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");n?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const n={};for(const r of t){const t=r.getBucket(e);t&&r.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,r.tileID,n,r.collisionBoxArray)}}updateBucketOpacities(e,n,r,i){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const a=e.layers[0],o=a.layout,s=new Le(null,0,!1,!1,!0),l=o.get("text-allow-overlap"),u=o.get("icon-allow-overlap"),c=a._unevaluatedLayout.hasValue("text-variable-anchor")||a._unevaluatedLayout.hasValue("text-variable-anchor-offset"),d="map"===o.get("text-rotation-alignment"),h="map"===o.get("text-pitch-alignment"),f="none"!==o.get("icon-text-fit"),p=new Le(null,0,l&&(u||!e.hasIconData()||o.get("icon-optional")),u&&(l||!e.hasTextData()||o.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const m=(e,t,n)=>{for(let r=0;r<t/4;r++)e.opacityVertexArray.emplaceBack(n);e.hasVisibleVertices=e.hasVisibleVertices||n!==tt},g=this.collisionBoxArrays.get(e.bucketInstanceId);for(let y=0;y<e.symbolInstances.length;y++){const n=e.symbolInstances.get(y),{numHorizontalGlyphVertices:i,numVerticalGlyphVertices:a,crossTileID:o}=n;let l=this.opacities[o];r[o]?l=s:l||(l=p,this.opacities[o]=l),r[o]=!0;const u=n.numIconVertices>0,v=this.placedOrientations[n.crossTileID],_=v===t.ah.vertical,b=v===t.ah.horizontal||v===t.ah.horizontalOnly;if(i>0||a>0){const t=et(l.text);m(e.text,i,_?tt:t),m(e.text,a,b?tt:t);const r=l.text.isHidden();[n.rightJustifiedTextSymbolIndex,n.centerJustifiedTextSymbolIndex,n.leftJustifiedTextSymbolIndex].forEach(t=>{t>=0&&(e.text.placedSymbolArray.get(t).hidden=r||_?1:0)}),n.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(n.verticalPlacedTextSymbolIndex).hidden=r||b?1:0);const o=this.variableOffsets[n.crossTileID];o&&this.markUsedJustification(e,o.anchor,n,v);const s=this.placedOrientations[n.crossTileID];s&&(this.markUsedJustification(e,"left",n,s),this.markUsedOrientation(e,s,n))}if(u){const t=et(l.icon),r=!(f&&n.verticalPlacedIconSymbolIndex&&_);n.placedIconSymbolIndex>=0&&(m(e.icon,n.numIconVertices,r?t:tt),e.icon.placedSymbolArray.get(n.placedIconSymbolIndex).hidden=l.icon.isHidden()),n.verticalPlacedIconSymbolIndex>=0&&(m(e.icon,n.numVerticalIconVertices,r?tt:t),e.icon.placedSymbolArray.get(n.verticalPlacedIconSymbolIndex).hidden=l.icon.isHidden())}const x=g&&g.has(y)?g.get(y):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const n=e.collisionArrays[y];if(n){let r=new t.P(0,0);if(n.textBox||n.verticalTextBox){let t=!0;if(c){const e=this.variableOffsets[o];e?(r=He(e.anchor,e.width,e.height,e.textOffset,e.textBoxScale),d&&r._rotate(h?this.transform.angle:-this.transform.angle)):t=!1}if(n.textBox||n.verticalTextBox){let i;n.textBox&&(i=_),n.verticalTextBox&&(i=b),Ze(e.textCollisionBox.collisionVertexArray,l.text.placed,!t||i,x.text,r.x,r.y)}}if(n.iconBox||n.verticalIconBox){const t=Boolean(!b&&n.verticalIconBox);let i;n.iconBox&&(i=t),n.verticalIconBox&&(i=!t),Ze(e.iconCollisionBox.collisionVertexArray,l.icon.placed,i,x.icon,f?r.x:0,f?r.y:0)}}}}if(e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error("bucket.text.opacityVertexArray.length (= ".concat(e.text.opacityVertexArray.length,") !== bucket.text.layoutVertexArray.length (= ").concat(e.text.layoutVertexArray.length,") / 4"));if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error("bucket.icon.opacityVertexArray.length (= ".concat(e.icon.opacityVertexArray.length,") !== bucket.icon.layoutVertexArray.length (= ").concat(e.icon.layoutVertexArray.length,") / 4"));if(e.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=t.invProjMatrix,e.placementViewportMatrix=t.viewportMatrix,e.collisionCircleArray=t.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const n=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*n>e}setStale(){this.stale=!0}}function Ze(e,t,n,r,i,a){r&&0!==r.length||(r=[0,0,0,0]);const o=r[0]-Me,s=r[1]-Me,l=r[2]-Me,u=r[3]-Me;e.emplaceBack(t?1:0,n?1:0,i||0,a||0,o,s),e.emplaceBack(t?1:0,n?1:0,i||0,a||0,l,s),e.emplaceBack(t?1:0,n?1:0,i||0,a||0,l,u),e.emplaceBack(t?1:0,n?1:0,i||0,a||0,o,u)}const Ke=Math.pow(2,25),Ge=Math.pow(2,24),Xe=Math.pow(2,17),$e=Math.pow(2,16),Ye=Math.pow(2,9),Je=Math.pow(2,8),Qe=Math.pow(2,1);function et(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,n=Math.floor(127*e.opacity);return n*Ke+t*Ge+n*Xe+t*$e+n*Ye+t*Je+n*Qe+t}const tt=0;function nt(){return{isOccluded:(e,t,n)=>!1,getPitchedTextCorrection:(e,t,n)=>1,get useSpecialProjectionForSymbols(){return!1},projectTileCoordinates(e,t,n,r){throw new Error("Not implemented.")},translatePosition:(e,t,n,r)=>function(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!n[0]&&!n[1])return[0,0];const a=i?"map"===r?e.angle:0:"viewport"===r?-e.angle:0;if(a){const e=Math.sin(a),t=Math.cos(a);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}return[i?n[0]:Be(t,n[0],e.zoom),i?n[1]:Be(t,n[1],e.zoom)]}(e,t,n,r),getCircleRadiusCorrection:e=>1}}class rt{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,n,r,i){const a=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(a,r,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,a.sort((e,t)=>e.sortKey-t.sortKey));this._currentPartIndex<a.length;)if(t.placeLayerBucketPart(a[this._currentPartIndex],this._seenCrossTileIDs,n),this._currentPartIndex++,i())return!0;return!1}}class it{constructor(e,t,n,r,i,a,o,s){this.placement=new We(e,nt(),t,a,o,s),this._currentPlacementIndex=n.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=i,this._done=!1}isDone(){return this._done}continuePlacement(e,t,n){const r=a.now(),i=()=>!this._forceFullPlacement&&a.now()-r>2;for(;this._currentPlacementIndex>=0;){const r=t[e[this._currentPlacementIndex]],a=this.placement.collisionIndex.transform.zoom;if("symbol"===r.type&&(!r.minzoom||r.minzoom<=a)&&(!r.maxzoom||r.maxzoom>a)){if(this._inProgressLayer||(this._inProgressLayer=new rt(r)),this._inProgressLayer.continuePlacement(n[r.source],this.placement,this._showCollisionBoxes,r,i))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const at=512/t.X/2;class ot{constructor(e,n,r){this.tileID=e,this.bucketInstanceId=r,this._symbolsByKey={};const i=new Map;for(let t=0;t<n.length;t++){const e=n.get(t),r=e.key,a=i.get(r);a?a.push(e):i.set(r,[e])}for(const[a,o]of i){const e={positions:o.map(e=>({x:Math.floor(e.anchorX*at),y:Math.floor(e.anchorY*at)})),crossTileIDs:o.map(e=>e.crossTileID)};if(e.positions.length>128){const n=new t.av(e.positions.length,16,Uint16Array);for(const{x:t,y:r}of e.positions)n.add(t,r);n.finish(),delete e.positions,e.index=n}this._symbolsByKey[a]=e}}getScaledCoordinates(e,n){const{x:r,y:i,z:a}=this.tileID.canonical,{x:o,y:s,z:l}=n.canonical,u=at/Math.pow(2,l-a),c=(s*t.X+e.anchorY)*u,d=i*t.X*at;return{x:Math.floor((o*t.X+e.anchorX)*u-r*t.X*at),y:Math.floor(c-d)}}findMatches(e,t,n){const r=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const a=e.get(i);if(a.crossTileID)continue;const o=this._symbolsByKey[a.key];if(!o)continue;const s=this.getScaledCoordinates(a,t);if(o.index){const e=o.index.range(s.x-r,s.y-r,s.x+r,s.y+r).sort();for(const t of e){const e=o.crossTileIDs[t];if(!n[e]){n[e]=!0,a.crossTileID=e;break}}}else if(o.positions)for(let e=0;e<o.positions.length;e++){const t=o.positions[e],i=o.crossTileIDs[e];if(Math.abs(t.x-s.x)<=r&&Math.abs(t.y-s.y)<=r&&!n[i]){n[i]=!0,a.crossTileID=i;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(e=>{let{crossTileIDs:t}=e;return t})}}class st{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const n in this.indexes){const e=this.indexes[n],r={};for(const n in e){const i=e[n];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),r[i.tileID.key]=i}this.indexes[n]=r}this.lng=e}addBucket(e,t,n){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const r=this.usedCrossTileIDs[e.overscaledZ];for(const i in this.indexes){const n=this.indexes[i];if(Number(i)>e.overscaledZ)for(const i in n){const a=n[i];a.tileID.isChildOf(e)&&a.findMatches(t.symbolInstances,e,r)}else{const a=n[e.scaledTo(Number(i)).key];a&&a.findMatches(t.symbolInstances,e,r)}}for(let i=0;i<t.symbolInstances.length;i++){const e=t.symbolInstances.get(i);e.crossTileID||(e.crossTileID=n.generate(),r[e.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new ot(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const n of t.getCrossTileIDsLists())for(const t of n)delete this.usedCrossTileIDs[e][t]}removeStaleBuckets(e){let t=!1;for(const n in this.indexes){const r=this.indexes[n];for(const i in r)e[r[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(n,r[i]),delete r[i],t=!0)}return t}}class ut{constructor(){this.layerIndexes={},this.crossTileIDs=new st,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,n){let r=this.layerIndexes[e.id];void 0===r&&(r=this.layerIndexes[e.id]=new lt);let i=!1;const a={};r.handleWrapJump(n);for(const o of t){const t=o.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),r.addBucket(o.tileID,t,this.crossTileIDs)&&(i=!0),a[t.bucketInstanceId]=!0)}return r.removeStaleBuckets(a)&&(i=!0),i}pruneUnusedLayers(e){const t={};e.forEach(e=>{t[e]=!0});for(const n in this.layerIndexes)t[n]||delete this.layerIndexes[n]}}const ct=(e,n)=>t.t(e,n&&n.filter(e=>"source.canvas"!==e.identifier)),dt=t.aw();class ht extends t.E{constructor(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),this._rtlPluginLoaded=()=>{for(const e in this.sourceCaches){const t=this.sourceCaches[e].getSource().type;"vector"!==t&&"geojson"!==t||this.sourceCaches[e].reload()}},this.map=e,this.dispatcher=new N(L(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(e,t)=>this.getGlyphs(e,t)),this.dispatcher.registerMessageHandler("GI",(e,t)=>this.getImages(e,t)),this.imageManager=new k,this.imageManager.setEventedParent(this),this.glyphManager=new P(e._requestManager,n.localIdeographFontFamily),this.lineAtlas=new O(256,512),this.crossTileSymbolIndex=new ut,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new t.ax,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",t.ay()),se().on(ie,this._rtlPluginLoaded),this.on("data",e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.sourceCaches[e.sourceId];if(!t)return;const n=t.getSource();if(n&&n.vectorLayerIds)for(const r in this._layers){const e=this._layers[r];e.source===n.id&&this._validateLayer(e)}})}loadURL(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.fire(new t.k("dataloading",{dataType:"style"})),n.validate="boolean"!=typeof n.validate||n.validate;const i=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const a=this._loadStyleRequest;t.h(i,this._loadStyleRequest).then(e=>{this._loadStyleRequest=null,this._load(e.data,n,r)}).catch(e=>{this._loadStyleRequest=null,e&&!a.signal.aborted&&this.fire(new t.j(e))})}loadJSON(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this.fire(new t.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,n.validate=!1!==n.validate,this._load(e,n,r)}).catch(()=>{})}loadEmpty(){this.fire(new t.k("dataloading",{dataType:"style"})),this._load(dt,{validate:!1})}_load(e,n,r){var i;const a=n.transformStyle?n.transformStyle(r,e):e;if(!n.validate||!ct(this,t.u(a))){this._loaded=!0,this.stylesheet=a;for(const e in a.sources)this.addSource(e,a.sources[e],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs),this._createLayers(),this.light=new T(this.stylesheet.light),this.sky=new z(this.stylesheet.sky),this.map.setTerrain(null!==(i=this.stylesheet.terrain)&&void 0!==i?i:null),this.fire(new t.k("data",{dataType:"style"})),this.fire(new t.k("style.load"))}}_createLayers(){const e=t.az(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(e=>e.id),this._layers={},this._serializedLayers=null;for(const n of e){const e=t.aA(n);e.setEventedParent(this,{layer:{id:n.id}}),this._layers[n.id]=e}}_loadSprite(e){let n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(e,n,r,i){return t._(this,void 0,void 0,function*(){const o=_(e),s=r>1?"@2x":"",l={},u={};for(const{id:e,url:r}of o){const a=n.transformRequest(b(r,s,".json"),"SpriteJSON");l[e]=t.h(a,i);const o=n.transformRequest(b(r,s,".png"),"SpriteImage");u[e]=f.getImage(o,i)}return yield Promise.all([...Object.values(l),...Object.values(u)]),function(e,n){return t._(this,void 0,void 0,function*(){const t={};for(const r in e){t[r]={};const i=a.getImageCanvasContext((yield n[r]).data),o=(yield e[r]).data;for(const e in o){const{width:n,height:a,x:s,y:l,sdf:u,pixelRatio:c,stretchX:d,stretchY:h,content:f,textFitWidth:p,textFitHeight:m}=o[e];t[r][e]={data:null,pixelRatio:c,sdf:u,stretchX:d,stretchY:h,content:f,textFitWidth:p,textFitHeight:m,spriteData:{width:n,height:a,x:s,y:l,context:i}}}}return t})}(l,u)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(e=>{if(this._spriteRequest=null,e)for(const t in e){this._spritesImagesIds[t]=[];const n=this._spritesImagesIds[t]?this._spritesImagesIds[t].filter(t=>!(t in e)):[];for(const e of n)this.imageManager.removeImage(e),this._changedImages[e]=!0;for(const i in e[t]){const n="default"===t?i:"".concat(t,":").concat(i);this._spritesImagesIds[t].push(n),n in this.imageManager.images?this.imageManager.updateImage(n,e[t][i],!1):this.imageManager.addImage(n,e[t][i]),r&&(this._changedImages[n]=!0)}}}).catch(e=>{this._spriteRequest=null,n=e,this.fire(new t.j(n))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),r&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"})),i&&i(n)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}_validateLayer(e){const n=this.sourceCaches[e.source];if(!n)return;const r=e.sourceLayer;if(!r)return;const i=n.getSource();("geojson"===i.type||i.vectorLayerIds&&-1===i.vectorLayerIds.indexOf(r))&&this.fire(new t.j(new Error('Source layer "'.concat(r,'" does not exist on source "').concat(i.id,'" as specified by style layer "').concat(e.id,'".'))))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this._serializedAllLayers();if(!e||0===e.length)return Object.values(n?t.aB(r):r);const i=[];for(const a of e)if(r[a]){const e=n?t.aB(r[a]):r[a];i.push(e)}return i}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const t=Object.keys(this._layers);for(const n of t){const t=this._layers[n];"custom"!==t.type&&(e[n]=t.serialize())}return e}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.sky&&this.sky.hasTransition())return!0;for(const e in this.sourceCaches)if(this.sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const n=this._changed;if(n){const t=Object.keys(this._updatedLayers),n=Object.keys(this._removedLayers);(t.length||n.length)&&this._updateWorkerLayers(t,n);for(const e in this._updatedSources){const t=this._updatedSources[e];if("reload"===t)this._reloadSource(e);else{if("clear"!==t)throw new Error("Invalid action ".concat(t));this._clearSource(e)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const r in this._updatedPaintProps)this._layers[r].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const r={};for(const t in this.sourceCaches){const e=this.sourceCaches[t];r[t]=e.used,e.used=!1}for(const t of this._order){const n=this._layers[t];n.recalculate(e,this._availableImages),!n.isHidden(e.zoom)&&n.source&&(this.sourceCaches[n.source].used=!0)}for(const i in r){const e=this.sourceCaches[i];!!r[i]!=!!e.used&&e.fire(new t.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:i}))}this.light.recalculate(e),this.sky.recalculate(e),this.z=e.zoom,n&&this.fire(new t.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;this._checkLoaded();const i=this.serialize();if(e=n.transformStyle?n.transformStyle(i,e):e,(null===(r=n.validate)||void 0===r||r)&&ct(this,t.u(e)))return!1;(e=t.aB(e)).layers=t.az(e.layers);const a=t.aC(i,e),o=this._getOperationsToPerform(a);if(o.unimplemented.length>0)throw new Error("Unimplemented: ".concat(o.unimplemented.join(", "),"."));if(0===o.operations.length)return!1;for(const t of o.operations)t();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const t=[],n=[];for(const r of e)switch(r.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":continue;case"addLayer":t.push(()=>this.addLayer.apply(this,r.args));break;case"removeLayer":t.push(()=>this.removeLayer.apply(this,r.args));break;case"setPaintProperty":t.push(()=>this.setPaintProperty.apply(this,r.args));break;case"setLayoutProperty":t.push(()=>this.setLayoutProperty.apply(this,r.args));break;case"setFilter":t.push(()=>this.setFilter.apply(this,r.args));break;case"addSource":t.push(()=>this.addSource.apply(this,r.args));break;case"removeSource":t.push(()=>this.removeSource.apply(this,r.args));break;case"setLayerZoomRange":t.push(()=>this.setLayerZoomRange.apply(this,r.args));break;case"setLight":t.push(()=>this.setLight.apply(this,r.args));break;case"setGeoJSONSourceData":t.push(()=>this.setGeoJSONSourceData.apply(this,r.args));break;case"setGlyphs":t.push(()=>this.setGlyphs.apply(this,r.args));break;case"setSprite":t.push(()=>this.setSprite.apply(this,r.args));break;case"setSky":t.push(()=>this.setSky.apply(this,r.args));break;case"setTerrain":t.push(()=>this.map.setTerrain.apply(this,r.args));break;case"setTransition":t.push(()=>{});break;default:n.push(r.command)}return{operations:t,unimplemented:n}}addImage(e,n){if(this.getImage(e))return this.fire(new t.j(new Error('An image named "'.concat(e,'" already exists.'))));this.imageManager.addImage(e,n),this._afterImageUpdated(e)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new t.j(new Error('An image named "'.concat(e,'" does not exist.'))));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._checkLoaded(),void 0!==this.sourceCaches[e])throw new Error('Source "'.concat(e,'" already exists.'));if(!n.type)throw new Error("The type property must be defined, but only the following properties were given: ".concat(Object.keys(n).join(", "),"."));if(["vector","raster","geojson","video","image"].indexOf(n.type)>=0&&this._validate(t.u.source,"sources.".concat(e),n,null,r))return;this.map&&this.map._collectResourceTiming&&(n.collectResourceTiming=!0);const i=this.sourceCaches[e]=new de(e,n,this.dispatcher);i.style=this,i.setEventedParent(this,()=>({isSourceLoaded:i.loaded(),source:i.serialize(),sourceId:e})),i.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID");for(const r in this._layers)if(this._layers[r].source===e)return this.fire(new t.j(new Error('Source "'.concat(e,'" cannot be removed while layer "').concat(r,'" is using it.'))));const n=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],n.fire(new t.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),n.setEventedParent(null),n.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,t){if(this._checkLoaded(),void 0===this.sourceCaches[e])throw new Error("There is no source with this ID=".concat(e));const n=this.sourceCaches[e].getSource();if("geojson"!==n.type)throw new Error("geojsonSource.type is ".concat(n.type,", which is !== 'geojson"));n.setData(t),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=e.id;if(this.getLayer(i))return void this.fire(new t.j(new Error('Layer "'.concat(i,'" already exists on this map.'))));let a;if("custom"===e.type){if(ct(this,t.aD(e)))return;a=t.aA(e)}else{if("source"in e&&"object"==typeof e.source&&(this.addSource(i,e.source),e=t.aB(e),e=t.e(e,{source:i})),this._validate(t.u.layer,"layers.".concat(i),e,{arrayIndex:-1},r))return;a=t.aA(e),this._validateLayer(a),a.setEventedParent(this,{layer:{id:i}})}const o=n?this._order.indexOf(n):this._order.length;if(n&&-1===o)this.fire(new t.j(new Error('Cannot add layer "'.concat(i,'" before non-existing layer "').concat(n,'".'))));else{if(this._order.splice(o,0,i),this._layerOrderChanged=!0,this._layers[i]=a,this._removedLayers[i]&&a.source&&"custom"!==a.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==a.type?this._updatedSources[a.source]="clear":(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause())}this._updateLayer(a),a.onAdd&&a.onAdd(this.map)}}moveLayer(e,n){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new t.j(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be moved."))));if(e===n)return;const r=this._order.indexOf(e);this._order.splice(r,1);const i=n?this._order.indexOf(n):this._order.length;n&&-1===i?this.fire(new t.j(new Error('Cannot move layer "'.concat(e,'" before non-existing layer "').concat(n,'".')))):(this._order.splice(i,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const n=this._layers[e];if(!n)return void this.fire(new t.j(new Error('Cannot remove non-existing layer "'.concat(e,'".'))));n.setEventedParent(null);const r=this._order.indexOf(e);this._order.splice(r,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=n,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],n.onRemove&&n.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,n,r){this._checkLoaded();const i=this.getLayer(e);i?i.minzoom===n&&i.maxzoom===r||(null!=n&&(i.minzoom=n),null!=r&&(i.maxzoom=r),this._updateLayer(i)):this.fire(new t.j(new Error('Cannot set the zoom range of non-existing layer "'.concat(e,'".'))))}setFilter(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._checkLoaded();const i=this.getLayer(e);if(i){if(!t.aE(i.filter,n))return null==n?(i.filter=void 0,void this._updateLayer(i)):void(this._validate(t.u.filter,"layers.".concat(i.id,".filter"),n,null,r)||(i.filter=t.aB(n),this._updateLayer(i)))}else this.fire(new t.j(new Error('Cannot filter non-existing layer "'.concat(e,'".'))))}getFilter(e){return t.aB(this.getLayer(e).filter)}setLayoutProperty(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(e);a?t.aE(a.getLayoutProperty(n),r)||(a.setLayoutProperty(n,r,i),this._updateLayer(a)):this.fire(new t.j(new Error('Cannot style non-existing layer "'.concat(e,'".'))))}getLayoutProperty(e,n){const r=this.getLayer(e);if(r)return r.getLayoutProperty(n);this.fire(new t.j(new Error('Cannot get style of non-existing layer "'.concat(e,'".'))))}setPaintProperty(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this._checkLoaded();const a=this.getLayer(e);a?t.aE(a.getPaintProperty(n),r)||(a.setPaintProperty(n,r,i)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new t.j(new Error('Cannot style non-existing layer "'.concat(e,'".'))))}getPaintProperty(e,t){return this.getLayer(e).getPaintProperty(t)}setFeatureState(e,n){this._checkLoaded();const r=e.source,i=e.sourceLayer,a=this.sourceCaches[r];if(void 0===a)return void this.fire(new t.j(new Error("The source '".concat(r,"' does not exist in the map's style."))));const o=a.getSource().type;"geojson"===o&&i?this.fire(new t.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==o||i?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),a.setFeatureState(i,e.id,n)):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,n){this._checkLoaded();const r=e.source,i=this.sourceCaches[r];if(void 0===i)return void this.fire(new t.j(new Error("The source '".concat(r,"' does not exist in the map's style."))));const a=i.getSource().type,o="vector"===a?e.sourceLayer:void 0;"vector"!==a||o?n&&"string"!=typeof e.id&&"number"!=typeof e.id?this.fire(new t.j(new Error("A feature id is required to remove its specific state property."))):i.removeFeatureState(o,e.id,n):this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const n=e.source,r=e.sourceLayer,i=this.sourceCaches[n];if(void 0!==i)return"vector"!==i.getSource().type||r?(void 0===e.id&&this.fire(new t.j(new Error("The feature id parameter must be provided."))),i.getFeatureState(r,e.id)):void this.fire(new t.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new t.j(new Error("The source '".concat(n,"' does not exist in the map's style."))))}getTransition(){return t.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=t.aF(this.sourceCaches,e=>e.serialize()),n=this._serializeByIds(this._order,!0),r=this.map.getTerrain()||void 0,i=this.stylesheet;return t.aG({version:i.version,name:i.name,metadata:i.metadata,light:i.light,sky:i.sky,center:i.center,zoom:i.zoom,bearing:i.bearing,pitch:i.pitch,sprite:i.sprite,glyphs:i.glyphs,transition:i.transition,sources:e,layers:n,terrain:r},e=>void 0!==e)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&"raster"!==this.sourceCaches[e.source].getSource().type&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,n={},r=[];for(let a=this._order.length-1;a>=0;a--){const i=this._order[a];if(t(i)){n[i]=a;for(const t of e){const e=t[i];if(e)for(const t of e)r.push(t)}}}r.sort((e,t)=>t.intersectionZ-e.intersectionZ);const i=[];for(let a=this._order.length-1;a>=0;a--){const o=this._order[a];if(t(o))for(let e=r.length-1;e>=0;e--){const t=r[e].feature;if(n[t.layer.id]<a)break;i.push(t),r.pop()}else for(const t of e){const e=t[o];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(e,n,r){n&&n.filter&&this._validate(t.u.filter,"queryRenderedFeatures.filter",n.filter,null,n);const i={};if(n&&n.layers){if(!Array.isArray(n.layers))return this.fire(new t.j(new Error("parameters.layers must be an Array."))),[];for(const e of n.layers){const n=this._layers[e];if(!n)return this.fire(new t.j(new Error("The layer '".concat(e,"' does not exist in the map's style and cannot be queried for features.")))),[];i[n.source]=!0}}const a=[];n.availableImages=this._availableImages;const o=this._serializedAllLayers();for(const t in this.sourceCaches)n.layers&&!i[t]||a.push(q(this.sourceCaches[t],this._layers,o,e,n,r));return this.placement&&a.push(function(e,t,n,r,i,a,o){const s={},l=a.queryRenderedSymbols(r),u=[];for(const c of Object.keys(l).map(Number))u.push(o[c]);u.sort(H);for(const c of u){const n=c.featureIndex.lookupSymbolFeatures(l[c.bucketInstanceId],t,c.bucketIndex,c.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(const e in n){const t=s[e]=s[e]||[],r=n[e];r.sort((e,t)=>{const n=c.featureSortOrder;if(n){const r=n.indexOf(e.featureIndex);return n.indexOf(t.featureIndex)-r}return t.featureIndex-e.featureIndex});for(const e of r)t.push(e)}}for(const c in s)s[c].forEach(t=>{const r=t.feature,i=n[e[c].source].getFeatureState(r.layer["source-layer"],r.id);r.source=r.layer.source,r.layer["source-layer"]&&(r.sourceLayer=r.layer["source-layer"]),r.state=i});return s}(this._layers,o,this.sourceCaches,e,n,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(a)}querySourceFeatures(e,n){n&&n.filter&&this._validate(t.u.filter,"querySourceFeatures.filter",n.filter,null,n);const r=this.sourceCaches[e];return r?function(e,t){const n=e.getRenderableIds().map(t=>e.getTileByID(t)),r=[],i={};for(let a=0;a<n.length;a++){const e=n[a],o=e.tileID.canonical.key;i[o]||(i[o]=!0,e.querySourceFeatures(r,t))}return r}(r,n):[]}getLight(){return this.light.getLight()}setLight(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded();const r=this.light.getLight();let i=!1;for(const a in e)if(!t.aE(e[a],r[a])){i=!0;break}if(!i)return;const o={now:a.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,n),this.light.updateTransitions(o)}getSky(){var e;return null===(e=this.stylesheet)||void 0===e?void 0:e.sky}setSky(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.getSky();let i=!1;if(!e&&!r)return;if(e&&!r)i=!0;else if(!e&&r)i=!0;else for(const a in e)if(!t.aE(e[a],r[a])){i=!0;break}if(!i)return;const o={now:a.now(),transition:t.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,n),this.sky.updateTransitions(o)}_validate(e,n,r,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(!a||!1!==a.validate)&&ct(this,e.call(t.u,t.e({key:n,style:this.serialize(),value:r,styleSpec:t.v},i)))}_remove(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),se().off(ie,this._rtlPluginLoaded);for(const t in this._layers)this._layers[t].setEventedParent(null);for(const t in this.sourceCaches){const e=this.sourceCaches[t];e.setEventedParent(null),e.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const t in this.sourceCaches)this.sourceCaches[t].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=!1,s=!1;const l={};for(const a of this._order){const t=this._layers[a];if("symbol"!==t.type)continue;if(!l[t.source]){const e=this.sourceCaches[t.source];l[t.source]=e.getRenderableIds(!0).map(t=>e.getTileByID(t)).sort((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1))}const n=this.crossTileSymbolIndex.addLayer(t,l[t.source],e.center.lng);o=o||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((i=i||this._layerOrderChanged||0===n)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.now(),e.zoom))&&(this.pauseablePlacement=new it(e,this.map.terrain,this._order,i,t,n,r,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,l),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.now()),s=!0),o&&this.pauseablePlacement.placement.setStale()),s||o)for(const a of this._order){const e=this._layers[a];"symbol"===e.type&&this.placement.updateLayerOpacities(e,l[e.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,n){return t._(this,void 0,void 0,function*(){const e=yield this.imageManager.getImages(n.icons);this._updateTilesForChangedImages();const t=this.sourceCaches[n.source];return t&&t.setDependencies(n.tileID.key,n.type,n.icons),e})}getGlyphs(e,n){return t._(this,void 0,void 0,function*(){const e=yield this.glyphManager.getGlyphs(n.stacks),t=this.sourceCaches[n.source];return t&&t.setDependencies(n.tileID.key,n.type,[""]),e})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkLoaded(),e&&this._validate(t.u.glyphs,"glyphs",e,null,n)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;this._checkLoaded();const a=[{id:e,url:n}],o=[..._(this.stylesheet.sprite),...a];this._validate(t.u.sprite,"sprite",o,null,r)||(this.stylesheet.sprite=o,this._loadSprite(a,!0,i))}removeSprite(e){this._checkLoaded();const n=_(this.stylesheet.sprite);if(n.find(t=>t.id===e)){if(this._spritesImagesIds[e])for(const t of this._spritesImagesIds[e])this.imageManager.removeImage(t),this._changedImages[t]=!0;n.splice(n.findIndex(t=>t.id===e),1),this.stylesheet.sprite=n.length>0?n:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new t.k("data",{dataType:"style"}))}else this.fire(new t.j(new Error('Sprite "'.concat(e,"\" doesn't exists on this map."))))}getSprite(){return _(this.stylesheet.sprite)}setSprite(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;this._checkLoaded(),e&&this._validate(t.u.sprite,"sprite",e,null,n)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,r):(this._unloadSprite(),r&&r(null)))}}var ft=t.Y([{name:"a_pos",type:"Int16",components:2}]);const pt={prelude:mt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:mt("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:mt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:mt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:mt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:mt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,get_elevation(floor(a_pos*0.5)),1);gl_Position=u_matrix*pos;}"),heatmapTexture:mt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:mt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_anchor_pos;attribute vec2 a_placed;attribute vec2 a_box_real;uniform mat4 u_matrix;uniform vec2 u_pixel_extrude_scale;varying float v_placed;varying float v_notUsed;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:mt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:mt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:mt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:mt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:mt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:mt("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:mt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:mt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:mt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:mt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:mt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:mt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:mt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_tex;varying float v_fade_opacity;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:mt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec2 v_data0;varying vec3 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:mt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;varying vec4 v_data0;varying vec4 v_data1;vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_matrix*vec4(posInTile,elevation,1.0);}\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:mt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;varying vec2 v_texture_pos;varying float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture2D(u_texture,v_texture_pos);if (v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);gl_FragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {gl_FragColor=surface_color;}}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform mat4 u_fog_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:mt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:mt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=u_matrix*vec4(a_pos3d.xy,ele-ele_delta,1.0);}"),sky:mt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform float u_horizon;uniform float u_sky_horizon_blend;void main() {float y=gl_FragCoord.y;if (y > u_horizon) {float blend=y-u_horizon;if (blend < u_sky_horizon_blend) {gl_FragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {gl_FragColor=u_sky_color;}}}","attribute vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function mt(e,t){const n=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,r=t.match(/attribute ([\w]+) ([\w]+)/g),i=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),a=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),o=a?a.concat(i):i,s={};return{fragmentSource:e=e.replace(n,(e,t,n,r,i)=>(s[i]=!0,"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"\n#ifdef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"))),vertexSource:t=t.replace(n,(e,t,n,r,i)=>{const a="float"===r?"vec2":"vec4",o=i.match(/color/)?"color":a;return s[i]?"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(a," a_").concat(i,";\nvarying ").concat(n," ").concat(r," ").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(i," = unpack_mix_").concat(o,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"define"===t?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\nuniform lowp float u_").concat(i,"_t;\nattribute ").concat(n," ").concat(a," a_").concat(i,";\n#else\nuniform ").concat(n," ").concat(r," u_").concat(i,";\n#endif\n"):"vec4"===o?"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = a_").concat(i,";\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n"):"\n#ifndef HAS_UNIFORM_u_".concat(i,"\n    ").concat(n," ").concat(r," ").concat(i," = unpack_mix_").concat(o,"(a_").concat(i,", u_").concat(i,"_t);\n#else\n    ").concat(n," ").concat(r," ").concat(i," = u_").concat(i,";\n#endif\n")}),staticAttributes:r,staticUniforms:o}}class gt{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,t,n,r,i,a,o,s,l){this.context=e;let u=this.boundPaintVertexBuffers.length!==r.length;for(let c=0;!u&&c<r.length;c++)this.boundPaintVertexBuffers[c]!==r[c]&&(u=!0);!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==n||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==a||this.boundDynamicVertexBuffer!==o||this.boundDynamicVertexBuffer2!==s||this.boundDynamicVertexBuffer3!==l?this.freshBind(t,n,r,i,a,o,s,l):(e.bindVertexArray.set(this.vao),o&&o.bind(),i&&i.dynamicDraw&&i.bind(),s&&s.bind(),l&&l.bind())}freshBind(e,t,n,r,i,a,o,s){const l=e.numAttributes,u=this.context,c=u.gl;this.vao&&this.destroy(),this.vao=u.createVertexArray(),u.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=n,this.boundIndexBuffer=r,this.boundVertexOffset=i,this.boundDynamicVertexBuffer=a,this.boundDynamicVertexBuffer2=o,this.boundDynamicVertexBuffer3=s,t.enableAttributes(c,e);for(const d of n)d.enableAttributes(c,e);a&&a.enableAttributes(c,e),o&&o.enableAttributes(c,e),s&&s.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);for(const d of n)d.bind(),d.setVertexAttribPointers(c,e,i);a&&(a.bind(),a.setVertexAttribPointers(c,e,i)),r&&r.bind(),o&&(o.bind(),o.setVertexAttribPointers(c,e,i)),s&&(s.bind(),s.setVertexAttribPointers(c,e,i)),u.currentNumAttributes=l}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const yt=(e,n,r,i,a)=>({u_matrix:e,u_texture:0,u_ele_delta:n,u_fog_matrix:r,u_fog_color:i?i.properties.get("fog-color"):t.aM.white,u_fog_ground_blend:i?i.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:i?i.calculateFogBlendOpacity(a):0,u_horizon_color:i?i.properties.get("horizon-color"):t.aM.white,u_horizon_fog_blend:i?i.properties.get("horizon-fog-blend"):1});function vt(e){const t=[];for(let n=0;n<e.length;n++){if(null===e[n])continue;const r=e[n].split(" ");t.push(r.pop())}return t}class _t{constructor(e,n,r,i,a,o){const s=e.gl;this.program=s.createProgram();const l=vt(n.staticAttributes),u=r?r.getBinderAttributes():[],c=l.concat(u),d=pt.prelude.staticUniforms?vt(pt.prelude.staticUniforms):[],h=n.staticUniforms?vt(n.staticUniforms):[],f=r?r.getBinderUniforms():[],p=d.concat(h).concat(f),m=[];for(const t of p)m.indexOf(t)<0&&m.push(t);const g=r?r.defines():[];a&&g.push("#define OVERDRAW_INSPECTOR;"),o&&g.push("#define TERRAIN3D;");const y=g.concat(pt.prelude.fragmentSource,n.fragmentSource).join("\n"),v=g.concat(pt.prelude.vertexSource,n.vertexSource).join("\n"),_=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(_,y),s.compileShader(_),!s.getShaderParameter(_,s.COMPILE_STATUS))throw new Error("Could not compile fragment shader: ".concat(s.getShaderInfoLog(_)));s.attachShader(this.program,_);const b=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);if(s.shaderSource(b,v),s.compileShader(b),!s.getShaderParameter(b,s.COMPILE_STATUS))throw new Error("Could not compile vertex shader: ".concat(s.getShaderInfoLog(b)));s.attachShader(this.program,b),this.attributes={};const x={};this.numAttributes=c.length;for(let t=0;t<this.numAttributes;t++)c[t]&&(s.bindAttribLocation(this.program,t,c[t]),this.attributes[c[t]]=t);if(s.linkProgram(this.program),!s.getProgramParameter(this.program,s.LINK_STATUS))throw new Error("Program failed to link: ".concat(s.getProgramInfoLog(this.program)));s.deleteShader(b),s.deleteShader(_);for(let t=0;t<m.length;t++){const e=m[t];if(e&&!x[e]){const t=s.getUniformLocation(this.program,e);t&&(x[e]=t)}}this.fixedUniforms=i(e,x),this.terrainUniforms=((e,n)=>({u_depth:new t.aH(e,n.u_depth),u_terrain:new t.aH(e,n.u_terrain),u_terrain_dim:new t.aI(e,n.u_terrain_dim),u_terrain_matrix:new t.aJ(e,n.u_terrain_matrix),u_terrain_unpack:new t.aK(e,n.u_terrain_unpack),u_terrain_exaggeration:new t.aI(e,n.u_terrain_exaggeration)}))(e,x),this.binderUniforms=r?r.getUniforms(e,x):[]}draw(e,t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y){const v=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(n),e.setStencilMode(r),e.setColorMode(i),e.setCullFace(a),s){e.activeTexture.set(v.TEXTURE2),v.bindTexture(v.TEXTURE_2D,s.depthTexture),e.activeTexture.set(v.TEXTURE3),v.bindTexture(v.TEXTURE_2D,s.texture);for(const e in this.terrainUniforms)this.terrainUniforms[e].set(s[e])}for(const b in this.fixedUniforms)this.fixedUniforms[b].set(o[b]);p&&p.setUniforms(e,this.binderUniforms,h,{zoom:f});let _=0;switch(t){case v.LINES:_=2;break;case v.TRIANGLES:_=3;break;case v.LINE_STRIP:_=1}for(const b of d.get()){const n=b.vaos||(b.vaos={});(n[l]||(n[l]=new gt)).bind(e,this,u,p?p.getPaintVertexBuffers():[],c,b.vertexOffset,m,g,y),v.drawElements(t,b.primitiveLength*_,v.UNSIGNED_SHORT,b.primitiveOffset*_*2)}}}function bt(e,t,n){const r=1/Be(n,1,t.transform.tileZoom),i=Math.pow(2,n.tileID.overscaledZ),a=n.tileSize*Math.pow(2,t.transform.tileZoom)/i,o=a*(n.tileID.canonical.x+n.tileID.wrap*i),s=a*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_scale:[r,e.fromScale,e.toScale],u_fade:e.t,u_pixel_coord_upper:[o>>16,s>>16],u_pixel_coord_lower:[65535&o,65535&s]}}const xt=(e,n,r,i)=>{const a=n.style.light,o=a.properties.get("position"),s=[o.x,o.y,o.z],l=function(){var e=new t.A(9);return t.A!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}();"viewport"===a.properties.get("anchor")&&function(e,t){var n=Math.sin(t),r=Math.cos(t);e[0]=r,e[1]=n,e[2]=0,e[3]=-n,e[4]=r,e[5]=0,e[6]=0,e[7]=0,e[8]=1}(l,-n.transform.angle),function(e,t,n){var r=t[0],i=t[1],a=t[2];e[0]=r*n[0]+i*n[3]+a*n[6],e[1]=r*n[1]+i*n[4]+a*n[7],e[2]=r*n[2]+i*n[5]+a*n[8]}(s,s,l);const u=a.properties.get("color");return{u_matrix:e,u_lightpos:s,u_lightintensity:a.properties.get("intensity"),u_lightcolor:[u.r,u.g,u.b],u_vertical_gradient:+r,u_opacity:i}},wt=(e,n,r,i,a,o,s)=>t.e(xt(e,n,r,i),bt(o,n,s),{u_height_factor:-Math.pow(2,a.overscaledZ)/s.tileSize/8}),kt=e=>({u_matrix:e}),St=(e,n,r,i)=>t.e(kt(e),bt(r,n,i)),Et=(e,t)=>({u_matrix:e,u_world:t}),Ct=(e,n,r,i,a)=>t.e(St(e,n,r,i),{u_world:a}),Pt=(e,t,n,r)=>{const i=e.transform;let a,o;if("map"===r.paint.get("circle-pitch-alignment")){const e=Be(n,1,i.zoom);a=!0,o=[e,e]}else a=!1,o=i.pixelsToGLUnits;return{u_camera_to_center_distance:i.cameraToCenterDistance,u_scale_with_map:+("map"===r.paint.get("circle-pitch-scale")),u_matrix:e.translatePosMatrix(t.posMatrix,n,r.paint.get("circle-translate"),r.paint.get("circle-translate-anchor")),u_pitch_with_map:+a,u_device_pixel_ratio:e.pixelRatio,u_extrude_scale:o}},Dt=(e,t,n)=>({u_matrix:e,u_inv_matrix:t,u_camera_to_center_distance:n.cameraToCenterDistance,u_viewport_size:[n.width,n.height]}),It=function(e,t){return{u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:arguments.length>2&&void 0!==arguments[2]?arguments[2]:1}},Tt=e=>({u_matrix:e}),At=(e,t,n,r)=>({u_matrix:e,u_extrude_scale:Be(t,1,n),u_intensity:r}),zt=(e,n,r,i)=>{const a=t.H();t.aP(a,0,e.width,e.height,0,0,1);const o=e.context.gl;return{u_matrix:a,u_world:[o.drawingBufferWidth,o.drawingBufferHeight],u_image:r,u_color_ramp:i,u_opacity:n.paint.get("heatmap-opacity")}};function Ot(e,n){const r=Math.pow(2,n.canonical.z),i=n.canonical.y;return[new t.Z(0,i/r).toLngLat().lat,new t.Z(0,(i+1)/r).toLngLat().lat]}const Ft=(e,t,n,r)=>{const i=e.transform;return{u_matrix:Lt(e,t,n,r),u_ratio:1/Be(t,1,i.zoom),u_device_pixel_ratio:e.pixelRatio,u_units_to_pixels:[1/i.pixelsToGLUnits[0],1/i.pixelsToGLUnits[1]]}},Mt=(e,n,r,i,a)=>t.e(Ft(e,n,r,a),{u_image:0,u_image_height:i}),jt=(e,t,n,r,i)=>{const a=e.transform,o=Rt(t,a);return{u_matrix:Lt(e,t,n,i),u_texsize:t.imageAtlasTexture.size,u_ratio:1/Be(t,1,a.zoom),u_device_pixel_ratio:e.pixelRatio,u_image:0,u_scale:[o,r.fromScale,r.toScale],u_fade:r.t,u_units_to_pixels:[1/a.pixelsToGLUnits[0],1/a.pixelsToGLUnits[1]]}},Bt=(e,n,r,i,a,o)=>{const s=e.lineAtlas,l=Rt(n,e.transform),u="round"===r.layout.get("line-cap"),c=s.getDash(i.from,u),d=s.getDash(i.to,u),h=c.width*a.fromScale,f=d.width*a.toScale;return t.e(Ft(e,n,r,o),{u_patternscale_a:[l/h,-c.height/2],u_patternscale_b:[l/f,-d.height/2],u_sdfgamma:s.width/(256*Math.min(h,f)*e.pixelRatio)/2,u_image:0,u_tex_y_a:c.y,u_tex_y_b:d.y,u_mix:a.t})};function Rt(e,t){return 1/Be(e,1,t.tileZoom)}function Lt(e,t,n,r){return e.translatePosMatrix(r?r.posMatrix:t.tileID.posMatrix,t,n.paint.get("line-translate"),n.paint.get("line-translate-anchor"))}const Nt=(e,t,n,r,i)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:n,u_buffer_scale:1,u_fade_t:r.mix,u_opacity:r.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(o=i.paint.get("raster-saturation"),o>0?1-1/(1.001-o):-o),u_contrast_factor:(a=i.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:Ut(i.paint.get("raster-hue-rotate"))};var a,o};function Ut(e){e*=Math.PI/180;const t=Math.sin(e),n=Math.cos(e);return[(2*n+1)/3,(-Math.sqrt(3)*t-n+1)/3,(Math.sqrt(3)*t-n+1)/3]}const Vt=(e,t,n,r,i,a,o,s,l,u,c,d,h,f)=>{const p=o.transform;return{u_is_size_zoom_constant:+("constant"===e||"source"===e),u_is_size_feature_constant:+("constant"===e||"camera"===e),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:p.cameraToCenterDistance,u_pitch:p.pitch/360*2*Math.PI,u_rotate_symbol:+n,u_aspect_ratio:p.width/p.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:l,u_coord_matrix:u,u_is_text:+d,u_pitch_with_map:+r,u_is_along_line:i,u_is_variable_anchor:a,u_texsize:h,u_texture:0,u_translation:c,u_pitched_scale:f}},qt=(e,n,r,i,a,o,s,l,u,c,d,h,f,p,m)=>{const g=s.transform;return t.e(Vt(e,n,r,i,a,o,s,l,u,c,d,h,f,m),{u_gamma_scale:i?Math.cos(g._pitch)*g.cameraToCenterDistance:1,u_device_pixel_ratio:s.pixelRatio,u_is_halo:+p})},Ht=(e,n,r,i,a,o,s,l,u,c,d,h,f,p)=>t.e(qt(e,n,r,i,a,o,s,l,u,c,d,!0,h,!0,p),{u_texsize_icon:f,u_texture_icon:1}),Wt=(e,t,n)=>({u_matrix:e,u_opacity:t,u_color:n}),Zt=(e,n,r,i,a,o)=>t.e(function(e,t,n,r){const i=n.imageManager.getPattern(e.from.toString()),a=n.imageManager.getPattern(e.to.toString()),{width:o,height:s}=n.imageManager.getPixelSize(),l=Math.pow(2,r.tileID.overscaledZ),u=r.tileSize*Math.pow(2,n.transform.tileZoom)/l,c=u*(r.tileID.canonical.x+r.tileID.wrap*l),d=u*r.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:i.tl,u_pattern_br_a:i.br,u_pattern_tl_b:a.tl,u_pattern_br_b:a.br,u_texsize:[o,s],u_mix:t.t,u_pattern_size_a:i.displaySize,u_pattern_size_b:a.displaySize,u_scale_a:t.fromScale,u_scale_b:t.toScale,u_tile_units_to_pixels:1/Be(r,1,n.transform.tileZoom),u_pixel_coord_upper:[c>>16,d>>16],u_pixel_coord_lower:[65535&c,65535&d]}}(i,o,r,a),{u_matrix:e,u_opacity:n}),Kt={fillExtrusion:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_lightpos:new t.aN(e,n.u_lightpos),u_lightintensity:new t.aI(e,n.u_lightintensity),u_lightcolor:new t.aN(e,n.u_lightcolor),u_vertical_gradient:new t.aI(e,n.u_vertical_gradient),u_opacity:new t.aI(e,n.u_opacity)}),fillExtrusionPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_lightpos:new t.aN(e,n.u_lightpos),u_lightintensity:new t.aI(e,n.u_lightintensity),u_lightcolor:new t.aN(e,n.u_lightcolor),u_vertical_gradient:new t.aI(e,n.u_vertical_gradient),u_height_factor:new t.aI(e,n.u_height_factor),u_image:new t.aH(e,n.u_image),u_texsize:new t.aO(e,n.u_texsize),u_pixel_coord_upper:new t.aO(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aO(e,n.u_pixel_coord_lower),u_scale:new t.aN(e,n.u_scale),u_fade:new t.aI(e,n.u_fade),u_opacity:new t.aI(e,n.u_opacity)}),fill:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix)}),fillPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_texsize:new t.aO(e,n.u_texsize),u_pixel_coord_upper:new t.aO(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aO(e,n.u_pixel_coord_lower),u_scale:new t.aN(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),fillOutline:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aO(e,n.u_world)}),fillOutlinePattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aO(e,n.u_world),u_image:new t.aH(e,n.u_image),u_texsize:new t.aO(e,n.u_texsize),u_pixel_coord_upper:new t.aO(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aO(e,n.u_pixel_coord_lower),u_scale:new t.aN(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),circle:(e,n)=>({u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_scale_with_map:new t.aH(e,n.u_scale_with_map),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_extrude_scale:new t.aO(e,n.u_extrude_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_matrix:new t.aJ(e,n.u_matrix)}),collisionBox:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_pixel_extrude_scale:new t.aO(e,n.u_pixel_extrude_scale)}),collisionCircle:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_inv_matrix:new t.aJ(e,n.u_inv_matrix),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_viewport_size:new t.aO(e,n.u_viewport_size)}),debug:(e,n)=>({u_color:new t.aL(e,n.u_color),u_matrix:new t.aJ(e,n.u_matrix),u_overlay:new t.aH(e,n.u_overlay),u_overlay_scale:new t.aI(e,n.u_overlay_scale)}),clippingMask:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix)}),heatmap:(e,n)=>({u_extrude_scale:new t.aI(e,n.u_extrude_scale),u_intensity:new t.aI(e,n.u_intensity),u_matrix:new t.aJ(e,n.u_matrix)}),heatmapTexture:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_world:new t.aO(e,n.u_world),u_image:new t.aH(e,n.u_image),u_color_ramp:new t.aH(e,n.u_color_ramp),u_opacity:new t.aI(e,n.u_opacity)}),hillshade:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_latrange:new t.aO(e,n.u_latrange),u_light:new t.aO(e,n.u_light),u_shadow:new t.aL(e,n.u_shadow),u_highlight:new t.aL(e,n.u_highlight),u_accent:new t.aL(e,n.u_accent)}),hillshadePrepare:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_image:new t.aH(e,n.u_image),u_dimension:new t.aO(e,n.u_dimension),u_zoom:new t.aI(e,n.u_zoom),u_unpack:new t.aK(e,n.u_unpack)}),line:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aO(e,n.u_units_to_pixels)}),lineGradient:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aO(e,n.u_units_to_pixels),u_image:new t.aH(e,n.u_image),u_image_height:new t.aI(e,n.u_image_height)}),linePattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texsize:new t.aO(e,n.u_texsize),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_image:new t.aH(e,n.u_image),u_units_to_pixels:new t.aO(e,n.u_units_to_pixels),u_scale:new t.aN(e,n.u_scale),u_fade:new t.aI(e,n.u_fade)}),lineSDF:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ratio:new t.aI(e,n.u_ratio),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_units_to_pixels:new t.aO(e,n.u_units_to_pixels),u_patternscale_a:new t.aO(e,n.u_patternscale_a),u_patternscale_b:new t.aO(e,n.u_patternscale_b),u_sdfgamma:new t.aI(e,n.u_sdfgamma),u_image:new t.aH(e,n.u_image),u_tex_y_a:new t.aI(e,n.u_tex_y_a),u_tex_y_b:new t.aI(e,n.u_tex_y_b),u_mix:new t.aI(e,n.u_mix)}),raster:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_tl_parent:new t.aO(e,n.u_tl_parent),u_scale_parent:new t.aI(e,n.u_scale_parent),u_buffer_scale:new t.aI(e,n.u_buffer_scale),u_fade_t:new t.aI(e,n.u_fade_t),u_opacity:new t.aI(e,n.u_opacity),u_image0:new t.aH(e,n.u_image0),u_image1:new t.aH(e,n.u_image1),u_brightness_low:new t.aI(e,n.u_brightness_low),u_brightness_high:new t.aI(e,n.u_brightness_high),u_saturation_factor:new t.aI(e,n.u_saturation_factor),u_contrast_factor:new t.aI(e,n.u_contrast_factor),u_spin_weights:new t.aN(e,n.u_spin_weights)}),symbolIcon:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aO(e,n.u_texsize),u_texture:new t.aH(e,n.u_texture),u_translation:new t.aO(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),symbolSDF:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aO(e,n.u_texsize),u_texture:new t.aH(e,n.u_texture),u_gamma_scale:new t.aI(e,n.u_gamma_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_is_halo:new t.aH(e,n.u_is_halo),u_translation:new t.aO(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),symbolTextAndIcon:(e,n)=>({u_is_size_zoom_constant:new t.aH(e,n.u_is_size_zoom_constant),u_is_size_feature_constant:new t.aH(e,n.u_is_size_feature_constant),u_size_t:new t.aI(e,n.u_size_t),u_size:new t.aI(e,n.u_size),u_camera_to_center_distance:new t.aI(e,n.u_camera_to_center_distance),u_pitch:new t.aI(e,n.u_pitch),u_rotate_symbol:new t.aH(e,n.u_rotate_symbol),u_aspect_ratio:new t.aI(e,n.u_aspect_ratio),u_fade_change:new t.aI(e,n.u_fade_change),u_matrix:new t.aJ(e,n.u_matrix),u_label_plane_matrix:new t.aJ(e,n.u_label_plane_matrix),u_coord_matrix:new t.aJ(e,n.u_coord_matrix),u_is_text:new t.aH(e,n.u_is_text),u_pitch_with_map:new t.aH(e,n.u_pitch_with_map),u_is_along_line:new t.aH(e,n.u_is_along_line),u_is_variable_anchor:new t.aH(e,n.u_is_variable_anchor),u_texsize:new t.aO(e,n.u_texsize),u_texsize_icon:new t.aO(e,n.u_texsize_icon),u_texture:new t.aH(e,n.u_texture),u_texture_icon:new t.aH(e,n.u_texture_icon),u_gamma_scale:new t.aI(e,n.u_gamma_scale),u_device_pixel_ratio:new t.aI(e,n.u_device_pixel_ratio),u_is_halo:new t.aH(e,n.u_is_halo),u_translation:new t.aO(e,n.u_translation),u_pitched_scale:new t.aI(e,n.u_pitched_scale)}),background:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_opacity:new t.aI(e,n.u_opacity),u_color:new t.aL(e,n.u_color)}),backgroundPattern:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_opacity:new t.aI(e,n.u_opacity),u_image:new t.aH(e,n.u_image),u_pattern_tl_a:new t.aO(e,n.u_pattern_tl_a),u_pattern_br_a:new t.aO(e,n.u_pattern_br_a),u_pattern_tl_b:new t.aO(e,n.u_pattern_tl_b),u_pattern_br_b:new t.aO(e,n.u_pattern_br_b),u_texsize:new t.aO(e,n.u_texsize),u_mix:new t.aI(e,n.u_mix),u_pattern_size_a:new t.aO(e,n.u_pattern_size_a),u_pattern_size_b:new t.aO(e,n.u_pattern_size_b),u_scale_a:new t.aI(e,n.u_scale_a),u_scale_b:new t.aI(e,n.u_scale_b),u_pixel_coord_upper:new t.aO(e,n.u_pixel_coord_upper),u_pixel_coord_lower:new t.aO(e,n.u_pixel_coord_lower),u_tile_units_to_pixels:new t.aI(e,n.u_tile_units_to_pixels)}),terrain:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texture:new t.aH(e,n.u_texture),u_ele_delta:new t.aI(e,n.u_ele_delta),u_fog_matrix:new t.aJ(e,n.u_fog_matrix),u_fog_color:new t.aL(e,n.u_fog_color),u_fog_ground_blend:new t.aI(e,n.u_fog_ground_blend),u_fog_ground_blend_opacity:new t.aI(e,n.u_fog_ground_blend_opacity),u_horizon_color:new t.aL(e,n.u_horizon_color),u_horizon_fog_blend:new t.aI(e,n.u_horizon_fog_blend)}),terrainDepth:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_ele_delta:new t.aI(e,n.u_ele_delta)}),terrainCoords:(e,n)=>({u_matrix:new t.aJ(e,n.u_matrix),u_texture:new t.aH(e,n.u_texture),u_terrain_coords_id:new t.aI(e,n.u_terrain_coords_id),u_ele_delta:new t.aI(e,n.u_ele_delta)}),sky:(e,n)=>({u_sky_color:new t.aL(e,n.u_sky_color),u_horizon_color:new t.aL(e,n.u_horizon_color),u_horizon:new t.aI(e,n.u_horizon),u_sky_horizon_blend:new t.aI(e,n.u_sky_horizon_blend)})};class Gt{constructor(e,t,n){this.context=e;const r=e.gl;this.buffer=r.createBuffer(),this.dynamicDraw=Boolean(n),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),r.bufferData(r.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?r.DYNAMIC_DRAW:r.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Xt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class $t{constructor(e,t,n,r){this.length=t.length,this.attributes=n,this.itemSize=t.bytesPerElement,this.dynamicDraw=r,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||delete t.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error("Length of new data is ".concat(e.length,", which doesn't match current length of ").concat(this.length));const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let n=0;n<this.attributes.length;n++){const r=t.attributes[this.attributes[n].name];void 0!==r&&e.enableVertexAttribArray(r)}}setVertexAttribPointers(e,t,n){for(let r=0;r<this.attributes.length;r++){const i=this.attributes[r],a=t.attributes[i.name];void 0!==a&&e.vertexAttribPointer(a,i.components,e[Xt[i.type]],!1,this.itemSize,i.offset+this.itemSize*(n||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yt=new WeakMap;function Jt(e){var t;if(Yt.has(e))return Yt.get(e);{const n=null===(t=e.getParameter(e.VERSION))||void 0===t?void 0:t.startsWith("WebGL 2.0");return Yt.set(e,n),n}}class Qt{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class en extends Qt{getDefault(){return t.aM.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class tn extends Qt{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class nn extends Qt{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class rn extends Qt{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class an extends Qt{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class on extends Qt{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class sn extends Qt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class ln extends Qt{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class un extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class cn extends Qt{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class dn extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class hn extends Qt{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class fn extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class pn extends Qt{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class mn extends Qt{getDefault(){return t.aM.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class gn extends Qt{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class yn extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class vn extends Qt{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class _n extends Qt{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class bn extends Qt{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class xn extends Qt{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class wn extends Qt{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class kn extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class Sn extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class En extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class Cn extends Qt{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Pn extends Qt{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Dn extends Qt{getDefault(){return null}set(e){var t;if(e===this.current&&!this.dirty)return;const n=this.gl;Jt(n)?n.bindVertexArray(e):null===(t=n.getExtension("OES_vertex_array_object"))||void 0===t||t.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class In extends Qt{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class Tn extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class An extends Qt{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class zn extends Qt{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class On extends zn{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class Fn extends zn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Mn extends zn{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class jn{constructor(e,t,n,r,i){this.context=e,this.width=t,this.height=n;const a=e.gl,o=this.framebuffer=a.createFramebuffer();if(this.colorAttachment=new On(e,o),r)this.depthAttachment=i?new Mn(e,o):new Fn(e,o);else if(i)throw new Error("Stencil cannot be set without depth");if(a.checkFramebufferStatus(a.FRAMEBUFFER)!==a.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Bn{constructor(e,t,n){this.blendFunction=e,this.blendColor=t,this.mask=n}}Bn.Replace=[1,0],Bn.disabled=new Bn(Bn.Replace,t.aM.transparent,[!1,!1,!1,!1]),Bn.unblended=new Bn(Bn.Replace,t.aM.transparent,[!0,!0,!0,!0]),Bn.alphaBlended=new Bn([1,771],t.aM.transparent,[!0,!0,!0,!0]);class Rn{constructor(e){var t,n;if(this.gl=e,this.clearColor=new en(this),this.clearDepth=new tn(this),this.clearStencil=new nn(this),this.colorMask=new rn(this),this.depthMask=new an(this),this.stencilMask=new on(this),this.stencilFunc=new sn(this),this.stencilOp=new ln(this),this.stencilTest=new un(this),this.depthRange=new cn(this),this.depthTest=new dn(this),this.depthFunc=new hn(this),this.blend=new fn(this),this.blendFunc=new pn(this),this.blendColor=new mn(this),this.blendEquation=new gn(this),this.cullFace=new yn(this),this.cullFaceSide=new vn(this),this.frontFace=new _n(this),this.program=new bn(this),this.activeTexture=new xn(this),this.viewport=new wn(this),this.bindFramebuffer=new kn(this),this.bindRenderbuffer=new Sn(this),this.bindTexture=new En(this),this.bindVertexBuffer=new Cn(this),this.bindElementBuffer=new Pn(this),this.bindVertexArray=new Dn(this),this.pixelStoreUnpack=new In(this),this.pixelStoreUnpackPremultiplyAlpha=new Tn(this),this.pixelStoreUnpackFlipY=new An(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Jt(e)){this.HALF_FLOAT=e.HALF_FLOAT;const r=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(t=e.RGBA16F)&&void 0!==t?t:null==r?void 0:r.RGBA16F_EXT,this.RGB16F=null!==(n=e.RGB16F)&&void 0!==n?n:null==r?void 0:r.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const t=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=null==t?void 0:t.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Gt(this,e,t)}createVertexBuffer(e,t,n){return new $t(this,e,t,n)}createRenderbuffer(e,t,n){const r=this.gl,i=r.createRenderbuffer();return this.bindRenderbuffer.set(i),r.renderbufferStorage(r.RENDERBUFFER,e,t,n),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,n,r){return new jn(this,e,t,n,r)}clear(e){let{color:t,depth:n,stencil:r}=e;const i=this.gl;let a=0;t&&(a|=i.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),void 0!==n&&(a|=i.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(n),this.depthMask.set(!0)),void 0!==r&&(a|=i.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),i.clear(a)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){t.aE(e.blendFunction,Bn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Jt(this.gl)?this.gl.createVertexArray():null===(e=this.gl.getExtension("OES_vertex_array_object"))||void 0===e?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var t;return Jt(this.gl)?this.gl.deleteVertexArray(e):null===(t=this.gl.getExtension("OES_vertex_array_object"))||void 0===t?void 0:t.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}class Ln{constructor(e,t,n){this.func=e,this.mask=t,this.range=n}}Ln.ReadOnly=!1,Ln.ReadWrite=!0,Ln.disabled=new Ln(519,Ln.ReadOnly,[0,1]);const Nn=7680;class Un{constructor(e,t,n,r,i,a){this.test=e,this.ref=t,this.mask=n,this.fail=r,this.depthFail=i,this.pass=a}}Un.disabled=new Un({func:519,mask:0},0,0,Nn,Nn,Nn);class Vn{constructor(e,t,n){this.enable=e,this.mode=t,this.frontFace=n}}let qn;function Hn(e,n,r,i,a){const o=e.context,s=o.gl,l=e.useProgram("collisionBox"),u=[];let c=0,d=0;for(let v=0;v<i.length;v++){const f=i[v],p=n.getTile(f).getBucket(r);if(!p)continue;const m=a?p.textCollisionBox:p.iconCollisionBox,g=p.collisionCircleArray;if(g.length>0){const n=t.H();t.aQ(n,p.placementInvProjMatrix,e.transform.glCoordMatrix),t.aQ(n,n,p.placementViewportMatrix),u.push({circleArray:g,circleOffset:d,transform:f.posMatrix,invTransform:n,coord:f}),c+=g.length/4,d=c}m&&l.draw(o,s.LINES,Ln.disabled,Un.disabled,e.colorModeForRenderPass(),Vn.disabled,{u_matrix:f.posMatrix,u_pixel_extrude_scale:[1/(h=e.transform).width,1/h.height]},e.style.map.terrain&&e.style.map.terrain.getTerrainData(f),r.id,m.layoutVertexBuffer,m.indexBuffer,m.segments,null,e.transform.zoom,null,null,m.collisionVertexBuffer)}var h;if(!a||!u.length)return;const f=e.useProgram("collisionCircle"),p=new t.aR;p.resize(4*c),p._trim();let m=0;for(const t of u)for(let e=0;e<t.circleArray.length/4;e++){const n=4*e,r=t.circleArray[n+0],i=t.circleArray[n+1],a=t.circleArray[n+2],o=t.circleArray[n+3];p.emplace(m++,r,i,a,o,0),p.emplace(m++,r,i,a,o,1),p.emplace(m++,r,i,a,o,2),p.emplace(m++,r,i,a,o,3)}(!qn||qn.length<2*c)&&(qn=function(e){const n=2*e,r=new t.aT;r.resize(n),r._trim();for(let t=0;t<n;t++){const e=6*t;r.uint16[e+0]=4*t+0,r.uint16[e+1]=4*t+1,r.uint16[e+2]=4*t+2,r.uint16[e+3]=4*t+2,r.uint16[e+4]=4*t+3,r.uint16[e+5]=4*t+0}return r}(c));const g=o.createIndexBuffer(qn,!0),y=o.createVertexBuffer(p,t.aS.members,!0);for(const v of u){const n=Dt(v.transform,v.invTransform,e.transform);f.draw(o,s.TRIANGLES,Ln.disabled,Un.disabled,e.colorModeForRenderPass(),Vn.disabled,n,e.style.map.terrain&&e.style.map.terrain.getTerrainData(v.coord),r.id,y,g,t.a0.simpleSegment(0,2*v.circleOffset,v.circleArray.length,v.circleArray.length/2),null,e.transform.zoom,null,null,null)}y.destroy(),g.destroy()}Vn.disabled=new Vn(!1,1029,2305),Vn.backCCW=new Vn(!0,1029,2305);const Wn=t.an(new Float32Array(16));function Zn(e,n,r,i,a,o){const{horizontalAlign:s,verticalAlign:l}=t.au(e);return new t.P((-(s-.5)*n/a+i[0])*o,(-(l-.5)*r/a+i[1])*o)}function Kn(e,n,r,i,a,o){const s=n.tileAnchorPoint.add(new t.P(n.translation[0],n.translation[1]));if(n.pitchWithMap){let e=i.mult(o);r||(e=e.rotate(-a));const t=s.add(e);return _e(t.x,t.y,n.labelPlaneMatrix,n.getElevation).point}if(r){const t=De(n.tileAnchorPoint.x+1,n.tileAnchorPoint.y,n).point.sub(e),r=Math.atan(t.y/t.x)+(t.x<0?Math.PI:0);return e.add(i.rotate(r))}return e.add(i)}function Gn(e,n,r,i,a,o,s,l,u,c,d,h,f,p){const m=e.text.placedSymbolArray,g=e.text.dynamicLayoutVertexArray,y=e.icon.dynamicLayoutVertexArray,v={};g.clear();for(let _=0;_<m.length;_++){const y=m.get(_),b=y.hidden||!y.crossTileID||e.allowVerticalPlacement&&!y.placedOrientation?null:i[y.crossTileID];if(b){const i=new t.P(y.anchorX,y.anchorY),m={getElevation:p,width:a.width,height:a.height,labelPlaneMatrix:o,lineVertexArray:null,pitchWithMap:r,projection:d,projectionCache:null,tileAnchorPoint:i,translation:h,unwrappedTileID:f},_=r?_e(i.x,i.y,s,p):De(i.x,i.y,m),x=be(a.cameraToCenterDistance,_.signedDistanceFromCamera);let w=t.ai(e.textSizeData,u,y)*x/t.ap;r&&(w*=e.tilePixelRatio/l);const{width:k,height:S,anchor:E,textOffset:C,textBoxScale:P}=b,D=Zn(E,k,S,C,P,w),I=d.getPitchedTextCorrection(a,i.add(new t.P(h[0],h[1])),f),T=Kn(_.point,m,n,D,a.angle,I),A=e.allowVerticalPlacement&&y.placedOrientation===t.ah.vertical?Math.PI/2:0;for(let e=0;e<y.numGlyphs;e++)t.aj(g,T,A);c&&y.associatedIconIndex>=0&&(v[y.associatedIconIndex]={shiftedAnchor:T,angle:A})}else Oe(y.numGlyphs,g)}if(c){y.clear();const n=e.icon.placedSymbolArray;for(let e=0;e<n.length;e++){const r=n.get(e);if(r.hidden)Oe(r.numGlyphs,y);else{const n=v[e];if(n)for(let e=0;e<r.numGlyphs;e++)t.aj(y,n.shiftedAnchor,n.angle);else Oe(r.numGlyphs,y)}}e.icon.dynamicLayoutVertexBuffer.updateData(y)}e.text.dynamicLayoutVertexBuffer.updateData(g)}function Xn(e,t,n){return n.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function $n(e,n,r,i,a,o,s,l,u,c,d,h){const f=e.context,p=f.gl,m=e.transform,g=nt(),y="map"===l,v="map"===u,_="viewport"!==l&&"point"!==r.layout.get("symbol-placement"),b=y&&!v&&!_,x=!v&&_,w=!r.layout.get("symbol-sort-key").isConstant();let k=!1;const S=e.depthModeForSublayer(0,Ln.ReadOnly),E=r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"),C=[],P=g.getCircleRadiusCorrection(m);for(const D of i){const i=n.getTile(D),l=i.getBucket(r);if(!l)continue;const u=a?l.text:l.icon;if(!u||!u.segments.get().length||!u.hasVisibleVertices)continue;const d=u.programConfigurations.get(r.id),h=a||l.sdfIcons,f=a?l.textSizeData:l.iconSizeData,S=v||0!==m.pitch,I=e.useProgram(Xn(h,a,l),d),T=t.ag(f,m.zoom),A=e.style.map.terrain&&e.style.map.terrain.getTerrainData(D);let z,O,F,M,j=[0,0],B=null;if(a)O=i.glyphAtlasTexture,F=p.LINEAR,z=i.glyphAtlasTexture.size,l.iconsInText&&(j=i.imageAtlasTexture.size,B=i.imageAtlasTexture,M=S||e.options.rotating||e.options.zooming||"composite"===f.kind||"camera"===f.kind?p.LINEAR:p.NEAREST);else{const t=1!==r.layout.get("icon-size").constantOr(0)||l.iconsNeedLinear;O=i.imageAtlasTexture,F=h||e.options.rotating||e.options.zooming||t||S?p.LINEAR:p.NEAREST,z=i.imageAtlasTexture.size}const R=Be(i,1,e.transform.zoom),L=x?D.posMatrix:Wn,N=ye(L,v,y,e.transform,R),U=ve(L,v,y,e.transform,R),V=ve(D.posMatrix,v,y,e.transform,R),q=g.translatePosition(e.transform,i,o,s),H=E&&l.hasTextData(),W="none"!==r.layout.get("icon-text-fit")&&H&&l.hasIconData();if(_){const t=e.style.map.terrain?(t,n)=>e.style.map.terrain.getElevation(D,t,n):null,n="map"===r.layout.get("text-rotation-alignment");we(l,D.posMatrix,e,a,N,V,v,c,n,g,D.toUnwrapped(),m.width,m.height,q,t)}const Z=D.posMatrix,K=a&&E||W,G=_||K?Wn:N,X=U,$=h&&0!==r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1);let Y;Y=h?l.iconsInText?Ht(f.kind,T,b,v,_,K,e,Z,G,X,q,z,j,P):qt(f.kind,T,b,v,_,K,e,Z,G,X,q,a,z,!0,P):Vt(f.kind,T,b,v,_,K,e,Z,G,X,q,a,z,P);const J={program:I,buffers:u,uniformValues:Y,atlasTexture:O,atlasTextureIcon:B,atlasInterpolation:F,atlasInterpolationIcon:M,isSDF:h,hasHalo:$};if(w&&l.canOverlap){k=!0;const e=u.segments.get();for(const n of e)C.push({segments:new t.a0([n]),sortKey:n.sortKey,state:J,terrainData:A})}else C.push({segments:u.segments,sortKey:0,state:J,terrainData:A})}k&&C.sort((e,t)=>e.sortKey-t.sortKey);for(const t of C){const n=t.state;if(f.activeTexture.set(p.TEXTURE0),n.atlasTexture.bind(n.atlasInterpolation,p.CLAMP_TO_EDGE),n.atlasTextureIcon&&(f.activeTexture.set(p.TEXTURE1),n.atlasTextureIcon&&n.atlasTextureIcon.bind(n.atlasInterpolationIcon,p.CLAMP_TO_EDGE)),n.isSDF){const i=n.uniformValues;n.hasHalo&&(i.u_is_halo=1,Yn(n.buffers,t.segments,r,e,n.program,S,d,h,i,t.terrainData)),i.u_is_halo=0}Yn(n.buffers,t.segments,r,e,n.program,S,d,h,n.uniformValues,t.terrainData)}}function Yn(e,t,n,r,i,a,o,s,l,u){const c=r.context;i.draw(c,c.gl.TRIANGLES,a,o,s,Vn.disabled,l,u,n.id,e.layoutVertexBuffer,e.indexBuffer,t,n.paint,r.transform.zoom,e.programConfigurations.get(n.id),e.dynamicLayoutVertexBuffer,e.opacityVertexBuffer)}function Jn(e,n,r,i){const a=e.context,o=a.gl,s=Un.disabled,l=new Bn([o.ONE,o.ONE],t.aM.transparent,[!0,!0,!0,!0]),u=n.getBucket(r);if(!u)return;const c=i.key;let d=r.heatmapFbos.get(c);d||(d=er(a,n.tileSize,n.tileSize),r.heatmapFbos.set(c,d)),a.bindFramebuffer.set(d.framebuffer),a.viewport.set([0,0,n.tileSize,n.tileSize]),a.clear({color:t.aM.transparent});const h=u.programConfigurations.get(r.id),f=e.useProgram("heatmap",h),p=e.style.map.terrain.getTerrainData(i);f.draw(a,o.TRIANGLES,Ln.disabled,s,l,Vn.disabled,At(i.posMatrix,n,e.transform.zoom,r.paint.get("heatmap-intensity")),p,r.id,u.layoutVertexBuffer,u.indexBuffer,u.segments,r.paint,e.transform.zoom,h)}function Qn(e,t,n){const r=e.context,i=r.gl;r.setColorMode(e.colorModeForRenderPass());const a=tr(r,t),o=n.key,s=t.heatmapFbos.get(o);s&&(r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,s.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Ln.disabled,Un.disabled,e.colorModeForRenderPass(),Vn.disabled,zt(e,t,0,1),null,t.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments,t.paint,e.transform.zoom),s.destroy(),t.heatmapFbos.delete(o))}function er(e,t,n){var r,i;const a=e.gl,o=a.createTexture();a.bindTexture(a.TEXTURE_2D,o),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);const s=null!==(r=e.HALF_FLOAT)&&void 0!==r?r:a.UNSIGNED_BYTE,l=null!==(i=e.RGBA16F)&&void 0!==i?i:a.RGBA;a.texImage2D(a.TEXTURE_2D,0,l,t,n,0,a.RGBA,s,null);const u=e.createFramebuffer(t,n,!1,!1);return u.colorAttachment.set(o),u}function tr(e,t){return t.colorRampTexture||(t.colorRampTexture=new x(e,t.colorRamp,e.gl.RGBA)),t.colorRampTexture}function nr(e,t,n,r,i){if(!n||!r||!r.imageAtlas)return;const a=r.imageAtlas.patternPositions;let o=a[n.to.toString()],s=a[n.from.toString()];if(!o&&s&&(o=s),!s&&o&&(s=o),!o||!s){const e=i.getPaintProperty(t);o=a[e],s=a[e]}o&&s&&e.setConstantPatternPositions(o,s)}function rr(e,t,n,r,i,a,o){const s=e.context.gl,l="fill-pattern",u=n.paint.get(l),c=u&&u.constantOr(1),d=n.getCrossfadeParameters();let h,f,p,m,g;o?(f=c&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=s.LINES):(f=c?"fillPattern":"fill",h=s.TRIANGLES);const y=u.constantOr(null);for(const v of r){const r=t.getTile(v);if(c&&!r.patternsLoaded())continue;const u=r.getBucket(n);if(!u)continue;const _=u.programConfigurations.get(n.id),b=e.useProgram(f,_),x=e.style.map.terrain&&e.style.map.terrain.getTerrainData(v);c&&(e.context.activeTexture.set(s.TEXTURE0),r.imageAtlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),_.updatePaintBuffers(d)),nr(_,l,y,r,n);const w=x?v:null,k=e.translatePosMatrix(w?w.posMatrix:v.posMatrix,r,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(o){m=u.indexBuffer2,g=u.segments2;const t=[s.drawingBufferWidth,s.drawingBufferHeight];p="fillOutlinePattern"===f&&c?Ct(k,e,d,r,t):Et(k,t)}else m=u.indexBuffer,g=u.segments,p=c?St(k,e,d,r):kt(k);b.draw(e.context,h,i,e.stencilModeForClipping(v),a,Vn.disabled,p,x,n.id,u.layoutVertexBuffer,m,g,n.paint,e.transform.zoom,_)}}function ir(e,t,n,r,i,a,o){const s=e.context,l=s.gl,u="fill-extrusion-pattern",c=n.paint.get(u),d=c.constantOr(1),h=n.getCrossfadeParameters(),f=n.paint.get("fill-extrusion-opacity"),p=c.constantOr(null);for(const m of r){const r=t.getTile(m),c=r.getBucket(n);if(!c)continue;const g=e.style.map.terrain&&e.style.map.terrain.getTerrainData(m),y=c.programConfigurations.get(n.id),v=e.useProgram(d?"fillExtrusionPattern":"fillExtrusion",y);d&&(e.context.activeTexture.set(l.TEXTURE0),r.imageAtlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE),y.updatePaintBuffers(h)),nr(y,u,p,r,n);const _=e.translatePosMatrix(m.posMatrix,r,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),b=n.paint.get("fill-extrusion-vertical-gradient"),x=d?wt(_,e,b,f,m,h,r):xt(_,e,b,f);v.draw(s,s.gl.TRIANGLES,i,a,o,Vn.backCCW,x,g,n.id,c.layoutVertexBuffer,c.indexBuffer,c.segments,n.paint,e.transform.zoom,y,e.style.map.terrain&&c.centroidVertexBuffer)}}function ar(e,t,n,r,i,a,o){const s=e.context,l=s.gl,u=n.fbo;if(!u)return;const c=e.useProgram("hillshade"),d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(t);s.activeTexture.set(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.colorAttachment.get()),c.draw(s,l.TRIANGLES,i,a,o,Vn.disabled,((e,t,n,r)=>{const i=n.paint.get("hillshade-shadow-color"),a=n.paint.get("hillshade-highlight-color"),o=n.paint.get("hillshade-accent-color");let s=n.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===n.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);const l=!e.options.moving;return{u_matrix:r?r.posMatrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped(),l),u_image:0,u_latrange:Ot(0,t.tileID),u_light:[n.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:a,u_accent:o}})(e,n,r,d?t:null),d,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}function or(e,n,r,i,a,o){const s=e.context,l=s.gl,u=n.dem;if(u&&u.data){const c=u.dim,d=u.stride,h=u.getPixels();if(s.activeTexture.set(l.TEXTURE1),s.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||e.getTileTexture(d),n.demTexture){const e=n.demTexture;e.update(h,{premultiply:!1}),e.bind(l.NEAREST,l.CLAMP_TO_EDGE)}else n.demTexture=new x(s,h,l.RGBA,{premultiply:!1}),n.demTexture.bind(l.NEAREST,l.CLAMP_TO_EDGE);s.activeTexture.set(l.TEXTURE0);let f=n.fbo;if(!f){const e=new x(s,{width:c,height:c,data:null},l.RGBA);e.bind(l.LINEAR,l.CLAMP_TO_EDGE),f=n.fbo=s.createFramebuffer(c,c,!0,!1),f.colorAttachment.set(e.texture)}s.bindFramebuffer.set(f.framebuffer),s.viewport.set([0,0,c,c]),e.useProgram("hillshadePrepare").draw(s,l.TRIANGLES,i,a,o,Vn.disabled,((e,n)=>{const r=n.stride,i=t.H();return t.aP(i,0,t.X,-t.X,0,0,1),t.J(i,i,[0,-t.X,0]),{u_matrix:i,u_image:1,u_dimension:[r,r],u_zoom:e.overscaledZ,u_unpack:n.getUnpackVector()}})(n.tileID,u),null,r.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function sr(e,n,r,i,o,s){const l=i.paint.get("raster-fade-duration");if(!s&&l>0){const i=a.now(),s=(i-e.timeAdded)/l,u=n?(i-n.timeAdded)/l:-1,c=r.getSource(),d=o.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!n||Math.abs(n.tileID.overscaledZ-d)>Math.abs(e.tileID.overscaledZ-d),f=h&&e.refreshedUponExpiration?1:t.ac(h?s:1-u,0,1);return e.refreshedUponExpiration&&s>=1&&(e.refreshedUponExpiration=!1),n?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}const lr=new t.aM(1,0,0,1),ur=new t.aM(0,1,0,1),cr=new t.aM(0,0,1,1),dr=new t.aM(1,0,1,1),hr=new t.aM(0,1,1,1);function fr(e,t,n,r){mr(e,0,t+n/2,e.transform.width,n,r)}function pr(e,t,n,r){mr(e,t-n/2,0,n,e.transform.height,r)}function mr(e,t,n,r,i,a){const o=e.context,s=o.gl;s.enable(s.SCISSOR_TEST),s.scissor(t*e.pixelRatio,n*e.pixelRatio,r*e.pixelRatio,i*e.pixelRatio),o.clear({color:a}),s.disable(s.SCISSOR_TEST)}function gr(e,n,r){const i=e.context,a=i.gl,o=r.posMatrix,s=e.useProgram("debug"),l=Ln.disabled,u=Un.disabled,c=e.colorModeForRenderPass(),d="$debug",h=e.style.map.terrain&&e.style.map.terrain.getTerrainData(r);i.activeTexture.set(a.TEXTURE0);const f=n.getTileByID(r.key).latestRawTileData,p=Math.floor((f&&f.byteLength||0)/1024),m=n.getTile(r).tileSize,g=512/Math.min(m,512)*(r.overscaledZ/e.transform.zoom)*.5;let y=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(y+=" => ".concat(r.overscaledZ)),function(e,t){e.initDebugOverlayCanvas();const n=e.debugOverlayCanvas,r=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,n.width,n.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(n),e.debugOverlayTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}(e,"".concat(y," ").concat(p,"kB")),s.draw(i,a.TRIANGLES,l,u,Bn.alphaBlended,Vn.disabled,It(o,t.aM.transparent,g),null,d,e.debugBuffer,e.quadTriangleIndexBuffer,e.debugSegments),s.draw(i,a.LINE_STRIP,l,u,c,Vn.disabled,It(o,t.aM.red),h,d,e.debugBuffer,e.tileBorderIndexBuffer,e.debugSegments)}function yr(e,t,n){const r=e.context,i=r.gl,a=e.colorModeForRenderPass(),o=new Ln(i.LEQUAL,Ln.ReadWrite,e.depthRangeFor3D),s=e.useProgram("terrain"),l=t.getTerrainMesh();r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height]);for(const u of n){const n=e.renderToTexture.getTexture(u),c=t.getTerrainData(u.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,n.texture);const d=e.transform.calculatePosMatrix(u.tileID.toUnwrapped()),h=t.getMeshFrameDelta(e.transform.zoom),f=e.transform.calculateFogMatrix(u.tileID.toUnwrapped()),p=yt(d,h,f,e.style.sky,e.transform.pitch);s.draw(r,i.TRIANGLES,o,Un.disabled,a,Vn.backCCW,p,c,"terrain",l.vertexBuffer,l.indexBuffer,l.segments)}}class vr{constructor(e,t,n){this.vertexBuffer=e,this.indexBuffer=t,this.segments=n}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}class _r{constructor(e,n){this.context=new Rn(e),this.transform=n,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:t.an(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=de.maxUnderzooming+de.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ut}resize(e,t,n){if(this.width=Math.floor(e*n),this.height=Math.floor(t*n),this.pixelRatio=n,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const r of this.style._order)this.style._layers[r].resize()}setup(){const e=this.context,n=new t.aX;n.emplaceBack(0,0),n.emplaceBack(t.X,0),n.emplaceBack(0,t.X),n.emplaceBack(t.X,t.X),this.tileExtentBuffer=e.createVertexBuffer(n,ft.members),this.tileExtentSegments=t.a0.simpleSegment(0,0,4,2);const r=new t.aX;r.emplaceBack(0,0),r.emplaceBack(t.X,0),r.emplaceBack(0,t.X),r.emplaceBack(t.X,t.X),this.debugBuffer=e.createVertexBuffer(r,ft.members),this.debugSegments=t.a0.simpleSegment(0,0,4,5);const i=new t.$;i.emplaceBack(0,0,0,0),i.emplaceBack(t.X,0,t.X,0),i.emplaceBack(0,t.X,0,t.X),i.emplaceBack(t.X,t.X,t.X,t.X),this.rasterBoundsBuffer=e.createVertexBuffer(i,J.members),this.rasterBoundsSegments=t.a0.simpleSegment(0,0,4,2);const a=new t.aX;a.emplaceBack(0,0),a.emplaceBack(1,0),a.emplaceBack(0,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,ft.members),this.viewportSegments=t.a0.simpleSegment(0,0,4,2);const o=new t.aZ;o.emplaceBack(0),o.emplaceBack(1),o.emplaceBack(3),o.emplaceBack(2),o.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(o);const s=new t.aY;s.emplaceBack(0,1,2),s.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(s);const l=this.context.gl;this.stencilClearMode=new Un({func:l.ALWAYS,mask:0},0,255,l.ZERO,l.ZERO,l.ZERO)}clearStencil(){const e=this.context,n=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const r=t.H();t.aP(r,0,this.width,this.height,0,0,1),t.K(r,r,[n.drawingBufferWidth,n.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(e,n.TRIANGLES,Ln.disabled,this.stencilClearMode,Bn.disabled,Vn.disabled,Tt(r),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,t){if(this.currentStencilSource===e.source||!e.isTileClipped()||!t||!t.length)return;this.currentStencilSource=e.source;const n=this.context,r=n.gl;this.nextStencilID+t.length>256&&this.clearStencil(),n.setColorMode(Bn.disabled),n.setDepthMode(Ln.disabled);const i=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const a of t){const e=this._tileClippingMaskIDs[a.key]=this.nextStencilID++,t=this.style.map.terrain&&this.style.map.terrain.getTerrainData(a);i.draw(n,r.TRIANGLES,Ln.disabled,new Un({func:r.ALWAYS,mask:0},e,255,r.KEEP,r.KEEP,r.REPLACE),Bn.disabled,Vn.disabled,Tt(a.posMatrix),t,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,t=this.context.gl;return new Un({func:t.NOTEQUAL,mask:255},e,255,t.KEEP,t.KEEP,t.REPLACE)}stencilModeForClipping(e){const t=this.context.gl;return new Un({func:t.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,t.KEEP,t.KEEP,t.REPLACE)}stencilConfigForOverlap(e){const t=this.context.gl,n=e.sort((e,t)=>t.overscaledZ-e.overscaledZ),r=n[n.length-1].overscaledZ,i=n[0].overscaledZ-r+1;if(i>1){this.currentStencilSource=void 0,this.nextStencilID+i>256&&this.clearStencil();const e={};for(let n=0;n<i;n++)e[n+r]=new Un({func:t.GEQUAL,mask:255},n+this.nextStencilID,255,t.KEEP,t.KEEP,t.REPLACE);return this.nextStencilID+=i,[e,n]}return[{[r]:Un.disabled},n]}colorModeForRenderPass(){const e=this.context.gl;if(this._showOverdrawInspector){const n=1/8;return new Bn([e.CONSTANT_COLOR,e.ONE],new t.aM(n,n,n,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?Bn.unblended:Bn.alphaBlended}depthModeForSublayer(e,t,n){if(!this.opaquePassEnabledForLayer())return Ln.disabled;const r=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Ln(n||this.context.gl.LEQUAL,t,[r,r])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,n){this.style=e,this.options=n,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(a.now()),this.imageManager.beginFrame();const r=this.style._order,i=this.style.sourceCaches,o={},s={},l={};for(const t in i){const e=i[t];e.used&&e.prepare(this.context),o[t]=e.getVisibleCoordinates(),s[t]=o[t].slice().reverse(),l[t]=e.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let t=0;t<r.length;t++)if(this.style._layers[r[t]].is3D()){this.opaquePassCutoff=t;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const t of r){const e=this.style._layers[t];if(!e.hasOffscreenPass()||e.isHidden(this.transform.zoom))continue;const n=s[e.source];("custom"===e.type||n.length)&&this.renderLayer(this,i[e.source],e,n)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:n.showOverdrawInspector?t.aM.black:t.aM.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(e,n){const r=e.context,i=r.gl,a=((e,t,n)=>({u_sky_color:e.properties.get("sky-color"),u_horizon_color:e.properties.get("horizon-color"),u_horizon:(t.height/2+t.getHorizon())*n,u_sky_horizon_blend:e.properties.get("sky-horizon-blend")*t.height/2*n}))(n,e.style.map.transform,e.pixelRatio),o=new Ln(i.LEQUAL,Ln.ReadWrite,[0,1]),s=Un.disabled,l=e.colorModeForRenderPass(),u=e.useProgram("sky");if(!n.mesh){const e=new t.aX;e.emplaceBack(-1,-1),e.emplaceBack(1,-1),e.emplaceBack(1,1),e.emplaceBack(-1,1);const i=new t.aY;i.emplaceBack(0,1,2),i.emplaceBack(0,2,3),n.mesh=new vr(r.createVertexBuffer(e,ft.members),r.createIndexBuffer(i),t.a0.simpleSegment(0,0,e.length,i.length))}u.draw(r,i.TRIANGLES,o,s,l,Vn.disabled,a,void 0,"sky",n.mesh.vertexBuffer,n.mesh.indexBuffer,n.mesh.segments)}(this,this.style.sky),this._showOverdrawInspector=n.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=r.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[r[this.currentLayer]],t=i[e.source],n=o[e.source];this._renderTileClippingMasks(e,n),this.renderLayer(this,t,e,n)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<r.length;this.currentLayer++){const e=this.style._layers[r[this.currentLayer]],t=i[e.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(e))continue;const n=("symbol"===e.type?l:s)[e.source];this._renderTileClippingMasks(e,o[e.source]),this.renderLayer(this,t,e,n)}if(this.options.showTileBoundaries){const e=function(e,t){let n=null;const r=Object.values(e._layers).flatMap(n=>n.source&&!n.isHidden(t)?[e.sourceCaches[n.source]]:[]),i=r.filter(e=>"vector"===e.getSource().type),a=r.filter(e=>"vector"!==e.getSource().type),o=e=>{(!n||n.getSource().maxzoom<e.getSource().maxzoom)&&(n=e)};return i.forEach(e=>o(e)),n||a.forEach(e=>o(e)),n}(this.style,this.transform.zoom);e&&function(e,t,n){for(let r=0;r<n.length;r++)gr(e,t,n[r])}(this,e,e.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;fr(e,e.transform.height-(t.top||0),3,lr),fr(e,t.bottom||0,3,ur),pr(e,t.left||0,3,cr),pr(e,e.transform.width-(t.right||0),3,dr);const n=e.transform.centerPoint;!function(e,t,n,r){mr(e,t-1,n-10,2,20,r),mr(e,t-10,n-1,20,2,r)}(e,n.x,e.transform.height-n.y,hr)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const n=this.terrainFacilitator.matrix,r=this.transform.modelViewProjectionMatrix;let i=this.terrainFacilitator.dirty;i||(i=e?!t.a_(n,r):!t.a$(n,r)),i||(i=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime).length>0),i&&(t.b0(n,r),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(e,n){const r=e.context,i=r.gl,a=Bn.unblended,o=new Ln(i.LEQUAL,Ln.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.sourceCache.getRenderableTiles(),u=e.useProgram("terrainDepth");r.bindFramebuffer.set(n.getFramebuffer("depth").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.aM.transparent,depth:1});for(const t of l){const l=n.getTerrainData(t.tileID),c={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_ele_delta:n.getMeshFrameDelta(e.transform.zoom)};u.draw(r,i.TRIANGLES,o,Un.disabled,a,Vn.backCCW,c,l,"terrain",s.vertexBuffer,s.indexBuffer,s.segments)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain),function(e,n){const r=e.context,i=r.gl,a=Bn.unblended,o=new Ln(i.LEQUAL,Ln.ReadWrite,[0,1]),s=n.getTerrainMesh(),l=n.getCoordsTexture(),u=n.sourceCache.getRenderableTiles(),c=e.useProgram("terrainCoords");r.bindFramebuffer.set(n.getFramebuffer("coords").framebuffer),r.viewport.set([0,0,e.width/devicePixelRatio,e.height/devicePixelRatio]),r.clear({color:t.aM.transparent,depth:1}),n.coordsIndex=[];for(const t of u){const u=n.getTerrainData(t.tileID);r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,l.texture);const d={u_matrix:e.transform.calculatePosMatrix(t.tileID.toUnwrapped()),u_terrain_coords_id:(255-n.coordsIndex.length)/255,u_texture:0,u_ele_delta:n.getMeshFrameDelta(e.transform.zoom)};c.draw(r,i.TRIANGLES,o,Un.disabled,a,Vn.backCCW,d,u,"terrain",s.vertexBuffer,s.indexBuffer,s.segments),n.coordsIndex.push(t.tileID.key)}r.bindFramebuffer.set(null),r.viewport.set([0,0,e.width,e.height])}(this,this.style.map.terrain))}renderLayer(e,n,r,i){if(!r.isHidden(this.transform.zoom)&&("background"===r.type||"custom"===r.type||(i||[]).length))switch(this.id=r.id,r.type){case"symbol":!function(e,n,r,i,a){if("translucent"!==e.renderPass)return;const o=Un.disabled,s=e.colorModeForRenderPass();(r._unevaluatedLayout.hasValue("text-variable-anchor")||r._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(e,n,r,i,a,o,s,l,u){const c=n.transform,d=nt(),h="map"===a,f="map"===o;for(const p of e){const e=i.getTile(p),a=e.getBucket(r);if(!a||!a.text||!a.text.segments.get().length)continue;const o=t.ag(a.textSizeData,c.zoom),m=Be(e,1,n.transform.zoom),g=ye(p.posMatrix,f,h,n.transform,m),y="none"!==r.layout.get("icon-text-fit")&&a.hasIconData();if(o){const t=Math.pow(2,c.zoom-e.tileID.overscaledZ),r=n.style.map.terrain?(e,t)=>n.style.map.terrain.getElevation(p,e,t):null,i=d.translatePosition(c,e,s,l);Gn(a,h,f,u,c,g,p.posMatrix,t,o,y,d,i,p.toUnwrapped(),r)}}}(i,e,r,n,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),a),0!==r.paint.get("icon-opacity").constantOr(1)&&$n(e,n,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),o,s),0!==r.paint.get("text-opacity").constantOr(1)&&$n(e,n,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),o,s),n.map.showCollisionBoxes&&(Hn(e,n,r,i,!0),Hn(e,n,r,i,!1))}(e,n,r,i,this.style.placement.variableOffsets);break;case"circle":!function(e,n,r,i){if("translucent"!==e.renderPass)return;const a=r.paint.get("circle-opacity"),o=r.paint.get("circle-stroke-width"),s=r.paint.get("circle-stroke-opacity"),l=!r.layout.get("circle-sort-key").isConstant();if(0===a.constantOr(1)&&(0===o.constantOr(1)||0===s.constantOr(1)))return;const u=e.context,c=u.gl,d=e.depthModeForSublayer(0,Ln.ReadOnly),h=Un.disabled,f=e.colorModeForRenderPass(),p=[];for(let m=0;m<i.length;m++){const a=i[m],o=n.getTile(a),s=o.getBucket(r);if(!s)continue;const u=s.programConfigurations.get(r.id),c=e.useProgram("circle",u),d=s.layoutVertexBuffer,h=s.indexBuffer,f=e.style.map.terrain&&e.style.map.terrain.getTerrainData(a),g={programConfiguration:u,program:c,layoutVertexBuffer:d,indexBuffer:h,uniformValues:Pt(e,a,o,r),terrainData:f};if(l){const e=s.segments.get();for(const n of e)p.push({segments:new t.a0([n]),sortKey:n.sortKey,state:g})}else p.push({segments:s.segments,sortKey:0,state:g})}l&&p.sort((e,t)=>e.sortKey-t.sortKey);for(const t of p){const{programConfiguration:n,program:i,layoutVertexBuffer:a,indexBuffer:o,uniformValues:s,terrainData:l}=t.state;i.draw(u,c.TRIANGLES,d,h,f,Vn.disabled,s,l,r.id,a,o,t.segments,r.paint,e.transform.zoom,n)}}(e,n,r,i);break;case"heatmap":!function(e,n,r,i){if(0===r.paint.get("heatmap-opacity"))return;const a=e.context;if(e.style.map.terrain){for(const t of i){const i=n.getTile(t);n.hasRenderableParent(t)||("offscreen"===e.renderPass?Jn(e,i,r,t):"translucent"===e.renderPass&&Qn(e,r,t))}a.viewport.set([0,0,e.width,e.height])}else"offscreen"===e.renderPass?function(e,n,r,i){const a=e.context,o=a.gl,s=Un.disabled,l=new Bn([o.ONE,o.ONE],t.aM.transparent,[!0,!0,!0,!0]);(function(e,n,r){const i=e.gl;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,n.width/4,n.height/4]);let a=r.heatmapFbos.get(t.aU);a?(i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),e.bindFramebuffer.set(a.framebuffer)):(a=er(e,n.width/4,n.height/4),r.heatmapFbos.set(t.aU,a))})(a,e,r),a.clear({color:t.aM.transparent});for(let t=0;t<i.length;t++){const u=i[t];if(n.hasRenderableParent(u))continue;const c=n.getTile(u),d=c.getBucket(r);if(!d)continue;const h=d.programConfigurations.get(r.id),f=e.useProgram("heatmap",h),{zoom:p}=e.transform;f.draw(a,o.TRIANGLES,Ln.disabled,s,l,Vn.disabled,At(u.posMatrix,c,p,r.paint.get("heatmap-intensity")),null,r.id,d.layoutVertexBuffer,d.indexBuffer,d.segments,r.paint,e.transform.zoom,h)}a.viewport.set([0,0,e.width,e.height])}(e,n,r,i):"translucent"===e.renderPass&&function(e,n){const r=e.context,i=r.gl;r.setColorMode(e.colorModeForRenderPass());const a=n.heatmapFbos.get(t.aU);a&&(r.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,a.colorAttachment.get()),r.activeTexture.set(i.TEXTURE1),tr(r,n).bind(i.LINEAR,i.CLAMP_TO_EDGE),e.useProgram("heatmapTexture").draw(r,i.TRIANGLES,Ln.disabled,Un.disabled,e.colorModeForRenderPass(),Vn.disabled,zt(e,n,0,1),null,n.id,e.viewportBuffer,e.quadTriangleIndexBuffer,e.viewportSegments,n.paint,e.transform.zoom))}(e,r)}(e,n,r,i);break;case"line":!function(e,n,r,i){if("translucent"!==e.renderPass)return;const a=r.paint.get("line-opacity"),o=r.paint.get("line-width");if(0===a.constantOr(1)||0===o.constantOr(1))return;const s=e.depthModeForSublayer(0,Ln.ReadOnly),l=e.colorModeForRenderPass(),u=r.paint.get("line-dasharray"),c=r.paint.get("line-pattern"),d=c.constantOr(1),h=r.paint.get("line-gradient"),f=r.getCrossfadeParameters(),p=d?"linePattern":u?"lineSDF":h?"lineGradient":"line",m=e.context,g=m.gl;let y=!0;for(const v of i){const i=n.getTile(v);if(d&&!i.patternsLoaded())continue;const a=i.getBucket(r);if(!a)continue;const o=a.programConfigurations.get(r.id),_=e.context.program.get(),b=e.useProgram(p,o),w=y||b.program!==_,k=e.style.map.terrain&&e.style.map.terrain.getTerrainData(v),S=c.constantOr(null);if(S&&i.imageAtlas){const e=i.imageAtlas,t=e.patternPositions[S.to.toString()],n=e.patternPositions[S.from.toString()];t&&n&&o.setConstantPatternPositions(t,n)}const E=k?v:null,C=d?jt(e,i,r,f,E):u?Bt(e,i,r,u,f,E):h?Mt(e,i,r,a.lineClipsArray.length,E):Ft(e,i,r,E);if(d)m.activeTexture.set(g.TEXTURE0),i.imageAtlasTexture.bind(g.LINEAR,g.CLAMP_TO_EDGE),o.updatePaintBuffers(f);else if(u&&(w||e.lineAtlas.dirty))m.activeTexture.set(g.TEXTURE0),e.lineAtlas.bind(m);else if(h){const i=a.gradients[r.id];let o=i.texture;if(r.gradientVersion!==i.version){let s=256;if(r.stepInterpolant){const r=n.getSource().maxzoom,i=v.canonical.z===r?Math.ceil(1<<e.transform.maxZoom-v.canonical.z):1;s=t.ac(t.aV(a.maxLineLength/t.X*1024*i),256,m.maxTextureSize)}i.gradient=t.aW({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:i.gradient||void 0,clips:a.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new x(m,i.gradient,g.RGBA),i.version=r.gradientVersion,o=i.texture}m.activeTexture.set(g.TEXTURE0),o.bind(r.stepInterpolant?g.NEAREST:g.LINEAR,g.CLAMP_TO_EDGE)}b.draw(m,g.TRIANGLES,s,e.stencilModeForClipping(v),l,Vn.disabled,C,k,r.id,a.layoutVertexBuffer,a.indexBuffer,a.segments,r.paint,e.transform.zoom,o,a.layoutVertexBuffer2),y=!1}}(e,n,r,i);break;case"fill":!function(e,n,r,i){const a=r.paint.get("fill-color"),o=r.paint.get("fill-opacity");if(0===o.constantOr(1))return;const s=e.colorModeForRenderPass(),l=r.paint.get("fill-pattern"),u=e.opaquePassEnabledForLayer()&&!l.constantOr(1)&&1===a.constantOr(t.aM.transparent).a&&1===o.constantOr(0)?"opaque":"translucent";if(e.renderPass===u){const t=e.depthModeForSublayer(1,"opaque"===e.renderPass?Ln.ReadWrite:Ln.ReadOnly);rr(e,n,r,i,t,s,!1)}if("translucent"===e.renderPass&&r.paint.get("fill-antialias")){const t=e.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Ln.ReadOnly);rr(e,n,r,i,t,s,!0)}}(e,n,r,i);break;case"fill-extrusion":!function(e,t,n,r){const i=n.paint.get("fill-extrusion-opacity");if(0!==i&&"translucent"===e.renderPass){const a=new Ln(e.context.gl.LEQUAL,Ln.ReadWrite,e.depthRangeFor3D);if(1!==i||n.paint.get("fill-extrusion-pattern").constantOr(1))ir(e,t,n,r,a,Un.disabled,Bn.disabled),ir(e,t,n,r,a,e.stencilModeFor3D(),e.colorModeForRenderPass());else{const i=e.colorModeForRenderPass();ir(e,t,n,r,a,Un.disabled,i)}}}(e,n,r,i);break;case"hillshade":!function(e,t,n,r){if("offscreen"!==e.renderPass&&"translucent"!==e.renderPass)return;const i=e.context,a=e.depthModeForSublayer(0,Ln.ReadOnly),o=e.colorModeForRenderPass(),[s,l]="translucent"===e.renderPass?e.stencilConfigForOverlap(r):[{},r];for(const u of l){const r=t.getTile(u);void 0!==r.needsHillshadePrepare&&r.needsHillshadePrepare&&"offscreen"===e.renderPass?or(e,r,n,a,Un.disabled,o):"translucent"===e.renderPass&&ar(e,u,r,n,a,s[u.overscaledZ],o)}i.viewport.set([0,0,e.width,e.height])}(e,n,r,i);break;case"raster":!function(e,t,n,r){if("translucent"!==e.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!r.length)return;const i=e.context,a=i.gl,o=t.getSource(),s=e.useProgram("raster"),l=e.colorModeForRenderPass(),[u,c]=o instanceof Q?[{},r]:e.stencilConfigForOverlap(r),d=c[c.length-1].overscaledZ,h=!e.options.moving;for(const f of c){const r=e.depthModeForSublayer(f.overscaledZ-d,1===n.paint.get("raster-opacity")?Ln.ReadWrite:Ln.ReadOnly,a.LESS),c=t.getTile(f);c.registerFadeDuration(n.paint.get("raster-fade-duration"));const p=t.findLoadedParent(f,0),m=t.findLoadedSibling(f),g=sr(c,p||m||null,t,n,e.transform,e.style.map.terrain);let y,v;const _="nearest"===n.paint.get("raster-resampling")?a.NEAREST:a.LINEAR;i.activeTexture.set(a.TEXTURE0),c.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),i.activeTexture.set(a.TEXTURE1),p?(p.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),y=Math.pow(2,p.tileID.overscaledZ-c.tileID.overscaledZ),v=[c.tileID.canonical.x*y%1,c.tileID.canonical.y*y%1]):c.texture.bind(_,a.CLAMP_TO_EDGE,a.LINEAR_MIPMAP_NEAREST),c.texture.useMipmap&&i.extTextureFilterAnisotropic&&e.transform.pitch>20&&a.texParameterf(a.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax);const b=e.style.map.terrain&&e.style.map.terrain.getTerrainData(f),x=b?f:null,w=x?x.posMatrix:e.transform.calculatePosMatrix(f.toUnwrapped(),h),k=Nt(w,v||[0,0],y||1,g,n);o instanceof Q?s.draw(i,a.TRIANGLES,r,Un.disabled,l,Vn.disabled,k,b,n.id,o.boundsBuffer,e.quadTriangleIndexBuffer,o.boundsSegments):s.draw(i,a.TRIANGLES,r,u[f.overscaledZ],l,Vn.disabled,k,b,n.id,e.rasterBoundsBuffer,e.quadTriangleIndexBuffer,e.rasterBoundsSegments)}}(e,n,r,i);break;case"background":!function(e,t,n,r){const i=n.paint.get("background-color"),a=n.paint.get("background-opacity");if(0===a)return;const o=e.context,s=o.gl,l=e.transform,u=l.tileSize,c=n.paint.get("background-pattern");if(e.isPatternMissing(c))return;const d=!c&&1===i.a&&1===a&&e.opaquePassEnabledForLayer()?"opaque":"translucent";if(e.renderPass!==d)return;const h=Un.disabled,f=e.depthModeForSublayer(0,"opaque"===d?Ln.ReadWrite:Ln.ReadOnly),p=e.colorModeForRenderPass(),m=e.useProgram(c?"backgroundPattern":"background"),g=r||l.coveringTiles({tileSize:u,terrain:e.style.map.terrain});c&&(o.activeTexture.set(s.TEXTURE0),e.imageManager.bind(e.context));const y=n.getCrossfadeParameters();for(const v of g){const t=r?v.posMatrix:e.transform.calculatePosMatrix(v.toUnwrapped()),l=c?Zt(t,a,e,c,{tileID:v,tileSize:u},y):Wt(t,a,i),d=e.style.map.terrain&&e.style.map.terrain.getTerrainData(v);m.draw(o,s.TRIANGLES,f,h,p,Vn.disabled,l,d,n.id,e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments)}}(e,0,r,i);break;case"custom":!function(e,t,n){const r=e.context,i=n.implementation;if("offscreen"===e.renderPass){const t=i.prerender;t&&(e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),t.call(i,r.gl,e.transform.customLayerMatrix()),r.setDirty(),e.setBaseState())}else if("translucent"===e.renderPass){e.setCustomLayerDefaults(),r.setColorMode(e.colorModeForRenderPass()),r.setStencilMode(Un.disabled);const t="3d"===i.renderingMode?new Ln(e.context.gl.LEQUAL,Ln.ReadWrite,e.depthRangeFor3D):e.depthModeForSublayer(0,Ln.ReadOnly);r.setDepthMode(t),i.render(r.gl,e.transform.customLayerMatrix(),{farZ:e.transform.farZ,nearZ:e.transform.nearZ,fov:e.transform._fov,modelViewProjectionMatrix:e.transform.modelViewProjectionMatrix,projectionMatrix:e.transform.projectionMatrix}),r.setDirty(),e.setBaseState(),r.bindFramebuffer.set(null)}}(e,0,r)}}translatePosMatrix(e,n,r,i,a){if(!r[0]&&!r[1])return e;const o=a?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(o){const e=Math.sin(o),t=Math.cos(o);r=[r[0]*t-r[1]*e,r[0]*e+r[1]*t]}const s=[a?r[0]:Be(n,r[0],this.transform.zoom),a?r[1]:Be(n,r[1],this.transform.zoom),0],l=new Float32Array(16);return t.J(l,e,s),l}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const t=this.imageManager.getPattern(e.from.toString()),n=this.imageManager.getPattern(e.to.toString());return!t||!n}useProgram(e,t){this.cache=this.cache||{};const n=e+(t?t.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[n]||(this.cache[n]=new _t(this.context,pt[e],t,Kt[e],this._showOverdrawInspector,this.style.map.terrain)),this.cache[n]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new x(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:t}=this.context.gl;return this.width!==e||this.height!==t}}class br{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,n,r){const i=Math.pow(2,r),a=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(r=>{const a=1/(r=t.af([],r,e))[3]/n*i;return t.b1(r,r,[a,a,1/r[3],a])}),o=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(e=>{const t=function(e,t){var n=t[0],r=t[1],i=t[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}([],function(e,t,n){var r=t[0],i=t[1],a=t[2],o=n[0],s=n[1],l=n[2];return e[0]=i*l-a*s,e[1]=a*o-r*l,e[2]=r*s-i*o,e}([],y([],a[e[0]],a[e[1]]),y([],a[e[2]],a[e[1]]))),n=-((r=t)[0]*(i=a[e[1]])[0]+r[1]*i[1]+r[2]*i[2]);var r,i;return t.concat(n)});return new br(a,o)}}class xr{constructor(e,t){this.min=e,this.max=t,this.center=function(e,t){return e[0]=.5*t[0],e[1]=.5*t[1],e[2]=.5*t[2],e}([],function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}([],this.min,this.max))}quadrant(e){const t=[e%2==0,e<2],n=m(this.min),r=m(this.max);for(let i=0;i<t.length;i++)n[i]=t[i]?this.min[i]:this.center[i],r[i]=t[i]?this.center[i]:this.max[i];return r[2]=this.max[2],new xr(n,r)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersects(e){const n=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let r=!0;for(let i=0;i<e.planes.length;i++){const a=e.planes[i];let o=0;for(let e=0;e<n.length;e++)t.b2(a,n[e])>=0&&o++;if(0===o)return 0;o!==n.length&&(r=!1)}if(r)return 2;for(let t=0;t<3;t++){let n=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e.points.length;i++){const a=e.points[i][t]-this.min[t];n=Math.min(n,a),r=Math.max(r,a)}if(r<0||n>this.max[t]-this.min[t])return 0}return 1}}class wr{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(n)||n<0||isNaN(r)||r<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=n,this.right=r}interpolate(e,n,r){return null!=n.top&&null!=e.top&&(this.top=t.y.number(e.top,n.top,r)),null!=n.bottom&&null!=e.bottom&&(this.bottom=t.y.number(e.bottom,n.bottom,r)),null!=n.left&&null!=e.left&&(this.left=t.y.number(e.left,n.left,r)),null!=n.right&&null!=e.right&&(this.right=t.y.number(e.right,n.right,r)),this}getCenter(e,n){const r=t.ac((this.left+e-this.right)/2,0,e),i=t.ac((this.top+n-this.bottom)/2,0,n);return new t.P(r,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new wr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const kr=85.051129;class Sr{constructor(e,n,r,i,a){this.tileSize=512,this._renderWorldCopies=void 0===a||!!a,this._minZoom=e||0,this._maxZoom=n||22,this._minPitch=null==r?0:r,this._maxPitch=null==i?60:i,this.setMaxBounds(),this.width=0,this.height=0,this._center=new t.N(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new wr,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={},this.minElevationForCurrentTile=0}clone(){const e=new Sr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return e.apply(this),e}apply(e){this.tileSize=e.tileSize,this.latRange=e.latRange,this.lngRange=e.lngRange,this.width=e.width,this.height=e.height,this._center=e._center,this._elevation=e._elevation,this.minElevationForCurrentTile=e.minElevationForCurrentTile,this.zoom=e.zoom,this.angle=e.angle,this._fov=e._fov,this._pitch=e._pitch,this._unmodified=e._unmodified,this._edgeInsets=e._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new t.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(e){const n=-t.b3(e,-180,180)*Math.PI/180;this.angle!==n&&(this._unmodified=!1,this.angle=n,this._calcMatrices(),this.rotationMatrix=function(){var e=new t.A(4);return t.A!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e}(),function(e,t,n){var r=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(n),l=Math.cos(n);e[0]=r*l+a*s,e[1]=i*l+o*s,e[2]=r*-s+a*l,e[3]=i*-s+o*l}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const n=t.ac(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==n&&(this._unmodified=!1,this._pitch=n,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=e/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._zoom=t,this.tileZoom=Math.max(0,Math.floor(t)),this.scale=this.zoomScale(t),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,n){this._unmodified=!1,this._edgeInsets.interpolate(e,t,n),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(e){const n=[new t.b4(0,e)];if(this._renderWorldCopies){const r=this.pointCoordinate(new t.P(0,0)),i=this.pointCoordinate(new t.P(this.width,0)),a=this.pointCoordinate(new t.P(this.width,this.height)),o=this.pointCoordinate(new t.P(0,this.height)),s=Math.floor(Math.min(r.x,i.x,a.x,o.x)),l=Math.floor(Math.max(r.x,i.x,a.x,o.x)),u=1;for(let c=s-u;c<=l+u;c++)0!==c&&n.push(new t.b4(c,e))}return n}coveringTiles(e){var n,r;let i=this.coveringZoomLevel(e);const a=i;if(void 0!==e.minzoom&&i<e.minzoom)return[];void 0!==e.maxzoom&&i>e.maxzoom&&(i=e.maxzoom);const o=this.pointCoordinate(this.getCameraPoint()),s=t.Z.fromLngLat(this.center),l=Math.pow(2,i),u=[l*o.x,l*o.y,0],c=[l*s.x,l*s.y,0],d=br.fromInvProjectionMatrix(this.invModelViewProjectionMatrix,this.worldSize,i);let h=e.minzoom||0;!e.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(h=i);const f=e.terrain?2/Math.min(this.tileSize,e.tileSize)*this.tileSize:3,p=e=>({aabb:new xr([e*l,0,0],[(e+1)*l,l,0]),zoom:0,x:0,y:0,wrap:e,fullyVisible:!1}),m=[],g=[],y=i,_=e.reparseOverscaled?a:i;if(this._renderWorldCopies)for(let t=1;t<=3;t++)m.push(p(-t)),m.push(p(t));for(m.push(p(0));m.length>0;){const i=m.pop(),a=i.x,o=i.y;let s=i.fullyVisible;if(!s){const e=i.aabb.intersects(d);if(0===e)continue;s=2===e}const l=e.terrain?u:c,p=i.aabb.distanceX(l),b=i.aabb.distanceY(l),x=Math.max(Math.abs(p),Math.abs(b));if(i.zoom===y||x>f+(1<<y-i.zoom)-2&&i.zoom>=h){const e=y-i.zoom,n=u[0]-.5-(a<<e),r=u[1]-.5-(o<<e);g.push({tileID:new t.S(i.zoom===y?_:i.zoom,i.wrap,i.zoom,a,o),distanceSq:v([c[0]-.5-a,c[1]-.5-o]),tileDistanceToCamera:Math.sqrt(n*n+r*r)})}else for(let u=0;u<4;u++){const l=(a<<1)+u%2,c=(o<<1)+(u>>1),d=i.zoom+1;let h=i.aabb.quadrant(u);if(e.terrain){const a=new t.S(d,i.wrap,d,l,c),o=e.terrain.getMinMaxElevation(a),s=null!==(n=o.minElevation)&&void 0!==n?n:this.elevation,u=null!==(r=o.maxElevation)&&void 0!==r?r:this.elevation;h=new xr([h.min[0],h.min[1],s],[h.max[0],h.max[1],u])}m.push({aabb:h,zoom:d,x:l,y:c,wrap:i.wrap,fullyVisible:s})}}return g.sort((e,t)=>e.distanceSq-t.distanceSq).map(e=>e.tileID)}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const n=t.ac(e.lat,-85.051129,kr);return new t.P(t.O(e.lng)*this.worldSize,t.Q(n)*this.worldSize)}unproject(e){return new t.Z(e.x/this.worldSize,e.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(e){const n=this.elevation,r=Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter,i=this.pointLocation(this.centerPoint,e),a=e.getElevationForLngLatZoom(i,this.tileZoom);if(!(this.elevation-a))return;const o=r+n-a,s=Math.cos(this._pitch)*this.cameraToCenterDistance/o/t.b5(1,i.lat),l=this.scaleZoom(s/this.tileSize);this._elevation=a,this._center=i,this.zoom=l}setLocationAtPoint(e,n){const r=this.pointCoordinate(n),i=this.pointCoordinate(this.centerPoint),a=this.locationCoordinate(e),o=new t.Z(a.x-(r.x-i.x),a.y-(r.y-i.y));this.center=this.coordinateLocation(o),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(e,t){return t?this.coordinatePoint(this.locationCoordinate(e),t.getElevationForLngLatZoom(e,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(e))}pointLocation(e,t){return this.coordinateLocation(this.pointCoordinate(e,t))}locationCoordinate(e){return t.Z.fromLngLat(e)}coordinateLocation(e){return e&&e.toLngLat()}pointCoordinate(e,n){if(n){const t=n.pointCoordinate(e);if(null!=t)return t}const r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];t.af(r,r,this.pixelMatrixInverse),t.af(i,i,this.pixelMatrixInverse);const a=r[3],o=i[3],s=r[1]/a,l=i[1]/o,u=r[2]/a,c=i[2]/o,d=u===c?0:(0-u)/(c-u);return new t.Z(t.y.number(r[0]/a,i[0]/o,d)/this.worldSize,t.y.number(s,l,d)/this.worldSize)}coordinatePoint(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.pixelMatrix;const i=[e.x*this.worldSize,e.y*this.worldSize,n,1];return t.af(i,i,r),new t.P(i[0]/i[3],i[1]/i[3])}getBounds(){const e=Math.max(0,this.height/2-this.getHorizon());return(new Z).extend(this.pointLocation(new t.P(0,e))).extend(this.pointLocation(new t.P(this.width,e))).extend(this.pointLocation(new t.P(this.width,this.height))).extend(this.pointLocation(new t.P(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Z([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(e){e?(this.lngRange=[e.getWest(),e.getEast()],this.latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-85.051129,kr])}calculateTileMatrix(e){const n=e.canonical,r=this.worldSize/this.zoomScale(n.z),i=n.x+Math.pow(2,n.z)*e.wrap,a=t.an(new Float64Array(16));return t.J(a,a,[i*r,n.y*r,0]),t.K(a,a,[r/t.X,r/t.X,1]),a}calculatePosMatrix(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.key,i=n?this._alignedPosMatrixCache:this._posMatrixCache;if(i[r])return i[r];const a=this.calculateTileMatrix(e);return t.L(a,n?this.alignedModelViewProjectionMatrix:this.modelViewProjectionMatrix,a),i[r]=new Float32Array(a),i[r]}calculateFogMatrix(e){const n=e.key,r=this._fogMatrixCache;if(r[n])return r[n];const i=this.calculateTileMatrix(e);return t.L(i,this.fogMatrix,i),r[n]=new Float32Array(i),r[n]}customLayerMatrix(){return this.mercatorMatrix.slice()}getConstrained(e,n){n=t.ac(+n,this.minZoom,this.maxZoom);const r={center:new t.N(e.lng,e.lat),zoom:n};let i=this.lngRange;if(!this._renderWorldCopies&&null===i){const e=180-1e-10;i=[-e,e]}const a=this.tileSize*this.zoomScale(r.zoom);let o=0,s=a,l=0,u=a,c=0,d=0;const{x:h,y:f}=this.size;if(this.latRange){const e=this.latRange;o=t.Q(e[1])*a,s=t.Q(e[0])*a,s-o<f&&(c=f/(s-o))}i&&(l=t.b3(t.O(i[0])*a,0,a),u=t.b3(t.O(i[1])*a,0,a),u<l&&(u+=a),u-l<h&&(d=h/(u-l)));const{x:p,y:m}=this.project.call({worldSize:a},e);let g,y;const v=Math.max(d||0,c||0);if(v){const e=new t.P(d?(u+l)/2:p,c?(s+o)/2:m);return r.center=this.unproject.call({worldSize:a},e).wrap(),r.zoom+=this.scaleZoom(v),r}if(this.latRange){const e=f/2;m-e<o&&(y=o+e),m+e>s&&(y=s-e)}if(i){const e=(l+u)/2;let n=p;this._renderWorldCopies&&(n=t.b3(p,e-a/2,e+a/2));const r=h/2;n-r<l&&(g=l+r),n+r>u&&(g=u-r)}if(void 0!==g||void 0!==y){const e=new t.P(null!=g?g:p,null!=y?y:m);r.center=this.unproject.call({worldSize:a},e).wrap()}return r}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:t,zoom:n}=this.getConstrained(this.center,this.zoom);this.center=t,this.zoom=n,this._unmodified=e,this._constraining=!1}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,n=this.point.x,r=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=t.b5(1,this.center.lat)*this.worldSize;let i=t.an(new Float64Array(16));t.K(i,i,[this.width/2,-this.height/2,1]),t.J(i,i,[1,-1,0]),this.labelPlaneMatrix=i,i=t.an(new Float64Array(16)),t.K(i,i,[1,-1,1]),t.J(i,i,[-1,-1,0]),t.K(i,i,[2/this.width,2/this.height,1]),this.glCoordMatrix=i;const a=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),o=Math.min(this.elevation,this.minElevationForCurrentTile),s=a-o*this._pixelPerMeter/Math.cos(this._pitch),l=o<0?s:a,u=Math.PI/2+this._pitch,c=this._fov*(.5+e.y/this.height),d=Math.sin(c)*l/Math.sin(t.ac(Math.PI-u-c,.01,Math.PI-.01)),h=this.getHorizon(),f=2*Math.atan(h/this.cameraToCenterDistance)*(.5+e.y/(2*h)),p=Math.sin(f)*l/Math.sin(t.ac(Math.PI-u-f,.01,Math.PI-.01)),m=Math.min(d,p);this.farZ=1.01*(Math.cos(Math.PI/2-this._pitch)*m+l),this.nearZ=this.height/50,i=new Float64Array(16),t.b6(i,this._fov,this.width/this.height,this.nearZ,this.farZ),i[8]=2*-e.x/this.width,i[9]=2*e.y/this.height,this.projectionMatrix=t.ae(i),t.K(i,i,[1,-1,1]),t.J(i,i,[0,0,-this.cameraToCenterDistance]),t.b7(i,i,this._pitch),t.ad(i,i,this.angle),t.J(i,i,[-n,-r,0]),this.mercatorMatrix=t.K([],i,[this.worldSize,this.worldSize,this.worldSize]),t.K(i,i,[1,1,this._pixelPerMeter]),this.pixelMatrix=t.L(new Float64Array(16),this.labelPlaneMatrix,i),t.J(i,i,[0,0,-this.elevation]),this.modelViewProjectionMatrix=i,this.invModelViewProjectionMatrix=t.as([],i),this.fogMatrix=new Float64Array(16),t.b6(this.fogMatrix,this._fov,this.width/this.height,a,this.farZ),this.fogMatrix[8]=2*-e.x/this.width,this.fogMatrix[9]=2*e.y/this.height,t.K(this.fogMatrix,this.fogMatrix,[1,-1,1]),t.J(this.fogMatrix,this.fogMatrix,[0,0,-this.cameraToCenterDistance]),t.b7(this.fogMatrix,this.fogMatrix,this._pitch),t.ad(this.fogMatrix,this.fogMatrix,this.angle),t.J(this.fogMatrix,this.fogMatrix,[-n,-r,0]),t.K(this.fogMatrix,this.fogMatrix,[1,1,this._pixelPerMeter]),t.J(this.fogMatrix,this.fogMatrix,[0,0,-this.elevation]),this.pixelMatrix3D=t.L(new Float64Array(16),this.labelPlaneMatrix,i);const g=this.width%2/2,y=this.height%2/2,v=Math.cos(this.angle),_=Math.sin(this.angle),b=n-Math.round(n)+v*g+_*y,x=r-Math.round(r)+v*y+_*g,w=new Float64Array(i);if(t.J(w,w,[b>.5?b-1:b,x>.5?x-1:x,0]),this.alignedModelViewProjectionMatrix=w,i=t.as(new Float64Array(16),this.pixelMatrix),!i)throw new Error("failed to invert matrix");this.pixelMatrixInverse=i,this._posMatrixCache={},this._alignedPosMatrixCache={},this._fogMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const e=this.pointCoordinate(new t.P(0,0)),n=[e.x*this.worldSize,e.y*this.worldSize,0,1];return t.af(n,n,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new t.P(0,e))}getCameraQueryGeometry(e){const n=this.getCameraPoint();if(1===e.length)return[e[0],n];{let r=n.x,i=n.y,a=n.x,o=n.y;for(const t of e)r=Math.min(r,t.x),i=Math.min(i,t.y),a=Math.max(a,t.x),o=Math.max(o,t.y);return[new t.P(r,i),new t.P(a,i),new t.P(a,o),new t.P(r,o),new t.P(r,i)]}}lngLatToCameraDepth(e,n){const r=this.locationCoordinate(e),i=[r.x*this.worldSize,r.y*this.worldSize,n,1];return t.af(i,i,this.modelViewProjectionMatrix),i[2]/i[3]}}function Er(e,t){var n=this;let r,i=!1,a=null,o=null;const s=()=>{a=null,i&&(e.apply(o,r),a=setTimeout(s,t),i=!1)};return function(){for(var e=arguments.length,t=new Array(e),l=0;l<e;l++)t[l]=arguments[l];return i=!0,o=n,r=t,a||s(),a}}class Cr{constructor(e){this._getCurrentHash=()=>{const e=window.location.hash.replace("#","");if(this._hashName){let t;return e.split("&").map(e=>e.split("=")).forEach(e=>{e[0]===this._hashName&&(t=e)}),(t&&t[1]||"").split("/")}return e.split("/")},this._onHashChange=()=>{const e=this._getCurrentHash();if(e.length>=3&&!e.some(e=>isNaN(e))){const t=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(e[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+e[2],+e[1]],zoom:+e[0],bearing:t,pitch:+(e[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const e=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,e)},this._removeHash=()=>{const e=this._getCurrentHash();if(0===e.length)return;const t=e.join("/");let n=t;n.split("&").length>0&&(n=n.split("&")[0]),this._hashName&&(n="".concat(this._hashName,"=").concat(t));let r=window.location.hash.replace(n,"");r.startsWith("#&")?r=r.slice(0,1)+r.slice(2):"#"===r&&(r="");let i=window.location.href.replace(/(#.+)?$/,r);i=i.replace("&&","&"),window.history.replaceState(window.history.state,null,i)},this._updateHash=Er(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const t=this._map.getCenter(),n=Math.round(100*this._map.getZoom())/100,r=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),i=Math.pow(10,r),a=Math.round(t.lng*i)/i,o=Math.round(t.lat*i)/i,s=this._map.getBearing(),l=this._map.getPitch();let u="";if(u+=e?"/".concat(a,"/").concat(o,"/").concat(n):"".concat(n,"/").concat(o,"/").concat(a),(s||l)&&(u+="/"+Math.round(10*s)/10),l&&(u+="/".concat(Math.round(l))),this._hashName){const e=this._hashName;let t=!1;const n=window.location.hash.slice(1).split("&").map(n=>{const r=n.split("=")[0];return r===e?(t=!0,"".concat(r,"=").concat(u)):n}).filter(e=>e);return t||n.push("".concat(e,"=").concat(u)),"#".concat(n.join("&"))}return"#".concat(u)}}const Pr={linearity:.3,easing:t.b8(0,0,.3,1)},Dr=t.e({deceleration:2500,maxSpeed:1400},Pr),Ir=t.e({deceleration:20,maxSpeed:1400},Pr),Tr=t.e({deceleration:1e3,maxSpeed:360},Pr),Ar=t.e({deceleration:1e3,maxSpeed:90},Pr);class zr{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,t=a.now();for(;e.length>0&&t-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const n={zoom:0,bearing:0,pitch:0,pan:new t.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:t}of this._inertiaBuffer)n.zoom+=t.zoomDelta||0,n.bearing+=t.bearingDelta||0,n.pitch+=t.pitchDelta||0,t.panDelta&&n.pan._add(t.panDelta),t.around&&(n.around=t.around),t.pinchAround&&(n.pinchAround=t.pinchAround);const r=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(n.pan.mag()){const a=Fr(n.pan.mag(),r,t.e({},Dr,e||{}));i.offset=n.pan.mult(a.amount/n.pan.mag()),i.center=this._map.transform.center,Or(i,a)}if(n.zoom){const e=Fr(n.zoom,r,Ir);i.zoom=this._map.transform.zoom+e.amount,Or(i,e)}if(n.bearing){const e=Fr(n.bearing,r,Tr);i.bearing=this._map.transform.bearing+t.ac(e.amount,-179,179),Or(i,e)}if(n.pitch){const e=Fr(n.pitch,r,Ar);i.pitch=this._map.transform.pitch+e.amount,Or(i,e)}if(i.zoom||i.bearing){const e=void 0===n.pinchAround?n.around:n.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),t.e(i,{noMoveStart:!0})}}function Or(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function Fr(e,n,r){const{maxSpeed:i,linearity:a,deceleration:o}=r,s=t.ac(e*a/(n/1e3),-i,i),l=Math.abs(s)/(o*a);return{easing:r.easing,duration:1e3*l,amount:s*(l/2)}}class Mr extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const a=o.mousePos(n.getCanvas(),r),s=n.unproject(a);super(e,t.e({point:a,lngLat:s,originalEvent:r},i)),this._defaultPrevented=!1,this.target=n}}class jr extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,n,r){const i="touchend"===e?r.changedTouches:r.touches,a=o.touchPos(n.getCanvasContainer(),i),s=a.map(e=>n.unproject(e)),l=a.reduce((e,t,n,r)=>e.add(t.div(r.length)),new t.P(0,0));super(e,{points:a,point:l,lngLats:s,lngLat:n.unproject(l),originalEvent:r}),this._defaultPrevented=!1}}class Br extends t.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,n){super(e,{originalEvent:n}),this._defaultPrevented=!1}}class Rr{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new Br(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new Mr(e.type,this._map,e))}mouseup(e){this._map.fire(new Mr(e.type,this._map,e))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||this._map.fire(new Mr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new Mr(e.type,this._map,e))}mouseover(e){this._map.fire(new Mr(e.type,this._map,e))}mouseout(e){this._map.fire(new Mr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new jr(e.type,this._map,e))}touchmove(e){this._map.fire(new jr(e.type,this._map,e))}touchend(e){this._map.fire(new jr(e.type,this._map,e))}touchcancel(e){this._map.fire(new jr(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Lr{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new Mr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Mr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new Mr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nr{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.pointLocation(t.P.convert(e),this._map.terrain)}}class Ur{constructor(e,t){this._map=e,this._tr=new Nr(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(o.disableDrag(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const n=t;if(this._lastPos.equals(n)||!this._box&&n.dist(this._startPos)<this._clickTolerance)return;const r=this._startPos;this._lastPos=n,this._box||(this._box=o.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const i=Math.min(r.x,n.x),a=Math.max(r.x,n.x),s=Math.min(r.y,n.y),l=Math.max(r.y,n.y);o.setTransform(this._box,"translate(".concat(i,"px,").concat(s,"px)")),this._box.style.width=a-i+"px",this._box.style.height=l-s+"px"}mouseupWindow(e,n){if(!this._active)return;if(0!==e.button)return;const r=this._startPos,i=n;if(this.reset(),o.suppressClick(),r.x!==i.x||r.y!==i.y)return this._map.fire(new t.k("boxzoomend",{originalEvent:e})),{cameraAnimation:e=>e.fitScreenCoordinates(r,i,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(o.remove(this._box),this._box=null),o.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,n){return this._map.fire(new t.k(e,{originalEvent:n}))}}function Vr(e,t){if(e.length!==t.length)throw new Error("The number of touches and points are not equal - touches ".concat(e.length,", points ").concat(t.length));const n={};for(let r=0;r<e.length;r++)n[e[r].identifier]=t[r];return n}class qr{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,n,r){(this.centroid||r.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=e.timeStamp),r.length===this.numTouches&&(this.centroid=function(e){const n=new t.P(0,0);for(const t of e)n._add(t);return n.div(e.length)}(n),this.touches=Vr(r,n)))}touchmove(e,t,n){if(this.aborted||!this.centroid)return;const r=Vr(n,t);for(const i in this.touches){const e=r[i];(!e||e.dist(this.touches[i])>30)&&(this.aborted=!0)}}touchend(e,t,n){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===n.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class Hr{constructor(e){this.singleTap=new qr(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,t,n){this.singleTap.touchstart(e,t,n)}touchmove(e,t,n){this.singleTap.touchmove(e,t,n)}touchend(e,t,n){const r=this.singleTap.touchend(e,t,n);if(r){const t=e.timeStamp-this.lastTime<500,n=!this.lastTap||this.lastTap.dist(r)<30;if(t&&n||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=r,this.count===this.numTaps)return this.reset(),r}}}class Wr{constructor(e){this._tr=new Nr(e),this._zoomIn=new Hr({numTouches:1,numTaps:2}),this._zoomOut=new Hr({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,n){this._zoomIn.touchstart(e,t,n),this._zoomOut.touchstart(e,t,n)}touchmove(e,t,n){this._zoomIn.touchmove(e,t,n),this._zoomOut.touchmove(e,t,n)}touchend(e,t,n){const r=this._zoomIn.touchend(e,t,n),i=this._zoomOut.touchend(e,t,n),a=this._tr;return r?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom+1,around:a.unproject(r)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:a.zoom-1,around:a.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zr{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(){const e=this._moveFunction(...arguments);if(e.bearingDelta||e.pitchDelta||e.around||e.panDelta)return this._active=!0,e}dragStart(e,t){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=t.length?t[0]:t,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,t){if(!this.isEnabled())return;const n=this._lastPoint;if(!n)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const r=t.length?t[0]:t;return!this._moved&&r.dist(n)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=r,this._move(n,r))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&o.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Kr={0:1,2:2};class Gr{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const t=o.mouseButton(e);this._eventButton=t}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(e,t){const n=Kr[t];return void 0===e.buttons||(e.buttons&n)!==n}(e,this._eventButton)}isValidEndEvent(e){return o.mouseButton(e)===this._eventButton}}class Xr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return 1===e.targetTouches.length}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}const $r=e=>{e.mousedown=e.dragStart,e.mousemoveWindow=e.dragMove,e.mouseup=e.dragEnd,e.contextmenu=e=>{e.preventDefault()}},Yr=e=>{let{enable:t,clickTolerance:n,bearingDegreesPerPixelMoved:r=.8}=e;const i=new Gr({checkCorrectEvent:e=>0===o.mouseButton(e)&&e.ctrlKey||2===o.mouseButton(e)});return new Zr({clickTolerance:n,move:(e,t)=>({bearingDelta:(t.x-e.x)*r}),moveStateManager:i,enable:t,assignEvents:$r})},Jr=e=>{let{enable:t,clickTolerance:n,pitchDegreesPerPixelMoved:r=-.5}=e;const i=new Gr({checkCorrectEvent:e=>0===o.mouseButton(e)&&e.ctrlKey||2===o.mouseButton(e)});return new Zr({clickTolerance:n,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:i,enable:t,assignEvents:$r})};class Qr{constructor(e,t){this._clickTolerance=e.clickTolerance||1,this._map=t,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new t.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,t,n){return this._calculateTransform(e,t,n)}touchmove(e,t,n){if(this._active){if(!this._shouldBePrevented(n.length))return e.preventDefault(),this._calculateTransform(e,t,n);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,t,n){this._calculateTransform(e,t,n),this._active&&this._shouldBePrevented(n.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,n,r){r.length>0&&(this._active=!0);const i=Vr(r,n),a=new t.P(0,0),o=new t.P(0,0);let s=0;for(const t in i){const e=i[t],n=this._touches[t];n&&(a._add(e),o._add(e.sub(n)),s++,i[t]=e)}if(this._touches=i,this._shouldBePrevented(s)||!o.mag())return;const l=o.div(s);return this._sum._add(l),this._sum.mag()<this._clickTolerance?void 0:{around:a.div(s),panDelta:l}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ei{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,t,n){this._firstTwoTouches||n.length<2||(this._firstTwoTouches=[n[0].identifier,n[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,n){if(!this._firstTwoTouches)return;e.preventDefault();const[r,i]=this._firstTwoTouches,a=ti(n,t,r),o=ti(n,t,i);if(!a||!o)return;const s=this._aroundCenter?null:a.add(o).div(2);return this._move([a,o],s,e)}touchend(e,t,n){if(!this._firstTwoTouches)return;const[r,i]=this._firstTwoTouches,a=ti(n,t,r),s=ti(n,t,i);a&&s||(this._active&&o.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ti(e,t,n){for(let r=0;r<e.length;r++)if(e[r].identifier===n)return t[r]}function ni(e,t){return Math.log(e/t)/Math.LN2}class ri extends ei{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const n=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(ni(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ni(this._distance,n),pinchAround:t}}}function ii(e,t){return 180*e.angleWith(t)/Math.PI}class ai extends ei{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t,n){const r=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ii(this._vector,r),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,n=ii(e,this._startVector);return Math.abs(n)<t}}function oi(e){return Math.abs(e.y)>Math.abs(e.x)}class si extends ei{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,t,n){super.touchstart(e,t,n),this._currentTouchCount=n.length}_start(e){this._lastPoints=e,oi(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,t,n){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const r=e[0].sub(this._lastPoints[0]),i=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(r,i,n.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(r.y+i.y)/2*-.5}):void 0}gestureBeginsVertically(e,t,n){if(void 0!==this._valid)return this._valid;const r=e.mag()>=2,i=t.mag()>=2;if(!r&&!i)return;if(!r||!i)return void 0===this._firstMove&&(this._firstMove=n),n-this._firstMove<100&&void 0;const a=e.y>0==t.y>0;return oi(e)&&oi(t)&&a}}const li={panStep:100,bearingStep:15,pitchStep:10};class ui{constructor(e){this._tr=new Nr(e);const t=li;this._panStep=t.panStep,this._bearingStep=t.bearingStep,this._pitchStep=t.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,n=0,r=0,i=0,a=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?n=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?n=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?r=1:(e.preventDefault(),a=-1);break;case 40:e.shiftKey?r=-1:(e.preventDefault(),a=1);break;default:return}return this._rotationDisabled&&(n=0,r=0),{cameraAnimation:o=>{const s=this._tr;o.easeTo({duration:300,easeId:"keyboardHandler",easing:ci,zoom:t?Math.round(s.zoom)+t*(e.shiftKey?2:1):s.zoom,bearing:s.bearing+n*this._bearingStep,pitch:s.pitch+r*this._pitchStep,offset:[-i*this._panStep,-a*this._panStep],center:s.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ci(e){return e*(2-e)}const di=4.000244140625;class hi{constructor(e,t){this._onTimeout=e=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)},this._map=e,this._tr=new Nr(e),this._triggerRenderFrame=t,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let t=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const n=a.now(),r=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==t&&t%di==0?this._type="wheel":0!==t&&Math.abs(t)<4?this._type="trackpad":r>400?(this._type=null,this._lastValue=t,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(r*t)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,t+=this._lastValue)),e.shiftKey&&t&&(t/=4),this._type&&(this._lastWheelEvent=e,this._delta-=t,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const n=o.mousePos(this._map.getCanvas(),e),r=this._tr;this._around=n.y>r.transform.height/2-r.transform.getHorizon()?t.N.convert(this._aroundCenter?r.center:r.unproject(n)):t.N.convert(r.center),this._aroundPoint=r.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const e=this._tr.transform;if(0!==this._delta){const t="wheel"===this._type&&Math.abs(this._delta)>di?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*t)));this._delta<0&&0!==n&&(n=1/n);const r="number"==typeof this._targetZoom?e.zoomScale(this._targetZoom):e.scale;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(r*n))),"wheel"===this._type&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:e.zoom,r=this._startZoom,i=this._easing;let o,s=!1;const l=a.now()-this._lastWheelEventTime;if("wheel"===this._type&&r&&i&&l){const e=Math.min(l/200,1),a=i(e);o=t.y.number(r,n,a),e<1?this._frameId||(this._frameId=!0):s=!0}else o=n,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:o-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let n=t.b9;if(this._prevEase){const e=this._prevEase,r=(a.now()-e.start)/e.duration,i=e.easing(r+.01)-e.easing(r),o=.27/Math.sqrt(i*i+1e-4)*.01,s=Math.sqrt(.0729-o*o);n=t.b8(o,s,.25,1)}return this._prevEase={start:a.now(),duration:e,easing:n},n}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class fi{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class pi{constructor(e){this._tr=new Nr(e),this.reset()}reset(){this._active=!1}dblclick(e,t){return e.preventDefault(),{cameraAnimation:n=>{n.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class mi{constructor(){this._tap=new Hr({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,t,n){if(!this._swipePoint)if(this._tapTime){const r=t[0],i=e.timeStamp-this._tapTime<500,a=this._tapPoint.dist(r)<30;i&&a?n.length>0&&(this._swipePoint=r,this._swipeTouch=n[0].identifier):this.reset()}else this._tap.touchstart(e,t,n)}touchmove(e,t,n){if(this._tapTime){if(this._swipePoint){if(n[0].identifier!==this._swipeTouch)return;const r=t[0],i=r.y-this._swipePoint.y;return this._swipePoint=r,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,n)}touchend(e,t,n){if(this._tapTime)this._swipePoint&&0===n.length&&this.reset();else{const r=this._tap.touchend(e,t,n);r&&(this._tapTime=e.timeStamp,this._tapPoint=r)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gi{constructor(e,t,n){this._el=e,this._mousePan=t,this._touchPan=n}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class yi{constructor(e,t,n){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=n}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class vi{constructor(e,t,n,r){this._el=e,this._touchZoom=t,this._touchRotate=n,this._tapDragZoom=r,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class _i{constructor(e,t){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=e,this._options=t,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=o.create("div","maplibregl-cooperative-gesture-screen",e);let t=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(t=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const n=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),r=document.createElement("div");r.className="maplibregl-desktop-message",r.textContent=t,this._container.appendChild(r);const i=document.createElement("div");i.className="maplibregl-mobile-message",i.textContent=n,this._container.appendChild(i),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(o.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,n){this._enabled&&(this._map.fire(new t.k("cooperativegestureprevented",{gestureType:e,originalEvent:n})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const bi=e=>e.zoom||e.drag||e.pitch||e.rotate;class xi extends t.k{}function wi(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class ki{constructor(e,t){this.handleWindowEvent=e=>{this.handleEvent(e,"".concat(e.type,"Window"))},this.handleEvent=(e,t)=>{if("blur"===e.type)return void this.stop(!0);this._updatingCamera=!0;const n="renderFrame"===e.type?void 0:e,r={needsRenderFrame:!1},i={},a={},s=e.touches,l=s?this._getMapTouches(s):void 0,u=l?o.touchPos(this._map.getCanvas(),l):o.mousePos(this._map.getCanvas(),e);for(const{handlerName:o,handler:h,allowed:f}of this._handlers){if(!h.isEnabled())continue;let s;this._blockedByActive(a,f,o)?h.reset():h[t||e.type]&&(s=h[t||e.type](e,u,l),this.mergeHandlerResult(r,i,s,o,n),s&&s.needsRenderFrame&&this._triggerRenderFrame()),(s||h.isActive())&&(a[o]=h)}const c={};for(const o in this._previousActiveHandlers)a[o]||(c[o]=n);this._previousActiveHandlers=a,(Object.keys(c).length||wi(r))&&(this._changes.push([r,i,c]),this._triggerRenderFrame()),(Object.keys(a).length||wi(r))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:d}=r;d&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],d(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zr(e),this._bearingSnap=t.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(t);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[window,"blur",void 0]];for(const[r,i,a]of this._listeners)o.addEventListener(r,i,r===document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[e,t,n]of this._listeners)o.removeEventListener(e,t,e===document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,n=t.getCanvasContainer();this._add("mapEvent",new Rr(t,e));const r=t.boxZoom=new Ur(t,e);this._add("boxZoom",r),e.interactive&&e.boxZoom&&r.enable();const i=t.cooperativeGestures=new _i(t,e.cooperativeGestures);this._add("cooperativeGestures",i),e.cooperativeGestures&&i.enable();const a=new Wr(t),s=new pi(t);t.doubleClickZoom=new fi(s,a),this._add("tapZoom",a),this._add("clickZoom",s),e.interactive&&e.doubleClickZoom&&t.doubleClickZoom.enable();const l=new mi;this._add("tapDragZoom",l);const u=t.touchPitch=new si(t);this._add("touchPitch",u),e.interactive&&e.touchPitch&&t.touchPitch.enable(e.touchPitch);const c=Yr(e),d=Jr(e);t.dragRotate=new yi(e,c,d),this._add("mouseRotate",c,["mousePitch"]),this._add("mousePitch",d,["mouseRotate"]),e.interactive&&e.dragRotate&&t.dragRotate.enable();const h=(e=>{let{enable:t,clickTolerance:n}=e;const r=new Gr({checkCorrectEvent:e=>0===o.mouseButton(e)&&!e.ctrlKey});return new Zr({clickTolerance:n,move:(e,t)=>({around:t,panDelta:t.sub(e)}),activateOnStart:!0,moveStateManager:r,enable:t,assignEvents:$r})})(e),f=new Qr(e,t);t.dragPan=new gi(n,h,f),this._add("mousePan",h),this._add("touchPan",f,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&t.dragPan.enable(e.dragPan);const p=new ai,m=new ri;t.touchZoomRotate=new vi(n,m,p,l),this._add("touchRotate",p,["touchPan","touchZoom"]),this._add("touchZoom",m,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&t.touchZoomRotate.enable(e.touchZoomRotate);const g=t.scrollZoom=new hi(t,()=>this._triggerRenderFrame());this._add("scrollZoom",g,["mousePan"]),e.interactive&&e.scrollZoom&&t.scrollZoom.enable(e.scrollZoom);const y=t.keyboard=new ui(t);this._add("keyboard",y),e.interactive&&e.keyboard&&t.keyboard.enable(),this._add("blockableMapEvent",new Lr(t))}_add(e,t,n){this._handlers.push({handlerName:e,handler:t,allowed:n}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(bi(this._eventsInProgress))||this.isZooming()}_blockedByActive(e,t,n){for(const r in e)if(r!==n&&(!t||t.indexOf(r)<0))return!0;return!1}_getMapTouches(e){const t=[];for(const n of e)this._el.contains(n.target)&&t.push(n);return t}mergeHandlerResult(e,n,r,i,a){if(!r)return;t.e(e,r);const o={handlerName:i,originalEvent:r.originalEvent||a};void 0!==r.zoomDelta&&(n.zoom=o),void 0!==r.panDelta&&(n.drag=o),void 0!==r.pitchDelta&&(n.pitch=o),void 0!==r.bearingDelta&&(n.rotate=o)}_applyChanges(){const e={},n={},r={};for(const[i,a,o]of this._changes)i.panDelta&&(e.panDelta=(e.panDelta||new t.P(0,0))._add(i.panDelta)),i.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(e.around=i.around),void 0!==i.pinchAround&&(e.pinchAround=i.pinchAround),i.noInertia&&(e.noInertia=i.noInertia),t.e(n,a),t.e(r,o);this._updateMapTransform(e,n,r),this._changes=[]}_updateMapTransform(e,t,n){const r=this._map,i=r._getTransformForUpdate(),a=r.terrain;if(!(wi(e)||a&&this._terrainMovement))return this._fireEvents(t,n,!0);let{panDelta:o,zoomDelta:s,bearingDelta:l,pitchDelta:u,around:c,pinchAround:d}=e;void 0!==d&&(c=d),r._stop(!0),c=c||r.transform.centerPoint;const h=i.pointLocation(o?c.sub(o):c);l&&(i.bearing+=l),u&&(i.pitch+=u),s&&(i.zoom+=s),a?this._terrainMovement||!t.drag&&!t.zoom?t.drag&&this._terrainMovement?i.center=i.pointLocation(i.centerPoint.sub(o)):i.setLocationAtPoint(h,c):(this._terrainMovement=!0,this._map._elevationFreeze=!0,i.setLocationAtPoint(h,c)):i.setLocationAtPoint(h,c),r._applyUpdatedTransform(i),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(t,n,!0)}_fireEvents(e,n,r){const i=bi(this._eventsInProgress),o=bi(e),s={};for(const t in e){const{originalEvent:n}=e[t];this._eventsInProgress[t]||(s["".concat(t,"start")]=n),this._eventsInProgress[t]=e[t]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const t in s)this._fireEvent(t,s[t]);o&&this._fireEvent("move",o.originalEvent);for(const t in e){const{originalEvent:n}=e[t];this._fireEvent(t,n)}const l={};let u;for(const t in this._eventsInProgress){const{handlerName:e,originalEvent:r}=this._eventsInProgress[t];this._handlersById[e].isActive()||(delete this._eventsInProgress[t],u=n[e]||r,l["".concat(t,"end")]=u)}for(const t in l)this._fireEvent(t,l[t]);const c=bi(this._eventsInProgress),d=(i||o)&&!c;if(d&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const e=this._map._getTransformForUpdate();e.recalculateZoom(this._map.terrain),this._map._applyUpdatedTransform(e)}if(r&&d){this._updatingCamera=!0;const e=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),n=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;!e||!e.essential&&a.prefersReducedMotion?(this._map.fire(new t.k("moveend",{originalEvent:u})),n(this._map.getBearing())&&this._map.resetNorth()):(n(e.bearing||this._map.getBearing())&&(e.bearing=0),e.freezeElevation=!0,this._map.easeTo(e,{originalEvent:u})),this._updatingCamera=!1}}_fireEvent(e,n){this._map.fire(new t.k(e,n?{originalEvent:n}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new xi("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Si extends t.E{constructor(e,t){super(),this._renderFrameCallback=()=>{const e=Math.min((a.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(e)),e<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=t.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new t.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(e,n,r){return e=t.P.convert(e).mult(-1),this.panTo(this.transform.center,t.e({offset:e},n),r)}panTo(e,n,r){return this.easeTo(t.e({center:e},n),r)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(e,n,r){return this.easeTo(t.e({zoom:e},n),r)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(e,n,r){return this.easeTo(t.e({bearing:e},n),r)}resetNorth(e,n){return this.rotateTo(0,t.e({duration:1e3},e),n),this}resetNorthPitch(e,n){return this.easeTo(t.e({bearing:0,pitch:0,duration:1e3},e),n),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(e,t){e=Z.convert(e).adjustAntiMeridian();const n=t&&t.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),n,t)}_cameraForBoxAndBearing(e,n,r,i){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=t.e({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const e=i.padding;i.padding={top:e,bottom:e,right:e,left:e}}i.padding=t.e(a,i.padding);const o=this.transform,s=o.padding,l=new Z(e,n),u=o.project(l.getNorthWest()),c=o.project(l.getNorthEast()),d=o.project(l.getSouthEast()),h=o.project(l.getSouthWest()),f=t.ba(-r),p=u.rotate(f),m=c.rotate(f),g=d.rotate(f),y=h.rotate(f),v=new t.P(Math.max(p.x,m.x,y.x,g.x),Math.max(p.y,m.y,y.y,g.y)),_=new t.P(Math.min(p.x,m.x,y.x,g.x),Math.min(p.y,m.y,y.y,g.y)),b=v.sub(_),x=(o.width-(s.left+s.right+i.padding.left+i.padding.right))/b.x,w=(o.height-(s.top+s.bottom+i.padding.top+i.padding.bottom))/b.y;if(w<0||x<0)return void t.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const k=Math.min(o.scaleZoom(o.scale*Math.min(x,w)),i.maxZoom),S=t.P.convert(i.offset),E=new t.P((i.padding.left-i.padding.right)/2,(i.padding.top-i.padding.bottom)/2).rotate(t.ba(r)),C=S.add(E).mult(o.scale/o.zoomScale(k));return{center:o.unproject(u.add(d).div(2).sub(C)),zoom:k,bearing:r}}fitBounds(e,t,n){return this._fitInternal(this.cameraForBounds(e,t),t,n)}fitScreenCoordinates(e,n,r,i,a){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(t.P.convert(e)),this.transform.pointLocation(t.P.convert(n)),r,i),i,a)}_fitInternal(e,n,r){return e?(delete(n=t.e(e,n)).padding,n.linear?this.easeTo(n,r):this.flyTo(n,r)):this}jumpTo(e,n){this.stop();const r=this._getTransformForUpdate();let i=!1,a=!1,o=!1;return"zoom"in e&&r.zoom!==+e.zoom&&(i=!0,r.zoom=+e.zoom),void 0!==e.center&&(r.center=t.N.convert(e.center)),"bearing"in e&&r.bearing!==+e.bearing&&(a=!0,r.bearing=+e.bearing),"pitch"in e&&r.pitch!==+e.pitch&&(o=!0,r.pitch=+e.pitch),null==e.padding||r.isPaddingEqual(e.padding)||(r.padding=e.padding),this._applyUpdatedTransform(r),this.fire(new t.k("movestart",n)).fire(new t.k("move",n)),i&&this.fire(new t.k("zoomstart",n)).fire(new t.k("zoom",n)).fire(new t.k("zoomend",n)),a&&this.fire(new t.k("rotatestart",n)).fire(new t.k("rotate",n)).fire(new t.k("rotateend",n)),o&&this.fire(new t.k("pitchstart",n)).fire(new t.k("pitch",n)).fire(new t.k("pitchend",n)),this.fire(new t.k("moveend",n))}calculateCameraOptionsFromTo(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const a=t.Z.fromLngLat(e,n),o=t.Z.fromLngLat(r,i),s=o.x-a.x,l=o.y-a.y,u=o.z-a.z,c=Math.hypot(s,l,u);if(0===c)throw new Error("Can't calculate camera options with same From and To");const d=Math.hypot(s,l),h=this.transform.scaleZoom(this.transform.cameraToCenterDistance/c/this.transform.tileSize),f=180*Math.atan2(s,-l)/Math.PI;let p=180*Math.acos(d/c)/Math.PI;return p=u<0?90-p:90+p,{center:o.toLngLat(),zoom:h,pitch:p,bearing:f}}easeTo(e,n){var r;this._stop(!1,e.easeId),(!1===(e=t.e({offset:[0,0],duration:500,easing:t.b9},e)).animate||!e.essential&&a.prefersReducedMotion)&&(e.duration=0);const i=this._getTransformForUpdate(),o=i.zoom,s=i.bearing,l=i.pitch,u=i.padding,c="bearing"in e?this._normalizeBearing(e.bearing,s):s,d="pitch"in e?+e.pitch:l,h="padding"in e?e.padding:i.padding,f=t.P.convert(e.offset);let p=i.centerPoint.add(f);const m=i.pointLocation(p),{center:g,zoom:y}=i.getConstrained(t.N.convert(e.center||m),null!==(r=e.zoom)&&void 0!==r?r:o);this._normalizeCenter(g,i);const v=i.project(m),_=i.project(g).sub(v),b=i.zoomScale(y-o);let x,w;e.around&&(x=t.N.convert(e.around),w=i.locationPoint(x));const k={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||y!==o,this._rotating=this._rotating||s!==c,this._pitching=this._pitching||d!==l,this._padding=!i.isPaddingEqual(h),this._easeId=e.easeId,this._prepareEase(n,e.noMoveStart,k),this.terrain&&this._prepareElevation(g),this._ease(r=>{if(this._zooming&&(i.zoom=t.y.number(o,y,r)),this._rotating&&(i.bearing=t.y.number(s,c,r)),this._pitching&&(i.pitch=t.y.number(l,d,r)),this._padding&&(i.interpolatePadding(u,h,r),p=i.centerPoint.add(f)),this.terrain&&!e.freezeElevation&&this._updateElevation(r),x)i.setLocationAtPoint(x,w);else{const e=i.zoomScale(i.zoom-o),t=y>o?Math.min(2,b):Math.max(.5,b),n=Math.pow(t,1-r),a=i.unproject(v.add(_.mult(r*n)).mult(e));i.setLocationAtPoint(i.renderWorldCopies?a.wrap():a,p)}this._applyUpdatedTransform(i),this._fireMoveEvents(n)},t=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n,t)},e),this}_prepareEase(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this._moving=!0,n||r.moving||this.fire(new t.k("movestart",e)),this._zooming&&!r.zooming&&this.fire(new t.k("zoomstart",e)),this._rotating&&!r.rotating&&this.fire(new t.k("rotatestart",e)),this._pitching&&!r.pitching&&this.fire(new t.k("pitchstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const n=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&n!==this._elevationTarget){const t=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(t-(n-(t*e+this._elevationStart))/(1-e)),this._elevationTarget=n}this.transform.elevation=t.y.number(this._elevationStart,this._elevationTarget,e)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){const t=e.getCameraPosition(),n=this.terrain.getElevationForLngLatZoom(t.lngLat,e.zoom);if(t.altitude<n){const r=this.calculateCameraOptionsFromTo(t.lngLat,n,e.center,e.elevation);return{pitch:r.pitch,zoom:r.zoom}}return{}}_applyUpdatedTransform(e){const t=[];if(this.terrain&&t.push(e=>this._elevateCameraIfInsideTerrain(e)),this.transformCameraUpdate&&t.push(e=>this.transformCameraUpdate(e)),!t.length)return;const n=e.clone();for(const r of t){const e=n.clone(),{center:t,zoom:i,pitch:a,bearing:o,elevation:s}=r(e);t&&(e.center=t),void 0!==i&&(e.zoom=i),void 0!==a&&(e.pitch=a),void 0!==o&&(e.bearing=o),void 0!==s&&(e.elevation=s),n.apply(e)}this.transform.apply(n)}_fireMoveEvents(e){this.fire(new t.k("move",e)),this._zooming&&this.fire(new t.k("zoom",e)),this._rotating&&this.fire(new t.k("rotate",e)),this._pitching&&this.fire(new t.k("pitch",e))}_afterEase(e,n){if(this._easeId&&n&&this._easeId===n)return;delete this._easeId;const r=this._zooming,i=this._rotating,a=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,r&&this.fire(new t.k("zoomend",e)),i&&this.fire(new t.k("rotateend",e)),a&&this.fire(new t.k("pitchend",e)),this.fire(new t.k("moveend",e))}flyTo(e,n){var r;if(!e.essential&&a.prefersReducedMotion){const r=t.M(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(r,n)}this.stop(),e=t.e({offset:[0,0],speed:1.2,curve:1.42,easing:t.b9},e);const i=this._getTransformForUpdate(),o=i.zoom,s=i.bearing,l=i.pitch,u=i.padding,c="bearing"in e?this._normalizeBearing(e.bearing,s):s,d="pitch"in e?+e.pitch:l,h="padding"in e?e.padding:i.padding,f=t.P.convert(e.offset);let p=i.centerPoint.add(f);const m=i.pointLocation(p),{center:g,zoom:y}=i.getConstrained(t.N.convert(e.center||m),null!==(r=e.zoom)&&void 0!==r?r:o);this._normalizeCenter(g,i);const v=i.zoomScale(y-o),_=i.project(m),b=i.project(g).sub(_);let x=e.curve;const w=Math.max(i.width,i.height),k=w/v,S=b.mag();if("minZoom"in e){const n=t.ac(Math.min(e.minZoom,o,y),i.minZoom,i.maxZoom),r=w/i.zoomScale(n-o);x=Math.sqrt(r/S*2)}const E=x*x;function C(e){const t=(k*k-w*w+(e?-1:1)*E*E*S*S)/(2*(e?k:w)*E*S);return Math.log(Math.sqrt(t*t+1)-t)}function P(e){return(Math.exp(e)-Math.exp(-e))/2}function D(e){return(Math.exp(e)+Math.exp(-e))/2}const I=C(!1);let T=function(e){return D(I)/D(I+x*e)},A=function(e){return w*((D(I)*(P(t=I+x*e)/D(t))-P(I))/E)/S;var t},z=(C(!0)-I)/x;if(Math.abs(S)<1e-6||!isFinite(z)){if(Math.abs(w-k)<1e-6)return this.easeTo(e,n);const t=k<w?-1:1;z=Math.abs(Math.log(k/w))/x,A=()=>0,T=e=>Math.exp(t*x*e)}return e.duration="duration"in e?+e.duration:1e3*z/("screenSpeed"in e?+e.screenSpeed/x:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=s!==c,this._pitching=d!==l,this._padding=!i.isPaddingEqual(h),this._prepareEase(n,!1),this.terrain&&this._prepareElevation(g),this._ease(r=>{const a=r*z,m=1/T(a);i.zoom=1===r?y:o+i.scaleZoom(m),this._rotating&&(i.bearing=t.y.number(s,c,r)),this._pitching&&(i.pitch=t.y.number(l,d,r)),this._padding&&(i.interpolatePadding(u,h,r),p=i.centerPoint.add(f)),this.terrain&&!e.freezeElevation&&this._updateElevation(r);const v=1===r?g:i.unproject(_.add(b.mult(A(a))).mult(m));i.setLocationAtPoint(i.renderWorldCopies?v.wrap():v,p),this._applyUpdatedTransform(i),this._fireMoveEvents(n)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(n)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){var n;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const e=this._onEaseEnd;delete this._onEaseEnd,e.call(this,t)}return e||null===(n=this.handlers)||void 0===n||n.stop(!1),this}_ease(e,t,n){!1===n.animate||0===n.duration?(e(1),t()):(this._easeStart=a.now(),this._easeOptions=n,this._onEaseFrame=e,this._onEaseEnd=t,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,n){e=t.b3(e,-180,180);const r=Math.abs(e-n);return Math.abs(e-360-n)<r&&(e-=360),Math.abs(e+360-n)<r&&(e+=360),e}_normalizeCenter(e,t){if(!t.renderWorldCopies||t.lngRange)return;const n=e.lng-t.center.lng;e.lng+=n>180?-360:n<-180?360:0}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(t.N.convert(e),this.transform.tileZoom)-this.transform.elevation:null}}const Ei={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Ci{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ei;this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=e=>{!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType&&"terrain"!==e.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=o.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=o.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){o.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const n=this._map._getUIString("AttributionControl.".concat(t));e.title=n,e.setAttribute("aria-label",n)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(e=>"string"!=typeof e?"":e)):"string"==typeof this.options.customAttribution&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style.sourceCaches;for(const r in t){const n=t[r];if(n.used||n.usedForTerrain){const t=n.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e=e.filter(e=>String(e).trim()),e.sort((e,t)=>e.length-t.length),e=e.filter((t,n)=>{for(let r=n+1;r<e.length;r++)if(e[r].indexOf(t)>=0)return!1;return!0});const n=e.join(" | ");n!==this._attribHTML&&(this._attribHTML=n,e.length?(this._innerContainer.innerHTML=n,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Pi{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._updateCompact=()=>{const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&t.classList.add("maplibregl-compact"):t.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=o.create("div","maplibregl-ctrl");const t=o.create("a","maplibregl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://maplibre.org/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){o.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class Di{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,n=t?this._queue.concat(t):this._queue;for(const r of n)if(r.id===e)return void(r.cancelled=!0)}run(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const t=this._currentlyRunning=this._queue;this._queue=[];for(const n of t)if(!n.cancelled&&(n.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Ii=t.Y([{name:"a_pos3d",type:"Int16",components:3}]);class Ti extends t.E{constructor(e){super(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,e.usedForTerrain=!0,e.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,n){this.sourceCache.update(e,n),this._renderableTilesKeys=[];const r={};for(const i of e.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:n}))r[i.key]=!0,this._renderableTilesKeys.push(i.key),this._tiles[i.key]||(i.posMatrix=new Float64Array(16),t.aP(i.posMatrix,0,t.X,0,t.X,0,1),this._tiles[i.key]=new le(i,this.tileSize));for(const t in this._tiles)r[t]||delete this._tiles[t]}freeRtt(e){for(const t in this._tiles){const n=this._tiles[t];(!e||n.tileID.equals(e)||n.tileID.isChildOf(e)||e.isChildOf(n.tileID))&&(n.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const n={};for(const r of this._renderableTilesKeys){const i=this._tiles[r].tileID;if(i.canonical.equals(e.canonical)){const i=e.clone();i.posMatrix=new Float64Array(16),t.aP(i.posMatrix,0,t.X,0,t.X,0,1),n[r]=i}else if(i.canonical.isChildOf(e.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=i.canonical.z-e.canonical.z,s=i.canonical.x-(i.canonical.x>>o<<o),l=i.canonical.y-(i.canonical.y>>o<<o),u=t.X>>o;t.aP(a.posMatrix,0,u,0,u,0,1),t.J(a.posMatrix,a.posMatrix,[-s*u,-l*u,0]),n[r]=a}else if(e.canonical.isChildOf(i.canonical)){const a=e.clone();a.posMatrix=new Float64Array(16);const o=e.canonical.z-i.canonical.z,s=e.canonical.x-(e.canonical.x>>o<<o),l=e.canonical.y-(e.canonical.y>>o<<o),u=t.X>>o;t.aP(a.posMatrix,0,t.X,0,t.X,0,1),t.J(a.posMatrix,a.posMatrix,[s*u,l*u,0]),t.K(a.posMatrix,a.posMatrix,[1/2**o,1/2**o,0]),n[r]=a}}return n}getSourceTile(e,t){const n=this.sourceCache._source;let r=e.overscaledZ-this.deltaZoom;if(r>n.maxzoom&&(r=n.maxzoom),r<n.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(r).key);let i=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!i||!i.dem)&&t)for(;r>=n.minzoom&&(!i||!i.dem);)i=this.sourceCache.getTileByID(e.scaledTo(r--).key);return i}tilesAfterTime(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();return Object.values(this._tiles).filter(t=>t.timeAdded>=e)}}class Ai{constructor(e,t,n){this.painter=e,this.sourceCache=new Ti(t),this.options=n,this.exaggeration="number"==typeof n.exaggeration?n.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.X;var a;if(!(n>=0&&n<i&&r>=0&&r<i))return 0;const o=this.getTerrainData(e),s=null===(a=o.tile)||void 0===a?void 0:a.dem;if(!s)return 0;const l=function(e,t,n){var r=t[0],i=t[1];return e[0]=n[0]*r+n[4]*i+n[12],e[1]=n[1]*r+n[5]*i+n[13],e}([],[n/i*t.X,r/i*t.X],o.u_terrain_matrix),u=[l[0]*s.dim,l[1]*s.dim],c=Math.floor(u[0]),d=Math.floor(u[1]),h=u[0]-c,f=u[1]-d;return s.get(c,d)*(1-h)*(1-f)+s.get(c+1,d)*h*(1-f)+s.get(c,d+1)*(1-h)*f+s.get(c+1,d+1)*h*f}getElevationForLngLatZoom(e,n){if(!t.bb(n,e.wrap()))return 0;const{tileID:r,mercatorX:i,mercatorY:a}=this._getOverscaledTileIDFromLngLatZoom(e,n);return this.getElevation(r,i%t.X,a%t.X,t.X)}getElevation(e,n,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.X;return this.getDEMElevation(e,n,r,i)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const e=this.painter.context,n=new t.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new x(e,n,e.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new x(e,new t.R({width:1,height:1}),e.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=t.an([])}const n=this.sourceCache.getSourceTile(e,!0);if(n&&n.dem&&(!n.demTexture||n.needsTerrainPrepare)){const e=this.painter.context;n.demTexture=this.painter.getTileTexture(n.dem.stride),n.demTexture?n.demTexture.update(n.dem.getPixels(),{premultiply:!1}):n.demTexture=new x(e,n.dem.getPixels(),e.gl.RGBA,{premultiply:!1}),n.demTexture.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),n.needsTerrainPrepare=!1}const r=n&&n+n.tileID.key+e.key;if(r&&!this._demMatrixCache[r]){const r=this.sourceCache.sourceCache._source.maxzoom;let i=e.canonical.z-n.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=r?i=e.canonical.z-r:t.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const a=e.canonical.x-(e.canonical.x>>i<<i),o=e.canonical.y-(e.canonical.y>>i<<i),s=t.bc(new Float64Array(16),[1/(t.X<<i),1/(t.X<<i),0]);t.J(s,s,[a*t.X,o*t.X,0]),this._demMatrixCache[e.key]={matrix:s,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:n&&n.dem&&n.dem.dim||1,u_terrain_matrix:r?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:n&&n.dem&&n.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(n&&n.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:n}}getFramebuffer(e){const t=this.painter,n=t.width/devicePixelRatio,r=t.height/devicePixelRatio;return!this._fbo||this._fbo.width===n&&this._fbo.height===r||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new x(t.context,{width:n,height:r,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new x(t.context,{width:n,height:r,data:null},t.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(t.context.gl.NEAREST,t.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=t.context.createFramebuffer(n,r,!0,!1),this._fbo.depthAttachment.set(t.context.createRenderbuffer(t.context.gl.DEPTH_COMPONENT16,n,r))),this._fbo.colorAttachment.set("coords"===e?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const n=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let t=0,a=0;t<this._coordsTextureSize;t++)for(let e=0;e<this._coordsTextureSize;e++,a+=4)n[a+0]=255&e,n[a+1]=255&t,n[a+2]=e>>8<<4|t>>8,n[a+3]=0;const r=new t.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(n.buffer)),i=new x(e,r,e.gl.RGBA,{premultiply:!1});return i.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=i,i}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const n=new Uint8Array(4),r=this.painter.context,i=r.gl,a=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),o=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),s=Math.round(this.painter.height/devicePixelRatio);r.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),i.readPixels(a,s-o-1,1,1,i.RGBA,i.UNSIGNED_BYTE,n),r.bindFramebuffer.set(null);const l=n[0]+(n[2]>>4<<8),u=n[1]+((15&n[2])<<8),c=this.coordsIndex[255-n[3]],d=c&&this.sourceCache.getTileByID(c);if(!d)return null;const h=this._coordsTextureSize,f=(1<<d.tileID.canonical.z)*h;return new t.Z((d.tileID.canonical.x*h+l)/f+d.tileID.wrap,(d.tileID.canonical.y*h+u)/f,this.getElevation(d.tileID,l,u,h))}depthAtPoint(e){const t=new Uint8Array(4),n=this.painter.context,r=n.gl;return n.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),r.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,r.RGBA,r.UNSIGNED_BYTE,t),n.bindFramebuffer.set(null),(t[0]/16777216+t[1]/65536+t[2]/256+t[3])/256}getTerrainMesh(){if(this._mesh)return this._mesh;const e=this.painter.context,n=new t.bd,r=new t.aY,i=this.meshSize,a=t.X/i,o=i*i;for(let t=0;t<=i;t++)for(let e=0;e<=i;e++)n.emplaceBack(e*a,t*a,0);for(let t=0;t<o;t+=i+1)for(let e=0;e<i;e++)r.emplaceBack(e+t,i+e+t+1,i+e+t+2),r.emplaceBack(e+t,i+e+t+2,e+t+1);const s=n.length,l=s+2*(i+1);for(const d of[0,1])for(let e=0;e<=i;e++)for(const r of[0,1])n.emplaceBack(e*a,d*t.X,r);for(let t=0;t<2*i;t+=2)r.emplaceBack(l+t,l+t+1,l+t+3),r.emplaceBack(l+t,l+t+3,l+t+2),r.emplaceBack(s+t,s+t+3,s+t+1),r.emplaceBack(s+t,s+t+2,s+t+3);const u=n.length,c=u+2*(i+1);for(const d of[0,1])for(let e=0;e<=i;e++)for(const r of[0,1])n.emplaceBack(d*t.X,e*a,r);for(let t=0;t<2*i;t+=2)r.emplaceBack(u+t,u+t+1,u+t+3),r.emplaceBack(u+t,u+t+3,u+t+2),r.emplaceBack(c+t,c+t+3,c+t+1),r.emplaceBack(c+t,c+t+2,c+t+3);return this._mesh=new vr(e.createVertexBuffer(n,Ii.members),e.createIndexBuffer(r),t.a0.simpleSegment(0,0,n.length,r.length)),this._mesh}getMeshFrameDelta(e){return 2*Math.PI*t.be/Math.pow(2,e)/5}getMinTileElevationForLngLatZoom(e,t){var n;const{tileID:r}=this._getOverscaledTileIDFromLngLatZoom(e,t);return null!==(n=this.getMinMaxElevation(r).minElevation)&&void 0!==n?n:0}getMinMaxElevation(e){const t=this.getTerrainData(e).tile,n={minElevation:null,maxElevation:null};return t&&t.dem&&(n.minElevation=t.dem.min*this.exaggeration,n.maxElevation=t.dem.max*this.exaggeration),n}_getOverscaledTileIDFromLngLatZoom(e,n){const r=t.Z.fromLngLat(e.wrap()),i=(1<<n)*t.X,a=r.x*i,o=r.y*i,s=Math.floor(a/t.X),l=Math.floor(o/t.X);return{tileID:new t.S(n,0,n,s,l),mercatorX:a,mercatorY:o}}}class zi{constructor(e,t,n){this._context=e,this._size=t,this._tileSize=n,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const t=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),n=new x(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return n.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),t.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),t.colorAttachment.set(n.texture),{id:e,fbo:t,texture:n,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(t=>e.id!==t),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const t of this._recentlyUsed)if(!this._objects[t].inUse)return this._objects[t];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(e=>!e.inUse)}}const Oi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Fi{constructor(e,t){this.painter=e,this.terrain=t,this.pool=new zi(e.context,30,t.sourceCache.tileSize*t.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,t){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(n=>!e._layers[n].isHidden(t)),this._coordsDescendingInv={};for(const n in e.sourceCaches){this._coordsDescendingInv[n]={};const t=e.sourceCaches[n].getVisibleCoordinates();for(const e of t){const t=this.terrain.sourceCache.getTerrainCoords(e);for(const e in t)this._coordsDescendingInv[n][e]||(this._coordsDescendingInv[n][e]=[]),this._coordsDescendingInv[n][e].push(t[e])}}this._coordsDescendingInvStr={};for(const n of e._order){const t=e._layers[n],r=t.source;if(Oi[t.type]&&!this._coordsDescendingInvStr[r]){this._coordsDescendingInvStr[r]={};for(const e in this._coordsDescendingInv[r])this._coordsDescendingInvStr[r][e]=this._coordsDescendingInv[r][e].map(e=>e.key).sort().join()}}for(const n of this._renderableTiles)for(const e in this._coordsDescendingInvStr){const t=this._coordsDescendingInvStr[e][n.tileID.key];t&&t!==n.rttCoords[e]&&(n.rtt=[])}}renderLayer(e){if(e.isHidden(this.painter.transform.zoom))return!1;const n=e.type,r=this.painter,i=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(Oi[n]&&(this._prevType&&Oi[this._prevType]||this._stacks.push([]),this._prevType=n,this._stacks[this._stacks.length-1].push(e.id),!i))return!0;if(Oi[this._prevType]||Oi[n]&&i){this._prevType=n;const e=this._stacks.length-1,i=this._stacks[e]||[];for(const n of this._renderableTiles){if(this.pool.isFull()&&(yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(n),n.rtt[e]){const t=this.pool.getObjectForId(n.rtt[e].id);if(t.stamp===n.rtt[e].stamp){this.pool.useObject(t);continue}}const a=this.pool.getOrCreateFreeObject();this.pool.useObject(a),this.pool.stampObject(a),n.rtt[e]={id:a.id,stamp:a.stamp},r.context.bindFramebuffer.set(a.fbo.framebuffer),r.context.clear({color:t.aM.transparent,stencil:0}),r.currentStencilSource=void 0;for(let e=0;e<i.length;e++){const t=r.style._layers[i[e]],o=t.source?this._coordsDescendingInv[t.source][n.tileID.key]:[n.tileID];r.context.viewport.set([0,0,a.fbo.width,a.fbo.height]),r._renderTileClippingMasks(t,o),r.renderLayer(r,r.style.sourceCaches[t.source],t,o),t.source&&(n.rttCoords[t.source]=this._coordsDescendingInvStr[t.source][n.tileID.key])}}return yr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Oi[n]}return!1}}const Mi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ji=n,Bi={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Ei,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,refreshExpiredTiles:!0,scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],zoom:0,bearing:0,pitch:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:t.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0},Ri=e=>{e.touchstart=e.dragStart,e.touchmoveWindow=e.dragMove,e.touchend=e.dragEnd},Li={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ni{constructor(e,n){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.mousedown=e=>{this.startMouse(t.e({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),o.mousePos(this.element,e)),o.addEventListener(window,"mousemove",this.mousemove),o.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=e=>{this.moveMouse(e,o.mousePos(this.element,e))},this.mouseup=e=>{this.mouseRotate.dragEnd(e),this.mousePitch&&this.mousePitch.dragEnd(e),this.offTemp()},this.touchstart=e=>{1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=o.touchPos(this.element,e.targetTouches)[0],this.startTouch(e,this._startPos),o.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.addEventListener(window,"touchend",this.touchend))},this.touchmove=e=>{1!==e.targetTouches.length?this.reset():(this._lastPos=o.touchPos(this.element,e.targetTouches)[0],this.moveTouch(e,this._lastPos))},this.touchend=e=>{0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const i=e.dragRotate._mouseRotate.getClickTolerance(),a=e.dragRotate._mousePitch.getClickTolerance();this.element=n,this.mouseRotate=Yr({clickTolerance:i,enable:!0}),this.touchRotate=(e=>{let{enable:t,clickTolerance:n,bearingDegreesPerPixelMoved:r=.8}=e;const i=new Xr;return new Zr({clickTolerance:n,move:(e,t)=>({bearingDelta:(t.x-e.x)*r}),moveStateManager:i,enable:t,assignEvents:Ri})})({clickTolerance:i,enable:!0}),this.map=e,r&&(this.mousePitch=Jr({clickTolerance:a,enable:!0}),this.touchPitch=(e=>{let{enable:t,clickTolerance:n,pitchDegreesPerPixelMoved:r=-.5}=e;const i=new Xr;return new Zr({clickTolerance:n,move:(e,t)=>({pitchDelta:(t.y-e.y)*r}),moveStateManager:i,enable:t,assignEvents:Ri})})({clickTolerance:a,enable:!0})),o.addEventListener(n,"mousedown",this.mousedown),o.addEventListener(n,"touchstart",this.touchstart,{passive:!1}),o.addEventListener(n,"touchcancel",this.reset)}startMouse(e,t){this.mouseRotate.dragStart(e,t),this.mousePitch&&this.mousePitch.dragStart(e,t),o.disableDrag()}startTouch(e,t){this.touchRotate.dragStart(e,t),this.touchPitch&&this.touchPitch.dragStart(e,t),o.disableDrag()}moveMouse(e,t){const n=this.map,{bearingDelta:r}=this.mouseRotate.dragMove(e,t)||{};if(r&&n.setBearing(n.getBearing()+r),this.mousePitch){const{pitchDelta:r}=this.mousePitch.dragMove(e,t)||{};r&&n.setPitch(n.getPitch()+r)}}moveTouch(e,t){const n=this.map,{bearingDelta:r}=this.touchRotate.dragMove(e,t)||{};if(r&&n.setBearing(n.getBearing()+r),this.touchPitch){const{pitchDelta:r}=this.touchPitch.dragMove(e,t)||{};r&&n.setPitch(n.getPitch()+r)}}off(){const e=this.element;o.removeEventListener(e,"mousedown",this.mousedown),o.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend),o.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){o.enableDrag(),o.removeEventListener(window,"mousemove",this.mousemove),o.removeEventListener(window,"mouseup",this.mouseup),o.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),o.removeEventListener(window,"touchend",this.touchend)}}let Ui;function Vi(e,n,r){const i=new t.N(e.lng,e.lat);if(e=new t.N(e.lng,e.lat),n){const i=new t.N(e.lng-360,e.lat),a=new t.N(e.lng+360,e.lat),o=r.locationPoint(e).distSqr(n);r.locationPoint(i).distSqr(n)<o?e=i:r.locationPoint(a).distSqr(n)<o&&(e=a)}for(;Math.abs(e.lng-r.center.lng)>180;){const t=r.locationPoint(e);if(t.x>=0&&t.y>=0&&t.x<=r.width&&t.y<=r.height)break;e.lng>r.center.lng?e.lng-=360:e.lng+=360}return e.lng!==i.lng&&r.locationPoint(e).y>r.height/2-r.getHorizon()?e:i}const qi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Hi(e,t,n){const r=e.classList;for(const i in qi)r.remove("maplibregl-".concat(n,"-anchor-").concat(i));r.add("maplibregl-".concat(n,"-anchor-").concat(t))}class Wi extends t.E{constructor(e){if(super(),this._onKeyPress=e=>{const t=e.code,n=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==n&&13!==n||this.togglePopup()},this._onMapClick=e=>{const t=e.originalEvent.target,n=this._element;this._popup&&(t===n||n.contains(t))&&this.togglePopup()},this._update=e=>{var t;if(!this._map)return;const n=this._map.loaded()&&!this._map.isMoving();("terrain"===(null==e?void 0:e.type)||"render"===(null==e?void 0:e.type)&&!n)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?Vi(this._lngLat,this._flatPos,this._map.transform):null===(t=this._lngLat)||void 0===t?void 0:t.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationPoint(this._lngLat)._add(this._offset));let r="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?r="rotateZ(".concat(this._rotation,"deg)"):"map"===this._rotationAlignment&&(r="rotateZ(".concat(this._rotation-this._map.getBearing(),"deg)"));let i="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?i="rotateX(0deg)":"map"===this._pitchAlignment&&(i="rotateX(".concat(this._map.getPitch(),"deg)")),this._subpixelPositioning||e&&"moveend"!==e.type||(this._pos=this._pos.round()),o.setTransform(this._element,"".concat(qi[this._anchor]," translate(").concat(this._pos.x,"px, ").concat(this._pos.y,"px) ").concat(i," ").concat(r)),a.frameAsync(new AbortController).then(()=>{this._updateOpacity(e&&"moveend"===e.type)}).catch(()=>{})},this._onMove=e=>{if(!this._isDragging){const t=this._clickTolerance||this._map._clickTolerance;this._isDragging=e.point.dist(this._pointerdownPos)>=t}this._isDragging&&(this._pos=e.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new t.k("dragstart"))),this.fire(new t.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new t.k("dragend")),this._state="inactive"},this._addDragHandler=e=>{this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(this._pos).add(this._offset),this._pointerdownPos=e.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&"auto"!==e.pitchAlignment?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(null==e?void 0:e.opacity,null==e?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=t.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=o.create("div");const n=o.createNS("http://www.w3.org/2000/svg","svg"),r=41,i=27;n.setAttributeNS(null,"display","block"),n.setAttributeNS(null,"height","".concat(r,"px")),n.setAttributeNS(null,"width","".concat(i,"px")),n.setAttributeNS(null,"viewBox","0 0 ".concat(i," ").concat(r));const a=o.createNS("http://www.w3.org/2000/svg","g");a.setAttributeNS(null,"stroke","none"),a.setAttributeNS(null,"stroke-width","1"),a.setAttributeNS(null,"fill","none"),a.setAttributeNS(null,"fill-rule","evenodd");const s=o.createNS("http://www.w3.org/2000/svg","g");s.setAttributeNS(null,"fill-rule","nonzero");const l=o.createNS("http://www.w3.org/2000/svg","g");l.setAttributeNS(null,"transform","translate(3.0, 29.0)"),l.setAttributeNS(null,"fill","#000000");const u=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const e of u){const t=o.createNS("http://www.w3.org/2000/svg","ellipse");t.setAttributeNS(null,"opacity","0.04"),t.setAttributeNS(null,"cx","10.5"),t.setAttributeNS(null,"cy","5.80029008"),t.setAttributeNS(null,"rx",e.rx),t.setAttributeNS(null,"ry",e.ry),l.appendChild(t)}const c=o.createNS("http://www.w3.org/2000/svg","g");c.setAttributeNS(null,"fill",this._color);const d=o.createNS("http://www.w3.org/2000/svg","path");d.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),c.appendChild(d);const h=o.createNS("http://www.w3.org/2000/svg","g");h.setAttributeNS(null,"opacity","0.25"),h.setAttributeNS(null,"fill","#000000");const f=o.createNS("http://www.w3.org/2000/svg","path");f.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),h.appendChild(f);const p=o.createNS("http://www.w3.org/2000/svg","g");p.setAttributeNS(null,"transform","translate(6.0, 7.0)"),p.setAttributeNS(null,"fill","#FFFFFF");const m=o.createNS("http://www.w3.org/2000/svg","g");m.setAttributeNS(null,"transform","translate(8.0, 8.0)");const g=o.createNS("http://www.w3.org/2000/svg","circle");g.setAttributeNS(null,"fill","#000000"),g.setAttributeNS(null,"opacity","0.25"),g.setAttributeNS(null,"cx","5.5"),g.setAttributeNS(null,"cy","5.5"),g.setAttributeNS(null,"r","5.4999962");const y=o.createNS("http://www.w3.org/2000/svg","circle");y.setAttributeNS(null,"fill","#FFFFFF"),y.setAttributeNS(null,"cx","5.5"),y.setAttributeNS(null,"cy","5.5"),y.setAttributeNS(null,"r","5.4999962"),m.appendChild(g),m.appendChild(y),s.appendChild(l),s.appendChild(c),s.appendChild(h),s.appendChild(p),s.appendChild(m),n.appendChild(s),n.setAttributeNS(null,"height",r*this._scale+"px"),n.setAttributeNS(null,"width",i*this._scale+"px"),this._element.appendChild(n),this._offset=t.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",e=>{e.preventDefault()}),this._element.addEventListener("mousedown",e=>{e.preventDefault()}),Hi(this._element,this._anchor,"marker"),e&&e.className)for(const t of e.className.split(" "))this._element.classList.add(t);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),o.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,n=13.5,r=Math.abs(n)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[r,-1*(t-n+r)],"bottom-right":[-r,-1*(t-n+r)],left:[n,-1*(t-n)],right:[-n,-1*(t-n)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var n,r;if(!(null===(n=this._map)||void 0===n?void 0:n.terrain))return void(this._element.style.opacity!==this._opacity&&(this._element.style.opacity=this._opacity));if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const i=this._map,a=i.terrain.depthAtPoint(this._pos),o=i.terrain.getElevationForLngLatZoom(this._lngLat,i.transform.tileZoom);if(i.transform.lngLatToCameraDepth(this._lngLat,o)-a<.006)return void(this._element.style.opacity=this._opacity);const s=-this._offset.y/i.transform._pixelPerMeter,l=Math.sin(i.getPitch()*Math.PI/180)*s,u=i.terrain.depthAtPoint(new t.P(this._pos.x,this._pos.y-this._offset.y)),c=i.transform.lngLatToCameraDepth(this._lngLat,o+l)-u>.006;(null===(r=this._popup)||void 0===r?void 0:r.isOpen())&&c&&this._popup.remove(),this._element.style.opacity=c?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=t.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&"auto"!==e?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,t){return void 0===e&&void 0===t&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==e&&(this._opacity=e),void 0!==t&&(this._opacityWhenCovered=t),this._map&&this._updateOpacity(!0),this}}const Zi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Ki=0,Gi=!1;const Xi={maxWidth:100,unit:"metric"};function $i(e,t,n){const r=n&&n.maxWidth||100,i=e._container.clientHeight/2,a=e.unproject([0,i]),o=e.unproject([r,i]),s=a.distanceTo(o);if(n&&"imperial"===n.unit){const n=3.2808*s;n>5280?Yi(t,r,n/5280,e._getUIString("ScaleControl.Miles")):Yi(t,r,n,e._getUIString("ScaleControl.Feet"))}else n&&"nautical"===n.unit?Yi(t,r,s/1852,e._getUIString("ScaleControl.NauticalMiles")):s>=1e3?Yi(t,r,s/1e3,e._getUIString("ScaleControl.Kilometers")):Yi(t,r,s,e._getUIString("ScaleControl.Meters"))}function Yi(e,t,n,r){const i=function(e){const t=Math.pow(10,"".concat(Math.floor(e)).length-1);let n=e/t;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:n>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(n),t*n}(n);e.style.width=t*(i/n)+"px",e.innerHTML="".concat(i,"&nbsp;").concat(r)}const Ji={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Qi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function ea(e){if(e){if("number"==typeof e){const n=Math.round(Math.abs(e)/Math.SQRT2);return{center:new t.P(0,0),top:new t.P(0,e),"top-left":new t.P(n,n),"top-right":new t.P(-n,n),bottom:new t.P(0,-e),"bottom-left":new t.P(n,-n),"bottom-right":new t.P(-n,-n),left:new t.P(e,0),right:new t.P(-e,0)}}if(e instanceof t.P||Array.isArray(e)){const n=t.P.convert(e);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:t.P.convert(e.center||[0,0]),top:t.P.convert(e.top||[0,0]),"top-left":t.P.convert(e["top-left"]||[0,0]),"top-right":t.P.convert(e["top-right"]||[0,0]),bottom:t.P.convert(e.bottom||[0,0]),"bottom-left":t.P.convert(e["bottom-left"]||[0,0]),"bottom-right":t.P.convert(e["bottom-right"]||[0,0]),left:t.P.convert(e.left||[0,0]),right:t.P.convert(e.right||[0,0])}}return ea(new t.P(0,0))}const ta=n;e.AJAXError=t.bh,e.Evented=t.E,e.LngLat=t.N,e.MercatorCoordinate=t.Z,e.Point=t.P,e.addProtocol=t.bi,e.config=t.a,e.removeProtocol=t.bj,e.AttributionControl=Ci,e.BoxZoomHandler=Ur,e.CanvasSource=te,e.CooperativeGesturesHandler=_i,e.DoubleClickZoomHandler=fi,e.DragPanHandler=gi,e.DragRotateHandler=yi,e.EdgeInsets=wr,e.FullscreenControl=class extends t.E{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._onFullscreenChange=()=>{var e;let t=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null===(e=null==t?void 0:t.shadowRoot)||void 0===e?void 0:e.fullscreenElement;)t=t.shadowRoot.fullscreenElement;t===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,e&&e.container&&(e.container instanceof HTMLElement?this._container=e.container:t.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(e){return this._map=e,this._container||(this._container=this._map.getContainer()),this._controlContainer=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){o.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const e=this._fullscreenButton=o.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);o.create("span","maplibregl-ctrl-icon",e).setAttribute("aria-hidden","true"),e.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.title=e}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new t.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new t.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},e.GeoJSONSource=Y,e.GeolocateControl=class extends t.E{constructor(e){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new t.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(e),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new t.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const n=new t.N(e.coords.longitude,e.coords.latitude),r=e.coords.accuracy,i=this._map.getBearing(),a=t.e({bearing:i},this.options.fitBoundsOptions),o=Z.fromLngLat(n,r);this._map.fitBounds(o,a,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const n=new t.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(1===e.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===e.code&&Gi)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new t.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=o.create("button","maplibregl-ctrl-geolocate",this._container),o.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(!1===e){t.w("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=e,this._geolocateButton.setAttribute("aria-label",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Wi({element:this._dotElement}),this._circleElement=o.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Wi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||"ACTIVE_LOCK"!==this._watchState||e.originalEvent&&"resize"===e.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new t.k("trackuserlocationend")),this.fire(new t.k("userlocationlostfocus")))})}},this.options=t.e({},Zi,e)}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return t._(this,arguments,void 0,function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function*(){if(void 0!==Ui&&!e)return Ui;if(void 0===window.navigator.permissions)return Ui=!!window.navigator.geolocation,Ui;try{const e=yield window.navigator.permissions.query({name:"geolocation"});Ui="denied"!==e.state}catch(e){Ui=!!window.navigator.geolocation}return Ui}()})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),o.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ki=0,Gi=!1}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),n=e.coords;return t&&(n.longitude<t.getWest()||n.longitude>t.getEast()||n.latitude<t.getSouth()||n.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}}_updateCircleRadius(){const e=this._map.getBounds(),t=e.getSouthEast(),n=e.getNorthEast(),r=t.distanceTo(n),i=Math.ceil(this._accuracy/(r/this._map._container.clientHeight)*2);this._circleElement.style.width="".concat(i,"px"),this._circleElement.style.height="".concat(i,"px")}trigger(){if(!this._setup)return t.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new t.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ki--,Gi=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new t.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new t.k("trackuserlocationstart")),this.fire(new t.k("userlocationfocus"));break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error("Unexpected watchState ".concat(this._watchState))}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Ki++,Ki>1?(e={maximumAge:6e5,timeout:0},Gi=!0):(e=this.options.positionOptions,Gi=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,e)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},e.Hash=Cr,e.ImageSource=Q,e.KeyboardHandler=ui,e.LngLatBounds=Z,e.LogoControl=Pi,e.Map=class extends Si{constructor(e){t.bf.mark(t.bg.create);const n=Object.assign(Object.assign({},Bi),e);if(null!=n.minZoom&&null!=n.maxZoom&&n.minZoom>n.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=n.minPitch&&null!=n.maxPitch&&n.minPitch>n.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=n.minPitch&&n.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=n.maxPitch&&n.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Sr(n.minZoom,n.maxZoom,n.minPitch,n.maxPitch,n.renderWorldCopies),{bearingSnap:n.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new Di,this._controls=[],this._mapId=t.a4(),this._contextLost=e=>{e.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new t.k("webglcontextlost",{originalEvent:e}))},this._contextRestored=e=>{this._setupPainter(),this.resize(),this._update(),this.fire(new t.k("webglcontextrestored",{originalEvent:e}))},this._onMapScroll=e=>{if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=n.interactive,this._maxTileCacheSize=n.maxTileCacheSize,this._maxTileCacheZoomLevels=n.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=!0===n.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=!0===n.preserveDrawingBuffer,this._antialias=!0===n.antialias,this._trackResize=!0===n.trackResize,this._bearingSnap=n.bearingSnap,this._refreshExpiredTiles=!0===n.refreshExpiredTiles,this._fadeDuration=n.fadeDuration,this._crossSourceCollisions=!0===n.crossSourceCollisions,this._collectResourceTiming=!0===n.collectResourceTiming,this._locale=Object.assign(Object.assign({},Mi),n.locale),this._clickTolerance=n.clickTolerance,this._overridePixelRatio=n.pixelRatio,this._maxCanvasSize=n.maxCanvasSize,this.transformCameraUpdate=n.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===n.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=f.addThrottleControl(()=>this.isMoving()),this._requestManager=new p(n.transformRequest),"string"==typeof n.container){if(this._container=document.getElementById(n.container),!this._container)throw new Error("Container '".concat(n.container,"' not found."))}else{if(!(n.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=n.container}if(n.maxBounds&&this.setMaxBounds(n.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)).on("moveend",()=>this._update(!1)).on("zoom",()=>this._update(!0)).on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}).once("idle",()=>{this._idleTriggered=!0}),"undefined"!=typeof window){addEventListener("online",this._onWindowOnline,!1);let e=!1;const t=Er(e=>{this._trackResize&&!this._removed&&(this.resize(e),this.redraw())},50);this._resizeObserver=new ResizeObserver(n=>{e?t(n):e=!0}),this._resizeObserver.observe(this._container)}this.handlers=new ki(this,n),this._hash=n.hash&&new Cr("string"==typeof n.hash&&n.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:n.center,zoom:n.zoom,bearing:n.bearing,pitch:n.pitch}),n.bounds&&(this.resize(),this.fitBounds(n.bounds,t.e({},n.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=n.localIdeographFontFamily,this._validateStyle=n.validateStyle,n.style&&this.setStyle(n.style,{localIdeographFontFamily:n.localIdeographFontFamily}),n.attributionControl&&this.addControl(new Ci("boolean"==typeof n.attributionControl?void 0:n.attributionControl)),n.maplibreLogo&&this.addControl(new Pi,n.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update("style"===e.dataType),this.fire(new t.k("".concat(e.dataType,"data"),e))}),this.on("dataloading",e=>{this.fire(new t.k("".concat(e.dataType,"dataloading"),e))}),this.on("dataabort",e=>{this.fire(new t.k("sourcedataabort",e))})}_getMapId(){return this._mapId}addControl(e,n){if(void 0===n&&(n=e.getDefaultPosition?e.getDefaultPosition():"top-right"),!e||!e.onAdd)return this.fire(new t.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=e.onAdd(this);this._controls.push(e);const i=this._controlPositions[n];return-1!==n.indexOf("bottom")?i.insertBefore(r,i.firstChild):i.appendChild(r),this}removeControl(e){if(!e||!e.onRemove)return this.fire(new t.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(e);return n>-1&&this._controls.splice(n,1),e.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}calculateCameraOptionsFromTo(e,t,n,r){return null==r&&this.terrain&&(r=this.terrain.getElevationForLngLatZoom(n,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(e,t,n,r)}resize(e){var n;const r=this._containerDimensions(),i=r[0],a=r[1],o=this._getClampedPixelRatio(i,a);if(this._resizeCanvas(i,a,o),this.painter.resize(i,a,o),this.painter.overLimit()){const e=this.painter.context.gl;this._maxCanvasSize=[e.drawingBufferWidth,e.drawingBufferHeight];const t=this._getClampedPixelRatio(i,a);this._resizeCanvas(i,a,t),this.painter.resize(i,a,t)}this.transform.resize(i,a),null===(n=this._requestedCameraState)||void 0===n||n.resize(i,a);const s=!this._moving;return s&&(this.stop(),this.fire(new t.k("movestart",e)).fire(new t.k("move",e))),this.fire(new t.k("resize",e)),s&&this.fire(new t.k("moveend",e)),this}_getClampedPixelRatio(e,t){const{0:n,1:r}=this._maxCanvasSize,i=this.getPixelRatio(),a=e*i,o=t*i;return Math.min(a>n?n/a:1,o>r?r/o:1)*i}getPixelRatio(){var e;return null!==(e=this._overridePixelRatio)&&void 0!==e?e:devicePixelRatio}setPixelRatio(e){this._overridePixelRatio=e,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(e){return this.transform.setMaxBounds(Z.convert(e)),this._update()}setMinZoom(e){if((e=null==e?-2:e)>=-2&&e<=this.transform.maxZoom)return this.transform.minZoom=e,this._update(),this.getZoom()<e&&this.setZoom(e),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(e){if((e=null==e?22:e)>=this.transform.minZoom)return this.transform.maxZoom=e,this._update(),this.getZoom()>e&&this.setZoom(e),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(e){if((e=null==e?0:e)<0)throw new Error("minPitch must be greater than or equal to 0");if(e>=0&&e<=this.transform.maxPitch)return this.transform.minPitch=e,this._update(),this.getPitch()<e&&this.setPitch(e),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(e){if((e=null==e?60:e)>85)throw new Error("maxPitch must be less than or equal to 85");if(e>=this.transform.minPitch)return this.transform.maxPitch=e,this._update(),this.getPitch()>e&&this.setPitch(e),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this._update()}project(e){return this.transform.locationPoint(t.N.convert(e),this.style&&this.terrain)}unproject(e){return this.transform.pointLocation(t.P.convert(e),this.terrain)}isMoving(){var e;return this._moving||(null===(e=this.handlers)||void 0===e?void 0:e.isMoving())}isZooming(){var e;return this._zooming||(null===(e=this.handlers)||void 0===e?void 0:e.isZooming())}isRotating(){var e;return this._rotating||(null===(e=this.handlers)||void 0===e?void 0:e.isRotating())}_createDelegatedListener(e,t,n){if("mouseenter"===e||"mouseover"===e){let r=!1;const i=i=>{const a=t.filter(e=>this.getLayer(e)),o=0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[];o.length?r||(r=!0,n.call(this,new Mr(e,this,i.originalEvent,{features:o}))):r=!1};return{layers:t,listener:n,delegates:{mousemove:i,mouseout:()=>{r=!1}}}}if("mouseleave"===e||"mouseout"===e){let r=!1;const i=i=>{const a=t.filter(e=>this.getLayer(e));(0!==a.length?this.queryRenderedFeatures(i.point,{layers:a}):[]).length?r=!0:r&&(r=!1,n.call(this,new Mr(e,this,i.originalEvent)))},a=t=>{r&&(r=!1,n.call(this,new Mr(e,this,t.originalEvent)))};return{layers:t,listener:n,delegates:{mousemove:i,mouseout:a}}}{const r=e=>{const r=t.filter(e=>this.getLayer(e)),i=0!==r.length?this.queryRenderedFeatures(e.point,{layers:r}):[];i.length&&(e.features=i,n.call(this,e),delete e.features)};return{layers:t,listener:n,delegates:{[e]:r}}}}_saveDelegatedListener(e,t){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(t)}_removeDelegatedListener(e,t,n){if(!this._delegatedListeners||!this._delegatedListeners[e])return;const r=this._delegatedListeners[e];for(let i=0;i<r.length;i++){const e=r[i];if(e.listener===n&&e.layers.length===t.length&&e.layers.every(e=>t.includes(e))){for(const t in e.delegates)this.off(t,e.delegates[t]);return void r.splice(i,1)}}}on(e,t,n){if(void 0===n)return super.on(e,t);const r=this._createDelegatedListener(e,"string"==typeof t?[t]:t,n);this._saveDelegatedListener(e,r);for(const i in r.delegates)this.on(i,r.delegates[i]);return this}once(e,t,n){var r=this;if(void 0===n)return super.once(e,t);const i="string"==typeof t?[t]:t,a=this._createDelegatedListener(e,i,n);for(const o in a.delegates){const t=a.delegates[o];a.delegates[o]=function(){r._removeDelegatedListener(e,i,n),t(...arguments)}}this._saveDelegatedListener(e,a);for(const o in a.delegates)this.once(o,a.delegates[o]);return this}off(e,t,n){return void 0===n?super.off(e,t):(this._removeDelegatedListener(e,"string"==typeof t?[t]:t,n),this)}queryRenderedFeatures(e,n){if(!this.style)return[];let r;const i=e instanceof t.P||Array.isArray(e),a=i?e:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(i?{}:e)||{},a instanceof t.P||"number"==typeof a[0])r=[t.P.convert(a)];else{const e=t.P.convert(a[0]),n=t.P.convert(a[1]);r=[e,new t.P(n.x,e.y),n,new t.P(e.x,n.y),e]}return this.style.queryRenderedFeatures(r,n,this.transform)}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(e,n){return!1!==(n=t.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&e?(this._diffStyle(e,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(e,n))}setTransformRequest(e){return this._requestManager.setTransformRequest(e),this}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error("Missing UI string '".concat(e,"'"));return t}_updateStyle(e,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(e,t));const n=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!e)),e?(this.style=new ht(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e,t,n):this.style.loadJSON(e,t,n),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new ht(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(e,n){if("string"==typeof e){const r=this._requestManager.transformRequest(e,"Style");t.h(r,new AbortController).then(e=>{this._updateDiff(e.data,n)}).catch(e=>{e&&this.fire(new t.j(e))})}else"object"==typeof e&&this._updateDiff(e,n)}_updateDiff(e,n){try{this.style.setState(e,n)&&this._update(!0)}catch(r){t.w("Unable to perform style diff: ".concat(r.message||r.error||r,".  Rebuilding the style from scratch.")),this._updateStyle(e,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():t.w("There is no style added to the map.")}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){const n=this.style&&this.style.sourceCaches[e];if(void 0!==n)return n.loaded();this.fire(new t.j(new Error("There is no source with ID '".concat(e,"'"))))}setTerrain(e){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),e){const n=this.style.sourceCaches[e.source];if(!n)throw new Error("cannot load terrain, because there exists no source with ID: ".concat(e.source));null===this.terrain&&n.reload();for(const r in this.style._layers){const n=this.style._layers[r];"hillshade"===n.type&&n.source===e.source&&t.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ai(this.painter,n,e),this.painter.renderToTexture=new Fi(this.painter,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=t=>{"style"===t.dataType?this.terrain.sourceCache.freeRtt():"source"===t.dataType&&t.tile&&(t.sourceId!==e.source||this._elevationFreeze||(this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(t.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.minElevationForCurrentTile=0,this.transform.elevation=0;return this.fire(new t.k("terrain",{terrain:e})),this}getTerrain(){var e,t;return null!==(t=null===(e=this.terrain)||void 0===e?void 0:e.options)&&void 0!==t?t:null}areTilesLoaded(){const e=this.style&&this.style.sourceCaches;for(const t in e){const n=e[t]._tiles;for(const e in n){const t=n[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}removeSource(e){return this.style.removeSource(e),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(e,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{pixelRatio:i=1,sdf:o=!1,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:d}=r;if(this._lazyInitEmptyStyle(),!(n instanceof HTMLImageElement||t.b(n))){if(void 0===n.width||void 0===n.height)return this.fire(new t.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:r,height:a,data:h}=n,f=n;return this.style.addImage(e,{data:new t.R({width:r,height:a},new Uint8Array(h)),pixelRatio:i,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:d,sdf:o,version:0,userImage:f}),f.onAdd&&f.onAdd(this,e),this}}{const{width:r,height:h,data:f}=a.getImageData(n);this.style.addImage(e,{data:new t.R({width:r,height:h},f),pixelRatio:i,stretchX:s,stretchY:l,content:u,textFitWidth:c,textFitHeight:d,sdf:o,version:0})}}updateImage(e,n){const r=this.style.getImage(e);if(!r)return this.fire(new t.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=n instanceof HTMLImageElement||t.b(n)?a.getImageData(n):n,{width:o,height:s,data:l}=i;if(void 0===o||void 0===s)return this.fire(new t.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(o!==r.data.width||s!==r.data.height)return this.fire(new t.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const u=!(n instanceof HTMLImageElement||t.b(n));return r.data.replace(l,u),this.style.updateImage(e,r),this}getImage(e){return this.style.getImage(e)}hasImage(e){return e?!!this.style.getImage(e):(this.fire(new t.j(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(e){return f.getImage(this._requestManager.transformRequest(e,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(e,t,n){return this.style.setLayerZoomRange(e,t,n),this._update(!0)}setFilter(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.style.setFilter(e,t,n),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setPaintProperty(e,t,n,r),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.style.setLayoutProperty(e,t,n,r),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setGlyphs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setGlyphs(e,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._lazyInitEmptyStyle(),this.style.addSprite(e,t,n,e=>{e||this._update(!0)}),this}removeSprite(e){return this._lazyInitEmptyStyle(),this.style.removeSprite(e),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setSprite(e,t,e=>{e||this._update(!0)}),this}setLight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setSky(e){return this._lazyInitEmptyStyle(),this.style.setSky(e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let e=0,t=0;return this._container&&(e=this._container.clientWidth||400,t=this._container.clientHeight||300),[e,t]}_setupContainer(){const e=this._container;e.classList.add("maplibregl-map");const t=this._canvasContainer=o.create("div","maplibregl-canvas-container",e);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=o.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const n=this._containerDimensions(),r=this._getClampedPixelRatio(n[0],n[1]);this._resizeCanvas(n[0],n[1],r);const i=this._controlContainer=o.create("div","maplibregl-control-container",e),a=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(e=>{a[e]=o.create("div","maplibregl-ctrl-".concat(e," "),i)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(e,t,n){this._canvas.width=Math.floor(n*e),this._canvas.height=Math.floor(n*t),this._canvas.style.width="".concat(e,"px"),this._canvas.style.height="".concat(t,"px")}_setupPainter(){const e={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",n=>{t={requestedAttributes:e},n&&(t.statusMessage=n.statusMessage,t.type=n.type)},{once:!0});const n=this._canvas.getContext("webgl2",e)||this._canvas.getContext("webgl",e);if(!n){const e="Failed to initialize WebGL";throw t?(t.message=e,new Error(JSON.stringify(t))):new Error(e)}this.painter=new _r(n,this.transform),s.testSupport(n)}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_render(e){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(e),this._removed)return;let r=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const e=this.transform.zoom,i=a.now();this.style.zoomHistory.update(e,i);const o=new t.z(e,{now:i,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),s=o.crossFadingFactor();1===s&&s===this._crossFadingFactor||(r=!0,this._crossFadingFactor=s),this.style.update(o)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.minElevationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.minElevationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new t.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,t.bf.mark(t.bg.load),this.fire(new t.k("load"))),this.style&&(this.style.hasTransitions()||r)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const i=this._sourcesDirty||this._styleDirty||this._placementDirty;return i||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new t.k("idle")),!this._loaded||this._fullyLoaded||i||(this._fullyLoaded=!0,t.bf.mark(t.bg.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var e;this._hash&&this._hash.remove();for(const t of this._controls)t.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),"undefined"!=typeof window&&removeEventListener("online",this._onWindowOnline,!1),f.removeThrottleControl(this._imageQueueHandle),null===(e=this._resizeObserver)||void 0===e||e.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");(null==n?void 0:n.loseContext)&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),o.remove(this._canvasContainer),o.remove(this._controlContainer),this._container.classList.remove("maplibregl-map"),t.bf.clearMetrics(),this._removed=!0,this.fire(new t.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,a.frameAsync(this._frameRequest).then(e=>{t.bf.frame(e),this._frameRequest=null,this._render(e)}).catch(()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get version(){return ji}getCameraTargetElevation(){return this.transform.elevation}},e.MapMouseEvent=Mr,e.MapTouchEvent=jr,e.MapWheelEvent=Br,e.Marker=Wi,e.NavigationControl=class{constructor(e){this._updateZoomButtons=()=>{const e=this._map.getZoom(),t=e===this._map.getMaxZoom(),n=e===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())},this._rotateCompassArrow=()=>{const e=this.options.visualizePitch?"scale(".concat(1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5),") rotateX(").concat(this._map.transform.pitch,"deg) rotateZ(").concat(this._map.transform.angle*(180/Math.PI),"deg)"):"rotate(".concat(this._map.transform.angle*(180/Math.PI),"deg)");this._compassIcon.style.transform=e},this._setButtonTitle=(e,t)=>{const n=this._map._getUIString("NavigationControl.".concat(t));e.title=n,e.setAttribute("aria-label",n)},this.options=t.e({},Li,e),this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),o.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),o.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=o.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ni(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){o.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(e,t){const n=o.create("button",e,this._container);return n.type="button",n.addEventListener("click",t),n}},e.Popup=class extends t.E{constructor(e){super(),this.remove=()=>(this._content&&o.remove(this._content),this._container&&(o.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new t.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var t;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=o.create("div","maplibregl-popup",this._map.getContainer()),this._tip=o.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const e of this.options.className.split(" "))this._container.classList.add(e);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?Vi(this._lngLat,this._flatPos,this._map.transform):null===(t=this._lngLat)||void 0===t?void 0:t.wrap(),this._trackPointer&&!e)return;const n=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationPoint(this._lngLat));let r=this.options.anchor;const i=ea(this.options.offset);if(!r){const e=this._container.offsetWidth,t=this._container.offsetHeight;let a;a=n.y+i.bottom.y<t?["top"]:n.y>this._map.transform.height-t?["bottom"]:[],n.x<e/2?a.push("left"):n.x>this._map.transform.width-e/2&&a.push("right"),r=0===a.length?"bottom":a.join("-")}let a=n.add(i[r]);this.options.subpixelPositioning||(a=a.round()),o.setTransform(this._container,"".concat(qi[r]," translate(").concat(a.x,"px,").concat(a.y,"px)")),Hi(this._container,r,"popup")},this._onClose=()=>{this.remove()},this.options=t.e(Object.create(Ji),e)}addTo(e){return this._map&&this.remove(),this._map=e,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new t.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=t.N.convert(e),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(e){return this.setDOMContent(document.createTextNode(e))}setHTML(e){const t=document.createDocumentFragment(),n=document.createElement("body");let r;for(n.innerHTML=e;r=n.firstChild,r;)t.appendChild(r);return this.setDOMContent(t)}getMaxWidth(){var e;return null===(e=this._container)||void 0===e?void 0:e.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=o.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(e),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(e){return this._container&&this._container.classList.add(e),this}removeClassName(e){return this._container&&this._container.classList.remove(e),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){if(this._container)return this._container.classList.toggle(e)}setSubpixelPositioning(e){this.options.subpixelPositioning=e}_createCloseButton(){this.options.closeButton&&(this._closeButton=o.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(Qi);e&&e.focus()}},e.RasterDEMTileSource=$,e.RasterTileSource=X,e.ScaleControl=class{constructor(e){this._onMove=()=>{$i(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,$i(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Xi),e)}getDefaultPosition(){return"bottom-left"}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-scale",e.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){o.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},e.ScrollZoomHandler=hi,e.Style=ht,e.TerrainControl=class{constructor(e){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=e}onAdd(e){return this._map=e,this._container=o.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=o.create("button","maplibregl-ctrl-terrain",this._container),o.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){o.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},e.TwoFingersTouchPitchHandler=si,e.TwoFingersTouchRotateHandler=ai,e.TwoFingersTouchZoomHandler=ri,e.TwoFingersTouchZoomRotateHandler=vi,e.VectorTileSource=G,e.VideoSource=ee,e.addSourceType=(e,n)=>t._(void 0,void 0,void 0,function*(){if(re(e))throw new Error('A source type called "'.concat(e,'" already exists.'));((e,t)=>{ne[e]=t})(e,n)}),e.clearPrewarmedResources=function(){const e=B;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(F),B=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},e.getMaxParallelImageRequests=function(){return t.a.MAX_PARALLEL_IMAGE_REQUESTS},e.getRTLTextPluginStatus=function(){return se().getRTLTextPluginStatus()},e.getVersion=function(){return ta},e.getWorkerCount=function(){return M.workerCount},e.getWorkerUrl=function(){return t.a.WORKER_URL},e.importScriptInWorkers=function(e){return U().broadcast("IS",e)},e.prewarm=function(){L().acquire(F)},e.setMaxParallelImageRequests=function(e){t.a.MAX_PARALLEL_IMAGE_REQUESTS=e},e.setRTLTextPlugin=function(e,t){return se().setRTLTextPlugin(e,t)},e.setWorkerCount=function(e){M.workerCount=e},e.setWorkerUrl=function(e){t.a.WORKER_URL=e}}),e}()},153(e,t,n){"use strict";var r=n(43),i=Symbol.for("react.element"),a=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,a={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:a,_owner:s.current}}t.Fragment=a,t.jsx=u,t.jsxs=u},159(e,t,n){e.exports=function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,o,s,l,u,c=[],d=0,h=e.length,f=h,p="string"!==r.getTypeOf(e);d<e.length;)f=h-d,i=p?(t=e[d++],n=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),o=t>>2,s=(3&t)<<4|n>>4,l=1<f?(15&n)<<2|i>>6:64,u=2<f?63&i:64,c.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(u));return c.join("")},n.decode=function(e){var t,n,r,o,s,l,u=0,c=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)t=a.indexOf(e.charAt(u++))<<2|(o=a.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(s=a.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(l=a.indexOf(e.charAt(u++))),h[c++]=t,64!==s&&(h[c++]=n),64!==l&&(h[c++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";var r=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n,r){var a=i,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}(0|t,e,e.length,0):function(e,t,n,r){var a=i,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var r=null;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){"use strict";function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,o,c){var d,h,f=e.file,p=e.compression,m=c!==s.utf8encode,g=a.transformTo("string",c(f.name)),y=a.transformTo("string",s.utf8encode(f.name)),v=f.comment,_=a.transformTo("string",c(v)),b=a.transformTo("string",s.utf8encode(v)),x=y.length!==f.name.length,w=b.length!==v.length,k="",S="",E="",C=f.dir,P=f.date,D={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(D.crc32=e.crc32,D.compressedSize=e.compressedSize,D.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!x&&!w||(I|=2048);var T=0,A=0;C&&(T|=16),"UNIX"===o?(A=798,T|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,C)):(A=20,T|=function(e){return 63&(e||0)}(f.dosPermissions)),d=P.getUTCHours(),d<<=6,d|=P.getUTCMinutes(),d<<=5,d|=P.getUTCSeconds()/2,h=P.getUTCFullYear()-1980,h<<=4,h|=P.getUTCMonth()+1,h<<=5,h|=P.getUTCDate(),x&&(S=r(1,1)+r(l(g),4)+y,k+="up"+r(S.length,2)+S),w&&(E=r(1,1)+r(l(_),4)+b,k+="uc"+r(E.length,2)+E);var z="";return z+="\n\0",z+=r(I,2),z+=p.magic,z+=r(d,2),z+=r(h,2),z+=r(D.crc32,4),z+=r(D.compressedSize,4),z+=r(D.uncompressedSize,4),z+=r(g.length,2),z+=r(k.length,2),{fileRecord:u.LOCAL_FILE_HEADER+z+g+k,dirRecord:u.CENTRAL_FILE_HEADER+r(A,2)+z+r(_.length,2)+"\0\0\0\0"+r(T,4)+r(i,4)+g+k+_}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),u=e("../signature");function c(e,t,n,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(c,o),c.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=i(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:function(e){return u.DATA_DESCRIPTOR+r(e.crc32,4)+r(e.compressedSize,4)+r(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var s=a.transformTo("string",o(i));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)}),a.entriesCount=o}catch(e){a.error(e)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";var r=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function u(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(u(r[a]));return i.Promise.all(n)}).then(function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],l=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(u).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function r(e,t,n){var r,i=a.getTypeOf(t),s=a.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=p(e))&&g.call(this,r,!0);var d="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!d),(t instanceof u&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string");var y=null;y=t instanceof u||t instanceof o?t:h.isNode&&h.isStream(t)?new f(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var v=new c(e,y,s);this.files[e]=v}var i=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),u=e("./compressedObject"),c=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(y(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(e){(t=new o("error")).error(e)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var r=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";var r=e("./GenericWorker"),i=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){"use strict";var r=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),u=null;if(s.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t){return new l.Promise(function(n,i){var a=[],s=e._internalType,l=e._outputType,u=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],i(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),u);n(e)}catch(e){i(e)}a=[]}).resume()})}function d(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new a("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(e){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(e){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";for(var r=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,r,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,a,o=e.length,l=new Array(2*o);for(t=n=0;t<o;)if((i=e[t++])<128)l[n++]=i;else if(4<(a=s[i]))l[n++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<o;)i=i<<6|63&e[t++],a--;1<a?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,o),u.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;o!==t.length&&(i.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=u,r.inherits(c,o),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";var r=e("./support"),i=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(t,r){n.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return i.append(t),i.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=c;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},h.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,s,u){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var c=n.getTypeOf(t);return c?("arraybuffer"===c?t=n.transformTo("uint8array",t):"string"===c&&(u?t=i.decode(t):a&&!0!==s&&(t=function(e){return l(e,r.uint8array?new Uint8Array(e.length):new Array(e.length))}(t))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";var r=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),u=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)r.prototype[u[d]]=c;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){"use strict";var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,o=new i(c),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,n=function(){l.port2.postMessage(0)}}var u=[];function c(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}t.exports=function(e){1!==u.push(e)||r||n()}}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){"use strict";var r=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r(function(){var r;try{r=t(n)}catch(r){return a.reject(e,r)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}var o=p(function(){t(i,r)});"error"===o.status&&r(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}(t.exports=u).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){a.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(h,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return a.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,l=-1,u=new this(i);++l<n;)c(e[l],l);return u;function c(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==n||r||(r=!0,a.resolve(u,o))},function(e){r||(r=!0,a.reject(u,e))})}},u.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o,s=-1,l=new this(i);++s<n;)o=e[s],t.resolve(o).then(function(e){r||(r=!0,a.resolve(l,e))},function(e){r||(r=!0,a.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,n){"use strict";var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){"use strict";var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,u=0,c=-1,d=0,h=8;function f(e){if(!(this instanceof f))return new f(e);this.options=i.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==u)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=r.deflateSetDictionary(this.strm,p))!==u)throw new Error(o[n]);this._dict_set=!0}}function p(e,t){var n=new f(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}f.prototype.push=function(e,t){var n,o,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=r.deflate(s,o))&&n!==u)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===u):2!==o||(this.onEnd(u),!(s.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===u&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=f,n.deflate=p,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){"use strict";var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),u=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,u,d,h,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(n=r.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===g&&(n=o.Z_OK,g=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(f.output,f.next_out),u=f.next_out-l,d=a.buf2string(f.output,l),f.next_out=u,f.avail_out=p-u,u&&i.arraySet(f.output,f.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){"use strict";var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){"use strict";var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,u=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)u[r++]=i;else if(4<(a=o[i]))u[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&n<s;)i=i<<6|63&e[n++],a--;1<a?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){"use strict";t.exports=function(e,t,n,r){for(var i=65535&e,a=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;a=a+(i=i+t[r++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16}},{}],44:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){"use strict";var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){"use strict";var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),u=0,c=4,d=0,h=-2,f=-1,p=4,m=2,g=8,y=9,v=286,_=30,b=19,x=2*v+1,w=15,k=3,S=258,E=S+k+1,C=42,P=113,D=1,I=2,T=3,A=4;function z(e,t){return e.msg=l[t],t}function O(e){return(e<<1)-(4<e?9:0)}function F(e){for(var t=e.length;0<=--t;)e[t]=0}function M(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function j(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,M(e.strm)}function B(e,t){e.pending_buf[e.pending++]=t}function R(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function L(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-E?e.strstart-(e.w_size-E):0,u=e.window,c=e.w_mask,d=e.prev,h=e.strstart+S,f=u[a+o-1],p=u[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+o]===p&&u[n+o-1]===f&&u[n]===u[a]&&u[++n]===u[a+1]){a+=2,n++;do{}while(u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&a<h);if(r=S-(h-a),a=h-S,o<r){if(e.match_start=t,s<=(o=r))break;f=u[a+o-1],p=u[a+o]}}}while((t=d[t&c])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function N(e){var t,n,r,a,l,u,c,d,h,f,p=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-E)){for(i.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=n=e.hash_size;r=e.head[--t],e.head[t]=p<=r?r-p:0,--n;);for(t=n=p;r=e.prev[--t],e.prev[t]=p<=r?r-p:0,--n;);a+=p}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,d=e.strstart+e.lookahead,f=void 0,(h=a)<(f=u.avail_in)&&(f=h),n=0===f?0:(u.avail_in-=f,i.arraySet(c,u.input,u.next_in,f,d),1===u.state.wrap?u.adler=o(u.adler,c,f,d):2===u.state.wrap&&(u.adler=s(u.adler,c,f,d)),u.next_in+=f,u.total_in+=f,f),e.lookahead+=n,e.lookahead+e.insert>=k)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+k-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<E&&0!==e.strm.avail_in)}function U(e,t){for(var n,r;;){if(e.lookahead<E){if(N(e),e.lookahead<E&&t===u)return D;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-E&&(e.match_length=L(e,n)),e.match_length>=k)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(j(e,!1),0===e.strm.avail_out))return D}return e.insert=e.strstart<k-1?e.strstart:k-1,t===c?(j(e,!0),0===e.strm.avail_out?T:A):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?D:I}function V(e,t){for(var n,r,i;;){if(e.lookahead<E){if(N(e),e.lookahead<E&&t===u)return D;if(0===e.lookahead)break}if(n=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-E&&(e.match_length=L(e,n),e.match_length<=5&&(1===e.strategy||e.match_length===k&&4096<e.strstart-e.match_start)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-k,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=k-1,e.strstart++,r&&(j(e,!1),0===e.strm.avail_out))return D}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&j(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return D}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,t===c?(j(e,!0),0===e.strm.avail_out?T:A):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?D:I}function q(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*x),this.dyn_dtree=new i.Buf16(2*(2*_+1)),this.bl_tree=new i.Buf16(2*(2*b+1)),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(w+1),this.heap=new i.Buf16(2*v+1),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*v+1),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:P,e.adler=2===t.wrap?0:1,t.last_flush=u,a._tr_init(t),d):z(e,h)}function Z(e){var t=W(e);return t===d&&function(e){e.window_size=2*e.w_size,F(e.head),e.max_lazy_match=r[e.level].max_lazy,e.good_match=r[e.level].good_length,e.nice_match=r[e.level].nice_length,e.max_chain_length=r[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=k-1,e.match_available=0,e.ins_h=0}(e.state),t}function K(e,t,n,r,a,o){if(!e)return h;var s=1;if(t===f&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||y<a||n!==g||r<8||15<r||t<0||9<t||o<0||p<o)return z(e,h);8===r&&(r=9);var l=new H;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+k-1)/k),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,Z(e)}r=[new q(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(N(e),0===e.lookahead&&t===u)return D;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,j(e,!1),0===e.strm.avail_out))return D;if(e.strstart-e.block_start>=e.w_size-E&&(j(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===c?(j(e,!0),0===e.strm.avail_out?T:A):(e.strstart>e.block_start&&(j(e,!1),e.strm.avail_out),D)}),new q(4,4,8,4,U),new q(4,5,16,8,U),new q(4,6,32,32,U),new q(4,4,16,16,V),new q(8,16,32,32,V),new q(8,16,128,128,V),new q(8,32,128,256,V),new q(32,128,258,1024,V),new q(32,258,258,4096,V)],n.deflateInit=function(e,t){return K(e,t,g,15,8,0)},n.deflateInit2=K,n.deflateReset=Z,n.deflateResetKeep=W,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,d):h},n.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||5<t||t<0)return e?z(e,h):h;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&t!==c)return z(e,0===e.avail_out?-5:h);if(i.strm=e,n=i.last_flush,i.last_flush=t,i.status===C)if(2===i.wrap)e.adler=0,B(i,31),B(i,139),B(i,8),i.gzhead?(B(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),B(i,255&i.gzhead.time),B(i,i.gzhead.time>>8&255),B(i,i.gzhead.time>>16&255),B(i,i.gzhead.time>>24&255),B(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),B(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(B(i,255&i.gzhead.extra.length),B(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(B(i,0),B(i,0),B(i,0),B(i,0),B(i,0),B(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),B(i,3),i.status=P);else{var f=g+(i.w_bits-8<<4)<<8;f|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(f|=32),f+=31-f%31,i.status=P,R(i,f),0!==i.strstart&&(R(i,e.adler>>>16),R(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),M(e),o=i.pending,i.pending!==i.pending_buf_size));)B(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),M(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,B(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),M(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,B(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&M(e),i.pending+2<=i.pending_buf_size&&(B(i,255&e.adler),B(i,e.adler>>8&255),e.adler=0,i.status=P)):i.status=P),0!==i.pending){if(M(e),0===e.avail_out)return i.last_flush=-1,d}else if(0===e.avail_in&&O(t)<=O(n)&&t!==c)return z(e,-5);if(666===i.status&&0!==e.avail_in)return z(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==u&&666!==i.status){var p=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(N(e),0===e.lookahead)){if(t===u)return D;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(j(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===c?(j(e,!0),0===e.strm.avail_out?T:A):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?D:I}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=S){if(N(e),e.lookahead<=S&&t===u)return D;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+S;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=S-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(n=a._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(j(e,!1),0===e.strm.avail_out))return D}return e.insert=0,t===c?(j(e,!0),0===e.strm.avail_out?T:A):e.last_lit&&(j(e,!1),0===e.strm.avail_out)?D:I}(i,t):r[i.level].func(i,t);if(p!==T&&p!==A||(i.status=666),p===D||p===T)return 0===e.avail_out&&(i.last_flush=-1),d;if(p===I&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t&&(F(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),M(e),0===e.avail_out))return i.last_flush=-1,d}return t!==c?d:i.wrap<=0?1:(2===i.wrap?(B(i,255&e.adler),B(i,e.adler>>8&255),B(i,e.adler>>16&255),B(i,e.adler>>24&255),B(i,255&e.total_in),B(i,e.total_in>>8&255),B(i,e.total_in>>16&255),B(i,e.total_in>>24&255)):(R(i,e.adler>>>16),R(i,65535&e.adler)),M(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?d:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==P&&666!==t?z(e,h):(e.state=null,t===P?z(e,-3):d):h},n.deflateSetDictionary=function(e,t){var n,r,a,s,l,u,c,f,p=t.length;if(!e||!e.state)return h;if(2===(s=(n=e.state).wrap)||1===s&&n.status!==C||n.lookahead)return h;for(1===s&&(e.adler=o(e.adler,t,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(F(n.head),n.strstart=0,n.block_start=0,n.insert=0),f=new i.Buf8(n.w_size),i.arraySet(f,t,p-n.w_size,n.w_size,0),t=f,p=n.w_size),l=e.avail_in,u=e.next_in,c=e.input,e.avail_in=p,e.next_in=0,e.input=t,N(n);n.lookahead>=k;){for(r=n.strstart,a=n.lookahead-(k-1);n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+k-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=k-1,N(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=k-1,n.match_available=0,e.next_in=u,e.input=c,e.avail_in=l,n.wrap=s,d},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){"use strict";t.exports=function(e,t){var n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,S,E,C;n=e.state,r=e.next_in,E=e.input,i=r+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=n.dmax,u=n.wsize,c=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),_=m[f&y];t:for(;;){if(f>>>=b=_>>>24,p-=b,0===(b=_>>>16&255))C[a++]=65535&_;else{if(!(16&b)){if(0==(64&b)){_=m[(65535&_)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&_,(b&=15)&&(p<b&&(f+=E[r++]<<p,p+=8),x+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),_=g[f&v];n:for(;;){if(f>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(0==(64&b)){_=g[(65535&_)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&_,p<(b&=15)&&(f+=E[r++]<<p,(p+=8)<b&&(f+=E[r++]<<p,p+=8)),l<(w+=f&(1<<b)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,p-=b,(b=a-o)<w){if(c<(b=w-b)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=h,(k=0)===d){if(k+=u-b,b<x){for(x-=b;C[a++]=h[k++],--b;);k=a-w,S=C}}else if(d<b){if(k+=u+d-b,(b-=d)<x){for(x-=b;C[a++]=h[k++],--b;);if(k=0,d<x){for(x-=b=d;C[a++]=h[k++],--b;);k=a-w,S=C}}}else if(k+=d-b,b<x){for(x-=b;C[a++]=h[k++],--b;);k=a-w,S=C}for(;2<x;)C[a++]=S[k++],C[a++]=S[k++],C[a++]=S[k++],x-=3;x&&(C[a++]=S[k++],1<x&&(C[a++]=S[k++]))}else{for(k=a-w;C[a++]=C[k++],C[a++]=C[k++],C[a++]=C[k++],2<(x-=3););x&&(C[a++]=C[k++],1<x&&(C[a++]=C[k++]))}break}}break}}while(r<i&&a<s);r-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){"use strict";var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=1,u=2,c=0,d=-2,h=1,f=852,p=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(f),t.distcode=t.distdyn=new r.Buf32(p),t.sane=1,t.back=-1,c):d}function v(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,y(e)):d}function _(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?d:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,v(e))):d}function b(e,t){var n,r;return e?(r=new g,(e.state=r).window=null,(n=_(e,t))!==c&&(e.state=null),n):d}var x,w,k=!0;function S(e){if(k){var t;for(x=new r.Buf32(512),w=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,x,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,w,0,e.work,{bits:5}),k=!1}e.lencode=x,e.lenbits=9,e.distcode=w,e.distbits=5}function E(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(a=o.wsize-o.wnext)&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=v,n.inflateReset2=_,n.inflateResetKeep=y,n.inflateInit=function(e){return b(e,15)},n.inflateInit2=b,n.inflate=function(e,t){var n,f,p,g,y,v,_,b,x,w,k,C,P,D,I,T,A,z,O,F,M,j,B,R,L=0,N=new r.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;12===(n=e.state).mode&&(n.mode=13),y=e.next_out,p=e.output,_=e.avail_out,g=e.next_in,f=e.input,v=e.avail_in,b=n.hold,x=n.bits,w=v,k=_,j=c;e:for(;;)switch(n.mode){case h:if(0===n.wrap){n.mode=13;break}for(;x<16;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(2&n.wrap&&35615===b){N[n.check=0]=255&b,N[1]=b>>>8&255,n.check=a(n.check,N,2,0),x=b=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&b)<<8)+(b>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&b)){e.msg="unknown compression method",n.mode=30;break}if(x-=4,M=8+(15&(b>>>=4)),0===n.wbits)n.wbits=M;else if(M>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<M,e.adler=n.check=1,n.mode=512&b?10:12,x=b=0;break;case 2:for(;x<16;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(n.flags=b,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=b>>8&1),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=a(n.check,N,2,0)),x=b=0,n.mode=3;case 3:for(;x<32;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.head&&(n.head.time=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,N[2]=b>>>16&255,N[3]=b>>>24&255,n.check=a(n.check,N,4,0)),x=b=0,n.mode=4;case 4:for(;x<16;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.head&&(n.head.xflags=255&b,n.head.os=b>>8),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=a(n.check,N,2,0)),x=b=0,n.mode=5;case 5:if(1024&n.flags){for(;x<16;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.length=b,n.head&&(n.head.extra_len=b),512&n.flags&&(N[0]=255&b,N[1]=b>>>8&255,n.check=a(n.check,N,2,0)),x=b=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(v<(C=n.length)&&(C=v),C&&(n.head&&(M=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,f,g,C,M)),512&n.flags&&(n.check=a(n.check,f,C,g)),v-=C,g+=C,n.length-=C),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===v)break e;for(C=0;M=f[g+C++],n.head&&M&&n.length<65536&&(n.head.name+=String.fromCharCode(M)),M&&C<v;);if(512&n.flags&&(n.check=a(n.check,f,C,g)),v-=C,g+=C,M)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===v)break e;for(C=0;M=f[g+C++],n.head&&M&&n.length<65536&&(n.head.comment+=String.fromCharCode(M)),M&&C<v;);if(512&n.flags&&(n.check=a(n.check,f,C,g)),v-=C,g+=C,M)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;x<16;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(b!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}x=b=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;x<32;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}e.adler=n.check=m(b),x=b=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=y,e.avail_out=_,e.next_in=g,e.avail_in=v,n.hold=b,n.bits=x,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){b>>>=7&x,x-=7&x,n.mode=27;break}for(;x<3;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}switch(n.last=1&b,x-=1,3&(b>>>=1)){case 0:n.mode=14;break;case 1:if(S(n),n.mode=20,6!==t)break;b>>>=2,x-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}b>>>=2,x-=2;break;case 14:for(b>>>=7&x,x-=7&x;x<32;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if((65535&b)!=(b>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&b,x=b=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(C=n.length){if(v<C&&(C=v),_<C&&(C=_),0===C)break e;r.arraySet(p,f,g,C,y),v-=C,g+=C,_-=C,y+=C,n.length-=C;break}n.mode=12;break;case 17:for(;x<14;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(n.nlen=257+(31&b),b>>>=5,x-=5,n.ndist=1+(31&b),b>>>=5,x-=5,n.ncode=4+(15&b),b>>>=4,x-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;x<3;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.lens[U[n.have++]]=7&b,b>>>=3,x-=3}for(;n.have<19;)n.lens[U[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,B={bits:n.lenbits},j=s(0,n.lens,0,19,n.lencode,0,n.work,B),n.lenbits=B.bits,j){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;T=(L=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,A=65535&L,!((I=L>>>24)<=x);){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(A<16)b>>>=I,x-=I,n.lens[n.have++]=A;else{if(16===A){for(R=I+2;x<R;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(b>>>=I,x-=I,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}M=n.lens[n.have-1],C=3+(3&b),b>>>=2,x-=2}else if(17===A){for(R=I+3;x<R;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}x-=I,M=0,C=3+(7&(b>>>=I)),b>>>=3,x-=3}else{for(R=I+7;x<R;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}x-=I,M=0,C=11+(127&(b>>>=I)),b>>>=7,x-=7}if(n.have+C>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;C--;)n.lens[n.have++]=M}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,B={bits:n.lenbits},j=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,B),n.lenbits=B.bits,j){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,B={bits:n.distbits},j=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,B),n.distbits=B.bits,j){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=v&&258<=_){e.next_out=y,e.avail_out=_,e.next_in=g,e.avail_in=v,n.hold=b,n.bits=x,o(e,k),y=e.next_out,p=e.output,_=e.avail_out,g=e.next_in,f=e.input,v=e.avail_in,b=n.hold,x=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;T=(L=n.lencode[b&(1<<n.lenbits)-1])>>>16&255,A=65535&L,!((I=L>>>24)<=x);){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(T&&0==(240&T)){for(z=I,O=T,F=A;T=(L=n.lencode[F+((b&(1<<z+O)-1)>>z)])>>>16&255,A=65535&L,!(z+(I=L>>>24)<=x);){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}b>>>=z,x-=z,n.back+=z}if(b>>>=I,x-=I,n.back+=I,n.length=A,0===T){n.mode=26;break}if(32&T){n.back=-1,n.mode=12;break}if(64&T){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&T,n.mode=22;case 22:if(n.extra){for(R=n.extra;x<R;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.length+=b&(1<<n.extra)-1,b>>>=n.extra,x-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;T=(L=n.distcode[b&(1<<n.distbits)-1])>>>16&255,A=65535&L,!((I=L>>>24)<=x);){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(0==(240&T)){for(z=I,O=T,F=A;T=(L=n.distcode[F+((b&(1<<z+O)-1)>>z)])>>>16&255,A=65535&L,!(z+(I=L>>>24)<=x);){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}b>>>=z,x-=z,n.back+=z}if(b>>>=I,x-=I,n.back+=I,64&T){e.msg="invalid distance code",n.mode=30;break}n.offset=A,n.extra=15&T,n.mode=24;case 24:if(n.extra){for(R=n.extra;x<R;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}n.offset+=b&(1<<n.extra)-1,b>>>=n.extra,x-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===_)break e;if(C=k-_,n.offset>C){if((C=n.offset-C)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}P=C>n.wnext?(C-=n.wnext,n.wsize-C):n.wnext-C,C>n.length&&(C=n.length),D=n.window}else D=p,P=y-n.offset,C=n.length;for(_<C&&(C=_),_-=C,n.length-=C;p[y++]=D[P++],--C;);0===n.length&&(n.mode=21);break;case 26:if(0===_)break e;p[y++]=n.length,_--,n.mode=21;break;case 27:if(n.wrap){for(;x<32;){if(0===v)break e;v--,b|=f[g++]<<x,x+=8}if(k-=_,e.total_out+=k,n.total+=k,k&&(e.adler=n.check=n.flags?a(n.check,p,k,y-k):i(n.check,p,k,y-k)),k=_,(n.flags?b:m(b))!==n.check){e.msg="incorrect data check",n.mode=30;break}x=b=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;x<32;){if(0===v)break e;v--,b+=f[g++]<<x,x+=8}if(b!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}x=b=0}n.mode=29;case 29:j=1;break e;case 30:j=-3;break e;case 31:return-4;default:return d}return e.next_out=y,e.avail_out=_,e.next_in=g,e.avail_in=v,n.hold=b,n.bits=x,(n.wsize||k!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&E(e,e.output,e.next_out,k-e.avail_out)?(n.mode=31,-4):(w-=e.avail_in,k-=e.avail_out,e.total_in+=w,e.total_out+=k,n.total+=k,n.wrap&&k&&(e.adler=n.check=n.flags?a(n.check,p,k,e.next_out-k):i(n.check,p,k,e.next_out-k)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==w&&0===k||4===t)&&j===c&&(j=-5),j)},n.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,c},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?d:((n.head=t).done=!1,c):d},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?d:11===n.mode&&i(1,t,r,0)!==n.check?-3:E(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,c):d},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){"use strict";var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,u,c,d,h){var f,p,m,g,y,v,_,b,x,w=h.bits,k=0,S=0,E=0,C=0,P=0,D=0,I=0,T=0,A=0,z=0,O=null,F=0,M=new r.Buf16(16),j=new r.Buf16(16),B=null,R=0;for(k=0;k<=15;k++)M[k]=0;for(S=0;S<l;S++)M[t[n+S]]++;for(P=w,C=15;1<=C&&0===M[C];C--);if(C<P&&(P=C),0===C)return u[c++]=20971520,u[c++]=20971520,h.bits=1,0;for(E=1;E<C&&0===M[E];E++);for(P<E&&(P=E),k=T=1;k<=15;k++)if(T<<=1,(T-=M[k])<0)return-1;if(0<T&&(0===e||1!==C))return-1;for(j[1]=0,k=1;k<15;k++)j[k+1]=j[k]+M[k];for(S=0;S<l;S++)0!==t[n+S]&&(d[j[t[n+S]]++]=S);if(v=0===e?(O=B=d,19):1===e?(O=i,F-=257,B=a,R-=257,256):(O=o,B=s,-1),k=E,y=c,I=S=z=0,m=-1,g=(A=1<<(D=P))-1,1===e&&852<A||2===e&&592<A)return 1;for(;;){for(_=k-I,x=d[S]<v?(b=0,d[S]):d[S]>v?(b=B[R+d[S]],O[F+d[S]]):(b=96,0),f=1<<k-I,E=p=1<<D;u[y+(z>>I)+(p-=f)]=_<<24|b<<16|x,0!==p;);for(f=1<<k-1;z&f;)f>>=1;if(0!==f?(z&=f-1,z+=f):z=0,S++,0==--M[k]){if(k===C)break;k=t[n+d[S]]}if(P<k&&(z&g)!==m){for(0===I&&(I=P),y+=E,T=1<<(D=k-I);D+I<C&&!((T-=M[D+I])<=0);)D++,T<<=1;if(A+=1<<D,1===e&&852<A||2===e&&592<A)return 1;u[m=z&g]=P<<24|D<<16|y-c}}return 0!==z&&(u[y+z]=k-I<<24|64<<16),h.bits=P,0}},{"../utils/common":41}],51:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){"use strict";var r=e("../utils/common"),i=0,a=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var s=0,l=29,u=256,c=u+1+l,d=30,h=19,f=2*c+1,p=15,m=16,g=7,y=256,v=16,_=17,b=18,x=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],w=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=new Array(2*(c+2));o(E);var C=new Array(2*d);o(C);var P=new Array(512);o(P);var D=new Array(256);o(D);var I=new Array(l);o(I);var T,A,z,O=new Array(d);function F(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function M(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function j(e){return e<256?P[e]:P[256+(e>>>7)]}function B(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function R(e,t,n){e.bi_valid>m-n?(e.bi_buf|=t<<e.bi_valid&65535,B(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=n-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function L(e,t,n){R(e,n[2*t],n[2*t+1])}function N(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function U(e,t,n){var r,i,a=new Array(p+1),o=0;for(r=1;r<=p;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=N(a[s]++,s))}}function V(e){var t;for(t=0;t<c;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*y]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function q(e){8<e.bi_valid?B(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function W(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&H(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!H(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function Z(e,t,n){var r,i,a,o,s=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],i=e.pending_buf[e.l_buf+s],s++,0===r?L(e,i,t):(L(e,(a=D[i])+u+1,t),0!==(o=x[a])&&R(e,i-=I[a],o),L(e,a=j(--r),n),0!==(o=w[a])&&R(e,r-=O[a],o)),s<e.last_lit;);L(e,y,t)}function K(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=f,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=u=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=u,n=e.heap_len>>1;1<=n;n--)W(e,a,n);for(i=l;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],W(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,W(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,g=t.stat_desc.max_length,y=0;for(a=0;a<=p;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<f;n++)g<(a=l[2*l[2*(r=e.heap[n])+1]+1]+1)&&(a=g,y++),l[2*r+1]=a,u<r||(e.bl_count[a]++,o=0,m<=r&&(o=h[r-m]),s=l[2*r],e.opt_len+=s*(a+o),d&&(e.static_len+=s*(c[2*r+1]+o)));if(0!==y){do{for(a=g-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[g]--,y-=2}while(0<y);for(a=g;0!==a;a--)for(r=e.bl_count[a];0!==r;)u<(i=e.heap[--n])||(l[2*i+1]!==a&&(e.opt_len+=(a-l[2*i+1])*l[2*i],l[2*i+1]=a),r--)}}(e,t),U(a,u,e.bl_count)}function G(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<l&&i===o||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[2*v]++):s<=10?e.bl_tree[2*_]++:e.bl_tree[2*b]++,a=i,u=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4))}function X(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<l&&i===o)){if(s<u)for(;L(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(L(e,i,e.bl_tree),s--),L(e,v,e.bl_tree),R(e,s-3,2)):s<=10?(L(e,_,e.bl_tree),R(e,s-3,3)):(L(e,b,e.bl_tree),R(e,s-11,7));a=i,u=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4)}}o(O);var $=!1;function Y(e,t,n,i){R(e,(s<<1)+(i?1:0),3),function(e,t,n,i){q(e),i&&(B(e,n),B(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n,!0)}n._tr_init=function(e){$||(function(){var e,t,n,r,i,a=new Array(p+1);for(r=n=0;r<l-1;r++)for(I[r]=n,e=0;e<1<<x[r];e++)D[n++]=r;for(D[n-1]=r,r=i=0;r<16;r++)for(O[r]=i,e=0;e<1<<w[r];e++)P[i++]=r;for(i>>=7;r<d;r++)for(O[r]=i<<7,e=0;e<1<<w[r]-7;e++)P[256+i++]=r;for(t=0;t<=p;t++)a[t]=0;for(e=0;e<=143;)E[2*e+1]=8,e++,a[8]++;for(;e<=255;)E[2*e+1]=9,e++,a[9]++;for(;e<=279;)E[2*e+1]=7,e++,a[7]++;for(;e<=287;)E[2*e+1]=8,e++,a[8]++;for(U(E,c+1,a),e=0;e<d;e++)C[2*e+1]=5,C[2*e]=N(e,5);T=new F(E,x,u+1,c,p),A=new F(C,w,0,d,p),z=new F(new Array(0),k,0,h,g)}(),$=!0),e.l_desc=new M(e.dyn_ltree,T),e.d_desc=new M(e.dyn_dtree,A),e.bl_desc=new M(e.bl_tree,z),e.bi_buf=0,e.bi_valid=0,V(e)},n._tr_stored_block=Y,n._tr_flush_block=function(e,t,n,r){var o,s,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return i;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return a;for(t=32;t<u;t++)if(0!==e.dyn_ltree[2*t])return a;return i}(e)),K(e,e.l_desc),K(e,e.d_desc),l=function(e){var t;for(G(e,e.dyn_ltree,e.l_desc.max_code),G(e,e.dyn_dtree,e.d_desc.max_code),K(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=o&&(o=s)):o=s=n+5,n+4<=o&&-1!==t?Y(e,t,n,r):4===e.strategy||s===o?(R(e,2+(r?1:0),3),Z(e,E,C)):(R(e,4+(r?1:0),3),function(e,t,n,r){var i;for(R(e,t-257,5),R(e,n-1,5),R(e,r-4,4),i=0;i<r;i++)R(e,e.bl_tree[2*S[i]+1],3);X(e,e.dyn_ltree,t-1),X(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),Z(e,e.dyn_ltree,e.dyn_dtree)),V(e),r&&q(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(D[n]+u+1)]++,e.dyn_dtree[2*j(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){R(e,2,3),L(e,y,E),function(e){16===e.bi_valid?(B(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e,t){"use strict";if(!e.setImmediate){var n,r,i,a,o=1,s={},l=!1,u=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,n="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){h(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(a="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(a+t,"*")}):e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){i.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(r=u.documentElement,function(e){var t=u.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):function(e){setTimeout(h,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var i={callback:e,args:t};return s[o]=i,n(o),o++},c.clearImmediate=d}function d(e){delete s[e]}function h(e){if(l)setTimeout(h,0,e);else{var n=s[e];if(n){l=!0;try{!function(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r)}}(n)}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&h(+t.data.slice(a.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},194(e,t,n){var r=Object.defineProperty,i=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;((e,t)=>{for(var n in(e=>{r(e,"__esModule",{value:!0})})(e),t)r(e,n,{get:t[n],enumerable:!0})})(t,{Atom:()=>Pt,PointerProxy:()=>Ft,Ticker:()=>zt,getPointerParts:()=>Ge,isPointer:()=>Ye,isPrism:()=>et,iterateAndCountTicks:()=>At,iterateOver:()=>Ot,pointer:()=>$e,pointerToPrism:()=>It,prism:()=>wt,val:()=>Tt});var c=Array.isArray,d="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,h="object"==typeof self&&self&&self.Object===Object&&self,f=d||h||Function("return this")(),p=f.Symbol,m=Object.prototype,g=m.hasOwnProperty,y=m.toString,v=p?p.toStringTag:void 0;var _=function(e){var t=g.call(e,v),n=e[v];try{e[v]=void 0;var r=!0}catch(a){}var i=y.call(e);return r&&(t?e[v]=n:delete e[v]),i},b=Object.prototype.toString;var x=function(e){return b.call(e)},w=p?p.toStringTag:void 0;var k=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":w&&w in Object(e)?_(e):x(e)};var S=function(e){return null!=e&&"object"==typeof e};var E=function(e){return"symbol"==typeof e||S(e)&&"[object Symbol]"==k(e)},C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,P=/^\w*$/;var D=function(e,t){if(c(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!E(e))||(P.test(e)||!C.test(e)||null!=t&&e in Object(t))};var I=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var T=function(e){if(!I(e))return!1;var t=k(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},A=f["__core-js_shared__"],z=function(){var e=/[^.]+$/.exec(A&&A.keys&&A.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var O=function(e){return!!z&&z in e},F=Function.prototype.toString;var M=function(e){if(null!=e){try{return F.call(e)}catch(t){}try{return e+""}catch(t){}}return""},j=/^\[object .+?Constructor\]$/,B=Function.prototype,R=Object.prototype,L=B.toString,N=R.hasOwnProperty,U=RegExp("^"+L.call(N).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var V=function(e){return!(!I(e)||O(e))&&(T(e)?U:j).test(M(e))};var q=function(e,t){return null==e?void 0:e[t]};var H=function(e,t){var n=q(e,t);return V(n)?n:void 0},W=H(Object,"create");var Z=function(){this.__data__=W?W(null):{},this.size=0};var K=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},G=Object.prototype.hasOwnProperty;var X=function(e){var t=this.__data__;if(W){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return G.call(t,e)?t[e]:void 0},$=Object.prototype.hasOwnProperty;var Y=function(e){var t=this.__data__;return W?void 0!==t[e]:$.call(t,e)};var J=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=W&&void 0===t?"__lodash_hash_undefined__":t,this};function Q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Q.prototype.clear=Z,Q.prototype.delete=K,Q.prototype.get=X,Q.prototype.has=Y,Q.prototype.set=J;var ee=Q;var te=function(){this.__data__=[],this.size=0};var ne=function(e,t){return e===t||e!==e&&t!==t};var re=function(e,t){for(var n=e.length;n--;)if(ne(e[n][0],t))return n;return-1},ie=Array.prototype.splice;var ae=function(e){var t=this.__data__,n=re(t,e);return!(n<0)&&(n==t.length-1?t.pop():ie.call(t,n,1),--this.size,!0)};var oe=function(e){var t=this.__data__,n=re(t,e);return n<0?void 0:t[n][1]};var se=function(e){return re(this.__data__,e)>-1};var le=function(e,t){var n=this.__data__,r=re(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function ue(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ue.prototype.clear=te,ue.prototype.delete=ae,ue.prototype.get=oe,ue.prototype.has=se,ue.prototype.set=le;var ce=ue,de=H(f,"Map");var he=function(){this.size=0,this.__data__={hash:new ee,map:new(de||ce),string:new ee}};var fe=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var pe=function(e,t){var n=e.__data__;return fe(t)?n["string"==typeof t?"string":"hash"]:n.map};var me=function(e){var t=pe(this,e).delete(e);return this.size-=t?1:0,t};var ge=function(e){return pe(this,e).get(e)};var ye=function(e){return pe(this,e).has(e)};var ve=function(e,t){var n=pe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function _e(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}_e.prototype.clear=he,_e.prototype.delete=me,_e.prototype.get=ge,_e.prototype.has=ye,_e.prototype.set=ve;var be=_e;function xe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(xe.Cache||be),n}xe.Cache=be;var we=xe;var ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Se=/\\(\\)?/g,Ee=function(e){var t=we(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ke,function(e,n,r,i){t.push(r?i.replace(Se,"$1"):n||e)}),t});var Ce=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Pe=p?p.prototype:void 0,De=Pe?Pe.toString:void 0;var Ie=function e(t){if("string"==typeof t)return t;if(c(t))return Ce(t,e)+"";if(E(t))return De?De.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var Te=function(e){return null==e?"":Ie(e)};var Ae=function(e,t){return c(e)?e:D(e,t)?[e]:Ee(Te(e))};var ze=function(e){if("string"==typeof e||E(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var Oe=function(e,t){for(var n=0,r=(t=Ae(t,e)).length;null!=e&&n<r;)e=e[ze(t[n++])];return n&&n==r?e:void 0};var Fe=function(e,t,n){var r=null==e?void 0:Oe(e,t);return void 0===r?n:r};var Me=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),je=Function.prototype,Be=Object.prototype,Re=je.toString,Le=Be.hasOwnProperty,Ne=Re.call(Object);var Ue=function(e){if(!S(e)||"[object Object]"!=k(e))return!1;var t=Me(e);if(null===t)return!0;var n=Le.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Re.call(n)==Ne};var Ve=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},qe=new WeakMap,He=new WeakMap,We=Symbol("pointerMeta"),Ze={get(e,t){if(t===We)return qe.get(e);let n=He.get(e);n||(n=new Map,He.set(e,n));const r=n.get(t);if(void 0!==r)return r;const i=qe.get(e),a=Xe({root:i.root,path:[...i.path,t]});return n.set(t,a),a}},Ke=e=>e[We],Ge=e=>{const{root:t,path:n}=Ke(e);return{root:t,path:n}};function Xe(e){var t;const n={root:e.root,path:null!=(t=e.path)?t:[]},r={};return qe.set(r,n),new Proxy(r,Ze)}var $e=Xe,Ye=e=>e&&!!Ke(e);var Je=(e,t,n)=>{if(0===t.length)return n(e);if(Array.isArray(e)){let[r,...i]=t;r=parseInt(String(r),10),isNaN(r)&&(r=0);const a=e[r],o=Je(a,i,n);if(a===o)return e;const s=[...e];return s.splice(r,1,o),s}if("object"===typeof e&&null!==e){const[c,...d]=t,h=e[c],f=Je(h,d,n);if(h===f)return e;const p=(r=((e,t)=>{for(var n in t||(t={}))s.call(t,n)&&u(e,n,t[n]);if(o)for(var n of o(t))l.call(t,n)&&u(e,n,t[n]);return e})({},e),i(r,a({[c]:f})));return p}{const[e,...r]=t;return{[e]:Je(void 0,r,n)}}var r},Qe=class{constructor(){this._head=void 0}peek(){return this._head&&this._head.data}pop(){const e=this._head;if(e)return this._head=e.next,e.data}push(e){const t={next:this._head,data:e};this._head=t}};function et(e){return!(!e||!e.isPrism||!0!==e.isPrism)}function tt(){const e=new Qe,t=()=>{};return{type:"Dataverse_discoveryMechanism",startIgnoringDependencies:()=>{e.push(t)},stopIgnoringDependencies:()=>{e.peek()!==t||e.pop()},reportResolutionStart:n=>{const r=e.peek();r&&r(n),e.push(t)},reportResolutionEnd:t=>{e.pop()},pushCollector:t=>{e.push(t)},popCollector:t=>{if(e.peek()!==t)throw new Error("Popped collector is not on top of the stack");e.pop()}}}var{startIgnoringDependencies:nt,stopIgnoringDependencies:rt,reportResolutionEnd:it,reportResolutionStart:at,pushCollector:ot,popCollector:st}=function(){const e="__dataverse_discoveryMechanism_sharedStack",t="undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:{};if(t){const n=t[e];if(n&&"object"===typeof n&&"Dataverse_discoveryMechanism"===n.type)return n;{const n=tt();return t[e]=n,n}}return tt()}(),lt=()=>{},ut=class{constructor(e,t){this._fn=e,this._prismInstance=t,this._didMarkDependentsAsStale=!1,this._isFresh=!1,this._cacheOfDendencyValues=new Map,this._dependents=new Set,this._dependencies=new Set,this._possiblyStaleDeps=new Set,this._scope=new ht(this),this._lastValue=void 0,this._forciblySetToStale=!1,this._reactToDependencyGoingStale=e=>{this._possiblyStaleDeps.add(e),this._markAsStale()};for(const n of this._dependencies)n._addDependent(this._reactToDependencyGoingStale);nt(),this.getValue(),rt()}get hasDependents(){return this._dependents.size>0}removeDependent(e){this._dependents.delete(e)}addDependent(e){this._dependents.add(e)}destroy(){for(const e of this._dependencies)e._removeDependent(this._reactToDependencyGoingStale);ft(this._scope)}getValue(){if(!this._isFresh){const e=this._recalculate();this._lastValue=e,this._isFresh=!0,this._didMarkDependentsAsStale=!1,this._forciblySetToStale=!1}return this._lastValue}_recalculate(){let e;if(!this._forciblySetToStale&&this._possiblyStaleDeps.size>0){let e=!1;nt();for(const t of this._possiblyStaleDeps)if(this._cacheOfDendencyValues.get(t)!==t.getValue()){e=!0;break}if(rt(),this._possiblyStaleDeps.clear(),!e)return this._lastValue}const t=new Set;this._cacheOfDendencyValues.clear();const n=e=>{t.add(e),this._addDependency(e)};ot(n),mt.push(this._scope);try{e=this._fn()}catch(r){console.error(r)}finally{mt.pop()!==this._scope&&console.warn("The Prism hook stack has slipped. This is a bug.")}st(n);for(const i of this._dependencies)t.has(i)||this._removeDependency(i);this._dependencies=t,nt();for(const i of t)this._cacheOfDendencyValues.set(i,i.getValue());return rt(),e}forceStale(){this._forciblySetToStale=!0,this._markAsStale()}_markAsStale(){if(!this._didMarkDependentsAsStale){this._didMarkDependentsAsStale=!0,this._isFresh=!1;for(const e of this._dependents)e(this._prismInstance)}}_addDependency(e){this._dependencies.has(e)||(this._dependencies.add(e),e._addDependent(this._reactToDependencyGoingStale))}_removeDependency(e){this._dependencies.has(e)&&(this._dependencies.delete(e),e._removeDependent(this._reactToDependencyGoingStale))}},ct={},dt=class{constructor(e){this._fn=e,this.isPrism=!0,this._state={hot:!1,handle:void 0}}get isHot(){return this._state.hot}onChange(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=()=>{e.onThisOrNextTick(a)};let i=ct;const a=()=>{const e=this.getValue();e!==i&&(i=e,t(e))};this._addDependent(r),n&&(i=this.getValue(),t(i));return()=>{this._removeDependent(r),e.offThisOrNextTick(a),e.offNextTick(a)}}onStale(e){const t=()=>e();return this._addDependent(t),()=>{this._removeDependent(t)}}keepHot(){return this.onStale(()=>{})}_addDependent(e){this._state.hot||this._goHot(),this._state.handle.addDependent(e)}_goHot(){const e=new ut(this._fn,this);this._state={hot:!0,handle:e}}_removeDependent(e){const t=this._state;if(!t.hot)return;const n=t.handle;n.removeDependent(e),n.hasDependents||(this._state={hot:!1,handle:void 0},n.destroy())}getValue(){at(this);const e=this._state;let t;return t=e.hot?e.handle.getValue():function(e){const t=new _t;let n;mt.push(t);try{n=e()}catch(r){console.error(r)}finally{mt.pop()!==t&&console.warn("The Prism hook stack has slipped. This is a bug.")}return n}(this._fn),it(this),t}},ht=class{constructor(e){this._hotHandle=e,this._refs=new Map,this.isPrismScope=!0,this.subs={},this.effects=new Map,this.memos=new Map}ref(e,t){let n=this._refs.get(e);if(void 0!==n)return n;{const n={current:t};return this._refs.set(e,n),n}}effect(e,t,n){let r=this.effects.get(e);void 0===r&&(r={cleanup:lt,deps:void 0},this.effects.set(e,r)),gt(r.deps,n)&&(r.cleanup(),nt(),r.cleanup=pt(t,lt).value,rt(),r.deps=n)}memo(e,t,n){let r=this.memos.get(e);return void 0===r&&(r={cachedValue:null,deps:void 0},this.memos.set(e,r)),gt(r.deps,n)&&(nt(),r.cachedValue=pt(t,void 0).value,rt(),r.deps=n),r.cachedValue}state(e,t){const{value:n,setValue:r}=this.memo("state/"+e,()=>{const e={current:t};return{value:e,setValue:t=>{e.current=t,this._hotHandle.forceStale()}}},[]);return[n.current,r]}sub(e){return this.subs[e]||(this.subs[e]=new ht(this._hotHandle)),this.subs[e]}cleanupEffects(){for(const e of this.effects.values())pt(e.cleanup,void 0);this.effects.clear()}source(e,t){return this.effect("$$source/blah",()=>e(()=>{this._hotHandle.forceStale()}),[e]),t()}};function ft(e){for(const t of Object.values(e.subs))ft(t);e.cleanupEffects()}function pt(e,t){try{return{value:e(),ok:!0}}catch(n){return setTimeout(function(){throw n}),{value:t,ok:!1}}}var mt=new Qe;function gt(e,t){if(void 0===e||void 0===t)return!0;const n=e.length;if(n!==t.length)return!0;for(let r=0;r<n;r++)if(e[r]!==t[r])return!0;return!1}function yt(e,t,n){const r=mt.peek();if(!r)throw new Error("prism.memo() is called outside of a prism() call.");return r.memo(e,t,n)}var vt=e=>new dt(e),_t=class{effect(e,t,n){console.warn("prism.effect() does not run in cold prisms")}memo(e,t,n){return t()}state(e,t){return[t,()=>{}]}ref(e,t){return{current:t}}sub(e){return new _t}source(e,t){return t()}};vt.ref=function(e,t){const n=mt.peek();if(!n)throw new Error("prism.ref() is called outside of a prism() call.");return n.ref(e,t)},vt.effect=function(e,t,n){const r=mt.peek();if(!r)throw new Error("prism.effect() is called outside of a prism() call.");return r.effect(e,t,n)},vt.memo=yt,vt.ensurePrism=function(){if(!mt.peek())throw new Error("The parent function is called outside of a prism() call.")},vt.state=function(e,t){const n=mt.peek();if(!n)throw new Error("prism.state() is called outside of a prism() call.");return n.state(e,t)},vt.scope=function(e,t){const n=mt.peek();if(!n)throw new Error("prism.scope() is called outside of a prism() call.");const r=n.sub(e);mt.push(r);const i=pt(t,void 0).value;return mt.pop(),i},vt.sub=function(e,t,n){return yt(e,()=>vt(t),n).getValue()},vt.inPrism=function(){return!!mt.peek()},vt.source=function(e,t){const n=mt.peek();if(!n)throw new Error("prism.source() is called outside of a prism() call.");return n.source(e,t)};var bt,xt,wt=vt;(xt=bt||(bt={}))[xt.Dict=0]="Dict",xt[xt.Array=1]="Array",xt[xt.Other=2]="Other";var kt=e=>Array.isArray(e)?1:Ue(e)?0:2,St=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kt(e);return 0===n&&"string"===typeof t||1===n&&Et(t)?e[t]:void 0},Et=e=>{const t="number"===typeof e?e:parseInt(e,10);return!isNaN(t)&&t>=0&&t<1/0&&(0|t)===t},Ct=class{constructor(e,t){this._parent=e,this._path=t,this.children=new Map,this.identityChangeListeners=new Set}addIdentityChangeListener(e){this.identityChangeListeners.add(e)}removeIdentityChangeListener(e){this.identityChangeListeners.delete(e),this._checkForGC()}removeChild(e){this.children.delete(e),this._checkForGC()}getChild(e){return this.children.get(e)}getOrCreateChild(e){let t=this.children.get(e);return t||(t=t=new Ct(this,this._path.concat([e])),this.children.set(e,t)),t}_checkForGC(){this.identityChangeListeners.size>0||this.children.size>0||this._parent&&this._parent.removeChild(Ve(this._path))}},Pt=class{constructor(e){this.$$isPointerToPrismProvider=!0,this.pointer=$e({root:this,path:[]}),this.prism=this.pointerToPrism(this.pointer),this._onPointerValueChange=(e,t)=>{const{path:n}=Ge(e),r=this._getOrCreateScopeForPath(n);r.identityChangeListeners.add(t);return()=>{r.identityChangeListeners.delete(t)}},this._currentState=e,this._rootScope=new Ct(void 0,[])}set(e){const t=this._currentState;this._currentState=e,this._checkUpdates(this._rootScope,t,e)}get(){return this._currentState}getByPointer(e){const t=Ye(e)?e:e(this.pointer),n=Ge(t).path;return this._getIn(n)}_getIn(e){return 0===e.length?this.get():Fe(this.get(),e)}reduce(e){this.set(e(this.get()))}reduceByPointer(e,t){const n=Ye(e)?e:e(this.pointer),r=Ge(n).path,i=function(e,t,n){return 0===t.length?n(e):Je(e,t,n)}(this.get(),r,t);this.set(i)}setByPointer(e,t){this.reduceByPointer(e,()=>t)}_checkUpdates(e,t,n){if(t===n)return;for(const a of e.identityChangeListeners)a(n);if(0===e.children.size)return;const r=kt(t),i=kt(n);if(2!==r||r!==i)for(const[a,o]of e.children){const e=St(t,a,r),s=St(n,a,i);this._checkUpdates(o,e,s)}}_getOrCreateScopeForPath(e){let t=this._rootScope;for(const n of e)t=t.getOrCreateChild(n);return t}pointerToPrism(e){const{path:t}=Ge(e),n=t=>this._onPointerValueChange(e,t),r=()=>this._getIn(t);return wt(()=>wt.source(n,r))}},Dt=new WeakMap;var It=e=>{const t=Ke(e);let n=Dt.get(t);if(!n){const i=t.root;if("object"!==typeof(r=i)||null===r||!0!==r.$$isPointerToPrismProvider)throw new Error("Cannot run pointerToPrism() on a pointer whose root is not an PointerToPrismProvider");n=i.pointerToPrism(e),Dt.set(t,n)}var r;return n},Tt=e=>Ye(e)?It(e).getValue():et(e)?e.getValue():e;function*At(e){let t;if(Ye(e))t=It(e);else{if(!et(e))throw new Error("Only pointers and prisms are supported");t=e}let n=0;const r=t.onStale(()=>{n++});try{for(;;){const e=n;n=0,yield{value:t.getValue(),ticks:e}}}finally{r()}}var zt=class{constructor(e){this._conf=e,this._ticking=!1,this._dormant=!0,this._numberOfDormantTicks=0,this.__ticks=0,this._scheduledForThisOrNextTick=new Set,this._scheduledForNextTick=new Set,this._timeAtCurrentTick=0}get dormant(){return this._dormant}onThisOrNextTick(e){this._scheduledForThisOrNextTick.add(e),this._dormant&&this._goActive()}onNextTick(e){this._scheduledForNextTick.add(e),this._dormant&&this._goActive()}offThisOrNextTick(e){this._scheduledForThisOrNextTick.delete(e)}offNextTick(e){this._scheduledForNextTick.delete(e)}get time(){return this._ticking?this._timeAtCurrentTick:performance.now()}_goActive(){var e,t;this._dormant&&(this._dormant=!1,null==(t=null==(e=this._conf)?void 0:e.onActive)||t.call(e))}_goDormant(){var e,t;this._dormant||(this._dormant=!0,this._numberOfDormantTicks=0,null==(t=null==(e=this._conf)?void 0:e.onDormant)||t.call(e))}tick(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:performance.now();if(this.__ticks++,!this._dormant&&0===this._scheduledForNextTick.size&&0===this._scheduledForThisOrNextTick.size&&(this._numberOfDormantTicks++,this._numberOfDormantTicks>=180))this._goDormant();else{this._ticking=!0,this._timeAtCurrentTick=e;for(const e of this._scheduledForNextTick)this._scheduledForThisOrNextTick.add(e);this._scheduledForNextTick.clear(),this._tick(0),this._ticking=!1}}_tick(e){const t=this.time;if(e>10&&console.warn("_tick() recursing for 10 times"),e>100)throw new Error("Maximum recursion limit for _tick()");const n=this._scheduledForThisOrNextTick;this._scheduledForThisOrNextTick=new Set;for(const r of n)r(t);if(this._scheduledForThisOrNextTick.size>0)return this._tick(e+1)}};function*Ot(e){let t;if(Ye(e))t=It(e);else{if(!et(e))throw new Error("Only pointers and prisms are supported");t=e}const n=new zt,r=t.onChange(n,e=>{});try{for(;;)n.tick(),yield t.getValue()}finally{r()}}var Ft=class{constructor(e){this.$$isPointerToPrismProvider=!0,this._currentPointerBox=new Pt(e),this.pointer=$e({root:this,path:[]})}setPointer(e){this._currentPointerBox.set(e)}pointerToPrism(e){const{path:t}=Ke(e);return wt(()=>{const e=this._currentPointerBox.prism.getValue(),n=t.reduce((e,t)=>e[t],e);return Tt(n)})}}},195(e,t,n){"use strict";var r,i,a;e=n.nmd(e);var o=Object.create,s=Object.freeze,l=Object.defineProperty,u=Object.defineProperties,c=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyDescriptors,h=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,p=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,y=(e,t)=>{if(t=Symbol[e])return t;throw Error("Symbol."+e+" is not defined")},v=Math.pow,_=(e,t,n)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))m.call(t,n)&&_(e,n,t[n]);if(f)for(var n of f(t))g.call(t,n)&&_(e,n,t[n]);return e},x=(e,t)=>u(e,d(t)),w=(e,t)=>{var n={};for(var r in e)m.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&f)for(var r of f(e))t.indexOf(r)<0&&g.call(e,r)&&(n[r]=e[r]);return n},k=(e,t)=>()=>(e&&(t=e(e=0)),t),S=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),E=(e,t)=>{for(var n in t)l(e,n,{get:t[n],enumerable:!0})},C=(e,t,n,r)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of h(t))!m.call(e,i)&&i!==n&&l(e,i,{get:()=>t[i],enumerable:!(r=c(t,i))||r.enumerable});return e},P=(e,t,n)=>(n=null!=e?o(p(e)):{},C(!t&&e&&e.__esModule?n:l(n,"default",{value:e,enumerable:!0}),e)),D=(e,t,n)=>(_(e,"symbol"!=typeof t?t+"":t,n),n),I=(e,t)=>s(l(e,"raw",{value:s(t||e.slice())})),T=(e,t,n)=>new Promise((r,i)=>{var a=e=>{try{s(n.next(e))}catch(t){i(t)}},o=e=>{try{s(n.throw(e))}catch(t){i(t)}},s=e=>e.done?r(e.value):Promise.resolve(e.value).then(a,o);s((n=n.apply(e,t)).next())}),A=function(e,t){this[0]=e,this[1]=t},z=e=>{var t,n=e[y("asyncIterator")],r=!1,i={};return null==n?(n=e[y("iterator")](),t=e=>i[e]=t=>n[e](t)):(n=n.call(e),t=e=>i[e]=t=>{if(r){if(r=!1,"throw"===e)throw t;return t}return r=!0,{done:!1,value:new A(new Promise(r=>{var i=n[e](t);if(!(i instanceof Object))throw TypeError("Object expected");r(i)}),1)}}),i[y("iterator")]=()=>i,t("next"),"throw"in n?t("throw"):i.throw=e=>{throw e},"return"in n&&t("return"),i};function O(){return F}var F,M=k(()=>{});function j(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if("object"==typeof e&&e){if(B(e)||R(e))return void t(e,n);for(let[r,i]of Object.entries(e))j(i,t,[...n,r])}else{if(null==e)return;t(e,n)}}var B,R,L=k(()=>{B=e=>"object"==typeof e&&null!==e&&Object.hasOwnProperty.call(e,"type")&&"image"===e.type&&Object.hasOwnProperty.call(e,"id")&&"string"==typeof e.id&&""!==e.id,R=e=>"object"==typeof e&&null!==e&&Object.hasOwnProperty.call(e,"r")&&Object.hasOwnProperty.call(e,"g")&&Object.hasOwnProperty.call(e,"b")&&Object.hasOwnProperty.call(e,"a")&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b&&"number"==typeof e.a});function N(e){return t=>"object"==typeof t&&!!t&&t.type===e}var U,V,q,H,W,Z,K,G,X,$,Y,J,Q,ee,te,ne=k(()=>{U=N("Theatre_Project"),V=N("Theatre_Sheet"),q=N("Theatre_SheetTemplate"),H=N("Theatre_SheetObject"),W=N("Theatre_Sequence"),Z=N("Theatre_SheetObjectTemplate"),N("Theatre_Project_PublicAPI"),K=N("Theatre_Sheet_PublicAPI"),G=N("Theatre_SheetObject_PublicAPI")}),re=k(()=>{X="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,$=X}),ie=k(()=>{re(),Y="object"==typeof self&&self&&self.Object===Object&&self,J=$||Y||Function("return this")(),Q=J}),ae=k(()=>{ie(),ee=Q.Symbol,te=ee});function oe(e){var t=le.call(e,ce),n=e[ce];try{e[ce]=void 0;var r=!0}catch(a){}var i=ue.call(e);return r&&(t?e[ce]=n:delete e[ce]),i}var se,le,ue,ce,de,he=k(()=>{ae(),se=Object.prototype,le=se.hasOwnProperty,ue=se.toString,ce=te?te.toStringTag:void 0,de=oe});function fe(e){return me.call(e)}var pe,me,ge,ye=k(()=>{pe=Object.prototype,me=pe.toString,ge=fe});function ve(e){return null==e?void 0===e?be:_e:xe&&xe in Object(e)?de(e):ge(e)}var _e,be,xe,we,ke=k(()=>{ae(),he(),ye(),_e="[object Null]",be="[object Undefined]",xe=te?te.toStringTag:void 0,we=ve});function Se(e){return null!=e&&"object"==typeof e}var Ee,Ce=k(()=>{Ee=Se});function Pe(e){return"symbol"==typeof e||Ee(e)&&we(e)==De}var De,Ie,Te=k(()=>{ke(),Ce(),De="[object Symbol]",Ie=Pe});function Ae(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}var ze,Oe,Fe,Me=k(()=>{ze=Ae}),je=k(()=>{Oe=Array.isArray,Fe=Oe});function Be(e){if("string"==typeof e)return e;if(Fe(e))return ze(e,Be)+"";if(Ie(e))return Ne?Ne.call(e):"";var t=e+"";return"0"==t&&1/e==-Re?"-0":t}var Re,Le,Ne,Ue,Ve=k(()=>{ae(),Me(),je(),Te(),Re=1/0,Le=te?te.prototype:void 0,Ne=Le?Le.toString:void 0,Ue=Be});function qe(e){for(var t=e.length;t--&&He.test(e.charAt(t)););return t}var He,We,Ze=k(()=>{He=/\s/,We=qe});function Ke(e){return e&&e.slice(0,We(e)+1).replace(Ge,"")}var Ge,Xe,$e=k(()=>{Ze(),Ge=/^\s+/,Xe=Ke});function Ye(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Je,Qe=k(()=>{Je=Ye});function et(e){if("number"==typeof e)return e;if(Ie(e))return tt;if(Je(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Je(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Xe(e);var n=rt.test(e);return n||it.test(e)?at(e.slice(2),n?2:8):nt.test(e)?tt:+e}var tt,nt,rt,it,at,ot,st=k(()=>{$e(),Qe(),Te(),tt=NaN,nt=/^[-+]0x[0-9a-f]+$/i,rt=/^0b[01]+$/i,it=/^0o[0-7]+$/i,at=parseInt,ot=et});function lt(e){return e?(e=ot(e))===ut||e===-ut?(e<0?-1:1)*ct:e===e?e:0:0===e?e:0}var ut,ct,dt,ht=k(()=>{st(),ut=1/0,ct=17976931348623157e292,dt=lt});function ft(e){var t=dt(e),n=t%1;return t===t?n?t-n:t:0}var pt,mt=k(()=>{ht(),pt=ft});function gt(e){return e}var yt,vt=k(()=>{yt=gt});function _t(e){if(!Je(e))return!1;var t=we(e);return t==xt||t==wt||t==bt||t==kt}var bt,xt,wt,kt,St,Et,Ct,Pt=k(()=>{ke(),Qe(),bt="[object AsyncFunction]",xt="[object Function]",wt="[object GeneratorFunction]",kt="[object Proxy]",St=_t}),Dt=k(()=>{ie(),Et=Q["__core-js_shared__"],Ct=Et});function It(e){return!!Tt&&Tt in e}var Tt,At,zt=k(()=>{Dt(),Tt=function(){var e=/[^.]+$/.exec(Ct&&Ct.keys&&Ct.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),At=It});function Ot(e){if(null!=e){try{return Mt.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var Ft,Mt,jt,Bt=k(()=>{Ft=Function.prototype,Mt=Ft.toString,jt=Ot});function Rt(e){return!(!Je(e)||At(e))&&(St(e)?Wt:Nt).test(jt(e))}var Lt,Nt,Ut,Vt,qt,Ht,Wt,Zt,Kt=k(()=>{Pt(),zt(),Qe(),Bt(),Lt=/[\\^$.*+?()[\]{}|]/g,Nt=/^\[object .+?Constructor\]$/,Ut=Function.prototype,Vt=Object.prototype,qt=Ut.toString,Ht=Vt.hasOwnProperty,Wt=RegExp("^"+qt.call(Ht).replace(Lt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Zt=Rt});function Gt(e,t){return null==e?void 0:e[t]}var Xt,$t=k(()=>{Xt=Gt});function Yt(e,t){var n=Xt(e,t);return Zt(n)?n:void 0}var Jt,Qt,en,tn=k(()=>{Kt(),$t(),Jt=Yt}),nn=k(()=>{tn(),ie(),Qt=Jt(Q,"WeakMap"),en=Qt});function rn(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var an,on=k(()=>{an=rn});function sn(){}var ln,un=k(()=>{ln=sn});function cn(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var dn,hn=k(()=>{dn=cn});function fn(e){var t=0,n=0;return function(){var r=gn(),i=mn-(r-n);if(n=r,i>0){if(++t>=pn)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var pn,mn,gn,yn,vn=k(()=>{pn=800,mn=16,gn=Date.now,yn=fn});function _n(e){return function(){return e}}var bn,xn,wn,kn,Sn,En,Cn=k(()=>{bn=_n}),Pn=k(()=>{tn(),xn=function(){try{var e=Jt(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),wn=xn}),Dn=k(()=>{Cn(),Pn(),vt(),kn=wn?function(e,t){return wn(e,"toString",{configurable:!0,enumerable:!1,value:bn(t),writable:!0})}:yt}),In=k(()=>{Dn(),vn(),Sn=yn(kn),En=Sn});function Tn(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}var An,zn=k(()=>{An=Tn});function On(e){return e!==e}var Fn,Mn=k(()=>{Fn=On});function jn(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}var Bn,Rn=k(()=>{Bn=jn});function Ln(e,t,n){return t===t?Bn(e,t,n):An(e,Fn,n)}var Nn,Un=k(()=>{zn(),Mn(),Rn(),Nn=Ln});function Vn(e,t){return!!(null==e?0:e.length)&&Nn(e,t,0)>-1}var qn,Hn=k(()=>{Un(),qn=Vn});function Wn(e,t){var n=typeof e;return!!(t=null==t?Zn:t)&&("number"==n||"symbol"!=n&&Kn.test(e))&&e>-1&&e%1==0&&e<t}var Zn,Kn,Gn,Xn=k(()=>{Zn=9007199254740991,Kn=/^(?:0|[1-9]\d*)$/,Gn=Wn});function $n(e,t,n){"__proto__"==t&&wn?wn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Yn,Jn=k(()=>{Pn(),Yn=$n});function Qn(e,t){return e===t||e!==e&&t!==t}var er,tr=k(()=>{er=Qn});function nr(e,t,n){var r=e[t];(!ir.call(e,t)||!er(r,n)||void 0===n&&!(t in e))&&Yn(e,t,n)}var rr,ir,ar,or=k(()=>{Jn(),tr(),rr=Object.prototype,ir=rr.hasOwnProperty,ar=nr});function sr(e,t,n){return t=lr(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,a=lr(r.length-t,0),o=Array(a);++i<a;)o[i]=r[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=r[i];return s[t]=n(o),an(e,this,s)}}var lr,ur,cr=k(()=>{on(),lr=Math.max,ur=sr});function dr(e,t){return En(ur(e,t,yt),e+"")}var hr,fr=k(()=>{vt(),cr(),In(),hr=dr});function pr(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=mr}var mr,gr,yr=k(()=>{mr=9007199254740991,gr=pr});function vr(e){return null!=e&&gr(e.length)&&!St(e)}var _r,br=k(()=>{Pt(),yr(),_r=vr});function xr(e,t,n){if(!Je(n))return!1;var r=typeof t;return!!("number"==r?_r(n)&&Gn(t,n.length):"string"==r&&t in n)&&er(n[t],e)}var wr,kr=k(()=>{tr(),br(),Xn(),Qe(),wr=xr});function Sr(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Er)}var Er,Cr,Pr=k(()=>{Er=Object.prototype,Cr=Sr});function Dr(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var Ir,Tr=k(()=>{Ir=Dr});function Ar(e){return Ee(e)&&we(e)==zr}var zr,Or,Fr,Mr,jr,Br,Rr,Lr=k(()=>{ke(),Ce(),zr="[object Arguments]",Or=Ar}),Nr=k(()=>{Lr(),Ce(),Fr=Object.prototype,Mr=Fr.hasOwnProperty,jr=Fr.propertyIsEnumerable,Br=Or(function(){return arguments}())?Or:function(e){return Ee(e)&&Mr.call(e,"callee")&&!jr.call(e,"callee")},Rr=Br});function Ur(){return!1}var Vr,qr,Hr,Wr,Zr,Kr,Gr,Xr=k(()=>{Vr=Ur}),$r=k(()=>{ie(),Xr(),qr=t&&!t.nodeType&&t,Hr=qr&&e&&!e.nodeType&&e,Wr=Hr&&Hr.exports===qr,Zr=Wr?Q.Buffer:void 0,Kr=Zr?Zr.isBuffer:void 0,Gr=Kr||Vr});function Yr(e){return Ee(e)&&gr(e.length)&&!!Jr[we(e)]}var Jr,Qr,ei=k(()=>{ke(),yr(),Ce(),(Jr={})["[object Float32Array]"]=Jr["[object Float64Array]"]=Jr["[object Int8Array]"]=Jr["[object Int16Array]"]=Jr["[object Int32Array]"]=Jr["[object Uint8Array]"]=Jr["[object Uint8ClampedArray]"]=Jr["[object Uint16Array]"]=Jr["[object Uint32Array]"]=!0,Jr["[object Arguments]"]=Jr["[object Array]"]=Jr["[object ArrayBuffer]"]=Jr["[object Boolean]"]=Jr["[object DataView]"]=Jr["[object Date]"]=Jr["[object Error]"]=Jr["[object Function]"]=Jr["[object Map]"]=Jr["[object Number]"]=Jr["[object Object]"]=Jr["[object RegExp]"]=Jr["[object Set]"]=Jr["[object String]"]=Jr["[object WeakMap]"]=!1,Qr=Yr});function ti(e){return function(t){return e(t)}}var ni,ri,ii,ai,oi,si,li,ui,ci,di,hi=k(()=>{ni=ti}),fi=k(()=>{re(),ri=t&&!t.nodeType&&t,ii=ri&&e&&!e.nodeType&&e,ai=ii&&ii.exports===ri,oi=ai&&$.process,si=function(){try{return ii&&ii.require&&ii.require("util").types||oi&&oi.binding&&oi.binding("util")}catch(e){}}(),li=si}),pi=k(()=>{ei(),hi(),fi(),ui=li&&li.isTypedArray,ci=ui?ni(ui):Qr,di=ci});function mi(e,t){var n=Fe(e),r=!n&&Rr(e),i=!n&&!r&&Gr(e),a=!n&&!r&&!i&&di(e),o=n||r||i||a,s=o?Ir(e.length,String):[],l=s.length;for(var u in e)(t||yi.call(e,u))&&(!o||!("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Gn(u,l)))&&s.push(u);return s}var gi,yi,vi,_i=k(()=>{Tr(),Nr(),je(),$r(),Xn(),pi(),gi=Object.prototype,yi=gi.hasOwnProperty,vi=mi});function bi(e,t){return function(n){return e(t(n))}}var xi,wi,ki,Si=k(()=>{xi=bi}),Ei=k(()=>{Si(),wi=xi(Object.keys,Object),ki=wi});function Ci(e){if(!Cr(e))return ki(e);var t=[];for(var n in Object(e))Di.call(e,n)&&"constructor"!=n&&t.push(n);return t}var Pi,Di,Ii,Ti=k(()=>{Pr(),Ei(),Pi=Object.prototype,Di=Pi.hasOwnProperty,Ii=Ci});function Ai(e){return _r(e)?vi(e):Ii(e)}var zi,Oi=k(()=>{_i(),Ti(),br(),zi=Ai});function Fi(e,t){if(Fe(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Ie(e))||(ji.test(e)||!Mi.test(e)||null!=t&&e in Object(t))}var Mi,ji,Bi,Ri,Li,Ni=k(()=>{je(),Te(),Mi=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ji=/^\w*$/,Bi=Fi}),Ui=k(()=>{tn(),Ri=Jt(Object,"create"),Li=Ri});function Vi(){this.__data__=Li?Li(null):{},this.size=0}var qi,Hi=k(()=>{Ui(),qi=Vi});function Wi(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Zi,Ki=k(()=>{Zi=Wi});function Gi(e){var t=this.__data__;if(Li){var n=t[e];return n===Xi?void 0:n}return Yi.call(t,e)?t[e]:void 0}var Xi,$i,Yi,Ji,Qi=k(()=>{Ui(),Xi="__lodash_hash_undefined__",$i=Object.prototype,Yi=$i.hasOwnProperty,Ji=Gi});function ea(e){var t=this.__data__;return Li?void 0!==t[e]:na.call(t,e)}var ta,na,ra,ia=k(()=>{Ui(),ta=Object.prototype,na=ta.hasOwnProperty,ra=ea});function aa(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Li&&void 0===t?oa:t,this}var oa,sa,la=k(()=>{Ui(),oa="__lodash_hash_undefined__",sa=aa});function ua(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var ca,da=k(()=>{Hi(),Ki(),Qi(),ia(),la(),ua.prototype.clear=qi,ua.prototype.delete=Zi,ua.prototype.get=Ji,ua.prototype.has=ra,ua.prototype.set=sa,ca=ua});function ha(){this.__data__=[],this.size=0}var fa,pa=k(()=>{fa=ha});function ma(e,t){for(var n=e.length;n--;)if(er(e[n][0],t))return n;return-1}var ga,ya=k(()=>{tr(),ga=ma});function va(e){var t=this.__data__,n=ga(t,e);return!(n<0)&&(n==t.length-1?t.pop():ba.call(t,n,1),--this.size,!0)}var _a,ba,xa,wa=k(()=>{ya(),_a=Array.prototype,ba=_a.splice,xa=va});function ka(e){var t=this.__data__,n=ga(t,e);return n<0?void 0:t[n][1]}var Sa,Ea=k(()=>{ya(),Sa=ka});function Ca(e){return ga(this.__data__,e)>-1}var Pa,Da=k(()=>{ya(),Pa=Ca});function Ia(e,t){var n=this.__data__,r=ga(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var Ta,Aa=k(()=>{ya(),Ta=Ia});function za(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var Oa,Fa,Ma,ja=k(()=>{pa(),wa(),Ea(),Da(),Aa(),za.prototype.clear=fa,za.prototype.delete=xa,za.prototype.get=Sa,za.prototype.has=Pa,za.prototype.set=Ta,Oa=za}),Ba=k(()=>{tn(),ie(),Fa=Jt(Q,"Map"),Ma=Fa});function Ra(){this.size=0,this.__data__={hash:new ca,map:new(Ma||Oa),string:new ca}}var La,Na=k(()=>{da(),ja(),Ba(),La=Ra});function Ua(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}var Va,qa=k(()=>{Va=Ua});function Ha(e,t){var n=e.__data__;return Va(t)?n["string"==typeof t?"string":"hash"]:n.map}var Wa,Za=k(()=>{qa(),Wa=Ha});function Ka(e){var t=Wa(this,e).delete(e);return this.size-=t?1:0,t}var Ga,Xa=k(()=>{Za(),Ga=Ka});function $a(e){return Wa(this,e).get(e)}var Ya,Ja=k(()=>{Za(),Ya=$a});function Qa(e){return Wa(this,e).has(e)}var eo,to=k(()=>{Za(),eo=Qa});function no(e,t){var n=Wa(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var ro,io=k(()=>{Za(),ro=no});function ao(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}var oo,so=k(()=>{Na(),Xa(),Ja(),to(),io(),ao.prototype.clear=La,ao.prototype.delete=Ga,ao.prototype.get=Ya,ao.prototype.has=eo,ao.prototype.set=ro,oo=ao});function lo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(uo);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(lo.Cache||oo),n}var uo,co,ho=k(()=>{so(),uo="Expected a function",lo.Cache=oo,co=lo});function fo(e){var t=co(e,function(e){return n.size===po&&n.clear(),e}),n=t.cache;return t}var po,mo,go,yo,vo,_o,bo=k(()=>{ho(),po=500,mo=fo}),xo=k(()=>{bo(),go=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yo=/\\(\\)?/g,vo=mo(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(go,function(e,n,r,i){t.push(r?i.replace(yo,"$1"):n||e)}),t}),_o=vo});function wo(e){return null==e?"":Ue(e)}var ko,So=k(()=>{Ve(),ko=wo});function Eo(e,t){return Fe(e)?e:Bi(e,t)?[e]:_o(ko(e))}var Co,Po=k(()=>{je(),Ni(),xo(),So(),Co=Eo});function Do(e){if("string"==typeof e||Ie(e))return e;var t=e+"";return"0"==t&&1/e==-Io?"-0":t}var Io,To,Ao=k(()=>{Te(),Io=1/0,To=Do});function zo(e,t){for(var n=0,r=(t=Co(t,e)).length;null!=e&&n<r;)e=e[To(t[n++])];return n&&n==r?e:void 0}var Oo,Fo=k(()=>{Po(),Ao(),Oo=zo});function Mo(e,t,n){var r=null==e?void 0:Oo(e,t);return void 0===r?n:r}var jo,Bo=k(()=>{Fo(),jo=Mo});function Ro(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var Lo,No=k(()=>{Lo=Ro});function Uo(e){return Fe(e)||Rr(e)||!!(Vo&&e&&e[Vo])}var Vo,qo,Ho=k(()=>{ae(),Nr(),je(),Vo=te?te.isConcatSpreadable:void 0,qo=Uo});function Wo(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=qo),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?Wo(s,t-1,n,r,i):Lo(i,s):r||(i[i.length]=s)}return i}var Zo,Ko,Go,Xo=k(()=>{No(),Ho(),Zo=Wo}),$o=k(()=>{Si(),Ko=xi(Object.getPrototypeOf,Object),Go=Ko});function Yo(e){if(!Ee(e)||we(e)!=Jo)return!1;var t=Go(e);if(null===t)return!0;var n=ns.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&ts.call(n)==rs}var Jo,Qo,es,ts,ns,rs,is,as=k(()=>{ke(),$o(),Ce(),Jo="[object Object]",Qo=Function.prototype,es=Object.prototype,ts=Qo.toString,ns=es.hasOwnProperty,rs=ts.call(Object),is=Yo});function os(e){var t=Math[e];return function(e,n){if(e=ot(e),(n=null==n?0:ls(pt(n),292))&&ss(e)){var r=(ko(e)+"e").split("e"),i=t(r[0]+"e"+(+r[1]+n));return+((r=(ko(i)+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var ss,ls,us,cs=k(()=>{ie(),mt(),st(),So(),ss=Q.isFinite,ls=Math.min,us=os});function ds(e,t,n){return e===e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}var hs,fs=k(()=>{hs=ds});function ps(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ot(n))===n?n:0),void 0!==t&&(t=(t=ot(t))===t?t:0),hs(ot(e),t,n)}var ms,gs=k(()=>{fs(),st(),ms=ps});function ys(){this.__data__=new Oa,this.size=0}var vs,_s=k(()=>{ja(),vs=ys});function bs(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var xs,ws=k(()=>{xs=bs});function ks(e){return this.__data__.get(e)}var Ss,Es=k(()=>{Ss=ks});function Cs(e){return this.__data__.has(e)}var Ps,Ds=k(()=>{Ps=Cs});function Is(e,t){var n=this.__data__;if(n instanceof Oa){var r=n.__data__;if(!Ma||r.length<Ts-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new oo(r)}return n.set(e,t),this.size=n.size,this}var Ts,As,zs=k(()=>{ja(),Ba(),so(),Ts=200,As=Is});function Os(e){var t=this.__data__=new Oa(e);this.size=t.size}var Fs,Ms=k(()=>{ja(),_s(),ws(),Es(),Ds(),zs(),Os.prototype.clear=vs,Os.prototype.delete=xs,Os.prototype.get=Ss,Os.prototype.has=Ps,Os.prototype.set=As,Fs=Os});function js(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}var Bs,Rs=k(()=>{Bs=js});function Ls(){return[]}var Ns,Us,Vs,qs,Hs,Ws=k(()=>{Ns=Ls}),Zs=k(()=>{Rs(),Ws(),Us=Object.prototype,Vs=Us.propertyIsEnumerable,qs=Object.getOwnPropertySymbols,Hs=qs?function(e){return null==e?[]:(e=Object(e),Bs(qs(e),function(t){return Vs.call(e,t)}))}:Ns});function Ks(e,t,n){var r=t(e);return Fe(e)?r:Lo(r,n(e))}var Gs,Xs=k(()=>{No(),je(),Gs=Ks});function $s(e){return Gs(e,zi,Hs)}var Ys,Js,Qs,el,tl,nl,rl,il,al,ol,sl,ll,ul,cl,dl,hl,fl,pl,ml,gl,yl,vl=k(()=>{Xs(),Zs(),Oi(),Ys=$s}),_l=k(()=>{tn(),ie(),Js=Jt(Q,"DataView"),Qs=Js}),bl=k(()=>{tn(),ie(),el=Jt(Q,"Promise"),tl=el}),xl=k(()=>{tn(),ie(),nl=Jt(Q,"Set"),rl=nl}),wl=k(()=>{_l(),Ba(),bl(),xl(),nn(),ke(),Bt(),il="[object Map]",al="[object Promise]",ol="[object Set]",sl="[object WeakMap]",ll="[object DataView]",ul=jt(Qs),cl=jt(Ma),dl=jt(tl),hl=jt(rl),fl=jt(en),pl=we,(Qs&&pl(new Qs(new ArrayBuffer(1)))!=ll||Ma&&pl(new Ma)!=il||tl&&pl(tl.resolve())!=al||rl&&pl(new rl)!=ol||en&&pl(new en)!=sl)&&(pl=function(e){var t=we(e),n="[object Object]"==t?e.constructor:void 0,r=n?jt(n):"";if(r)switch(r){case ul:return ll;case cl:return il;case dl:return al;case hl:return ol;case fl:return sl}return t}),ml=pl}),kl=k(()=>{ie(),gl=Q.Uint8Array,yl=gl});function Sl(e){return this.__data__.set(e,El),this}var El,Cl,Pl=k(()=>{El="__lodash_hash_undefined__",Cl=Sl});function Dl(e){return this.__data__.has(e)}var Il,Tl=k(()=>{Il=Dl});function Al(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new oo;++t<n;)this.add(e[t])}var zl,Ol=k(()=>{so(),Pl(),Tl(),Al.prototype.add=Al.prototype.push=Cl,Al.prototype.has=Il,zl=Al});function Fl(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Ml,jl=k(()=>{Ml=Fl});function Bl(e,t){return e.has(t)}var Rl,Ll=k(()=>{Rl=Bl});function Nl(e,t,n,r,i,a){var o=n&Ul,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,f=n&Vl?new zl:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var p=e[d],m=t[d];if(r)var g=o?r(m,p,d,t,e,a):r(p,m,d,e,t,a);if(void 0!==g){if(g)continue;h=!1;break}if(f){if(!Ml(t,function(e,t){if(!Rl(f,t)&&(p===e||i(p,e,n,r,a)))return f.push(t)})){h=!1;break}}else if(p!==m&&!i(p,m,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}var Ul,Vl,ql,Hl=k(()=>{Ol(),jl(),Ll(),Ul=1,Vl=2,ql=Nl});function Wl(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}var Zl,Kl=k(()=>{Zl=Wl});function Gl(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}var Xl,$l=k(()=>{Xl=Gl});function Yl(e,t,n,r,i,a,o){switch(n){case cu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case uu:return!(e.byteLength!=t.byteLength||!a(new yl(e),new yl(t)));case eu:case tu:case iu:return er(+e,+t);case nu:return e.name==t.name&&e.message==t.message;case au:case su:return e==t+"";case ru:var s=Zl;case ou:var l=r&Jl;if(s||(s=Xl),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;r|=Ql,o.set(e,t);var c=ql(s(e),s(t),r,i,a,o);return o.delete(e),c;case lu:if(hu)return hu.call(e)==hu.call(t)}return!1}var Jl,Ql,eu,tu,nu,ru,iu,au,ou,su,lu,uu,cu,du,hu,fu,pu=k(()=>{ae(),kl(),tr(),Hl(),Kl(),$l(),Jl=1,Ql=2,eu="[object Boolean]",tu="[object Date]",nu="[object Error]",ru="[object Map]",iu="[object Number]",au="[object RegExp]",ou="[object Set]",su="[object String]",lu="[object Symbol]",uu="[object ArrayBuffer]",cu="[object DataView]",du=te?te.prototype:void 0,hu=du?du.valueOf:void 0,fu=Yl});function mu(e,t,n,r,i,a){var o=n&gu,s=Ys(e),l=s.length;if(l!=Ys(t).length&&!o)return!1;for(var u=l;u--;){var c=s[u];if(!(o?c in t:vu.call(t,c)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var f=!0;a.set(e,t),a.set(t,e);for(var p=o;++u<l;){var m=e[c=s[u]],g=t[c];if(r)var y=o?r(g,m,c,t,e,a):r(m,g,c,e,t,a);if(!(void 0===y?m===g||i(m,g,n,r,a):y)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=e.constructor,_=t.constructor;v!=_&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _)&&(f=!1)}return a.delete(e),a.delete(t),f}var gu,yu,vu,_u,bu=k(()=>{vl(),gu=1,yu=Object.prototype,vu=yu.hasOwnProperty,_u=mu});function xu(e,t,n,r,i,a){var o=Fe(e),s=Fe(t),l=o?Su:ml(e),u=s?Su:ml(t),c=(l=l==ku?Eu:l)==Eu,d=(u=u==ku?Eu:u)==Eu,h=l==u;if(h&&Gr(e)){if(!Gr(t))return!1;o=!0,c=!1}if(h&&!c)return a||(a=new Fs),o||di(e)?ql(e,t,n,r,i,a):fu(e,t,l,n,r,i,a);if(!(n&wu)){var f=c&&Pu.call(e,"__wrapped__"),p=d&&Pu.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return a||(a=new Fs),i(m,g,n,r,a)}}return!!h&&(a||(a=new Fs),_u(e,t,n,r,i,a))}var wu,ku,Su,Eu,Cu,Pu,Du,Iu=k(()=>{Ms(),Hl(),pu(),bu(),wl(),je(),$r(),pi(),wu=1,ku="[object Arguments]",Su="[object Array]",Eu="[object Object]",Cu=Object.prototype,Pu=Cu.hasOwnProperty,Du=xu});function Tu(e,t,n,r,i){return e===t||(null==e||null==t||!Ee(e)&&!Ee(t)?e!==e&&t!==t:Du(e,t,n,r,Tu,i))}var Au,zu=k(()=>{Iu(),Ce(),Au=Tu});function Ou(e,t,n,r){var i=n.length,a=i,o=!r;if(null==e)return!a;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var l=(s=n[i])[0],u=e[l],c=s[1];if(o&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new Fs;if(r)var h=r(u,c,l,e,t,d);if(!(void 0===h?Au(c,u,Fu|Mu,r,d):h))return!1}}return!0}var Fu,Mu,ju,Bu=k(()=>{Ms(),zu(),Fu=1,Mu=2,ju=Ou});function Ru(e){return e===e&&!Je(e)}var Lu,Nu=k(()=>{Qe(),Lu=Ru});function Uu(e){for(var t=zi(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Lu(i)]}return t}var Vu,qu=k(()=>{Nu(),Oi(),Vu=Uu});function Hu(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}var Wu,Zu=k(()=>{Wu=Hu});function Ku(e){var t=Vu(e);return 1==t.length&&t[0][2]?Wu(t[0][0],t[0][1]):function(n){return n===e||ju(n,e,t)}}var Gu,Xu=k(()=>{Bu(),qu(),Zu(),Gu=Ku});function $u(e,t){return null!=e&&t in Object(e)}var Yu,Ju=k(()=>{Yu=$u});function Qu(e,t,n){for(var r=-1,i=(t=Co(t,e)).length,a=!1;++r<i;){var o=To(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&gr(i)&&Gn(o,i)&&(Fe(e)||Rr(e))}var ec,tc=k(()=>{Po(),Nr(),je(),Xn(),yr(),Ao(),ec=Qu});function nc(e,t){return null!=e&&ec(e,t,Yu)}var rc,ic=k(()=>{Ju(),tc(),rc=nc});function ac(e,t){return Bi(e)&&Lu(t)?Wu(To(e),t):function(n){var r=jo(n,e);return void 0===r&&r===t?rc(n,e):Au(t,r,oc|sc)}}var oc,sc,lc,uc=k(()=>{zu(),Bo(),ic(),Ni(),Nu(),Zu(),Ao(),oc=1,sc=2,lc=ac});function cc(e){return function(t){return null==t?void 0:t[e]}}var dc,hc=k(()=>{dc=cc});function fc(e){return function(t){return Oo(t,e)}}var pc,mc=k(()=>{Fo(),pc=fc});function gc(e){return Bi(e)?dc(To(e)):pc(e)}var yc,vc=k(()=>{hc(),mc(),Ni(),Ao(),yc=gc});function _c(e){return"function"==typeof e?e:null==e?yt:"object"==typeof e?Fe(e)?lc(e[0],e[1]):Gu(e):yc(e)}var bc,xc=k(()=>{Xu(),uc(),vt(),je(),vc(),bc=_c});function wc(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}var kc,Sc=k(()=>{kc=wc});function Ec(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===n(a[l],l,a))break}return t}}var Cc,Pc,Dc,Ic=k(()=>{Cc=Ec}),Tc=k(()=>{Ic(),Pc=Cc(),Dc=Pc});function Ac(e,t){return e&&Dc(e,t,zi)}var zc,Oc=k(()=>{Tc(),Oi(),zc=Ac});function Fc(e,t){return function(n,r){if(null==n)return n;if(!_r(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=Object(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}var Mc,jc,Bc,Rc=k(()=>{br(),Mc=Fc}),Lc=k(()=>{Oc(),Rc(),jc=Mc(zc),Bc=jc});function Nc(e,t,n,r){return Bc(e,function(e,i,a){t(r,e,n(e),a)}),r}var Uc,Vc=k(()=>{Lc(),Uc=Nc});function qc(e,t){return function(n,r){var i=Fe(n)?kc:Uc,a=t?t():{};return i(n,e,bc(r,2),a)}}var Hc,Wc,Zc=k(()=>{Sc(),Vc(),xc(),je(),Hc=qc}),Kc=k(()=>{ie(),Wc=function(){return Q.Date.now()}});function Gc(e,t,n){var r,i,a,o,s,l,u=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(Xc);function f(t){var n=r,a=i;return r=i=void 0,u=t,o=e.apply(a,n)}function p(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=a}function m(){var e=Wc();if(p(e))return g(e);s=setTimeout(m,function(e){var n=t-(e-l);return d?Yc(n,a-(e-u)):n}(e))}function g(e){return s=void 0,h&&r?f(e):(r=i=void 0,o)}function y(){var e=Wc(),n=p(e);if(r=arguments,i=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(m,t),c?f(e):o}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),f(l)}return void 0===s&&(s=setTimeout(m,t)),o}return t=ot(t)||0,Je(n)&&(c=!!n.leading,a=(d="maxWait"in n)?$c(ot(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=l=i=s=void 0},y.flush=function(){return void 0===s?o:g(Wc())},y}var Xc,$c,Yc,Jc,Qc=k(()=>{Qe(),Kc(),st(),Xc="Expected a function",$c=Math.max,Yc=Math.min,Jc=Gc});function ed(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}var td,nd=k(()=>{td=ed});function rd(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var id,ad=k(()=>{id=rd});function od(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:pt(n);return i<0&&(i=sd(r+i,0)),An(e,bc(t,3),i)}var sd,ld,ud=k(()=>{zn(),xc(),mt(),sd=Math.max,ld=od});function cd(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return void 0!==n&&(i=pt(n),i=n<0?dd(r+i,0):hd(i,r-1)),An(e,bc(t,3),i,!0)}var dd,hd,fd,pd=k(()=>{zn(),xc(),mt(),dd=Math.max,hd=Math.min,fd=cd});function md(e,t){var n=-1,r=_r(e)?Array(e.length):[];return Bc(e,function(e,i,a){r[++n]=t(e,i,a)}),r}var gd,yd=k(()=>{Lc(),br(),gd=md});function vd(e,t,n){return e>=bd(t,n)&&e<_d(t,n)}var _d,bd,xd,wd=k(()=>{_d=Math.max,bd=Math.min,xd=vd});function kd(e,t,n){return t=dt(t),void 0===n?(n=t,t=0):n=dt(n),e=ot(e),xd(e,t,n)}var Sd,Ed=k(()=>{wd(),ht(),st(),Sd=kd});function Cd(e){return"number"==typeof e&&e==pt(e)}var Pd,Dd,Id,Td=k(()=>{mt(),Pd=Cd}),Ad=k(()=>{Jn(),Zc(),Dd=Hc(function(e,t,n){Yn(e,n,t)}),Id=Dd});function zd(e,t){var n={};return t=bc(t,3),zc(e,function(e,r,i){Yn(n,r,t(e,r,i))}),n}var Od,Fd=k(()=>{Jn(),Oc(),xc(),Od=zd});function Md(e,t,n,r){if(!Je(e))return e;for(var i=-1,a=(t=Co(t,e)).length,o=a-1,s=e;null!=s&&++i<a;){var l=To(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=o){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=Je(c)?c:Gn(t[i+1])?[]:{})}ar(s,l,u),s=s[l]}return e}var jd,Bd=k(()=>{or(),Po(),Xn(),Qe(),Ao(),jd=Md});function Rd(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var Ld,Nd=k(()=>{Ld=Rd});function Ud(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e===e,a=Ie(e),o=void 0!==t,s=null===t,l=t===t,u=Ie(t);if(!s&&!u&&!a&&e>t||a&&o&&l&&!s&&!u||r&&o&&l||!n&&l||!i)return 1;if(!r&&!a&&!u&&e<t||u&&n&&i&&!r&&!a||s&&n&&i||!o&&i||!l)return-1}return 0}var Vd,qd=k(()=>{Te(),Vd=Ud});function Hd(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var l=Vd(i[r],a[r]);if(l)return r>=s?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}var Wd,Zd=k(()=>{qd(),Wd=Hd});function Kd(e,t,n){t=t.length?ze(t,function(e){return Fe(e)?function(t){return Oo(t,1===e.length?e[0]:e)}:e}):[yt];var r=-1;t=ze(t,ni(bc));var i=gd(e,function(e,n,i){return{criteria:ze(t,function(t){return t(e)}),index:++r,value:e}});return Ld(i,function(e,t){return Wd(e,t,n)})}var Gd,Xd=k(()=>{Me(),Fo(),xc(),yd(),Nd(),hi(),Zd(),vt(),je(),Gd=Kd});function $d(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}var Yd,Jd=k(()=>{Yd=$d});function Qd(e,t,n,r){var i=r?Yd:Nn,a=-1,o=t.length,s=e;for(e===t&&(t=dn(t)),n&&(s=ze(e,ni(n)));++a<o;)for(var l=0,u=t[a],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&th.call(s,l,1),th.call(e,l,1);return e}var eh,th,nh,rh=k(()=>{Me(),Un(),Jd(),hi(),hn(),eh=Array.prototype,th=eh.splice,nh=Qd});function ih(e,t){return e&&e.length&&t&&t.length?nh(e,t):e}var ah,oh,sh,lh,uh,ch=k(()=>{rh(),ah=ih}),dh=k(()=>{fr(),ch(),oh=hr(ah),sh=oh}),hh=k(()=>{cs(),lh=us("round"),uh=lh});function fh(e,t,n){return null==e?e:jd(e,t,n)}var ph,mh,gh,yh,vh,_h,bh=k(()=>{Bd(),ph=fh}),xh=k(()=>{Xo(),Xd(),fr(),kr(),mh=hr(function(e,t){if(null==e)return[];var n=t.length;return n>1&&wr(e,t[0],t[1])?t=[]:n>2&&wr(t[0],t[1],t[2])&&(t=[t[0]]),Gd(e,Zo(t,1),[])}),gh=mh}),wh=k(()=>{xl(),un(),$l(),yh=1/0,vh=rl&&1/Xl(new rl([,-0]))[1]==yh?function(e){return new rl(e)}:ln,_h=vh});function kh(e,t,n){var r=-1,i=qn,a=e.length,o=!0,s=[],l=s;if(n)o=!1,i=td;else if(a>=Sh){var u=t?null:_h(e);if(u)return Xl(u);o=!1,i=Rl,l=new zl}else l=t?[]:s;e:for(;++r<a;){var c=e[r],d=t?t(c):c;if(c=n||0!==c?c:0,o&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;t&&l.push(d),s.push(c)}else i(l,d,n)||(l!==s&&l.push(d),s.push(c))}return s}var Sh,Eh,Ch=k(()=>{Ol(),Hn(),nd(),Ll(),wh(),$l(),Sh=200,Eh=kh});function Ph(e){return e&&e.length?Eh(e):[]}var Dh,Ih=k(()=>{Ch(),Dh=Ph}),Th=k(()=>{gs(),Qc(),ud(),Ed(),Td(),as(),ad(),Fd(),ho(),hh(),Ih()}),Ah=S((e,t)=>{var r;t.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:n.g):e=>(r||(r=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0))}),zh=S(e=>{var t=Symbol.for("react.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),s=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),h=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}function y(){}function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||f}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var _=v.prototype=new y;_.constructor=v,p(_,g.prototype),_.isPureReactComponent=!0;var b=Array.isArray,x=Object.prototype.hasOwnProperty,w={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,n,r){var i,a={},o=null,s=null;if(null!=n)for(i in void 0!==n.ref&&(s=n.ref),void 0!==n.key&&(o=""+n.key),n)x.call(n,i)&&!k.hasOwnProperty(i)&&(a[i]=n[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:t,type:e,key:o,ref:s,props:a,_owner:w.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===t}var C=/\/+/g;function P(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function D(e,r,i,a,o){var s=typeof e;("undefined"===s||"boolean"===s)&&(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case t:case n:l=!0}}if(l)return o=o(l=e),e=""===a?"."+P(l,0):a,b(o)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),D(o,r,i,"",function(e){return e})):null!=o&&(E(o)&&(o=function(e,n){return{$$typeof:t,type:e.type,key:n,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+e)),r.push(o)),1;if(l=0,a=""===a?".":a+":",b(e))for(var u=0;u<e.length;u++){var c=a+P(s=e[u],u);l+=D(s,r,i,c,o)}else if(c=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"==typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=D(s=s.value,r,i,c=a+P(s,u++),o);else if("object"===s)throw r=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===r?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,n){if(null==e)return e;var r=[],i=0;return D(e,r,"","",function(e){return t.call(n,e,i++)}),r}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){(0===e._status||-1===e._status)&&(e._status=1,e._result=t)},function(t){(0===e._status||-1===e._status)&&(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},z={transition:null},O={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:z,ReactCurrentOwner:w};e.Children={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!E(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},e.Component=g,e.Fragment=r,e.Profiler=a,e.PureComponent=v,e.StrictMode=i,e.Suspense=u,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,e.cloneElement=function(e,n,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=n){if(void 0!==n.ref&&(o=n.ref,s=w.current),void 0!==n.key&&(a=""+n.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in n)x.call(n,u)&&!k.hasOwnProperty(u)&&(i[u]=void 0===n[u]&&void 0!==l?l[u]:n[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:t,type:e.type,key:a,ref:o,props:i,_owner:s}},e.createContext=function(e){return(e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},e.createElement=S,e.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},e.createRef=function(){return{current:null}},e.forwardRef=function(e){return{$$typeof:l,render:e}},e.isValidElement=E,e.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:T}},e.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},e.startTransition=function(e){var t=z.transition;z.transition={};try{e()}finally{z.transition=t}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(e,t){return A.current.useCallback(e,t)},e.useContext=function(e){return A.current.useContext(e)},e.useDebugValue=function(){},e.useDeferredValue=function(e){return A.current.useDeferredValue(e)},e.useEffect=function(e,t){return A.current.useEffect(e,t)},e.useId=function(){return A.current.useId()},e.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},e.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},e.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},e.useMemo=function(e,t){return A.current.useMemo(e,t)},e.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},e.useRef=function(e){return A.current.useRef(e)},e.useState=function(e){return A.current.useState(e)},e.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},e.useTransition=function(){return A.current.useTransition()},e.version="18.2.0"}),Oh=S((e,t)=>{t.exports=zh()}),Fh=S(e=>{function t(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function n(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>i(l,n))u<a&&0>i(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<a&&0>i(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}"object"==typeof performance&&"function"==typeof performance.now?(a=performance,e.unstable_now=function(){return a.now()}):(o=Date,s=o.now(),e.unstable_now=function(){return o.now()-s});var a,o,s,l=[],u=[],c=1,d=null,h=3,f=!1,p=!1,m=!1,g="function"==typeof setTimeout?setTimeout:null,y="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function _(e){for(var i=n(u);null!==i;){if(null===i.callback)r(u);else{if(!(i.startTime<=e))break;r(u),i.sortIndex=i.expirationTime,t(l,i)}i=n(u)}}function b(e){if(m=!1,_(e),!p)if(null!==n(l))p=!0,z(x);else{var t=n(u);null!==t&&O(b,t.startTime-e)}}function x(t,i){p=!1,m&&(m=!1,y(P),P=-1),f=!0;var a=h;try{for(_(i),d=n(l);null!==d&&(!(d.expirationTime>i)||t&&!T());){var o=d.callback;if("function"==typeof o){d.callback=null,h=d.priorityLevel;var s=o(d.expirationTime<=i);i=e.unstable_now(),"function"==typeof s?d.callback=s:d===n(l)&&r(l),_(i)}else r(l);d=n(l)}if(null!==d)var c=!0;else{var g=n(u);null!==g&&O(b,g.startTime-i),c=!1}return c}finally{d=null,h=a,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var w,k,S,E=!1,C=null,P=-1,D=5,I=-1;function T(){return!(e.unstable_now()-I<D)}function A(){if(null!==C){var t=e.unstable_now();I=t;var n=!0;try{n=C(!0,t)}finally{n?w():(E=!1,C=null)}}else E=!1}function z(e){C=e,E||(E=!0,w())}function O(t,n){P=g(function(){t(e.unstable_now())},n)}"function"==typeof v?w=function(){v(A)}:"undefined"!=typeof MessageChannel?(k=new MessageChannel,S=k.port2,k.port1.onmessage=A,w=function(){S.postMessage(null)}):w=function(){g(A,0)},e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,z(x))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var n=h;h=t;try{return e()}finally{h=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=h;h=e;try{return t()}finally{h=n}},e.unstable_scheduleCallback=function(r,i,a){var o=e.unstable_now();switch("object"==typeof a&&null!==a?a="number"==typeof(a=a.delay)&&0<a?o+a:o:a=o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return r={id:c++,callback:i,priorityLevel:r,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(r.sortIndex=a,t(u,r),null===n(l)&&r===n(u)&&(m?(y(P),P=-1):m=!0,O(b,a-o))):(r.sortIndex=s,t(l,r),p||f||(p=!0,z(x))),r},e.unstable_shouldYield=T,e.unstable_wrapCallback=function(e){var t=h;return function(){var n=h;h=t;try{return e.apply(this,arguments)}finally{h=n}}}}),Mh=S((e,t)=>{t.exports=Fh()}),jh=S(e=>{var t=Oh(),n=Mh();function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,a={};function o(e,t){s(e,t),s(e+"Capture",t)}function s(e,t){for(a[e]=t,e=0;e<t.length;e++)i.add(t[e])}var l=!("undefined"==typeof window||"undefined"==typeof window.document||"undefined"==typeof window.document.createElement),u=Object.prototype.hasOwnProperty,c=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},h={};function f(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){p[e]=new f(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];p[t]=new f(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){p[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){p[e]=new f(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){p[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){p[e]=new f(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){p[e]=new f(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){p[e]=new f(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){p[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)});var m=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function y(e,t,n,r){var i=p.hasOwnProperty(t)?p[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"==typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!u.call(h,e)||!u.call(d,e)&&(c.test(e)?h[e]=!0:(d[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(m,g);p[t]=new f(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(m,g);p[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(m,g);p[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){p[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)}),p.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){p[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),b=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var A=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var z=Symbol.iterator;function O(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=z&&e[z]||e["@@iterator"])?e:null}var F,M=Object.assign;function j(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var B=!1;function R(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"==typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function L(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=R(e.type,!1);case 11:return e=R(e.type.render,!1);case 1:return e=R(e.type,!0);default:return""}}function N(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case x:return"Fragment";case b:return"Portal";case k:return"Profiler";case w:return"StrictMode";case P:return"Suspense";case D:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:N(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return N(e(t))}catch(n){}}return null}function U(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N(t);case 8:return t===w?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function V(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!=typeof n&&"function"==typeof n.get&&"function"==typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function W(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Z(e){if("undefined"==typeof(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function G(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=V(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function $(e,t){X(e,t);var n=V(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?J(e,t.type,n):t.hasOwnProperty("defaultValue")&&J(e,t.type,V(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Y(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function J(e,t,n){("number"!==t||Z(e.ownerDocument)!==e)&&(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Q=Array.isArray;function ee(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+V(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function te(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(r(92));if(Q(n)){if(1<n.length)throw Error(r(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:V(n)}}function re(e,t){var n=V(t.value),r=V(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var se,le,ue=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((se=se||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=se.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return le(e,t)})}:le);function ce(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function fe(e,t,n){return null==t||"boolean"==typeof t||""===t?"":n||"number"!=typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function pe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=fe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(de).forEach(function(e){he.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]})});var me=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(me[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(r(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var be=null,xe=null,we=null;function ke(e){if(e=yi(e)){if("function"!=typeof be)throw Error(r(280));var t=e.stateNode;t&&(t=_i(t),be(e.stateNode,e.type,t))}}function Se(e){xe?we?we.push(e):we=[e]:xe=e}function Ee(){if(xe){var e=xe,t=we;if(we=xe=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ce(e,t){return e(t)}function Pe(){}var De=!1;function Ie(e,t,n){if(De)return e(t,n);De=!0;try{return Ce(e,t,n)}finally{De=!1,(null!==xe||null!==we)&&(Pe(),Ee())}}function Te(e,t){var n=e.stateNode;if(null===n)return null;var i=_i(n);if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!=typeof n)throw Error(r(231,t,typeof n));return n}var Ae,ze=!1;if(l)try{Ae={},Object.defineProperty(Ae,"passive",{get:function(){ze=!0}}),window.addEventListener("test",Ae,Ae),window.removeEventListener("test",Ae,Ae)}catch(le){ze=!1}function Oe(e,t,n,r,i,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Fe=!1,Me=null,je=!1,Be=null,Re={onError:function(e){Fe=!0,Me=e}};function Le(e,t,n,r,i,a,o,s,l){Fe=!1,Me=null,Oe.apply(Re,arguments)}function Ne(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{4098&(t=e).flags&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ue(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ve(e){if(Ne(e)!==e)throw Error(r(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ne(e)))throw Error(r(188));return t!==e?null:e}for(var n=e,i=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(i=a.return)){n=i;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ve(a),e;if(o===i)return Ve(a),t;o=o.sibling}throw Error(r(188))}if(n.return!==i.return)n=a,i=o;else{for(var s=!1,l=a.child;l;){if(l===n){s=!0,n=a,i=o;break}if(l===i){s=!0,i=a,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=a;break}if(l===i){s=!0,i=o,n=a;break}l=l.sibling}if(!s)throw Error(r(189))}}if(n.alternate!==i)throw Error(r(190))}if(3!==n.tag)throw Error(r(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var We=n.unstable_scheduleCallback,Ze=n.unstable_cancelCallback,Ke=n.unstable_shouldYield,Ge=n.unstable_requestPaint,Xe=n.unstable_now,$e=n.unstable_getCurrentPriorityLevel,Ye=n.unstable_ImmediatePriority,Je=n.unstable_UserBlockingPriority,Qe=n.unstable_NormalPriority,et=n.unstable_LowPriority,tt=n.unstable_IdlePriority,nt=null,rt=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/ot|0)|0},at=Math.log,ot=Math.LN2;var st=64,lt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ct(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=ut(s):0!==(a&=o)&&(r=ut(a))}else 0!==(o=n&~i)?r=ut(o):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&!(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(4&r&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-it(t)),r|=e[n],t&=~i;return r}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function ft(){var e=st;return!(4194240&(st<<=1))&&(st=64),e}function pt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function mt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var yt=0;function vt(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var _t,bt,xt,wt,kt,St=!1,Et=[],Ct=null,Pt=null,Dt=null,It=new Map,Tt=new Map,At=[],zt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ot(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tt.delete(t.pointerId)}}function Ft(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&bt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=gi(e.target);if(null!==t){var n=Ne(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ue(n)))return e.blockedOn=t,void kt(e.priority,function(){xt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=yi(n))&&bt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Bt(e,t,n){jt(e)&&n.delete(t)}function Rt(){St=!1,null!==Ct&&jt(Ct)&&(Ct=null),null!==Pt&&jt(Pt)&&(Pt=null),null!==Dt&&jt(Dt)&&(Dt=null),It.forEach(Bt),Tt.forEach(Bt)}function Lt(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,Rt)))}function Nt(e){function t(t){return Lt(t,e)}if(0<Et.length){Lt(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Lt(Ct,e),null!==Pt&&Lt(Pt,e),null!==Dt&&Lt(Dt,e),It.forEach(t),Tt.forEach(t),n=0;n<At.length;n++)(r=At[n]).blockedOn===e&&(r.blockedOn=null);for(;0<At.length&&null===(n=At[0]).blockedOn;)Mt(n),null===n.blockedOn&&At.shift()}var Ut=v.ReactCurrentBatchConfig,Vt=!0;function qt(e,t,n,r){var i=yt,a=Ut.transition;Ut.transition=null;try{yt=1,Wt(e,t,n,r)}finally{yt=i,Ut.transition=a}}function Ht(e,t,n,r){var i=yt,a=Ut.transition;Ut.transition=null;try{yt=4,Wt(e,t,n,r)}finally{yt=i,Ut.transition=a}}function Wt(e,t,n,r){if(Vt){var i=Kt(e,t,n,r);if(null===i)Vr(e,t,r,Zt,n),Ot(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Ct=Ft(Ct,e,t,n,r,i),!0;case"dragenter":return Pt=Ft(Pt,e,t,n,r,i),!0;case"mouseover":return Dt=Ft(Dt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return It.set(a,Ft(It.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,Tt.set(a,Ft(Tt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Ot(e,r),4&t&&-1<zt.indexOf(e)){for(;null!==i;){var a=yi(i);if(null!==a&&_t(a),null===(a=Kt(e,t,n,r))&&Vr(e,t,r,Zt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Vr(e,t,r,null,n)}}var Zt=null;function Kt(e,t,n,r){if(Zt=null,null!==(e=gi(e=_e(r))))if(null===(t=Ne(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ue(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zt=e,null}function Gt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Ye:return 1;case Je:return 4;case Qe:case et:return 16;case tt:return 536870912;default:return 16}default:return 16}}var Xt=null,$t=null,Yt=null;function Jt(){if(Yt)return Yt;var e,t,n=$t,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Yt=i.slice(e,1<t?1-t:void 0)}function Qt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function en(){return!0}function tn(){return!1}function nn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?en:tn,this.isPropagationStopped=tn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=en)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=en)},persist:function(){},isPersistent:en}),t}var rn,an,on,sn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=nn(sn),un=M({},sn,{view:0,detail:0}),cn=nn(un),dn=M({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==on&&(on&&"mousemove"===e.type?(rn=e.screenX-on.screenX,an=e.screenY-on.screenY):an=rn=0,on=e),rn)},movementY:function(e){return"movementY"in e?e.movementY:an}}),hn=nn(dn),fn=nn(M({},dn,{dataTransfer:0})),pn=nn(M({},un,{relatedTarget:0})),mn=nn(M({},sn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=M({},sn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yn=nn(gn),vn=nn(M({},sn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=xn[e])&&!!t[e]}function kn(){return wn}var Sn=M({},un,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?bn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?Qt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=nn(Sn),Cn=nn(M({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Pn=nn(M({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Dn=nn(M({},sn,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=M({},dn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tn=nn(In),An=[9,13,27,32],zn=l&&"CompositionEvent"in window,On=null;l&&"documentMode"in document&&(On=document.documentMode);var Fn=l&&"TextEvent"in window&&!On,Mn=l&&(!zn||On&&8<On&&11>=On),jn=String.fromCharCode(32),Bn=!1;function Rn(e,t){switch(e){case"keyup":return-1!==An.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ln(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Nn=!1;var Un={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Un[e.type]:"textarea"===t}function qn(e,t,n,r){Se(r),0<(t=Hr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Wn=null;function Zn(e){jr(e,0)}function Kn(e){if(W(vi(e)))return e}function Gn(e,t){if("change"===e)return t}var Xn,$n,Yn,Jn=!1;function Qn(){Hn&&(Hn.detachEvent("onpropertychange",er),Wn=Hn=null)}function er(e){if("value"===e.propertyName&&Kn(Wn)){var t=[];qn(t,Wn,e,_e(e)),Ie(Zn,t)}}function tr(e,t,n){"focusin"===e?(Qn(),Wn=n,(Hn=t).attachEvent("onpropertychange",er)):"focusout"===e&&Qn()}function nr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(Wn)}function rr(e,t){if("click"===e)return Kn(t)}function ir(e,t){if("input"===e||"change"===e)return Kn(t)}l&&(l?(($n="oninput"in document)||((Yn=document.createElement("div")).setAttribute("oninput","return;"),$n="function"==typeof Yn.oninput),Xn=$n):Xn=!1,Jn=Xn&&(!document.documentMode||9<document.documentMode));var ar="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function or(e,t){if(ar(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!u.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function sr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=sr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=sr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function cr(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var n="string"==typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Z((e=t.contentWindow).document)}return t}function dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=cr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&dr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=lr(n,a);var o=lr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fr=l&&"documentMode"in document&&11>=document.documentMode,pr=null,mr=null,gr=null,yr=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;yr||null==pr||pr!==Z(r)||("selectionStart"in(r=pr)&&dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&or(gr,r)||(gr=r,0<(r=Hr(mr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=pr)))}function _r(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var br={animationend:_r("Animation","AnimationEnd"),animationiteration:_r("Animation","AnimationIteration"),animationstart:_r("Animation","AnimationStart"),transitionend:_r("Transition","TransitionEnd")},xr={},wr={};function kr(e){if(xr[e])return xr[e];if(!br[e])return e;var t,n=br[e];for(t in n)if(n.hasOwnProperty(t)&&t in wr)return xr[e]=n[t];return e}l&&(wr=document.createElement("div").style,"AnimationEvent"in window||(delete br.animationend.animation,delete br.animationiteration.animation,delete br.animationstart.animation),"TransitionEvent"in window||delete br.transitionend.transition);var Sr,Er,Cr=kr("animationend"),Pr=kr("animationiteration"),Dr=kr("animationstart"),Ir=kr("transitionend"),Tr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(e,t){Tr.set(e,t),o(t,[e])}for(Er=0;Er<Ar.length;Er++)zr((Sr=Ar[Er]).toLowerCase(),"on"+(Sr[0].toUpperCase()+Sr.slice(1)));zr(Cr,"onAnimationEnd"),zr(Pr,"onAnimationIteration"),zr(Dr,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(Ir,"onTransitionEnd"),s("onMouseEnter",["mouseout","mouseover"]),s("onMouseLeave",["mouseout","mouseover"]),s("onPointerEnter",["pointerout","pointerover"]),s("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Or="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Or));function Mr(e,t,n){var i=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,i,a,o,s,l,u){if(Le.apply(this,arguments),Fe){if(!Fe)throw Error(r(198));var c=Me;Fe=!1,Me=null,je||(je=!0,Be=c)}}(i,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;Mr(i,s,u),a=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,u=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;Mr(i,s,u),a=l}}}if(je)throw e=Be,je=!1,Be=null,e}function Br(e,t){var n=t[fi];void 0===n&&(n=t[fi]=new Set);var r=e+"__bubble";n.has(r)||(Ur(t,e,2,!1),n.add(r))}function Rr(e,t,n){var r=0;t&&(r|=4),Ur(n,e,r,t)}var Lr="_reactListening"+Math.random().toString(36).slice(2);function Nr(e){if(!e[Lr]){e[Lr]=!0,i.forEach(function(t){"selectionchange"!==t&&(Fr.has(t)||Rr(t,!1,e),Rr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Lr]||(t[Lr]=!0,Rr("selectionchange",!1,t))}}function Ur(e,t,n,r){switch(Gt(t)){case 1:var i=qt;break;case 4:i=Ht;break;default:i=Wt}n=i.bind(null,t,n,e),i=void 0,!ze||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Vr(e,t,n,r,i){var a=r;if(!(1&t)&&!(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=gi(s)))return;if(5===(l=o.tag)||6===l){r=a=o;continue e}s=s.parentNode}}r=r.return}Ie(function(){var r=a,i=_e(n),o=[];e:{var s=Tr.get(e);if(void 0!==s){var l=ln,u=e;switch(e){case"keypress":if(0===Qt(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":u="focus",l=pn;break;case"focusout":u="blur",l=pn;break;case"beforeblur":case"afterblur":l=pn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Pn;break;case Cr:case Pr:case Dr:l=mn;break;case Ir:l=Dn;break;case"scroll":l=cn;break;case"wheel":l=Tn;break;case"copy":case"cut":case"paste":l=yn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Te(p,h))&&c.push(qr(p,m,f)))),d)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,i),o.push({event:s,listeners:c}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===ve||!(u=n.relatedTarget||n.fromElement)||!gi(u)&&!u[hi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?gi(u):null)&&(u!==(d=Ne(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=hn,m="onMouseLeave",h="onMouseEnter",p="mouse",("pointerout"===e||"pointerover"===e)&&(c=Cn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?s:vi(l),f=null==u?s:vi(u),(s=new c(m,p+"leave",l,n,i)).target=d,s.relatedTarget=f,m=null,gi(i)===r&&((c=new c(h,p+"enter",u,n,i)).target=f,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,p=0,f=c=l;f;f=Wr(f))p++;for(f=0,m=h;m;m=Wr(m))f++;for(;0<p-f;)c=Wr(c),p--;for(;0<f-p;)h=Wr(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Wr(c),h=Wr(h)}c=null}else c=null;null!==l&&Zr(o,s,l,c,!1),null!==u&&null!==d&&Zr(o,d,u,c,!0)}if("select"===(l=(s=r?vi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=Gn;else if(Vn(s))if(Jn)g=ir;else{g=nr;var y=tr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=rr);switch(g&&(g=g(e,r))?qn(o,g,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&J(s,"number",s.value)),y=r?vi(r):window,e){case"focusin":(Vn(y)||"true"===y.contentEditable)&&(pr=y,mr=r,gr=null);break;case"focusout":gr=mr=pr=null;break;case"mousedown":yr=!0;break;case"contextmenu":case"mouseup":case"dragend":yr=!1,vr(o,n,i);break;case"selectionchange":if(fr)break;case"keydown":case"keyup":vr(o,n,i)}var v;if(zn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Nn?Rn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Mn&&"ko"!==n.locale&&(Nn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Nn&&(v=Jt()):($t="value"in(Xt=i)?Xt.value:Xt.textContent,Nn=!0)),0<(y=Hr(r,_)).length&&(_=new vn(_,e,null,n,i),o.push({event:_,listeners:y}),v?_.data=v:null!==(v=Ln(n))&&(_.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return Ln(t);case"keypress":return 32!==t.which?null:(Bn=!0,jn);case"textInput":return(e=t.data)===jn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Nn)return"compositionend"===e||!zn&&Rn(e,t)?(e=Jt(),Yt=$t=Xt=null,Nn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new vn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}jr(o,t)})}function qr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=Te(e,n))&&r.unshift(qr(e,a,i)),null!=(a=Te(e,t))&&r.push(qr(e,a,i))),e=e.return}return r}function Wr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Zr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=Te(n,a))&&o.unshift(qr(n,l,s)):i||null!=(l=Te(n,a))&&o.push(qr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Kr=/\r\n?/g,Gr=/\u0000|\uFFFD/g;function Xr(e){return("string"==typeof e?e:""+e).replace(Kr,"\n").replace(Gr,"")}function $r(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(r(425))}function Yr(){}var Jr=null,Qr=null;function ei(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ti="function"==typeof setTimeout?setTimeout:void 0,ni="function"==typeof clearTimeout?clearTimeout:void 0,ri="function"==typeof Promise?Promise:void 0,ii="function"==typeof queueMicrotask?queueMicrotask:"undefined"!=typeof ri?function(e){return ri.resolve(null).then(e).catch(ai)}:ti;function ai(e){setTimeout(function(){throw e})}function oi(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Nt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Nt(t)}function si(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var ui=Math.random().toString(36).slice(2),ci="__reactFiber$"+ui,di="__reactProps$"+ui,hi="__reactContainer$"+ui,fi="__reactEvents$"+ui,pi="__reactListeners$"+ui,mi="__reactHandles$"+ui;function gi(e){var t=e[ci];if(t)return t;for(var n=e.parentNode;n;){if(t=n[hi]||n[ci]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=li(e);null!==e;){if(n=e[ci])return n;e=li(e)}return t}n=(e=n).parentNode}return null}function yi(e){return!(e=e[ci]||e[hi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function _i(e){return e[di]||null}var bi=[],xi=-1;function wi(e){return{current:e}}function ki(e){0>xi||(e.current=bi[xi],bi[xi]=null,xi--)}function Si(e,t){xi++,bi[xi]=e.current,e.current=t}var Ei={},Ci=wi(Ei),Pi=wi(!1),Di=Ei;function Ii(e,t){var n=e.type.contextTypes;if(!n)return Ei;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ti(e){return null!=(e=e.childContextTypes)}function Ai(){ki(Pi),ki(Ci)}function zi(e,t,n){if(Ci.current!==Ei)throw Error(r(168));Si(Ci,t),Si(Pi,n)}function Oi(e,t,n){var i=e.stateNode;if(t=t.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var a in i=i.getChildContext())if(!(a in t))throw Error(r(108,U(e)||"Unknown",a));return M({},n,i)}function Fi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ei,Di=Ci.current,Si(Ci,e),Si(Pi,Pi.current),!0}function Mi(e,t,n){var i=e.stateNode;if(!i)throw Error(r(169));n?(e=Oi(e,t,Di),i.__reactInternalMemoizedMergedChildContext=e,ki(Pi),ki(Ci),Si(Ci,e)):ki(Pi),Si(Pi,n)}var ji=null,Bi=!1,Ri=!1;function Li(e){null===ji?ji=[e]:ji.push(e)}function Ni(){if(!Ri&&null!==ji){Ri=!0;var e=0,t=yt;try{var n=ji;for(yt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ji=null,Bi=!1}catch(i){throw null!==ji&&(ji=ji.slice(e+1)),We(Ye,Ni),i}finally{yt=t,Ri=!1}}return null}var Ui=[],Vi=0,qi=null,Hi=0,Wi=[],Zi=0,Ki=null,Gi=1,Xi="";function $i(e,t){Ui[Vi++]=Hi,Ui[Vi++]=qi,qi=e,Hi=t}function Yi(e,t,n){Wi[Zi++]=Gi,Wi[Zi++]=Xi,Wi[Zi++]=Ki,Ki=e;var r=Gi;e=Xi;var i=32-it(r)-1;r&=~(1<<i),n+=1;var a=32-it(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Gi=1<<32-it(t)+i|n<<i|r,Xi=a+e}else Gi=1<<a|n<<i|r,Xi=e}function Ji(e){null!==e.return&&($i(e,1),Yi(e,1,0))}function Qi(e){for(;e===qi;)qi=Ui[--Vi],Ui[Vi]=null,Hi=Ui[--Vi],Ui[Vi]=null;for(;e===Ki;)Ki=Wi[--Zi],Wi[Zi]=null,Xi=Wi[--Zi],Wi[Zi]=null,Gi=Wi[--Zi],Wi[Zi]=null}var ea=null,ta=null,na=!1,ra=null;function ia(e,t){var n=Tu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function aa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ea=e,ta=si(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ea=e,ta=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ki?{id:Gi,overflow:Xi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ea=e,ta=null,!0);default:return!1}}function oa(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function sa(e){if(na){var t=ta;if(t){var n=t;if(!aa(e,t)){if(oa(e))throw Error(r(418));t=si(n.nextSibling);var i=ea;t&&aa(e,t)?ia(i,n):(e.flags=-4097&e.flags|2,na=!1,ea=e)}}else{if(oa(e))throw Error(r(418));e.flags=-4097&e.flags|2,na=!1,ea=e}}}function la(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ea=e}function ua(e){if(e!==ea)return!1;if(!na)return la(e),na=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ei(e.type,e.memoizedProps)),t&&(t=ta)){if(oa(e))throw ca(),Error(r(418));for(;t;)ia(e,t),t=si(t.nextSibling)}if(la(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ta=si(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ta=null}}else ta=ea?si(e.stateNode.nextSibling):null;return!0}function ca(){for(var e=ta;e;)e=si(e.nextSibling)}function da(){ta=ea=null,na=!1}function ha(e){null===ra?ra=[e]:ra.push(e)}var fa=v.ReactCurrentBatchConfig;function pa(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var ma=wi(null),ga=null,ya=null,va=null;function _a(){va=ya=ga=null}function ba(e){var t=ma.current;ki(ma),e._currentValue=t}function xa(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function wa(e,t){ga=e,va=ya=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.lanes&t&&(vs=!0),e.firstContext=null)}function ka(e){var t=e._currentValue;if(va!==e)if(e={context:e,memoizedValue:t,next:null},null===ya){if(null===ga)throw Error(r(308));ya=e,ga.dependencies={lanes:0,firstContext:e}}else ya=ya.next=e;return t}var Sa=null;function Ea(e){null===Sa?Sa=[e]:Sa.push(e)}function Ca(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ea(t)):(n.next=i.next,i.next=n),t.interleaved=n,Pa(e,r)}function Pa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Da=!1;function Ia(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ta(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Aa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function za(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,2&Pl){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Pa(e,n)}return null===(i=r.interleaved)?(t.next=t,Ea(r)):(t.next=i.next,i.next=t),r.interleaved=t,Pa(e,n)}function Oa(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Fa(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ma(e,t,n,r){var i=e.updateQueue;Da=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===o?a=u:o.next=u,o=l;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==a){var d=i.baseState;for(o=0,c=u=l=null,s=a;;){var h=s.lane,f=s.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(h=t,f=n,m.tag){case 1:if("function"==typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=m.payload)?p.call(f,d,h):p))break e;d=M({},d,h);break e;case 2:Da=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=f,l=d):c=c.next=f,o|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=d}}function ja(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var i=e[t],a=i.callback;if(null!==a){if(i.callback=null,i=n,"function"!=typeof a)throw Error(r(191,a));a.call(i)}}}var Ba=(new t.Component).refs;function Ra(e,t,n,r){n=null==(n=n(r,t=e.memoizedState))?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var La={isMounted:function(e){return!!(e=e._reactInternals)&&Ne(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=eu(e),a=Aa(r,i);a.payload=t,null!=n&&(a.callback=n),null!==(t=za(e,a,i))&&(tu(t,e,i,r),Oa(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=eu(e),a=Aa(r,i);a.tag=1,a.payload=t,null!=n&&(a.callback=n),null!==(t=za(e,a,i))&&(tu(t,e,i,r),Oa(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),r=eu(e),i=Aa(n,r);i.tag=2,null!=t&&(i.callback=t),null!==(t=za(e,i,r))&&(tu(t,e,r,n),Oa(t,e,r))}};function Na(e,t,n,r,i,a,o){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!or(n,r)||!or(i,a))}function Ua(e,t,n){var r=!1,i=Ei,a=t.contextType;return"object"==typeof a&&null!==a?a=ka(a):(i=Ti(t)?Di:Ci.current,a=(r=null!=(r=t.contextTypes))?Ii(e,i):Ei),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=La,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Va(e,t,n,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&La.enqueueReplaceState(t,t.state,null)}function qa(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Ba,Ia(e);var a=t.contextType;"object"==typeof a&&null!==a?i.context=ka(a):(a=Ti(t)?Di:Ci.current,i.context=Ii(e,a)),i.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(Ra(e,t,a,n),i.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(t=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&La.enqueueReplaceState(i,i.state,null),Ma(e,n,i,r),i.state=e.memoizedState),"function"==typeof i.componentDidMount&&(e.flags|=4194308)}function Ha(e,t,n){if(null!==(e=n.ref)&&"function"!=typeof e&&"object"!=typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(r(309));var i=n.stateNode}if(!i)throw Error(r(147,e));var a=i,o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=a.refs;t===Ba&&(t=a.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t)}if("string"!=typeof e)throw Error(r(284));if(!n._owner)throw Error(r(290,e))}return e}function Wa(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Za(e){return(0,e._init)(e._payload)}function Ka(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function i(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=zu(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=ju(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){var i=n.type;return i===x?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===T&&Za(i)===t.type)?((r=a(t,n.props)).ref=Ha(e,t,n),r.return=e,r):((r=Ou(n.type,n.key,n.props,null,e.mode,r)).ref=Ha(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bu(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Fu(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=ju(""+t,e.mode,n)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Ou(t.type,t.key,t.props,null,e.mode,n)).ref=Ha(e,null,t),n.return=e,n;case b:return(t=Bu(t,e.mode,n)).return=e,t;case T:return h(e,(0,t._init)(t._payload),n)}if(Q(t)||O(t))return(t=Fu(t,e.mode,n,null)).return=e,t;Wa(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==i?null:l(e,t,""+n,r);if("object"==typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?u(e,t,n,r):null;case b:return n.key===i?c(e,t,n,r):null;case T:return f(e,t,(i=n._init)(n._payload),r)}if(Q(n)||O(n))return null!==i?null:d(e,t,n,r,null);Wa(e,n)}return null}function p(e,t,n,r,i){if("string"==typeof r&&""!==r||"number"==typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"==typeof r&&null!==r){switch(r.$$typeof){case _:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case b:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case T:return p(e,t,n,(0,r._init)(r._payload),i)}if(Q(r)||O(r))return d(t,e=e.get(n)||null,r,i,null);Wa(t,r)}return null}return function l(u,c,d,m){if("object"==typeof d&&null!==d&&d.type===x&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case _:e:{for(var g=d.key,y=c;null!==y;){if(y.key===g){if((g=d.type)===x){if(7===y.tag){n(u,y.sibling),(c=a(y,d.props.children)).return=u,u=c;break e}}else if(y.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===T&&Za(g)===y.type){n(u,y.sibling),(c=a(y,d.props)).ref=Ha(u,y,d),c.return=u,u=c;break e}n(u,y);break}t(u,y),y=y.sibling}d.type===x?((c=Fu(d.props.children,u.mode,m,d.key)).return=u,u=c):((m=Ou(d.type,d.key,d.props,null,u.mode,m)).ref=Ha(u,c,d),m.return=u,u=m)}return s(u);case b:e:{for(y=d.key;null!==c;){if(c.key===y){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){n(u,c.sibling),(c=a(c,d.children||[])).return=u,u=c;break e}n(u,c);break}t(u,c),c=c.sibling}(c=Bu(d,u.mode,m)).return=u,u=c}return s(u);case T:return l(u,c,(y=d._init)(d._payload),m)}if(Q(d))return function(r,a,s,l){for(var u=null,c=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(r,d,s[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(r,d),a=o(y,a,m),null===c?u=y:c.sibling=y,c=y,d=g}if(m===s.length)return n(r,d),na&&$i(r,m),u;if(null===d){for(;m<s.length;m++)null!==(d=h(r,s[m],l))&&(a=o(d,a,m),null===c?u=d:c.sibling=d,c=d);return na&&$i(r,m),u}for(d=i(r,d);m<s.length;m++)null!==(g=p(d,r,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach(function(e){return t(r,e)}),na&&$i(r,m),u}(u,c,d,m);if(O(d))return function(a,s,l,u){var c=O(l);if("function"!=typeof c)throw Error(r(150));if(null==(l=c.call(l)))throw Error(r(151));for(var d=c=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=f(a,m,v.value,u);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(a,m),s=o(_,s,g),null===d?c=_:d.sibling=_,d=_,m=y}if(v.done)return n(a,m),na&&$i(a,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(a,v.value,u))&&(s=o(v,s,g),null===d?c=v:d.sibling=v,d=v);return na&&$i(a,g),c}for(m=i(a,m);!v.done;g++,v=l.next())null!==(v=p(m,a,g,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=o(v,s,g),null===d?c=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(a,e)}),na&&$i(a,g),c}(u,c,d,m);Wa(u,d)}return"string"==typeof d&&""!==d||"number"==typeof d?(d=""+d,null!==c&&6===c.tag?(n(u,c.sibling),(c=a(c,d)).return=u,u=c):(n(u,c),(c=ju(d,u.mode,m)).return=u,u=c),s(u)):n(u,c)}}var Ga=Ka(!0),Xa=Ka(!1),$a={},Ya=wi($a),Ja=wi($a),Qa=wi($a);function eo(e){if(e===$a)throw Error(r(174));return e}function to(e,t){switch(Si(Qa,t),Si(Ja,e),Si(Ya,$a),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Ya),Si(Ya,t)}function no(){ki(Ya),ki(Ja),ki(Qa)}function ro(e){eo(Qa.current);var t=eo(Ya.current),n=oe(t,e.type);t!==n&&(Si(Ja,e),Si(Ya,n))}function io(e){Ja.current===e&&(ki(Ya),ki(Ja))}var ao=wi(0);function oo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var so=[];function lo(){for(var e=0;e<so.length;e++)so[e]._workInProgressVersionPrimary=null;so.length=0}var uo=v.ReactCurrentDispatcher,co=v.ReactCurrentBatchConfig,ho=0,fo=null,po=null,mo=null,go=!1,yo=!1,vo=0,_o=0;function bo(){throw Error(r(321))}function xo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function wo(e,t,n,i,a,o){if(ho=o,fo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,uo.current=null===e||null===e.memoizedState?as:os,e=n(i,a),yo){o=0;do{if(yo=!1,vo=0,25<=o)throw Error(r(301));o+=1,mo=po=null,t.updateQueue=null,uo.current=ss,e=n(i,a)}while(yo)}if(uo.current=is,t=null!==po&&null!==po.next,ho=0,mo=po=fo=null,go=!1,t)throw Error(r(300));return e}function ko(){var e=0!==vo;return vo=0,e}function So(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mo?fo.memoizedState=mo=e:mo=mo.next=e,mo}function Eo(){if(null===po){var e=fo.alternate;e=null!==e?e.memoizedState:null}else e=po.next;var t=null===mo?fo.memoizedState:mo.next;if(null!==t)mo=t,po=e;else{if(null===e)throw Error(r(310));e={memoizedState:(po=e).memoizedState,baseState:po.baseState,baseQueue:po.baseQueue,queue:po.queue,next:null},null===mo?fo.memoizedState=mo=e:mo=mo.next=e}return mo}function Co(e,t){return"function"==typeof t?t(e):t}function Po(e){var t=Eo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=po,a=i.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}i.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,i=i.baseState;var l=s=null,u=null,c=o;do{var d=c.lane;if((ho&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:e(i,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,s=i):u=u.next=h,fo.lanes|=d,Ml|=d}c=c.next}while(null!==c&&c!==o);null===u?s=i:u.next=l,ar(i,t.memoizedState)||(vs=!0),t.memoizedState=i,t.baseState=s,t.baseQueue=u,n.lastRenderedState=i}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,fo.lanes|=o,Ml|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Do(e){var t=Eo(),n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=e;var i=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);ar(o,t.memoizedState)||(vs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function Io(){}function To(e,t){var n=fo,i=Eo(),a=t(),o=!ar(i.memoizedState,a);if(o&&(i.memoizedState=a,vs=!0),i=i.queue,Vo(Oo.bind(null,n,i,e),[e]),i.getSnapshot!==t||o||null!==mo&&1&mo.memoizedState.tag){if(n.flags|=2048,Bo(9,zo.bind(null,n,i,a,t),void 0,null),null===Dl)throw Error(r(349));30&ho||Ao(n,t,a)}return a}function Ao(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function zo(e,t,n,r){t.value=n,t.getSnapshot=r,Fo(t)&&Mo(e)}function Oo(e,t,n){return n(function(){Fo(t)&&Mo(e)})}function Fo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Mo(e){var t=Pa(e,1);null!==t&&tu(t,e,1,-1)}function jo(e){var t=So();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=es.bind(null,fo,e),[t.memoizedState,e]}function Bo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=fo.updateQueue)?(t={lastEffect:null,stores:null},fo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ro(){return Eo().memoizedState}function Lo(e,t,n,r){var i=So();fo.flags|=e,i.memoizedState=Bo(1|t,n,void 0,void 0===r?null:r)}function No(e,t,n,r){var i=Eo();r=void 0===r?null:r;var a=void 0;if(null!==po){var o=po.memoizedState;if(a=o.destroy,null!==r&&xo(r,o.deps))return void(i.memoizedState=Bo(t,n,a,r))}fo.flags|=e,i.memoizedState=Bo(1|t,n,a,r)}function Uo(e,t){return Lo(8390656,8,e,t)}function Vo(e,t){return No(2048,8,e,t)}function qo(e,t){return No(4,2,e,t)}function Ho(e,t){return No(4,4,e,t)}function Wo(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Zo(e,t,n){return n=null!=n?n.concat([e]):null,No(4,4,Wo.bind(null,t,e),n)}function Ko(){}function Go(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Xo(e,t){var n=Eo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&xo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $o(e,t,n){return 21&ho?(ar(n,t)||(n=ft(),fo.lanes|=n,Ml|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,vs=!0),e.memoizedState=n)}function Yo(e,t){var n=yt;yt=0!==n&&4>n?n:4,e(!0);var r=co.transition;co.transition={};try{e(!1),t()}finally{yt=n,co.transition=r}}function Jo(){return Eo().memoizedState}function Qo(e,t,n){var r=eu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ts(e))ns(t,n);else if(null!==(n=Ca(e,t,n,r))){tu(n,e,r,Ql()),rs(n,t,r)}}function es(e,t,n){var r=eu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ts(e))ns(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,ar(s,o)){var l=t.interleaved;return null===l?(i.next=i,Ea(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Ca(e,t,i,r))&&(tu(n,e,r,i=Ql()),rs(n,t,r))}}function ts(e){var t=e.alternate;return e===fo||null!==t&&t===fo}function ns(e,t){yo=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function rs(e,t,n){if(4194240&n){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var is={readContext:ka,useCallback:bo,useContext:bo,useEffect:bo,useImperativeHandle:bo,useInsertionEffect:bo,useLayoutEffect:bo,useMemo:bo,useReducer:bo,useRef:bo,useState:bo,useDebugValue:bo,useDeferredValue:bo,useTransition:bo,useMutableSource:bo,useSyncExternalStore:bo,useId:bo,unstable_isNewReconciler:!1},as={readContext:ka,useCallback:function(e,t){return So().memoizedState=[e,void 0===t?null:t],e},useContext:ka,useEffect:Uo,useImperativeHandle:function(e,t,n){return n=null!=n?n.concat([e]):null,Lo(4194308,4,Wo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Lo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lo(4,2,e,t)},useMemo:function(e,t){var n=So();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=So();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Qo.bind(null,fo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},So().memoizedState=e},useState:jo,useDebugValue:Ko,useDeferredValue:function(e){return So().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=Yo.bind(null,e[1]),So().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var i=fo,a=So();if(na){if(void 0===n)throw Error(r(407));n=n()}else{if(n=t(),null===Dl)throw Error(r(349));30&ho||Ao(i,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Uo(Oo.bind(null,i,o,e),[e]),i.flags|=2048,Bo(9,zo.bind(null,i,o,n,t),void 0,null),n},useId:function(){var e=So(),t=Dl.identifierPrefix;if(na){var n=Xi;t=":"+t+"R"+(n=(Gi&~(1<<32-it(Gi)-1)).toString(32)+n),0<(n=vo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=_o++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},os={readContext:ka,useCallback:Go,useContext:ka,useEffect:Vo,useImperativeHandle:Zo,useInsertionEffect:qo,useLayoutEffect:Ho,useMemo:Xo,useReducer:Po,useRef:Ro,useState:function(){return Po(Co)},useDebugValue:Ko,useDeferredValue:function(e){return $o(Eo(),po.memoizedState,e)},useTransition:function(){return[Po(Co)[0],Eo().memoizedState]},useMutableSource:Io,useSyncExternalStore:To,useId:Jo,unstable_isNewReconciler:!1},ss={readContext:ka,useCallback:Go,useContext:ka,useEffect:Vo,useImperativeHandle:Zo,useInsertionEffect:qo,useLayoutEffect:Ho,useMemo:Xo,useReducer:Do,useRef:Ro,useState:function(){return Do(Co)},useDebugValue:Ko,useDeferredValue:function(e){var t=Eo();return null===po?t.memoizedState=e:$o(t,po.memoizedState,e)},useTransition:function(){return[Do(Co)[0],Eo().memoizedState]},useMutableSource:Io,useSyncExternalStore:To,useId:Jo,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=L(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function cs(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ds="function"==typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Aa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),cs(0,t)},n}function fs(e,t,n){(n=Aa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){cs(0,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(n.callback=function(){cs(0,t),"function"!=typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ps(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ds;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Su.bind(null,e,t,n),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,i){return 1&e.mode?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Aa(-1,1)).tag=2,za(n,t,1))),n.lanes|=1),e)}var ys=v.ReactCurrentOwner,vs=!1;function _s(e,t,n,r){t.child=null===e?Xa(t,null,n,r):Ga(t,e.child,n,r)}function bs(e,t,n,r,i){n=n.render;var a=t.ref;return wa(t,i),r=wo(e,t,n,r,a,i),n=ko(),null===e||vs?(na&&n&&Ji(t),t.flags|=1,_s(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function xs(e,t,n,r,i){if(null===e){var a=n.type;return"function"!=typeof a||Au(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ou(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ws(e,t,a,r,i))}if(a=e.child,!(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:or)(o,r)&&e.ref===t.ref)return qs(e,t,i)}return t.flags|=1,(e=zu(a,r)).ref=t.ref,e.return=t,t.child=e}function ws(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(or(a,r)&&e.ref===t.ref){if(vs=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,qs(e,t,i);131072&e.flags&&(vs=!0)}}return Es(e,t,n,r,i)}function ks(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(1&t.mode){if(!(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(zl,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Si(zl,Al),Al|=r}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(zl,Al),Al|=n;else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Si(zl,Al),Al|=r;return _s(e,t,i,n),t.child}function Ss(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Es(e,t,n,r,i){var a=Ti(n)?Di:Ci.current;return a=Ii(t,a),wa(t,i),n=wo(e,t,n,r,a,i),r=ko(),null===e||vs?(na&&r&&Ji(t),t.flags|=1,_s(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function Cs(e,t,n,r,i){if(Ti(n)){var a=!0;Fi(t)}else a=!1;if(wa(t,i),null===t.stateNode)Vs(e,t),Ua(t,n,r),qa(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=n.contextType;"object"==typeof u&&null!==u?u=ka(u):u=Ii(t,u=Ti(n)?Di:Ci.current);var c=n.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof o.getSnapshotBeforeUpdate;d||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==r||l!==u)&&Va(t,o,r,u),Da=!1;var h=t.memoizedState;o.state=h,Ma(t,r,o,i),l=t.memoizedState,s!==r||h!==l||Pi.current||Da?("function"==typeof c&&(Ra(t,n,c,r),l=t.memoizedState),(s=Da||Na(t,n,s,r,h,l,u))?(d||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||("function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"==typeof o.componentDidMount&&(t.flags|=4194308)):("function"==typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):("function"==typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ta(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:pa(t.type,s),o.props=u,d=t.pendingProps,h=o.context,"object"==typeof(l=n.contextType)&&null!==l?l=ka(l):l=Ii(t,l=Ti(n)?Di:Ci.current);var f=n.getDerivedStateFromProps;(c="function"==typeof f||"function"==typeof o.getSnapshotBeforeUpdate)||"function"!=typeof o.UNSAFE_componentWillReceiveProps&&"function"!=typeof o.componentWillReceiveProps||(s!==d||h!==l)&&Va(t,o,r,l),Da=!1,h=t.memoizedState,o.state=h,Ma(t,r,o,i);var p=t.memoizedState;s!==d||h!==p||Pi.current||Da?("function"==typeof f&&(Ra(t,n,f,r),p=t.memoizedState),(u=Da||Na(t,n,u,r,h,p,l)||!1)?(c||"function"!=typeof o.UNSAFE_componentWillUpdate&&"function"!=typeof o.componentWillUpdate||("function"==typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"==typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof o.componentDidUpdate&&(t.flags|=4),"function"==typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):("function"!=typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ps(e,t,n,r,a,i)}function Ps(e,t,n,r,i,a){Ss(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Mi(t,n,!1),qs(e,t,a);r=t.stateNode,ys.current=t;var s=o&&"function"!=typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ga(t,e.child,null,a),t.child=Ga(t,null,s,a)):_s(e,t,s,a),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Ds(e){var t=e.stateNode;t.pendingContext?zi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&zi(0,t.context,!1),to(e,t.containerInfo)}function Is(e,t,n,r,i){return da(),ha(i),t.flags|=256,_s(e,t,n,r),t.child}var Ts,As,zs,Os,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var i,a=t.pendingProps,o=ao.current,s=!1,l=0!==(128&t.flags);if((i=l)||(i=(null===e||null!==e.memoizedState)&&0!==(2&o)),i?(s=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(o|=1),Si(ao,1&o),null===e)return sa(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=a.children,e=a.fallback,s?(a=t.mode,s=t.child,l={mode:"hidden",children:l},1&a||null===s?s=Mu(l,a,0,null):(s.childLanes=0,s.pendingProps=l),e=Fu(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(n),t.memoizedState=Fs,e):Bs(t,l));if(null!==(o=e.memoizedState)&&null!==(i=o.dehydrated))return function(e,t,n,i,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,i=us(Error(r(422))),Rs(e,t,s,i)):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=i.fallback,a=t.mode,i=Mu({mode:"visible",children:i.children},a,0,null),o=Fu(o,a,s,null),o.flags|=2,i.return=t,o.return=t,i.sibling=o,t.child=i,1&t.mode&&Ga(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Fs,o);if(!(1&t.mode))return Rs(e,t,s,null);if("$!"===a.data){if(i=a.nextSibling&&a.nextSibling.dataset)var l=i.dgst;return i=l,Rs(e,t,s,i=us(o=Error(r(419)),i,void 0))}if(l=0!==(s&e.childLanes),vs||l){if(null!==(i=Dl)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=a&(i.suspendedLanes|s)?0:a)&&a!==o.retryLane&&(o.retryLane=a,Pa(e,a),tu(i,e,a,-1))}return pu(),Rs(e,t,s,i=us(Error(r(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cu.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ta=si(a.nextSibling),ea=t,na=!0,ra=null,null!==e&&(Wi[Zi++]=Gi,Wi[Zi++]=Xi,Wi[Zi++]=Ki,Gi=e.id,Xi=e.overflow,Ki=t),t=Bs(t,i.children),t.flags|=4096,t)}(e,t,l,a,i,o,n);if(s){s=a.fallback,l=t.mode,i=(o=e.child).sibling;var u={mode:"hidden",children:a.children};return 1&l||t.child===o?(a=zu(o,u)).subtreeFlags=14680064&o.subtreeFlags:((a=t.child).childLanes=0,a.pendingProps=u,t.deletions=null),null!==i?s=zu(i,s):(s=Fu(s,l,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,l=null===(l=e.child.memoizedState)?Ms(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Fs,a}return e=(s=e.child).sibling,a=zu(s,{mode:"visible",children:a.children}),!(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Mu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Rs(e,t,n,r){return null!==r&&ha(r),Ga(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ls(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),xa(e.return,t,n)}function Ns(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Us(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(_s(e,t,r.children,n),2&(r=ao.current))r=1&r|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ls(e,n,t);else if(19===e.tag)Ls(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Si(ao,r),1&t.mode)switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===oo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ns(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===oo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ns(t,!0,n,null,a);break;case"together":Ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Vs(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,!(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(n=zu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!na)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Zs(e,t,n){var i=t.pendingProps;switch(Qi(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return Ti(t.type)&&Ai(),Ws(t),null;case 3:return i=t.stateNode,no(),ki(Pi),ki(Ci),lo(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(null===e||null===e.child)&&(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==ra&&(au(ra),ra=null))),As(e,t),Ws(t),null;case 5:io(t);var o=eo(Qa.current);if(n=t.type,null!==e&&null!=t.stateNode)zs(e,t,n,i,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(null===t.stateNode)throw Error(r(166));return Ws(t),null}if(e=eo(Ya.current),ua(t)){i=t.stateNode,n=t.type;var s=t.memoizedProps;switch(i[ci]=t,i[di]=s,e=0!==(1&t.mode),n){case"dialog":Br("cancel",i),Br("close",i);break;case"iframe":case"object":case"embed":Br("load",i);break;case"video":case"audio":for(o=0;o<Or.length;o++)Br(Or[o],i);break;case"source":Br("error",i);break;case"img":case"image":case"link":Br("error",i),Br("load",i);break;case"details":Br("toggle",i);break;case"input":G(i,s),Br("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Br("invalid",i);break;case"textarea":ne(i,s),Br("invalid",i)}for(var l in ge(n,s),o=null,s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"==typeof u?i.textContent!==u&&(!0!==s.suppressHydrationWarning&&$r(i.textContent,u,e),o=["children",u]):"number"==typeof u&&i.textContent!==""+u&&(!0!==s.suppressHydrationWarning&&$r(i.textContent,u,e),o=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Br("scroll",i)}switch(n){case"input":H(i),Y(i,s,!0);break;case"textarea":H(i),ie(i);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(i.onclick=Yr)}i=o,t.updateQueue=i,null!==i&&(t.flags|=4)}else{l=9===o.nodeType?o:o.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof i.is?e=l.createElement(n,{is:i.is}):(e=l.createElement(n),"select"===n&&(l=e,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):e=l.createElementNS(e,n),e[ci]=t,e[di]=i,Ts(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(n,i),n){case"dialog":Br("cancel",e),Br("close",e),o=i;break;case"iframe":case"object":case"embed":Br("load",e),o=i;break;case"video":case"audio":for(o=0;o<Or.length;o++)Br(Or[o],e);o=i;break;case"source":Br("error",e),o=i;break;case"img":case"image":case"link":Br("error",e),Br("load",e),o=i;break;case"details":Br("toggle",e),o=i;break;case"input":G(e,i),o=K(e,i),Br("invalid",e);break;case"option":default:o=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},o=M({},i,{value:void 0}),Br("invalid",e);break;case"textarea":ne(e,i),o=te(e,i),Br("invalid",e)}for(s in ge(n,o),u=o)if(u.hasOwnProperty(s)){var c=u[s];"style"===s?pe(e,c):"dangerouslySetInnerHTML"===s?null!=(c=c?c.__html:void 0)&&ue(e,c):"children"===s?"string"==typeof c?("textarea"!==n||""!==c)&&ce(e,c):"number"==typeof c&&ce(e,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=c&&"onScroll"===s&&Br("scroll",e):null!=c&&y(e,s,c,l))}switch(n){case"input":H(e),Y(e,i,!1);break;case"textarea":H(e),ie(e);break;case"option":null!=i.value&&e.setAttribute("value",""+V(i.value));break;case"select":e.multiple=!!i.multiple,null!=(s=i.value)?ee(e,!!i.multiple,s,!1):null!=i.defaultValue&&ee(e,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Yr)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Os(e,t,e.memoizedProps,i);else{if("string"!=typeof i&&null===t.stateNode)throw Error(r(166));if(n=eo(Qa.current),eo(Ya.current),ua(t)){if(i=t.stateNode,n=t.memoizedProps,i[ci]=t,(s=i.nodeValue!==n)&&null!==(e=ea))switch(e.tag){case 3:$r(i.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$r(i.nodeValue,n,0!==(1&e.mode))}s&&(t.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[ci]=t,t.stateNode=i}return Ws(t),null;case 13:if(ki(ao),i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(na&&null!==ta&&1&t.mode&&!(128&t.flags))ca(),da(),t.flags|=98560,s=!1;else if(s=ua(t),null!==i&&null!==i.dehydrated){if(null===e){if(!s)throw Error(r(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(r(317));s[ci]=t}else da(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),s=!1}else null!==ra&&(au(ra),ra=null),s=!0;if(!s)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=n,t):((i=null!==i)!==(null!==e&&null!==e.memoizedState)&&i&&(t.child.flags|=8192,1&t.mode&&(null===e||1&ao.current?0===Ol&&(Ol=3):pu())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return no(),As(e,t),null===e&&Nr(t.stateNode.containerInfo),Ws(t),null;case 10:return ba(t.type._context),Ws(t),null;case 19:if(ki(ao),null===(s=t.memoizedState))return Ws(t),null;if(i=0!==(128&t.flags),null===(l=s.rendering))if(i)Hs(s,!1);else{if(0!==Ol||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(l=oo(e))){for(t.flags|=128,Hs(s,!1),null!==(i=l.updateQueue)&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=n,n=t.child;null!==n;)e=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,e=l.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Si(ao,1&ao.current|2),t.child}e=e.sibling}null!==s.tail&&Xe()>Ul&&(t.flags|=128,i=!0,Hs(s,!1),t.lanes=4194304)}else{if(!i)if(null!==(e=oo(l))){if(t.flags|=128,i=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!na)return Ws(t),null}else 2*Xe()-s.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,i=!0,Hs(s,!1),t.lanes=4194304);s.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=s.last)?n.sibling=l:t.child=l,s.last=l)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Xe(),t.sibling=null,n=ao.current,Si(ao,i?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return cu(),i=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==i&&(t.flags|=8192),i&&1&t.mode?1073741824&Al&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Ks(e,t){switch(Qi(t),t.tag){case 1:return Ti(t.type)&&Ai(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return no(),ki(Pi),ki(Ci),lo(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return io(t),null;case 13:if(ki(ao),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));da()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(ao),null;case 4:return no(),null;case 10:return ba(t.type._context),null;case 22:case 23:return cu(),null;default:return null}}Ts=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},As=function(){},zs=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,eo(Ya.current);var o,s=null;switch(n){case"input":i=K(e,i),r=K(e,r),s=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),s=[];break;case"textarea":i=te(e,i),r=te(e,r),s=[];break;default:"function"!=typeof i.onClick&&"function"==typeof r.onClick&&(e.onclick=Yr)}for(c in ge(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(s=s||[]).push(c,u)):"children"===c?"string"!=typeof u&&"number"!=typeof u||(s=s||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Br("scroll",e),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Xs=!1,$s="function"==typeof WeakSet?WeakSet:Set,Ys=null;function Js(e,t){var n=e.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(r){ku(e,t,r)}else n.current=null}function Qs(e,t,n){try{n()}catch(r){ku(e,t,r)}}var el=!1;function tl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&Qs(t,n,a)}i=i.next}while(i!==r)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"==typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ci],delete t[di],delete t[fi],delete t[pi],delete t[mi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function sl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!=(n=n._reactRootContainer)||null!==t.onclick||(t.onclick=Yr));else if(4!==r&&null!==(e=e.child))for(sl(e,t,n),e=e.sibling;null!==e;)sl(e,t,n),e=e.sibling}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var ul=null,cl=!1;function dl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(rt&&"function"==typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(nt,n)}catch(s){}switch(n.tag){case 5:Xs||Js(n,t);case 6:var r=ul,i=cl;ul=null,dl(e,t,n),cl=i,null!==(ul=r)&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?oi(e.parentNode,n):1===e.nodeType&&oi(e,n),Nt(e)):oi(ul,n.stateNode));break;case 4:r=ul,i=cl,ul=n.stateNode.containerInfo,cl=!0,dl(e,t,n),ul=r,cl=i;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(2&a||4&a)&&Qs(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Xs&&(Js(n,t),"function"==typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ku(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,dl(e,t,n),Xs=r):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach(function(t){var r=Pu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function pl(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var a=n[i];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,cl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,cl=!0;break e}l=l.return}if(null===ul)throw Error(r(160));hl(o,s,a),ul=null,cl=!1;var u=a.alternate;null!==u&&(u.return=null),a.return=null}catch(c){ku(a,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),gl(e),4&i){try{tl(3,e,e.return),nl(3,e)}catch(g){ku(e,e.return,g)}try{tl(5,e,e.return)}catch(g){ku(e,e.return,g)}}break;case 1:pl(t,e),gl(e),512&i&&null!==n&&Js(n,n.return);break;case 5:if(pl(t,e),gl(e),512&i&&null!==n&&Js(n,n.return),32&e.flags){var a=e.stateNode;try{ce(a,"")}catch(g){ku(e,e.return,g)}}if(4&i&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(a,o),ye(l,s);var c=ye(l,o);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];"style"===d?pe(a,h):"dangerouslySetInnerHTML"===d?ue(a,h):"children"===d?ce(a,h):y(a,d,h,c)}switch(l){case"input":$(a,o);break;case"textarea":re(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ee(a,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ee(a,!!o.multiple,o.defaultValue,!0):ee(a,!!o.multiple,o.multiple?[]:"",!1))}a[di]=o}catch(g){ku(e,e.return,g)}}break;case 6:if(pl(t,e),gl(e),4&i){if(null===e.stateNode)throw Error(r(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(g){ku(e,e.return,g)}}break;case 3:if(pl(t,e),gl(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Nt(t.containerInfo)}catch(g){ku(e,e.return,g)}break;case 4:default:pl(t,e),gl(e);break;case 13:pl(t,e),gl(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Nl=Xe())),4&i&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(c=Xs)||d,pl(t,e),Xs=c):pl(t,e),gl(e),8192&i){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&1&e.mode)for(Ys=e,d=e.child;null!==d;){for(h=Ys=d;null!==Ys;){switch(p=(f=Ys).child,f.tag){case 0:case 11:case 14:case 15:tl(4,f,f.return);break;case 1:Js(f,f.return);var m=f.stateNode;if("function"==typeof m.componentWillUnmount){i=f,n=f.return;try{t=i,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){ku(i,n,g)}}break;case 5:Js(f,f.return);break;case 22:if(null!==f.memoizedState){bl(h);continue}}null!==p?(p.return=f,Ys=p):bl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{a=h.stateNode,c?"function"==typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,s=null!=(u=h.memoizedProps.style)&&u.hasOwnProperty("display")?u.display:null,l.style.display=fe("display",s))}catch(g){ku(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){ku(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),gl(e),4&i&&fl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var i=n;break e}n=n.return}throw Error(r(160))}switch(i.tag){case 5:var a=i.stateNode;32&i.flags&&(ce(a,""),i.flags&=-33),ll(e,ol(e),a);break;case 3:case 4:var o=i.stateNode.containerInfo;sl(e,ol(e),o);break;default:throw Error(r(161))}}catch(s){ku(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Ys=e,vl(e,t,n)}function vl(e,t,n){for(var r=0!==(1&e.mode);null!==Ys;){var i=Ys,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Gs;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Gs;var u=Xs;if(Gs=o,(Xs=l)&&!u)for(Ys=i;null!==Ys;)l=(o=Ys).child,22===o.tag&&null!==o.memoizedState?xl(i):null!==l?(l.return=o,Ys=l):xl(i);for(;null!==a;)Ys=a,vl(a,t,n),a=a.sibling;Ys=i,Gs=s,Xs=u}_l(e)}else 8772&i.subtreeFlags&&null!==a?(a.return=i,Ys=a):_l(e)}}function _l(e){for(;null!==Ys;){var t=Ys;if(8772&t.flags){var n=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Xs||nl(5,t);break;case 1:var i=t.stateNode;if(4&t.flags&&!Xs)if(null===n)i.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:pa(t.type,n.memoizedProps);i.componentDidUpdate(a,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ja(t,o,i);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ja(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Nt(h)}}}break;default:throw Error(r(163))}Xs||512&t.flags&&rl(t)}catch(f){ku(t,t.return,f)}}if(t===e){Ys=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ys=n;break}Ys=t.return}}function bl(e){for(;null!==Ys;){var t=Ys;if(t===e){Ys=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ys=n;break}Ys=t.return}}function xl(e){for(;null!==Ys;){var t=Ys;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){ku(t,n,l)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){ku(t,i,l)}}var a=t.return;try{rl(t)}catch(l){ku(t,a,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){ku(t,o,l)}}}catch(l){ku(t,t.return,l)}if(t===e){Ys=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ys=s;break}Ys=t.return}}var wl,kl=Math.ceil,Sl=v.ReactCurrentDispatcher,El=v.ReactCurrentOwner,Cl=v.ReactCurrentBatchConfig,Pl=0,Dl=null,Il=null,Tl=0,Al=0,zl=wi(0),Ol=0,Fl=null,Ml=0,jl=0,Bl=0,Rl=null,Ll=null,Nl=0,Ul=1/0,Vl=null,ql=!1,Hl=null,Wl=null,Zl=!1,Kl=null,Gl=0,Xl=0,$l=null,Yl=-1,Jl=0;function Ql(){return 6&Pl?Xe():-1!==Yl?Yl:Yl=Xe()}function eu(e){return 1&e.mode?2&Pl&&0!==Tl?Tl&-Tl:null!==fa.transition?(0===Jl&&(Jl=ft()),Jl):(0!==(e=yt)||(e=void 0===(e=window.event)?16:Gt(e.type)),e):1}function tu(e,t,n,i){if(50<Xl)throw Xl=0,$l=null,Error(r(185));mt(e,n,i),(!(2&Pl)||e!==Dl)&&(e===Dl&&(!(2&Pl)&&(jl|=n),4===Ol&&ou(e,Tl)),nu(e,i),1===n&&0===Pl&&!(1&t.mode)&&(Ul=Xe()+500,Bi&&Ni()))}function nu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-it(a),s=1<<o,l=i[o];-1===l?(!(s&n)||s&r)&&(i[o]=dt(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ct(e,e===Dl?Tl:0);if(0===r)null!==n&&Ze(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ze(n),1===t)0===e.tag?function(e){Bi=!0,Li(e)}(su.bind(null,e)):Li(su.bind(null,e)),ii(function(){!(6&Pl)&&Ni()}),n=null;else{switch(vt(r)){case 1:n=Ye;break;case 4:n=Je;break;case 16:default:n=Qe;break;case 536870912:n=tt}n=Du(n,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ru(e,t){if(Yl=-1,Jl=0,6&Pl)throw Error(r(327));var n=e.callbackNode;if(xu()&&e.callbackNode!==n)return null;var i=ct(e,e===Dl?Tl:0);if(0===i)return null;if(30&i||i&e.expiredLanes||t)t=mu(e,i);else{t=i;var a=Pl;Pl|=2;var o=fu();for((Dl!==e||Tl!==t)&&(Vl=null,Ul=Xe()+500,du(e,t));;)try{yu();break}catch(l){hu(e,l)}_a(),Sl.current=o,Pl=a,null!==Il?t=0:(Dl=null,Tl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(a=ht(e))&&(i=a,t=iu(e,a))),1===t)throw n=Fl,du(e,0),ou(e,i),nu(e,Xe()),n;if(6===t)ou(e,i);else{if(a=e.current.alternate,!(30&i)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!ar(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mu(e,i))&&(0!==(o=ht(e))&&(i=o,t=iu(e,o))),1===t))throw n=Fl,du(e,0),ou(e,i),nu(e,Xe()),n;switch(e.finishedWork=a,e.finishedLanes=i,t){case 0:case 1:throw Error(r(345));case 2:case 5:bu(e,Ll,Vl);break;case 3:if(ou(e,i),(130023424&i)===i&&10<(t=Nl+500-Xe())){if(0!==ct(e,0))break;if(((a=e.suspendedLanes)&i)!==i){Ql(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ti(bu.bind(null,e,Ll,Vl),t);break}bu(e,Ll,Vl);break;case 4:if(ou(e,i),(4194240&i)===i)break;for(t=e.eventTimes,a=-1;0<i;){var s=31-it(i);o=1<<s,(s=t[s])>a&&(a=s),i&=~o}if(i=a,10<(i=(120>(i=Xe()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*kl(i/1960))-i)){e.timeoutHandle=ti(bu.bind(null,e,Ll,Vl),i);break}bu(e,Ll,Vl);break;default:throw Error(r(329))}}}return nu(e,Xe()),e.callbackNode===n?ru.bind(null,e):null}function iu(e,t){var n=Rl;return e.current.memoizedState.isDehydrated&&(du(e,t).flags|=256),2!==(e=mu(e,t))&&(t=Ll,Ll=n,null!==t&&au(t)),e}function au(e){null===Ll?Ll=e:Ll.push.apply(Ll,e)}function ou(e,t){for(t&=~Bl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function su(e){if(6&Pl)throw Error(r(327));xu();var t=ct(e,0);if(!(1&t))return nu(e,Xe()),null;var n=mu(e,t);if(0!==e.tag&&2===n){var i=ht(e);0!==i&&(t=i,n=iu(e,i))}if(1===n)throw n=Fl,du(e,0),ou(e,t),nu(e,Xe()),n;if(6===n)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bu(e,Ll,Vl),nu(e,Xe()),null}function lu(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(Ul=Xe()+500,Bi&&Ni())}}function uu(e){null!==Kl&&0===Kl.tag&&!(6&Pl)&&xu();var t=Pl;Pl|=1;var n=Cl.transition,r=yt;try{if(Cl.transition=null,yt=1,e)return e()}finally{yt=r,Cl.transition=n,!(6&(Pl=t))&&Ni()}}function cu(){Al=zl.current,ki(zl)}function du(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ni(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(Qi(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&Ai();break;case 3:no(),ki(Pi),ki(Ci),lo();break;case 5:io(r);break;case 4:no();break;case 13:case 19:ki(ao);break;case 10:ba(r.type._context);break;case 22:case 23:cu()}n=n.return}if(Dl=e,Il=e=zu(e.current,null),Tl=Al=t,Ol=0,Fl=null,Bl=jl=Ml=0,Ll=Rl=null,null!==Sa){for(t=0;t<Sa.length;t++)if(null!==(r=(n=Sa[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Sa=null}return e}function hu(e,t){for(;;){var n=Il;try{if(_a(),uo.current=is,go){for(var i=fo.memoizedState;null!==i;){var a=i.queue;null!==a&&(a.pending=null),i=i.next}go=!1}if(ho=0,mo=po=fo=null,yo=!1,vo=0,El.current=null,null===n||null===n.return){Ol=1,Fl=t,Il=null;break}e:{var o=e,s=n.return,l=n,u=t;if(t=Tl,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var c=u,d=l,h=d.tag;if(!(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=ms(s);if(null!==p){p.flags&=-257,gs(p,s,l,0,t),1&p.mode&&ps(o,c,t),u=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(!(1&t)){ps(o,c,t),pu();break e}u=Error(r(426))}else if(na&&1&l.mode){var y=ms(s);if(null!==y){!(65536&y.flags)&&(y.flags|=256),gs(y,s,l,0,t),ha(ls(u,l));break e}}o=u=ls(u,l),4!==Ol&&(Ol=2),null===Rl?Rl=[o]:Rl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Fa(o,hs(0,u,t));break e;case 1:l=u;var v=o.type,_=o.stateNode;if(!(128&o.flags)&&("function"==typeof v.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===Wl||!Wl.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,Fa(o,fs(o,l,t));break e}}o=o.return}while(null!==o)}_u(n)}catch(b){t=b,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fu(){var e=Sl.current;return Sl.current=is,null===e?is:e}function pu(){(0===Ol||3===Ol||2===Ol)&&(Ol=4),null===Dl||!(268435455&Ml)&&!(268435455&jl)||ou(Dl,Tl)}function mu(e,t){var n=Pl;Pl|=2;var i=fu();for((Dl!==e||Tl!==t)&&(Vl=null,du(e,t));;)try{gu();break}catch(a){hu(e,a)}if(_a(),Pl=n,Sl.current=i,null!==Il)throw Error(r(261));return Dl=null,Tl=0,Ol}function gu(){for(;null!==Il;)vu(Il)}function yu(){for(;null!==Il&&!Ke();)vu(Il)}function vu(e){var t=wl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?_u(e):Il=t,El.current=null}function _u(e){var t=e;do{var n=t.alternate;if(e=t.return,32768&t.flags){if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ol=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(n=Zs(n,t,Al)))return void(Il=n);if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ol&&(Ol=5)}function bu(e,t,n){var i=yt,a=Cl.transition;try{Cl.transition=null,yt=1,function(e,t,n,i){do{xu()}while(null!==Kl);if(6&Pl)throw Error(r(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-it(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Dl&&(Il=Dl=null,Tl=0),!(2064&n.subtreeFlags)&&!(2064&n.flags)||Zl||(Zl=!0,Du(Qe,function(){return xu(),null})),o=0!==(15990&n.flags),15990&n.subtreeFlags||o){o=Cl.transition,Cl.transition=null;var s=yt;yt=1;var l=Pl;Pl|=4,El.current=null,function(e,t){if(Jr=Vt,dr(e=cr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var a=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var s=0,l=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==a&&3!==h.nodeType||(l=s+a),h!==o||0!==i&&3!==h.nodeType||(u=s+i),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===a&&(l=s),f===o&&++d===i&&(u=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Qr={focusedElem:e,selectionRange:n},Vt=!1,Ys=t;null!==Ys;)if(e=(t=Ys).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ys=e;else for(;null!==Ys;){t=Ys;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:pa(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(r(163))}}catch(x){ku(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Ys=e;break}Ys=t.return}m=el,el=!1}(e,n),ml(n,e),hr(Qr),Vt=!!Jr,Qr=Jr=null,e.current=n,yl(n,e,a),Ge(),Pl=l,yt=s,Cl.transition=o}else e.current=n;if(Zl&&(Zl=!1,Kl=e,Gl=a),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(rt&&"function"==typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nu(e,Xe()),null!==t)for(i=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],i(a.value,{componentStack:a.stack,digest:a.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;1&Gl&&0!==e.tag&&xu(),o=e.pendingLanes,1&o?e===$l?Xl++:(Xl=0,$l=e):Xl=0,Ni()}(e,t,n,i)}finally{Cl.transition=a,yt=i}return null}function xu(){if(null!==Kl){var e=vt(Gl),t=Cl.transition,n=yt;try{if(Cl.transition=null,yt=16>e?16:e,null===Kl)var i=!1;else{if(e=Kl,Kl=null,Gl=0,6&Pl)throw Error(r(331));var a=Pl;for(Pl|=4,Ys=e.current;null!==Ys;){var o=Ys,s=o.child;if(16&Ys.flags){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Ys=c;null!==Ys;){var d=Ys;switch(d.tag){case 0:case 11:case 15:tl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Ys=h;else for(;null!==Ys;){var f=(d=Ys).sibling,p=d.return;if(il(d),d===c){Ys=null;break}if(null!==f){f.return=p,Ys=f;break}Ys=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Ys=o}}if(2064&o.subtreeFlags&&null!==s)s.return=o,Ys=s;else e:for(;null!==Ys;){if(2048&(o=Ys).flags)switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Ys=v;break e}Ys=o.return}}var _=e.current;for(Ys=_;null!==Ys;){var b=(s=Ys).child;if(2064&s.subtreeFlags&&null!==b)b.return=s,Ys=b;else e:for(s=_;null!==Ys;){if(2048&(l=Ys).flags)try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){ku(l,l.return,w)}if(l===s){Ys=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Ys=x;break e}Ys=l.return}}if(Pl=a,Ni(),rt&&"function"==typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(nt,e)}catch(w){}i=!0}return i}finally{yt=n,Cl.transition=t}}return!1}function wu(e,t,n){e=za(e,t=hs(0,t=ls(n,t),1),1),t=Ql(),null!==e&&(mt(e,1,t),nu(e,t))}function ku(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=za(t,e=fs(t,e=ls(n,e),1),1),e=Ql(),null!==t&&(mt(t,1,e),nu(t,e));break}}t=t.return}}function Su(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ql(),e.pingedLanes|=e.suspendedLanes&n,Dl===e&&(Tl&n)===n&&(4===Ol||3===Ol&&(130023424&Tl)===Tl&&500>Xe()-Nl?du(e,0):Bl|=n),nu(e,t)}function Eu(e,t){0===t&&(1&e.mode?(t=lt,!(130023424&(lt<<=1))&&(lt=4194304)):t=1);var n=Ql();null!==(e=Pa(e,t))&&(mt(e,t,n),nu(e,n))}function Cu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Pu(e,t){var n=0;switch(e.tag){case 13:var i=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(r(314))}null!==i&&i.delete(t),Eu(e,n)}function Du(e,t){return We(e,t)}function Iu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tu(e,t,n,r){return new Iu(e,t,n,r)}function Au(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zu(e,t){var n=e.alternate;return null===n?((n=Tu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ou(e,t,n,i,a,o){var s=2;if(i=e,"function"==typeof e)Au(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case x:return Fu(n.children,a,o,t);case w:s=8,a|=8;break;case k:return(e=Tu(12,n,t,2|a)).elementType=k,e.lanes=o,e;case P:return(e=Tu(13,n,t,a)).elementType=P,e.lanes=o,e;case D:return(e=Tu(19,n,t,a)).elementType=D,e.lanes=o,e;case A:return Mu(n,a,o,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case E:s=9;break e;case C:s=11;break e;case I:s=14;break e;case T:s=16,i=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Tu(s,n,t,a)).elementType=e,t.type=i,t.lanes=o,t}function Fu(e,t,n,r){return(e=Tu(7,e,r,t)).lanes=n,e}function Mu(e,t,n,r){return(e=Tu(22,e,r,t)).elementType=A,e.lanes=n,e.stateNode={isHidden:!1},e}function ju(e,t,n){return(e=Tu(6,e,null,t)).lanes=n,e}function Bu(e,t,n){return(t=Tu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ru(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lu(e,t,n,r,i,a,o,s,l){return e=new Ru(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Tu(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ia(a),e}function Nu(e){if(!e)return Ei;e:{if(Ne(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ti(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var n=e.type;if(Ti(n))return Oi(e,n,t)}return t}function Uu(e,t,n,r,i,a,o,s,l){return(e=Lu(n,r,!0,e,0,a,0,s,l)).context=Nu(null),n=e.current,(a=Aa(r=Ql(),i=eu(n))).callback=null!=t?t:null,za(n,a,i),e.current.lanes=i,mt(e,i,r),nu(e,r),e}function Vu(e,t,n,r){var i=t.current,a=Ql(),o=eu(i);return n=Nu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Aa(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=za(i,t,o))&&(tu(e,i,o,a),Oa(e,i,o)),o}function qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wu(e,t){Hu(e,t),(e=e.alternate)&&Hu(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pi.current)vs=!0;else{if(!(e.lanes&n)&&!(128&t.flags))return vs=!1,function(e,t,n){switch(t.tag){case 3:Ds(t),da();break;case 5:ro(t);break;case 1:Ti(t.type)&&Fi(t);break;case 4:to(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Si(ma,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Si(ao,1&ao.current),t.flags|=128,null):n&t.child.childLanes?js(e,t,n):(Si(ao,1&ao.current),null!==(e=qs(e,t,n))?e.sibling:null);Si(ao,1&ao.current);break;case 19:if(r=0!==(n&t.childLanes),128&e.flags){if(r)return Us(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(ao,ao.current),r)break;return null;case 22:case 23:return t.lanes=0,ks(e,t,n)}return qs(e,t,n)}(e,t,n);vs=!!(131072&e.flags)}else vs=!1,na&&1048576&t.flags&&Yi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;Vs(e,t),e=t.pendingProps;var a=Ii(t,Ci.current);wa(t,n),a=wo(null,t,i,e,a,n);var o=ko();return t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ti(i)?(o=!0,Fi(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ia(t),a.updater=La,t.stateNode=a,a._reactInternals=t,qa(t,i,e,n),t=Ps(null,t,i,!0,o,n)):(t.tag=0,na&&o&&Ji(t),_s(null,t,a,n),t=t.child),t;case 16:i=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,i=(a=i._init)(i._payload),t.type=i,a=t.tag=function(e){if("function"==typeof e)return Au(e)?1:0;if(null!=e){if((e=e.$$typeof)===C)return 11;if(e===I)return 14}return 2}(i),e=pa(i,e),a){case 0:t=Es(null,t,i,e,n);break e;case 1:t=Cs(null,t,i,e,n);break e;case 11:t=bs(null,t,i,e,n);break e;case 14:t=xs(null,t,i,pa(i.type,e),n);break e}throw Error(r(306,i,""))}return t;case 0:return i=t.type,a=t.pendingProps,Es(e,t,i,a=t.elementType===i?a:pa(i,a),n);case 1:return i=t.type,a=t.pendingProps,Cs(e,t,i,a=t.elementType===i?a:pa(i,a),n);case 3:e:{if(Ds(t),null===e)throw Error(r(387));i=t.pendingProps,a=(o=t.memoizedState).element,Ta(e,t),Ma(t,i,null,n);var s=t.memoizedState;if(i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Is(e,t,i,n,a=ls(Error(r(423)),t));break e}if(i!==a){t=Is(e,t,i,n,a=ls(Error(r(424)),t));break e}for(ta=si(t.stateNode.containerInfo.firstChild),ea=t,na=!0,ra=null,n=Xa(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(da(),i===a){t=qs(e,t,n);break e}_s(e,t,i,n)}t=t.child}return t;case 5:return ro(t),null===e&&sa(t),i=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,ei(i,a)?s=null:null!==o&&ei(i,o)&&(t.flags|=32),Ss(e,t),_s(e,t,s,n),t.child;case 6:return null===e&&sa(t),null;case 13:return js(e,t,n);case 4:return to(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=Ga(t,null,i,n):_s(e,t,i,n),t.child;case 11:return i=t.type,a=t.pendingProps,bs(e,t,i,a=t.elementType===i?a:pa(i,a),n);case 7:return _s(e,t,t.pendingProps,n),t.child;case 8:case 12:return _s(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(i=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Si(ma,i._currentValue),i._currentValue=s,null!==o)if(ar(o.value,s)){if(o.children===a.children&&!Pi.current){t=qs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===o.tag){(u=Aa(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),xa(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(r(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),xa(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}_s(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,i=t.pendingProps.children,wa(t,n),i=i(a=ka(a)),t.flags|=1,_s(e,t,i,n),t.child;case 14:return a=pa(i=t.type,t.pendingProps),xs(e,t,i,a=pa(i.type,a),n);case 15:return ws(e,t,t.type,t.pendingProps,n);case 17:return i=t.type,a=t.pendingProps,a=t.elementType===i?a:pa(i,a),Vs(e,t),t.tag=1,Ti(i)?(e=!0,Fi(t)):e=!1,wa(t,n),Ua(t,i,a),qa(t,i,a,n),Ps(null,t,i,!0,e,n);case 19:return Us(e,t,n);case 22:return ks(e,t,n)}throw Error(r(156,t.tag))};var Zu="function"==typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Gu(e){this._internalRoot=e}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yu(){}function Ju(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"==typeof i){var s=i;i=function(){var e=qu(o);s.call(e)}}Vu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"==typeof r){var a=r;r=function(){var e=qu(o);a.call(e)}}var o=Uu(t,r,e,0,null,!1,0,"",Yu);return e._reactRootContainer=o,e[hi]=o.current,Nr(8===e.nodeType?e.parentNode:e),uu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"==typeof r){var s=r;r=function(){var e=qu(l);s.call(e)}}var l=Lu(e,0,!1,null,0,!1,0,"",Yu);return e._reactRootContainer=l,e[hi]=l.current,Nr(8===e.nodeType?e.parentNode:e),uu(function(){Vu(t,l,n,r)}),l}(n,t,e,i,r);return qu(o)}Gu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Vu(e,t,null,null)},Gu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uu(function(){Vu(null,e,null,null)}),t[hi]=null}},Gu.prototype.unstable_scheduleHydration=function(e){if(e){var t=wt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<At.length&&0!==t&&t<At[n].priority;n++);At.splice(n,0,e),0===n&&Mt(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(gt(t,1|n),nu(t,Xe()),!(6&Pl)&&(Ul=Xe()+500,Ni()))}break;case 13:uu(function(){var t=Pa(e,1);if(null!==t){var n=Ql();tu(t,e,1,n)}}),Wu(e,1)}},bt=function(e){if(13===e.tag){var t=Pa(e,134217728);if(null!==t)tu(t,e,134217728,Ql());Wu(e,134217728)}},xt=function(e){if(13===e.tag){var t=eu(e),n=Pa(e,t);if(null!==n)tu(n,e,t,Ql());Wu(e,t)}},wt=function(){return yt},kt=function(e,t){var n=yt;try{return yt=e,t()}finally{yt=n}},be=function(e,t,n){switch(t){case"input":if($(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var a=_i(i);if(!a)throw Error(r(90));W(i),$(i,a)}}}break;case"textarea":re(e,n);break;case"select":null!=(t=n.value)&&ee(e,!!n.multiple,t,!1)}},Ce=lu,Pe=uu;var Qu,ec={usingClientEntryPoint:!1,Events:[yi,vi,_i,Se,Ee,lu]},tc={findFiberByHostInstance:gi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nc={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&(!(Qu=__REACT_DEVTOOLS_GLOBAL_HOOK__).isDisabled&&Qu.supportsFiber))try{nt=Qu.inject(nc),rt=Qu}catch(le){}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,e.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xu(t))throw Error(r(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:b,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},e.createRoot=function(e,t){if(!Xu(e))throw Error(r(299));var n=!1,i="",a=Zu;return null!=t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Lu(e,1,!1,null,0,n,0,i,a),e[hi]=t.current,Nr(8===e.nodeType?e.parentNode:e),new Ku(t)},e.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t)throw"function"==typeof e.render?Error(r(188)):(e=Object.keys(e).join(","),Error(r(268,e)));return e=null===(e=qe(t))?null:e.stateNode},e.flushSync=function(e){return uu(e)},e.hydrate=function(e,t,n){if(!$u(t))throw Error(r(200));return Ju(null,e,t,!0,n)},e.hydrateRoot=function(e,t,n){if(!Xu(e))throw Error(r(405));var i=null!=n&&n.hydratedSources||null,a=!1,o="",s=Zu;if(null!=n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Uu(t,null,e,1,null!=n?n:null,a,0,o,s),e[hi]=t.current,Nr(e),i)for(e=0;e<i.length;e++)a=(a=(n=i[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Gu(t)},e.render=function(e,t,n){if(!$u(t))throw Error(r(200));return Ju(null,e,t,!1,n)},e.unmountComponentAtNode=function(e){if(!$u(e))throw Error(r(40));return!!e._reactRootContainer&&(uu(function(){Ju(null,null,e,!1,function(){e._reactRootContainer=null,e[hi]=null})}),!0)},e.unstable_batchedUpdates=lu,e.unstable_renderSubtreeIntoContainer=function(e,t,n,i){if(!$u(n))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Ju(e,t,n,!1,i)},e.version="18.2.0-next-9e3b772b8-20220608"}),Bh=S((e,t)=>{(function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(r$){console.error(r$)}})(),t.exports=jh()});function Rh(e,t,n){let r=(0,Vh.useCallback)(e,t),i=(0,Vh.useRef)(null);i.current?i.current.set(r):i.current=new Nh.Atom(r);let a=(0,Vh.useRef)(null);return a.current||(a.current=(0,Nh.prism)(()=>i.current.prism.getValue()())),Lh(a.current,n)}function Lh(e,t){var n;let r=function(){let[,e]=(0,Vh.useState)(0);return(0,Vh.useCallback)(()=>{e(e=>e+1)},[])}(),i=(0,Vh.useRef)(void 0);i.current||(Zh++,i.current={order:Zh,runUpdate:()=>{i.current.unmounted||r()},der:e,lastValue:void 0,unmounted:!1,queueUpdate:()=>{var e;Hh&&(null==(e=i.current.debug)||e.history.push("queueUpdate()")),$h(i.current)},untap:e.onStale(()=>{Hh&&i.current.debug.history.push("onStale(cb)"),i.current.queueUpdate()})},Hh&&(i.current.debug={label:t,traceOfFirstTimeRender:new Error,history:[]})),(0,Vh.useLayoutEffect)(()=>function(){i.current.unmounted=!0,i.current.untap(),Jh(i.current)},[]),Jh(i.current);let a=i.current.der.getValue();return i.current.lastValue=a,Hh&&(null==(n=i.current.debug)||n.history.push("rendered")),a}var Nh,Uh,Vh,qh,Hh,Wh,Zh,Kh,Gh,Xh,$h,Yh,Jh,Qh=k(()=>{Nh=n(194),Th(),Uh=P(Ah()),Vh=P(Oh()),qh=P(Bh()),Hh=!1,Wh=(e,t)=>Rh(()=>(0,Nh.val)(e),[e],t),Zh=0,Kh=[],Gh=new Set,Xh=!1,$h=e=>{Yh(e),Xh||(Xh=!0,(0,Uh.default)(()=>{(0,qh.unstable_batchedUpdates)(function(){for(var e,t;Kh.length>0;){let r,i=Kh.shift();Gh.delete(i),Hh&&(null==(e=i.debug)||e.history.push("queue reached"));try{r=i.der.getValue()}catch(n){Hh&&(null==(t=i.debug)||t.history.push("queue: der.getValue() errored")),console.error("A `der.getValue()` in `usePrismInstance(der)` threw an error. This may be a zombie child issue, so we're gonna try to get its value again in a normal react render phase.If you see the same error again, then you either have an error in your prism code, or the deps array in `usePrism(fn, deps)` is missing a dependency and causing the prism to read stale values."),console.error(n),i.runUpdate();continue}r!==i.lastValue&&(i.lastValue=r,i.runUpdate())}Xh=!1},1)}))},Yh=e=>{if(!Gh.has(e))if(Gh.add(e),0===Kh.length)Kh.push(e);else{let t=ld(Kh,t=>t.order>=e.order);-1===t?Kh.push(e):Kh[t].order>e.order&&Kh.splice(t,0,e)}},Jh=e=>{if(!Gh.has(e))return;Gh.delete(e);let t=ld(Kh,t=>t===e);Kh.splice(t,1)}}),ef=S(e=>{var t,n=60103,r=60106,i=60107,a=60108,o=60114,s=60109,l=60110,u=60112,c=60113,d=60120,h=60115,f=60116,p=60121,m=60122,g=60117,y=60129,v=60131;function _(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case i:case o:case a:case c:case d:return e;default:switch(e=e&&e.$$typeof){case l:case u:case f:case h:case s:return e;default:return t}}case r:return t}}}"function"==typeof Symbol&&Symbol.for&&(t=Symbol.for,n=t("react.element"),r=t("react.portal"),i=t("react.fragment"),a=t("react.strict_mode"),o=t("react.profiler"),s=t("react.provider"),l=t("react.context"),u=t("react.forward_ref"),c=t("react.suspense"),d=t("react.suspense_list"),h=t("react.memo"),f=t("react.lazy"),p=t("react.block"),m=t("react.server.block"),g=t("react.fundamental"),y=t("react.debug_trace_mode"),v=t("react.legacy_hidden"));var b=s,x=n,w=u,k=i,S=f,E=h,C=r,P=o,D=a,I=c;e.ContextConsumer=l,e.ContextProvider=b,e.Element=x,e.ForwardRef=w,e.Fragment=k,e.Lazy=S,e.Memo=E,e.Portal=C,e.Profiler=P,e.StrictMode=D,e.Suspense=I,e.isAsyncMode=function(){return!1},e.isConcurrentMode=function(){return!1},e.isContextConsumer=function(e){return _(e)===l},e.isContextProvider=function(e){return _(e)===s},e.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},e.isForwardRef=function(e){return _(e)===u},e.isFragment=function(e){return _(e)===i},e.isLazy=function(e){return _(e)===f},e.isMemo=function(e){return _(e)===h},e.isPortal=function(e){return _(e)===r},e.isProfiler=function(e){return _(e)===o},e.isStrictMode=function(e){return _(e)===a},e.isSuspense=function(e){return _(e)===c},e.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===o||e===y||e===a||e===c||e===d||e===v||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===h||e.$$typeof===s||e.$$typeof===l||e.$$typeof===u||e.$$typeof===g||e.$$typeof===p||e[0]===m)},e.typeOf=_}),tf=S((e,t)=>{t.exports=ef()}),nf=S((e,t)=>{t.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),l=0;l<a.length;l++){var u=a[l];if(!s(u))return!1;var c=e[u],d=t[u];if(!1===(i=n?n.call(r,c,d,u):void 0)||void 0===i&&c!==d)return!1}return!0}});function rf(e){function t(e,r,l,u,h){for(var f,p,m,g,b,w=0,k=0,S=0,E=0,C=0,z=0,F=m=f=0,j=0,B=0,R=0,L=0,N=l.length,U=N-1,V="",q="",H="",W="";j<N;){if(p=l.charCodeAt(j),j===U&&k+E+S+w!==0&&(0!==k&&(p=47===k?10:47),E=S=w=0,N++,U++),k+E+S+w===0){if(j===U&&(0<B&&(V=V.replace(d,"")),0<V.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:V+=l.charAt(j)}p=59}switch(p){case 123:for(f=(V=V.trim()).charCodeAt(0),m=1,L=++j;j<N;){switch(p=l.charCodeAt(j)){case 123:m++;break;case 125:m--;break;case 47:switch(p=l.charCodeAt(j+1)){case 42:case 47:e:{for(F=j+1;F<U;++F)switch(l.charCodeAt(F)){case 47:if(42===p&&42===l.charCodeAt(F-1)&&j+2!==F){j=F+1;break e}break;case 10:if(47===p){j=F+1;break e}}j=F}}break;case 91:p++;case 40:p++;case 34:case 39:for(;j++<U&&l.charCodeAt(j)!==p;);}if(0===m)break;j++}if(64===(m=l.substring(L,j),0===f&&(f=(V=V.replace(c,"").trim()).charCodeAt(0)),f)){switch(0<B&&(V=V.replace(d,"")),p=V.charCodeAt(1)){case 100:case 109:case 115:case 45:B=r;break;default:B=A}if(L=(m=t(r,B,m,p,h+1)).length,0<O&&(b=s(3,m,B=n(A,V,R),r,D,P,L,p,h,u),V=B.join(""),void 0!==b&&0===(L=(m=b.trim()).length)&&(p=0,m="")),0<L)switch(p){case 115:V=V.replace(x,o);case 100:case 109:case 45:m=V+"{"+m+"}";break;case 107:m=(V=V.replace(y,"$1 $2"))+"{"+m+"}",m=1===T||2===T&&a("@"+m,3)?"@-webkit-"+m+"@"+m:"@"+m;break;default:m=V+m,112===u&&(q+=m,m="")}else m=""}else m=t(r,n(r,V,R),m,u,h+1);H+=m,m=R=B=F=f=0,V="",p=l.charCodeAt(++j);break;case 125:case 59:if(1<(L=(V=(0<B?V.replace(d,""):V).trim()).length))switch(0===F&&(f=V.charCodeAt(0),45===f||96<f&&123>f)&&(L=(V=V.replace(" ",":")).length),0<O&&void 0!==(b=s(1,V,r,e,D,P,q.length,u,h,u))&&0===(L=(V=b.trim()).length)&&(V="\0\0"),f=V.charCodeAt(0),p=V.charCodeAt(1),f){case 0:break;case 64:if(105===p||99===p){W+=V+l.charAt(j);break}default:58!==V.charCodeAt(L-1)&&(q+=i(V,f,p,V.charCodeAt(2)))}R=B=F=f=0,V="",p=l.charCodeAt(++j)}}switch(p){case 13:case 10:47===k?k=0:1+f===0&&107!==u&&0<V.length&&(B=1,V+="\0"),0<O*M&&s(0,V,r,e,D,P,q.length,u,h,u),P=1,D++;break;case 59:case 125:if(k+E+S+w===0){P++;break}default:switch(P++,g=l.charAt(j),p){case 9:case 32:if(E+w+k===0)switch(C){case 44:case 58:case 9:case 32:g="";break;default:32!==p&&(g=" ")}break;case 0:g="\\0";break;case 12:g="\\f";break;case 11:g="\\v";break;case 38:E+k+w===0&&(B=R=1,g="\f"+g);break;case 108:if(E+k+w+I===0&&0<F)switch(j-F){case 2:112===C&&58===l.charCodeAt(j-3)&&(I=C);case 8:111===z&&(I=z)}break;case 58:E+k+w===0&&(F=j);break;case 44:k+S+E+w===0&&(B=1,g+="\r");break;case 34:case 39:0===k&&(E=E===p?0:0===E?p:E);break;case 91:E+k+S===0&&w++;break;case 93:E+k+S===0&&w--;break;case 41:E+k+w===0&&S--;break;case 40:if(E+k+w===0){if(0===f)if(2*C+3*z===533);else f=1;S++}break;case 64:k+S+E+w+F+m===0&&(m=1);break;case 42:case 47:if(!(0<E+w+S))switch(k){case 0:switch(2*p+3*l.charCodeAt(j+1)){case 235:k=47;break;case 220:L=j,k=42}break;case 42:47===p&&42===C&&L+2!==j&&(33===l.charCodeAt(L+2)&&(q+=l.substring(L,j+1)),g="",k=0)}}0===k&&(V+=g)}z=C,C=p,j++}if(0<(L=q.length)){if(B=r,0<O&&(void 0!==(b=s(2,q,B,e,D,P,L,u,h,u))&&0===(q=b).length))return W+q+H;if(q=B.join(",")+"{"+q+"}",T*I!==0){switch(2!==T||a(q,2)||(I=0),I){case 111:q=q.replace(_,":-moz-$1")+q;break;case 112:q=q.replace(v,"::-webkit-input-$1")+q.replace(v,"::-moz-$1")+q.replace(v,":-ms-input-$1")+q}I=0}}return W+q+H}function n(e,t,n){var i=t.trim().split(m);t=i;var a=i.length,o=e.length;switch(o){case 0:case 1:var s=0;for(e=0===o?"":e[0]+" ";s<a;++s)t[s]=r(e,t[s],n).trim();break;default:var l=s=0;for(t=[];s<a;++s)for(var u=0;u<o;++u)t[l++]=r(e[u]+" ",i[s],n).trim()}return t}function r(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(g,"$1"+e.trim());case 58:return e.trim()+t.replace(g,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(g,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function i(e,t,n,r){var o=e+";",s=2*t+3*n+4*r;if(944===s){e=o.indexOf(":",9)+1;var l=o.substring(e,o.length-1).trim();return l=o.substring(0,e).trim()+l+";",1===T||2===T&&a(l,1)?"-webkit-"+l+l:l}if(0===T||2===T&&!a(o,1))return o;switch(s){case 1015:return 97===o.charCodeAt(10)?"-webkit-"+o+o:o;case 951:return 116===o.charCodeAt(3)?"-webkit-"+o+o:o;case 963:return 110===o.charCodeAt(5)?"-webkit-"+o+o:o;case 1009:if(100!==o.charCodeAt(4))break;case 969:case 942:return"-webkit-"+o+o;case 978:return"-webkit-"+o+"-moz-"+o+o;case 1019:case 983:return"-webkit-"+o+"-moz-"+o+"-ms-"+o+o;case 883:if(45===o.charCodeAt(8))return"-webkit-"+o+o;if(0<o.indexOf("image-set(",11))return o.replace(C,"$1-webkit-$2")+o;break;case 932:if(45===o.charCodeAt(4))switch(o.charCodeAt(5)){case 103:return"-webkit-box-"+o.replace("-grow","")+"-webkit-"+o+"-ms-"+o.replace("grow","positive")+o;case 115:return"-webkit-"+o+"-ms-"+o.replace("shrink","negative")+o;case 98:return"-webkit-"+o+"-ms-"+o.replace("basis","preferred-size")+o}return"-webkit-"+o+"-ms-"+o+o;case 964:return"-webkit-"+o+"-ms-flex-"+o+o;case 1023:if(99!==o.charCodeAt(8))break;return"-webkit-box-pack"+(l=o.substring(o.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+o+"-ms-flex-pack"+l+o;case 1005:return f.test(o)?o.replace(h,":-webkit-")+o.replace(h,":-moz-")+o:o;case 1e3:switch(t=(l=o.substring(13).trim()).indexOf("-")+1,l.charCodeAt(0)+l.charCodeAt(t)){case 226:l=o.replace(b,"tb");break;case 232:l=o.replace(b,"tb-rl");break;case 220:l=o.replace(b,"lr");break;default:return o}return"-webkit-"+o+"-ms-"+l+o;case 1017:if(-1===o.indexOf("sticky",9))break;case 975:switch(t=(o=e).length-10,s=(l=(33===o.charCodeAt(t)?o.substring(0,t):o).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|l.charCodeAt(7))){case 203:if(111>l.charCodeAt(8))break;case 115:o=o.replace(l,"-webkit-"+l)+";"+o;break;case 207:case 102:o=o.replace(l,"-webkit-"+(102<s?"inline-":"")+"box")+";"+o.replace(l,"-webkit-"+l)+";"+o.replace(l,"-ms-"+l+"box")+";"+o}return o+";";case 938:if(45===o.charCodeAt(5))switch(o.charCodeAt(6)){case 105:return l=o.replace("-items",""),"-webkit-"+o+"-webkit-box-"+l+"-ms-flex-"+l+o;case 115:return"-webkit-"+o+"-ms-flex-item-"+o.replace(k,"")+o;default:return"-webkit-"+o+"-ms-flex-line-pack"+o.replace("align-content","").replace(k,"")+o}break;case 973:case 989:if(45!==o.charCodeAt(3)||122===o.charCodeAt(4))break;case 931:case 953:if(!0===E.test(e))return 115===(l=e.substring(e.indexOf(":")+1)).charCodeAt(0)?i(e.replace("stretch","fill-available"),t,n,r).replace(":fill-available",":stretch"):o.replace(l,"-webkit-"+l)+o.replace(l,"-moz-"+l.replace("fill-",""))+o;break;case 962:if(o="-webkit-"+o+(102===o.charCodeAt(5)?"-ms-"+o:"")+o,n+r===211&&105===o.charCodeAt(13)&&0<o.indexOf("transform",10))return o.substring(0,o.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+o}return o}function a(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),F(2!==t?r:r.replace(S,"$1"),n,t)}function o(e,t){var n=i(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(w," or ($1)").substring(4):"("+t+")"}function s(e,t,n,r,i,a,o,s,l,c){for(var d,h=0,f=t;h<O;++h)switch(d=z[h].call(u,e,f,n,r,i,a,o,s,l,c)){case void 0:case!1:case!0:case null:break;default:f=d}if(f!==t)return f}function l(e){return void 0!==(e=e.prefix)&&(F=null,e?"function"!=typeof e?T=1:(T=2,F=e):T=0),l}function u(e,n){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<O){var i=s(-1,n,r,r,D,P,0,0,0,0);void 0!==i&&"string"==typeof i&&(n=i)}var a=t(A,r,n,0,0);return 0<O&&(void 0!==(i=s(-2,a,r,r,D,P,a.length,0,0,0))&&(a=i)),I=0,P=D=1,a}var c=/^\0+/g,d=/[\0\r\f]/g,h=/: */g,f=/zoo|gra/,p=/([,: ])(transform)/g,m=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,v=/::(place)/g,_=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,x=/\(\s*(.*)\s*\)/g,w=/([\s\S]*?);/g,k=/-self|flex-/g,S=/[^]*?(:[rp][el]a[\w-]+)[^]*/,E=/stretch|:\s*\w+\-(?:conte|avail)/,C=/([^-])(image-set\()/,P=1,D=1,I=0,T=1,A=[],z=[],O=0,F=null,M=0;return u.use=function e(t){switch(t){case void 0:case null:O=z.length=0;break;default:if("function"==typeof t)z[O++]=t;else if("object"==typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else M=0|!!t}return e},u.set=l,void 0!==e&&l(e),u}var af,of,sf=k(()=>{af=rf}),lf=k(()=>{of={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}});function uf(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}var cf,df,hf,ff,pf=k(()=>{cf=uf}),mf=k(()=>{pf(),df=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,hf=cf(function(e){return df.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}),ff=hf}),gf=S(e=>{var t="function"==typeof Symbol&&Symbol.for,n=t?Symbol.for("react.element"):60103,r=t?Symbol.for("react.portal"):60106,i=t?Symbol.for("react.fragment"):60107,a=t?Symbol.for("react.strict_mode"):60108,o=t?Symbol.for("react.profiler"):60114,s=t?Symbol.for("react.provider"):60109,l=t?Symbol.for("react.context"):60110,u=t?Symbol.for("react.async_mode"):60111,c=t?Symbol.for("react.concurrent_mode"):60111,d=t?Symbol.for("react.forward_ref"):60112,h=t?Symbol.for("react.suspense"):60113,f=t?Symbol.for("react.suspense_list"):60120,p=t?Symbol.for("react.memo"):60115,m=t?Symbol.for("react.lazy"):60116,g=t?Symbol.for("react.block"):60121,y=t?Symbol.for("react.fundamental"):60117,v=t?Symbol.for("react.responder"):60118,_=t?Symbol.for("react.scope"):60119;function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case c:case i:case o:case a:case h:return e;default:switch(e=e&&e.$$typeof){case l:case d:case m:case p:case s:return e;default:return t}}case r:return t}}}function x(e){return b(e)===c}e.AsyncMode=u,e.ConcurrentMode=c,e.ContextConsumer=l,e.ContextProvider=s,e.Element=n,e.ForwardRef=d,e.Fragment=i,e.Lazy=m,e.Memo=p,e.Portal=r,e.Profiler=o,e.StrictMode=a,e.Suspense=h,e.isAsyncMode=function(e){return x(e)||b(e)===u},e.isConcurrentMode=x,e.isContextConsumer=function(e){return b(e)===l},e.isContextProvider=function(e){return b(e)===s},e.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},e.isForwardRef=function(e){return b(e)===d},e.isFragment=function(e){return b(e)===i},e.isLazy=function(e){return b(e)===m},e.isMemo=function(e){return b(e)===p},e.isPortal=function(e){return b(e)===r},e.isProfiler=function(e){return b(e)===o},e.isStrictMode=function(e){return b(e)===a},e.isSuspense=function(e){return b(e)===h},e.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===c||e===o||e===a||e===h||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===p||e.$$typeof===s||e.$$typeof===l||e.$$typeof===d||e.$$typeof===y||e.$$typeof===v||e.$$typeof===_||e.$$typeof===g)},e.typeOf=b}),yf=S((e,t)=>{t.exports=gf()}),vf=S((e,t)=>{var n=yf(),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},o={};function s(e){return n.isMemo(e)?a:o[e.$$typeof]||r}o[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},o[n.Memo]=a;var l=Object.defineProperty,u=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,d=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;t.exports=function e(t,n,r){if("string"!=typeof n){if(f){var a=h(n);a&&a!==f&&e(t,a,r)}var o=u(n);c&&(o=o.concat(c(n)));for(var p=s(t),m=s(n),g=0;g<o.length;++g){var y=o[g];if(!i[y]&&(!r||!r[y])&&(!m||!m[y])&&(!p||!p[y])){var v=d(n,y);try{l(t,y,v)}catch(_){}}}}return t}});function _f(){return(_f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function bf(e){return"function"==typeof e}function xf(e){return e.displayName||e.name||"Component"}function wf(e){return e&&"string"==typeof e.styledComponentId}function kf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}function Sf(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=yp(t%52)+n;return(yp(t%52)+n).replace(gp,"$1-$2")}function Ef(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(bf(n)&&!wf(n))return!1}return!0}function Cf(e){var t,n,r,i,a=void 0===e?Zf:e,o=a.options,s=void 0===o?Zf:o,l=a.plugins,u=void 0===l?Wf:l,c=new af(s),d=[],h=function(e){function t(t){if(t)try{e(t+"}")}catch(n){}}return function(n,r,i,a,o,s,l,u,c,d){switch(n){case 1:if(0===c&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===u)return r+"/*|*/";break;case 3:switch(u){case 102:case 112:return e(i[0]+r),"";default:return r+(0===d?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(t)}}}(function(e){d.push(e)}),f=function(e,r,a){return 0===r&&-1!==kp.indexOf(a[n.length])||a.match(i)?e:"."+t};function p(e,a,o,s){void 0===s&&(s="&");var l=e.replace(wp,""),u=a&&o?o+" "+a+" { "+l+" }":l;return t=s,n=a,r=new RegExp("\\"+n+"\\b","g"),i=new RegExp("(\\"+n+"\\b){2,}"),c(o||!a?"":a,u)}return c.use([].concat(u,[function(e,t,i){2===e&&i.length&&i[0].lastIndexOf(n)>0&&(i[0]=i[0].replace(r,f))},h,function(e){if(-2===e){var t=d;return d=[],t}}])),p.hash=u.length?u.reduce(function(e,t){return t.name||kf(15),vp(e,t.name)},5381).toString():"",p}function Pf(){return(0,Nf.useContext)(Sp)||Cp}function Df(){return(0,Nf.useContext)(Ep)||Pp}function If(e){var t=(0,Nf.useState)(e.stylisPlugins),n=t[0],r=t[1],i=Pf(),a=(0,Nf.useMemo)(function(){var t=i;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t},[e.disableCSSOMInjection,e.sheet,e.target]),o=(0,Nf.useMemo)(function(){return Cf({options:{prefix:!e.disableVendorPrefixes},plugins:n})},[e.disableVendorPrefixes,n]);return(0,Nf.useEffect)(function(){(0,Uf.default)(n,e.stylisPlugins)||r(e.stylisPlugins)},[e.stylisPlugins]),Nf.default.createElement(Sp.Provider,{value:a},Nf.default.createElement(Ep.Provider,{value:o},e.children))}function Tf(e){return Ip.test(e)?e.replace(Tp,zp).replace(Ap,"-ms-"):e}function Af(e,t,n,r){if(Array.isArray(e)){for(var i,a=[],o=0,s=e.length;o<s;o+=1)""!==(i=Af(e[o],t,n,r))&&(Array.isArray(i)?a.push.apply(a,i):a.push(i));return a}return Op(e)?"":wf(e)?"."+e.styledComponentId:bf(e)?"function"!=typeof(l=e)||l.prototype&&l.prototype.isReactComponent||!t?e:Af(e(t),t,n,r):e instanceof Dp?n?(e.inject(n,r),e.getName(r)):e:Hf(e)?function e(t,n){var r,i,a=[];for(var o in t)t.hasOwnProperty(o)&&!Op(t[o])&&(Array.isArray(t[o])&&t[o].isCss||bf(t[o])?a.push(Tf(o)+":",t[o],";"):Hf(t[o])?a.push.apply(a,e(t[o],o)):a.push(Tf(o)+": "+(r=o,(null==(i=t[o])||"boolean"==typeof i||""===i?"":"number"!=typeof i||0===i||r in of||r.startsWith("--")?String(i).trim():i+"px")+";")));return n?[n+" {"].concat(a,["}"]):a}(e):e.toString();var l}function zf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return bf(e)||Hf(e)?Fp(Af(qf(Wf,[e].concat(n)))):0===n.length&&1===e.length&&"string"==typeof e[0]?e:Fp(Af(qf(e,n)))}function Of(e){return e.replace(jp,"-").replace(Bp,"")}function Ff(e){return"string"==typeof e&&!0}function Mf(e,t,n){var r=e[n];Lp(t)&&Lp(r)?jf(r,t):e[n]=t}function jf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,a=n;i<a.length;i++){var o=a[i];if(Lp(o))for(var s in o)Np(s)&&Mf(e,o[s],s)}return e}function Bf(e,t,n){var r,i=wf(e),a=!Ff(e),o=t.attrs,s=void 0===o?Wf:o,l=t.componentId,u=void 0===l?function(e,t){var n="string"!=typeof e?"sc":Of(e);Vp[n]=(Vp[n]||0)+1;var r=n+"-"+Rp("5.3.11"+n+Vp[n]);return t?t+"-"+r:r}(t.displayName,t.parentComponentId):l,c=t.displayName,d=void 0===c?Ff(r=e)?"styled."+r:"Styled("+xf(r)+")":c,h=t.displayName&&t.componentId?Of(t.displayName)+"-"+t.componentId:t.componentId||u,f=i&&e.attrs?Array.prototype.concat(e.attrs,s).filter(Boolean):s,p=t.shouldForwardProp;i&&e.shouldForwardProp&&(p=t.shouldForwardProp?function(n,r,i){return e.shouldForwardProp(n,r,i)&&t.shouldForwardProp(n,r,i)}:e.shouldForwardProp);var m,g=new xp(n,h,i?e.componentStyle:void 0),y=g.isStatic&&0===s.length,v=function(e,t){return function(e,t,n,r){var i=e.attrs,a=e.componentStyle,o=e.defaultProps,s=e.foldedComponentIds,l=e.shouldForwardProp,u=e.styledComponentId,c=e.target,d=function(e,t,n){void 0===e&&(e=Zf);var r=_f({},t,{theme:e}),i={};return n.forEach(function(e){var t,n,a,o=e;for(t in bf(o)&&(o=o(r)),o)r[t]=i[t]="className"===t?(n=i[t],a=o[t],n&&a?n+" "+a:n||a):o[t]}),[r,i]}(Mp(t,(0,Nf.useContext)(Up),o)||Zf,t,i),h=d[0],f=d[1],p=function(e,t,n){var r=Pf(),i=Df();return t?e.generateAndInjectStyles(Zf,r,i):e.generateAndInjectStyles(n,r,i)}(a,r,h),m=n,g=f.$as||t.$as||f.as||t.as||c,y=Ff(g),v=f!==t?_f({},t,{},f):t,_={};for(var b in v)"$"!==b[0]&&"as"!==b&&("forwardedAs"===b?_.as=v[b]:(l?l(b,ff,g):!y||ff(b))&&(_[b]=v[b]));return t.style&&f.style!==t.style&&(_.style=_f({},t.style,{},f.style)),_.className=Array.prototype.concat(s,u,p!==u?p:null,t.className,f.className).filter(Boolean).join(" "),_.ref=m,(0,Nf.createElement)(g,_)}(m,e,t,y)};return v.displayName=d,(m=Nf.default.forwardRef(v)).attrs=f,m.componentStyle=g,m.displayName=d,m.shouldForwardProp=p,m.foldedComponentIds=i?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):Wf,m.styledComponentId=h,m.target=i?e.target:e,m.withComponent=function(e){var r=t.componentId,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(t,["componentId"]),a=r&&r+"-"+(Ff(e)?e:Of(xf(e)));return Bf(e,_f({},i,{attrs:f,componentId:a}),n)},Object.defineProperty(m,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=i?jf({},e.defaultProps,t):t}}),Object.defineProperty(m,"toString",{value:function(){return"."+m.styledComponentId}}),a&&(0,Vf.default)(m,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),m}function Rf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=zf.apply(void 0,[e].concat(n)),a="sc-global-"+Rp(JSON.stringify(i)),o=new Hp(i,a);function s(e){var t=Pf(),n=Df(),r=(0,Nf.useContext)(Up),i=(0,Nf.useRef)(t.allocateGSInstance(a)).current;return t.server&&l(i,e,t,r,n),(0,Nf.useLayoutEffect)(function(){if(!t.server)return l(i,e,t,r,n),function(){return o.removeStyles(i,t)}},[i,e,t,r,n]),null}function l(e,t,n,r,i){if(o.isStatic)o.renderStyles(e,$f,n,i);else{var a=_f({},t,{theme:Mp(t,r,s.defaultProps)});o.renderStyles(e,a,n,i)}}return Nf.default.memo(s)}var Lf,Nf,Uf,Vf,qf,Hf,Wf,Zf,Kf,Gf,Xf,$f,Yf,Jf,Qf,ep,tp,np,rp,ip,ap,op,sp,lp,up,cp,dp,hp,fp,pp,mp,gp,yp,vp,_p,bp,xp,wp,kp,Sp,Ep,Cp,Pp,Dp,Ip,Tp,Ap,zp,Op,Fp,Mp,jp,Bp,Rp,Lp,Np,Up,Vp,qp,Hp,Wp,Zp=k(()=>{Lf=P(tf()),Nf=P(Oh()),Uf=P(nf()),sf(),lf(),mf(),Vf=P(vf()),qf=function(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n},Hf=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!(0,Lf.typeOf)(e)},Wf=Object.freeze([]),Zf=Object.freeze({}),Kf="undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_ATTR||{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_ATTR)||"data-styled",Gf="undefined"!=typeof window&&"HTMLElement"in window,Xf=!!("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof process&&void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}&&(void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY?"false"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SC_DISABLE_SPEEDY:void 0!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&""!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&"false"!=={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY&&{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.SC_DISABLE_SPEEDY)),$f={},Yf=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,i=r;e>=i;)(i<<=1)<0&&kf(16,""+e);this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var a=r;a<i;a++)this.groupSizes[a]=0}for(var o=this.indexOfGroup(e+1),s=0,l=t.length;s<l;s++)this.tag.insertRule(o,t[s])&&(this.groupSizes[e]++,o++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var i=n;i<r;i++)this.tag.deleteRule(n)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n,a=r;a<i;a++)t+=this.tag.getRule(a)+"/*!sc*/\n";return t},e}(),Jf=new Map,Qf=new Map,ep=1,tp=function(e){if(Jf.has(e))return Jf.get(e);for(;Qf.has(ep);)ep++;var t=ep++;return Jf.set(e,t),Qf.set(t,e),t},np=function(e){return Qf.get(e)},rp=function(e,t){t>=ep&&(ep=t+1),Jf.set(e,t),Qf.set(t,e)},ip="style["+Kf+'][data-styled-version="5.3.11"]',ap=new RegExp("^"+Kf+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),op=function(e,t,n){for(var r,i=n.split(","),a=0,o=i.length;a<o;a++)(r=i[a])&&e.registerName(t,r)},sp=function(e,t){for(var n=(t.textContent||"").split("/*!sc*/\n"),r=[],i=0,a=n.length;i<a;i++){var o=n[i].trim();if(o){var s=o.match(ap);if(s){var l=0|parseInt(s[1],10),u=s[2];0!==l&&(rp(u,l),op(e,u,s[3]),e.getTag().insertRules(l,r)),r.length=0}else r.push(o)}}},lp=function(){return n.nc},up=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(e){for(var t=e.childNodes,n=t.length;n>=0;n--){var r=t[n];if(r&&1===r.nodeType&&r.hasAttribute(Kf))return r}}(n),a=void 0!==i?i.nextSibling:null;r.setAttribute(Kf,"active"),r.setAttribute("data-styled-version","5.3.11");var o=lp();return o&&r.setAttribute("nonce",o),n.insertBefore(r,a),r},cp=function(){function e(e){var t=this.element=up(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var i=t[n];if(i.ownerNode===e)return i}kf(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(n){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),dp=function(){function e(e){var t=this.element=up(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t),r=this.nodes[e];return this.element.insertBefore(n,r||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),hp=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),fp=Gf,pp={isServer:!Gf,useCSSOMInjection:!Xf},mp=function(){function e(e,t,n){void 0===e&&(e=Zf),void 0===t&&(t={}),this.options=_f({},pp,{},e),this.gs=t,this.names=new Map(n),this.server=!!e.isServer,!this.server&&Gf&&fp&&(fp=!1,function(e){for(var t=document.querySelectorAll(ip),n=0,r=t.length;n<r;n++){var i=t[n];i&&"active"!==i.getAttribute(Kf)&&(sp(e,i),i.parentNode&&i.parentNode.removeChild(i))}}(this))}e.registerId=function(e){return tp(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(_f({},this.options,{},t),this.gs,n&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(t=this.options).isServer,r=t.useCSSOMInjection,i=t.target,e=n?new hp(i):r?new cp(i):new dp(i),new Yf(e)));var e,t,n,r,i},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(tp(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},t.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(tp(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(tp(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),n=t.length,r="",i=0;i<n;i++){var a=np(i);if(void 0!==a){var o=e.names.get(a),s=t.getGroup(i);if(o&&s&&o.size){var l=Kf+".g"+i+'[id="'+a+'"]',u="";void 0!==o&&o.forEach(function(e){e.length>0&&(u+=e+",")}),r+=""+s+l+'{content:"'+u+'"}/*!sc*/\n'}}}return r}(this)},e}(),gp=/(a)(d)/gi,yp=function(e){return String.fromCharCode(e+(e>25?39:97))},vp=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},bp=(_p=function(e){return vp(5381,e)})("5.3.11"),xp=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&Ef(e),this.componentId=t,this.baseHash=vp(bp,t),this.baseStyle=n,mp.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.componentId,i=[];if(this.baseStyle&&i.push(this.baseStyle.generateAndInjectStyles(e,t,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(r,this.staticRulesId))i.push(this.staticRulesId);else{var a=Af(this.rules,e,t,n).join(""),o=Sf(vp(this.baseHash,a)>>>0);if(!t.hasNameForId(r,o)){var s=n(a,"."+o,void 0,r);t.insertRules(r,o,s)}i.push(o),this.staticRulesId=o}else{for(var l=this.rules.length,u=vp(this.baseHash,n.hash),c="",d=0;d<l;d++){var h=this.rules[d];if("string"==typeof h)c+=h;else if(h){var f=Af(h,e,t,n),p=Array.isArray(f)?f.join(""):f;u=vp(u,p+d),c+=p}}if(c){var m=Sf(u>>>0);if(!t.hasNameForId(r,m)){var g=n(c,"."+m,void 0,r);t.insertRules(r,m,g)}i.push(m)}}return i.join(" ")},e}(),wp=/^\s*\/\/.*$/gm,kp=[":","[",".","#"],Sp=Nf.default.createContext(),Sp.Consumer,(Ep=Nf.default.createContext()).Consumer,Cp=new mp,Pp=Cf(),Dp=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=Pp);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.toString=function(){return kf(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=Pp),this.name+e.hash},e}(),Ip=/([A-Z])/,Tp=/([A-Z])/g,Ap=/^ms-/,zp=function(e){return"-"+e.toLowerCase()},Op=function(e){return null==e||!1===e||""===e},Fp=function(e){return Array.isArray(e)&&(e.isCss=!0),e},Mp=function(e,t,n){return void 0===n&&(n=Zf),e.theme!==n.theme&&e.theme||t||n.theme},jp=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,Bp=/(^-|-$)/g,Rp=function(e){return Sf(_p(e)>>>0)},Lp=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Np=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e},Up=Nf.default.createContext(),Up.Consumer,Vp={},qp=function(e){return function e(t,n,r){if(void 0===r&&(r=Zf),!(0,Lf.isValidElementType)(n))return kf(1,String(n));var i=function(){return t(n,r,zf.apply(void 0,arguments))};return i.withConfig=function(i){return e(t,n,_f({},r,{},i))},i.attrs=function(i){return e(t,n,_f({},r,{attrs:Array.prototype.concat(r.attrs,i).filter(Boolean)}))},i}(Bf,e)},["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(e){qp[e]=qp(e)}),Hp=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=Ef(e),mp.registerId(this.componentId+1)}var t=e.prototype;return t.createStyles=function(e,t,n,r){var i=r(Af(this.rules,t,n,r).join(""),""),a=this.componentId+e;n.insertRules(a,a,i)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,n,r){e>2&&mp.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)},e}(),function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString();if(!t)return"";var n=lp();return"<style "+[n&&'nonce="'+n+'"',Kf+'="true"','data-styled-version="5.3.11"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?kf(2):e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)return kf(2);var n=((t={})[Kf]="",t["data-styled-version"]="5.3.11",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),r=lp();return r&&(n.nonce=r),[Nf.default.createElement("style",_f({},n,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new mp({isServer:!0}),this.sealed=!1}var t=e.prototype;return t.collectStyles=function(e){return this.sealed?kf(2):Nf.default.createElement(If,{sheet:this.instance},e)},t.interleaveWithNodeStream=function(e){return kf(3)},e}(),Wp=qp});function Kp(){return Kp=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kp.apply(this,arguments)}var Gp=k(()=>{});var Xp=k(()=>{});function $p(e,t){return($p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Yp=k(()=>{});var Jp=k(()=>{Yp()});function Qp(e){return(Qp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var em=k(()=>{});var tm=k(()=>{});var nm=k(()=>{});function rm(e,t,n){return(rm=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&$p(i,n.prototype),i}).apply(null,arguments)}var im=k(()=>{Yp(),nm()});function am(e){var t="function"==typeof Map?new Map:void 0;return am=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return rm(e,arguments,Qp(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),$p(n,e)},am(e)}var om=k(()=>{em(),Yp(),tm(),im()}),sm=k(()=>{});function lm(e,t){if(!e)return t.toLowerCase();var n=e.split("-");if(n.length>1)return n.splice(1,0,t),n.reduce(function(e,t){return""+e+function(e){return e.charAt(0).toUpperCase()+e.slice(1)}(t)});var r=e.replace(/([a-z])([A-Z])/g,"$1"+t+"$2");return e===r?""+e+t:r}function um(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],a=n[1],o=void 0===a?i:a,s=n[2],l=void 0===s?i:s,u=n[3];return function(e,t){for(var n={},r=0;r<t.length;r+=1)(t[r]||0===t[r])&&(n[lm(e,Am[r])]=t[r]);return n}(e,[i,o,l,void 0===u?o:u])}function cm(e){return Math.round(255*e)}function dm(e,t,n){return cm(e)+","+cm(t)+","+cm(n)}function hm(e,t,n,r){if(void 0===r&&(r=dm),0===t)return r(n,n,n);var i=(e%360+360)%360/60,a=(1-Math.abs(2*n-1))*t,o=a*(1-Math.abs(i%2-1)),s=0,l=0,u=0;i>=0&&i<1?(s=a,l=o):i>=1&&i<2?(s=o,l=a):i>=2&&i<3?(l=a,u=o):i>=3&&i<4?(l=o,u=a):i>=4&&i<5?(s=o,u=a):i>=5&&i<6&&(s=a,u=o);var c=n-a/2;return r(s+c,l+c,u+c)}function fm(e){if("string"!=typeof e)throw new Tm(3);var t=function(e){if("string"!=typeof e)return e;var t=e.toLowerCase();return zm[t]?"#"+zm[t]:e}(e);if(t.match(Om))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(Fm)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(Mm))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(jm)){var r=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:r}}var i=Bm.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var a=Rm.exec(t.substring(0,50));if(a)return{red:parseInt(""+a[1],10),green:parseInt(""+a[2],10),blue:parseInt(""+a[3],10),alpha:parseFloat(""+a[4])};var o=Lm.exec(t);if(o){var s="rgb("+hm(parseInt(""+o[1],10),parseInt(""+o[2],10)/100,parseInt(""+o[3],10)/100)+")",l=Bm.exec(s);if(!l)throw new Tm(4,t,s);return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var u=Nm.exec(t.substring(0,50));if(u){var c="rgb("+hm(parseInt(""+u[1],10),parseInt(""+u[2],10)/100,parseInt(""+u[3],10)/100)+")",d=Bm.exec(c);if(!d)throw new Tm(4,t,c);return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10),alpha:parseFloat(""+u[4])}}throw new Tm(5)}function pm(e){return function(e){var t=e.red/255,n=e.green/255,r=e.blue/255,i=Math.max(t,n,r),a=Math.min(t,n,r),o=(i+a)/2;if(i===a)return void 0!==e.alpha?{hue:0,saturation:0,lightness:o,alpha:e.alpha}:{hue:0,saturation:0,lightness:o};var s,l=i-a,u=o>.5?l/(2-i-a):l/(i+a);switch(i){case t:s=(n-r)/l+(n<r?6:0);break;case n:s=(r-t)/l+2;break;default:s=(t-n)/l+4}return s*=60,void 0!==e.alpha?{hue:s,saturation:u,lightness:o,alpha:e.alpha}:{hue:s,saturation:u,lightness:o}}(fm(e))}function mm(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function gm(e){return mm(Math.round(255*e))}function ym(e,t,n){return Um("#"+gm(e)+gm(t)+gm(n))}function vm(e,t,n){return hm(e,t,n,ym)}function _m(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return Um("#"+mm(e)+mm(t)+mm(n));if("object"==typeof e&&void 0===t&&void 0===n)return Um("#"+mm(e.red)+mm(e.green)+mm(e.blue));throw new Tm(6)}function bm(e,t,n,r){if("string"==typeof e&&"number"==typeof t){var i=fm(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?_m(e,t,n):"rgba("+e+","+t+","+n+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?_m(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new Tm(7)}function xm(e){if("object"!=typeof e)throw new Tm(8);if(qm(e))return bm(e);if(Vm(e))return _m(e);if(Wm(e))return function(e,t,n,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof r)return r>=1?vm(e,t,n):"rgba("+hm(e,t,n)+","+r+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===r)return e.alpha>=1?vm(e.hue,e.saturation,e.lightness):"rgba("+hm(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new Tm(2)}(e);if(Hm(e))return function(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return vm(e,t,n);if("object"==typeof e&&void 0===t&&void 0===n)return vm(e.hue,e.saturation,e.lightness);throw new Tm(1)}(e);throw new Tm(8)}function wm(e,t,n){return function(){var r=n.concat(Array.prototype.slice.call(arguments));return r.length>=t?e.apply(this,r):wm(e,t,r)}}function km(e){return wm(e,e.length,[])}function Sm(e,t,n){return Math.max(e,Math.min(t,n))}function Em(e,t){if("transparent"===t)return t;var n=pm(t);return xm(Kp({},n,{lightness:Sm(0,1,n.lightness-parseFloat(e))}))}function Cm(e,t){if("transparent"===t)return t;var n=pm(t);return xm(Kp({},n,{lightness:Sm(0,1,n.lightness+parseFloat(e))}))}function Pm(e,t){if("transparent"===t)return t;var n=pm(t);return xm(Kp({},n,{saturation:Sm(0,1,n.saturation+parseFloat(e))}))}function Dm(e,t){if("transparent"===t)return t;var n=fm(t);return bm(Kp({},n,{alpha:Sm(0,1,+(100*("number"==typeof n.alpha?n.alpha:1)-100*parseFloat(e)).toFixed(2)/100)}))}function Im(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return $m.indexOf(e)>=0&&e?Kp({},um.apply(void 0,[""].concat(n)),{position:e}):um.apply(void 0,["",e].concat(n))}var Tm,Am,zm,Om,Fm,Mm,jm,Bm,Rm,Lm,Nm,Um,Vm,qm,Hm,Wm,Zm,Km,Gm,Xm,$m,Ym=k(()=>{Gp(),Xp(),Jp(),om(),sm(),Tm=function(e){function t(t){return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this)}return function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,$p(e,t)}(t,e),t}(am(Error)),Am=["Top","Right","Bottom","Left"],zm={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Om=/^#[a-fA-F0-9]{6}$/,Fm=/^#[a-fA-F0-9]{8}$/,Mm=/^#[a-fA-F0-9]{3}$/,jm=/^#[a-fA-F0-9]{4}$/,Bm=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,Rm=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,Lm=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,Nm=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,Um=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e},Vm=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&("number"!=typeof e.alpha||"undefined"==typeof e.alpha)},qm=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&"number"==typeof e.alpha},Hm=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&("number"!=typeof e.alpha||"undefined"==typeof e.alpha)},Wm=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&"number"==typeof e.alpha},Zm=km(Em),Km=km(Cm),Gm=km(Pm),Xm=km(Dm),$m=["absolute","fixed","relative","static","sticky"]});function Jm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qm(Object(n),!0).forEach(function(t){Jm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qm(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function tg(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}var ng,rg,ig=k(()=>{}),ag=k(()=>{ng=P(Oh()),rg=(0,ng.createContext)({})});function og(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sg(Object(n),!0).forEach(function(t){og(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ug(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}function cg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dg(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return cg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cg(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}var hg=k(()=>{});var fg,pg,mg=k(()=>{fg=P(Oh()),ag(),hg(),pg=function(e,t,n){void 0===n&&(n=t.children);var r=(0,fg.useContext)(rg);if(r.useCreateElement)return r.useCreateElement(e,t,n);if("string"==typeof e&&"function"==typeof n){t.children;return n(ug(t,["children"]))}return(0,fg.createElement)(e,t,n)}});function gg(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function vg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yg(Object(n),!0).forEach(function(t){gg(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _g=k(()=>{});var bg=k(()=>{});function xg(e){var t;if(!function(e){return"object"==typeof e&&null!=e}(e))return!1;var n=Object.getPrototypeOf(e);return null==n||(null===(t=n.constructor)||void 0===t?void 0:t.toString())===Object.toString()}var wg=k(()=>{bg()});function kg(e,t){for(var n={},r={},i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];t.indexOf(o)>=0?n[o]=e[o]:r[o]=e[o]}return[n,r]}function Sg(e,t){if(void 0===t&&(t=[]),!xg(e.state))return kg(e,t);var n=kg(e,[].concat(t,["state"])),r=n[0],i=n[1],a=r.state,o=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],!(t.indexOf(n)>=0)&&(i[n]=e[n]);return i}(r,["state"]);return[vg(vg({},a),o),i]}var Eg=k(()=>{_g(),wg()});function Cg(e,t){if(e===t)return!0;if(!e||!t||"object"!=typeof e||"object"!=typeof t)return!1;var n=Object.keys(e),r=Object.keys(t),i=n.length;if(r.length!==i)return!1;for(var a=0,o=n;a<o.length;a++){var s=o[a];if(e[s]!==t[s])return!1}return!0}var Pg=k(()=>{});function Dg(e){return"normalizePropsAreEqualInner"===e.name?e:function(t,n){return xg(t.state)&&xg(n.state)?e(vg(vg({},t.state),t),vg(vg({},n.state),n)):e(t,n)}}var Ig=k(()=>{_g(),wg()});function Tg(e){var t=e.as,n=e.useHook,r=e.memo,i=e.propsAreEqual,a=void 0===i?null==n?void 0:n.unstable_propsAreEqual:i,o=e.keys,s=void 0===o?(null==n?void 0:n.__keys)||[]:o,l=e.useCreateElement,u=void 0===l?pg:l,c=function(e,r){var i=e.as,a=void 0===i?t:i,o=ug(e,["as"]);if(n){var l,c=Sg(o,s),d=c[0],h=c[1],f=n(d,lg({ref:r},h)),p=f.wrapElement,m=ug(f,["wrapElement"]),g=(null===(l=a.render)||void 0===l?void 0:l.__keys)||a.__keys,y=g&&Sg(o,g)[0],v=y?lg(lg({},m),y):m,_=u(a,v);return p?p(_):_}return u(a,lg({ref:r},o))};return c=function(e){return(0,Ag.forwardRef)(e)}(c),r&&(c=function(e,t){return(0,Ag.memo)(e,t)}(c,a&&Dg(a))),c.__keys=s,c.unstable_propsAreEqual=Dg(a||Cg),c}var Ag,zg=k(()=>{Ag=P(Oh()),hg(),mg(),Eg(),Pg(),Ig()});function Og(e,t){(0,Fg.useDebugValue)(e);var n=(0,Fg.useContext)(rg);return null!=n[e]?n[e]:t}var Fg,Mg=k(()=>{Fg=P(Oh()),ag()});var jg,Bg=k(()=>{jg=P(Oh()),Mg()});var Rg,Lg=k(()=>{Rg=P(Oh()),Mg(),hg()});var Ng=k(()=>{});function Ug(e){var t,n,r=function(e){return Array.isArray(e)?e:"undefined"!=typeof e?[e]:[]}(e.compose),i=function(t,n){if(e.useOptions&&(t=e.useOptions(t,n)),e.name&&(t=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={});var r="use"+e+"Options";(0,Rg.useDebugValue)(r);var i=Og(r);return i?lg(lg({},t),i(t,n)):t}(e.name,t,n)),e.compose)for(var i,a=dg(r);!(i=a()).done;){t=i.value.__useOptions(t,n)}return t},a=function(t,n,a){if(void 0===t&&(t={}),void 0===n&&(n={}),void 0===a&&(a=!1),a||(t=i(t,n)),e.useProps&&(n=e.useProps(t,n)),e.name&&(n=function(e,t,n){void 0===t&&(t={}),void 0===n&&(n={});var r="use"+e+"Props";(0,jg.useDebugValue)(r);var i=Og(r);return i?i(t,n):n}(e.name,t,n)),e.compose)if(e.useComposeOptions&&(t=e.useComposeOptions(t,n)),e.useComposeProps)n=e.useComposeProps(t,n);else for(var o,s=dg(r);!(o=s()).done;){n=(0,o.value)(t,n,!0)}var l={},u=n||{};for(var c in u)void 0!==u[c]&&(l[c]=u[c]);return l};a.__useOptions=i;var o=r.reduce(function(e,t){return e.push.apply(e,t.__keys||[]),e},[]);return a.__keys=[].concat(o,(null===(t=e.useState)||void 0===t?void 0:t.__keys)||[],e.keys||[]),a.unstable_propsAreEqual=e.propsAreEqual||(null===(n=r[0])||void 0===n?void 0:n.unstable_propsAreEqual)||Cg,a}var Vg=k(()=>{P(Oh()),Bg(),hg(),Lg(),Pg(),Ng()});function qg(e,t){void 0===t&&(t=null),e&&("function"==typeof e?e(t):e.current=t)}function Hg(e,t){return(0,Wg.useMemo)(function(){return null==e&&null==t?null:function(n){qg(e,n),qg(t,n)}},[e,t])}var Wg,Zg=k(()=>{Wg=P(Oh())});function Kg(e){if("BUTTON"===e.tagName)return!0;if("INPUT"===e.tagName){var t=e;return-1!==Gg.indexOf(t.type)}return!1}var Gg,Xg=k(()=>{Gg=["button","color","file","image","reset","submit"]}),$g=k(()=>{}),Yg=k(()=>{$g(),P(Oh())}),Jg=k(()=>{$g(),P(Oh()),Yg()});function Qg(e){return e?e.ownerDocument||e:document}var ey=k(()=>{});var ty,ny=k(()=>{ey();try{ty=window}catch(r$){}});function ry(){var e=function(e){return e&&Qg(e).defaultView||ty}();return!("undefined"==typeof e||!e.document||!e.document.createElement)}var iy,ay,oy,sy=k(()=>{ny(),iy=ry()}),ly=k(()=>{ay=P(Oh()),sy(),oy=iy?ay.useLayoutEffect:ay.useEffect});function uy(e){var t=(0,cy.useRef)(e);return oy(function(){t.current=e}),t}var cy,dy=k(()=>{cy=P(Oh()),ly()});var hy=k(()=>{});var fy=k(()=>{ey()});function py(e,t){return e===t||e.contains(t)}var my=k(()=>{});function gy(e){var t=function(e){var t=Qg(e).activeElement;return null!=t&&t.nodeName?t:null}(e);if(!t)return!1;if(py(e,t))return!0;var n=t.getAttribute("aria-activedescendant");return!!n&&(n===e.id||!!e.querySelector("#"+n))}var yy=k(()=>{fy(),my()});var vy=k(()=>{my()});function _y(e){return!!iy&&-1!==window.navigator.userAgent.indexOf(e)}var by=k(()=>{sy()});var xy=k(()=>{});var wy,ky,Sy=k(()=>{xy(),wy="input:not([type='hidden']):not([disabled]), select:not([disabled]), textarea:not([disabled]), a[href], button:not([disabled]), [tabindex], iframe, object, embed, area[href], audio[controls], video[controls], [contenteditable]:not([contenteditable='false'])"}),Ey=k(()=>{ig(),zg(),Vg(),Pg(),ky=Ug({name:"Role",keys:["unstable_system"],propsAreEqual:function(e,t){var n=e.unstable_system,r=tg(e,["unstable_system"]),i=t.unstable_system,a=tg(t,["unstable_system"]);return!(n!==i&&!Cg(n,i))&&Cg(r,a)}}),Tg({as:"div",useHook:ky})});function Cy(e){!gy(e)&&function(e){return function(e,t){return"matches"in e?e.matches(t):"msMatchesSelector"in e?e.msMatchesSelector(t):e.webkitMatchesSelector(t)}(e,wy)&&function(e){var t=e;return t.offsetWidth>0||t.offsetHeight>0||e.getClientRects().length>0}(e)}(e)&&e.focus()}function Py(e,t,n,r){return e?t&&!n?-1:void 0:t?r:r||0}function Dy(e,t){return(0,Iy.useCallback)(function(n){var r;null===(r=e.current)||void 0===r||r.call(e,n),!n.defaultPrevented&&t&&(n.stopPropagation(),n.preventDefault())},[e,t])}var Iy,Ty,Ay,zy,Oy=k(()=>{ig(),zg(),Vg(),Iy=P(Oh()),Zg(),Xg(),Jg(),dy(),ly(),yy(),vy(),by(),Sy(),Ey(),Ty=["disabled","focusable"],Ay=_y("Mac")&&!_y("Chrome")&&(_y("Safari")||_y("Firefox")),zy=Ug({name:"Tabbable",compose:ky,keys:Ty,useOptions:function(e,t){return eg({disabled:t.disabled},e)},useProps:function(e,t){var n=t.ref,r=t.tabIndex,i=t.onClickCapture,a=t.onMouseDownCapture,o=t.onMouseDown,s=t.onKeyPressCapture,l=t.style,u=tg(t,["ref","tabIndex","onClickCapture","onMouseDownCapture","onMouseDown","onKeyPressCapture","style"]),c=(0,Iy.useRef)(null),d=uy(i),h=uy(a),f=uy(o),p=uy(s),m=!!e.disabled&&!e.focusable,g=(0,Iy.useState)(!0),y=g[0],v=g[1],_=(0,Iy.useState)(!0),b=_[0],x=_[1],w=e.disabled?eg({pointerEvents:"none"},l):l;oy(function(){var e,t=c.current;t&&("BUTTON"===(e=t).tagName||"INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName||"A"===e.tagName||v(!1),function(e){return"BUTTON"===e.tagName||"INPUT"===e.tagName||"SELECT"===e.tagName||"TEXTAREA"===e.tagName}(t)||x(!1))},[]);var k=Dy(d,e.disabled),S=Dy(h,e.disabled),E=Dy(p,e.disabled),C=(0,Iy.useCallback)(function(e){var t;null===(t=f.current)||void 0===t||t.call(f,e);var n,r=e.currentTarget;if(!e.defaultPrevented&&Ay&&py((n=e).currentTarget,n.target)&&Kg(r)){var i=requestAnimationFrame(function(){r.removeEventListener("mouseup",a,!0),Cy(r)}),a=function(){cancelAnimationFrame(i),Cy(r)};r.addEventListener("mouseup",a,{once:!0,capture:!0})}},[]);return eg({ref:Hg(c,n),style:w,tabIndex:Py(m,y,b,r),disabled:!(!m||!b)||void 0,"aria-disabled":!!e.disabled||void 0,onClickCapture:k,onMouseDownCapture:S,onMouseDown:C,onKeyPressCapture:E},u)}}),Tg({as:"div",useHook:zy})});var Fy,My,jy,By,Ry,Ly,Ny,Uy=k(()=>{ig(),zg(),Vg(),Fy=P(Oh()),Xg(),Jg(),dy(),hy(),Oy(),My=Ug({name:"Clickable",compose:zy,keys:["unstable_clickOnEnter","unstable_clickOnSpace"],useOptions:function(e){var t=e.unstable_clickOnEnter,n=void 0===t||t,r=e.unstable_clickOnSpace;return eg({unstable_clickOnEnter:n,unstable_clickOnSpace:void 0===r||r},tg(e,["unstable_clickOnEnter","unstable_clickOnSpace"]))},useProps:function(e,t){var n=t.onKeyDown,r=t.onKeyUp,i=tg(t,["onKeyDown","onKeyUp"]),a=(0,Fy.useState)(!1),o=a[0],s=a[1],l=uy(n),u=uy(r),c=(0,Fy.useCallback)(function(t){var n,r;if(null===(n=l.current)||void 0===n||n.call(l,t),!t.defaultPrevented&&!e.disabled&&!t.metaKey&&(r=t).target===r.currentTarget){var i=e.unstable_clickOnEnter&&"Enter"===t.key,a=e.unstable_clickOnSpace&&" "===t.key;if(i||a){if(function(e){var t=e.currentTarget;return!!e.isTrusted&&(Kg(t)||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"A"===t.tagName||"SELECT"===t.tagName)}(t))return;t.preventDefault(),i?t.currentTarget.click():a&&s(!0)}}},[e.disabled,e.unstable_clickOnEnter,e.unstable_clickOnSpace]),d=(0,Fy.useCallback)(function(t){var n;if(null===(n=u.current)||void 0===n||n.call(u,t),!t.defaultPrevented&&!e.disabled&&!t.metaKey){var r=e.unstable_clickOnSpace&&" "===t.key;o&&r&&(s(!1),t.currentTarget.click())}},[e.disabled,e.unstable_clickOnSpace,o]);return eg({"data-active":o||void 0,onKeyDown:c,onKeyUp:d},i)}}),Tg({as:"button",memo:!0,useHook:My})}),Vy=k(()=>{ig(),zg(),Vg(),jy=P(Oh()),Zg(),Xg(),Jg(),Uy(),By=Ug({name:"Button",compose:My,keys:[],useProps:function(e,t){var n=t.ref,r=tg(t,["ref"]),i=(0,jy.useRef)(null),a=(0,jy.useState)(void 0),o=a[0],s=a[1],l=(0,jy.useState)("button"),u=l[0],c=l[1];return(0,jy.useEffect)(function(){var e=i.current;e&&(Kg(e)||("A"!==e.tagName&&s("button"),c(void 0)))},[]),eg({ref:Hg(i,n),role:o,type:u},r)}}),Ry=Tg({as:"button",memo:!0,useHook:By})}),qy=k(()=>{ig(),zg(),Vg(),Ey(),Ly=Ug({name:"Group",compose:ky,keys:[],useProps:function(e,t){return eg({role:"group"},t)}}),Ny=Tg({as:"div",useHook:Ly})});function Hy(){return iy?document.body:null}function Wy(e){var t=e.children,n=(0,Zy.useContext)(Gy)||Hy(),r=(0,Zy.useState)(function(){if(iy){var e=document.createElement("div");return e.className=Wy.__className,e}return null})[0];return oy(function(){if(r&&n)return n.appendChild(r),function(){n.removeChild(r)}},[r,n]),r?(0,Ky.createPortal)((0,Zy.createElement)(Gy.Provider,{value:r},t),r):null}var Zy,Ky,Gy,Xy,$y=k(()=>{Zy=P(Oh()),ly(),sy(),Ky=P(Bh()),Gy=(0,Zy.createContext)(Hy()),Wy.__className="__reakit-portal",Wy.__selector="."+Wy.__className}),Yy=k(()=>{"undefined"!=typeof window&&(Xy={get passive(){0}},window.addEventListener("testPassive",null,Xy),window.removeEventListener("testPassive",null,Xy)),"undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1)}),Jy=k(()=>{P(Oh()),Jg(),Vy(),qy(),P(Bh()),$y(),Yy(),$g()});function Qy(e){let t=(0,ev.useMemo)(()=>{let t=e;return{get current(){return t},set current(e){t=e,r(e)}}},[]),[n,r]=(0,ev.useState)(()=>e);return[t,n]}var ev,tv=k(()=>{ev=P(Oh())});var nv,rv,iv,av,ov,sv,lv,uv,cv,dv,hv,fv,pv,mv,gv,yv,vv,_v,bv,xv,wv,kv,Sv,Ev,Cv=k(()=>{Ym(),Zp(),Zp(),nv=P(Oh()),rv=P(Bh()),Jy(),tv(),av=zf(iv||(iv=I(["\n  #pointer-root & {\n    pointer-events: none;\n  }\n  #pointer-root.normal & {\n    pointer-events: auto;\n  }\n"]))),ov={panel:{bg:"#282b2f",head:{title:{color:"#bbb"},punctuation:{color:"#808080"}},body:{compoudThing:{label:{get color(){return Km(.6,ov.panel.bg)}}}}}},lv="undefined"!=typeof window?Rf(sv||(sv=I(["\n  :host {\n    all: initial;\n    color: white;\n    font: 11px -apple-system, BlinkMacSystemFont, Segoe WPC, Segoe Editor,\n      HelveticaNeue-Light, Ubuntu, Droid Sans, sans-serif;\n  }\n\n  * {\n    padding: 0;\n    margin: 0;\n    font-size: 100%;\n    font: inherit;\n    vertical-align: baseline;\n    list-style: none;\n  }\n"]))):{},cv=Wp.div(uv||(uv=I(["\n  z-index: 51;\n  position: fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  pointer-events: none;\n"]))),dv=e=>nv.default.createElement(If,{disableVendorPrefixes:!0,target:e.target},nv.default.createElement(nv.default.Fragment,null,nv.default.createElement(lv,null),e.children)),hv=e=>{let[t,n]=(0,nv.useState)(null),[r,i]=(0,nv.useState)(null);(0,nv.useLayoutEffect)(()=>{if(!t)return;let{parentNode:e}=t;if(!e)return;let n=e.shadowRoot?parent.shadowRoot:e.attachShadow({mode:"open"});i(n)},[t]);let[a,o]=Qy(void 0);return r?rv.default.createPortal(nv.default.createElement(dv,{target:r},nv.default.createElement(nv.default.Fragment,null,nv.default.createElement(cv,{ref:a}),nv.default.createElement(Gy.Provider,{value:o},e.children))),r):nv.default.createElement("template",{ref:n,"shadow-root":"open"},e.children)}}),Pv=k(()=>{Cv(),Zp(),fv={get outlinePanel(){return 1},get propsPanel(){return fv.outlinePanel},get sequenceEditorPanel(){return this.outlinePanel-1},get toolbar(){return this.outlinePanel+1},get pluginPanes(){return this.sequenceEditorPanel-1}},pv=ov.panel.bg,gv=Wp.span(mv||(mv=I(["\n  white-space: nowrap;\n"]))),vv=Wp.span(yv||(yv=I(["\n  white-space: nowrap;\n  color: ",";\n"])),ov.panel.head.punctuation.color),bv=Wp.div(_v||(_v=I(["\n  background: ",";\n  flex-grow: 1;\n  overflow-y: scroll;\n  padding: 0;\n"])),pv),xv=18,kv=Wp.div(wv||(wv=I(["\n  height: ","px;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n  padding: 0 10px;\n  position: relative;\n  color: #adadadb3;\n  border-bottom: 1px solid rgb(0 0 0 / 13%);\n  background-color: #25272b;\n  font-size: 10px;\n  font-weight: 500;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n"])),xv),Sv=100}),Dv=k(()=>{Ev=()=>{}});function Iv(e){return Tv.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Tv.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.775 2.781a.5.5 0 01.5.5v1.7H4.67c.108-.957.92-1.7 1.905-1.7h6.608a1.917 1.917 0 110 3.834H6.574c-.78 0-1.452-.466-1.751-1.135H2.275v5.03h2.39a2.032 2.032 0 012.023-1.854h6.38a2.031 2.031 0 110 4.063h-6.38c-.83 0-1.543-.497-1.858-1.21H1.775a.5.5 0 01-.5-.5V3.281a.5.5 0 01.5-.5zm4.799 1.5h6.608a.917.917 0 110 1.834H6.574a.917.917 0 110-1.834zm.114 5.875h6.38a1.031 1.031 0 110 2.063h-6.38a1.032 1.032 0 110-2.063z",fill:"currentColor"}))}var Tv,Av,zv=k(()=>{Tv=P(Oh()),Av=Iv});function Ov(e){return Fv.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Fv.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 10.5L4 6.654 5.2 5.5 8 8.385 10.8 5.5 12 6.654 8 10.5z",fill:"currentColor"}))}var Fv,Mv,jv=k(()=>{Fv=P(Oh()),Mv=Ov});function Bv(e){return Rv.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Rv.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.5 3c-1.072 0-1.969.904-1.969 1.969 0 1 .929 1.968 1.969 1.968h9A1.969 1.969 0 1012.5 3h-9zm9 1H5.531v1.938H12.5A.969.969 0 0012.5 4zM3.5 9.14a1.969 1.969 0 000 3.938h9a1.969 1.969 0 100-3.937h-9zm9 1H8.406v1.938H12.5a.969.969 0 100-1.937z",fill:"currentColor"}))}var Rv,Lv,Nv=k(()=>{Rv=P(Oh()),Lv=Bv});function Uv(e){return Vv.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Vv.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M.166 7.994a2.26 2.26 0 114.518 0 2.26 2.26 0 01-4.518 0zM2.425 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM5.74 7.994a2.26 2.26 0 114.519 0 2.26 2.26 0 01-4.519 0zM8 6.91a1.085 1.085 0 100 2.17 1.085 1.085 0 000-2.17zM13.575 5.735a2.26 2.26 0 100 4.519 2.26 2.26 0 000-4.52zm-1.086 2.26a1.085 1.085 0 112.171 0 1.085 1.085 0 01-2.17 0z",fill:"currentColor"}))}var Vv,qv,Hv=k(()=>{Vv=P(Oh()),qv=Uv});function Wv(e){return Zv.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),Zv.createElement("path",{d:"M8.339 4.5l-2.055.644 4.451 1.393v2.748l-2.966.928-2.504-.783V6.738l2.42.758 2.055-.644-4.458-1.395L4 5.858v4.463L7.768 11.5 12 10.175V5.646L8.339 4.5z",fill:"currentColor"}))}var Zv,Kv,Gv=k(()=>{Zv=P(Oh()),Kv=Wv});function Xv(e){return $v.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),$v.createElement("path",{d:"M8 1.57c-.416 0-.752.36-.752.804v.482c-1.715.372-3.006 1.994-3.006 3.938v.473c0 1.18-.407 2.32-1.14 3.205l-.173.208a.85.85 0 00-.125.864.75.75 0 00.686.475h9.019a.752.752 0 00.686-.475.845.845 0 00-.125-.864l-.174-.208a5.026 5.026 0 01-1.139-3.205v-.473c0-1.944-1.291-3.566-3.006-3.938v-.482c0-.445-.336-.804-.752-.804zm1.063 12.39c.282-.301.44-.71.44-1.138H6.496c0 .428.158.837.44 1.138.281.302.664.47 1.063.47.4 0 .783-.168 1.064-.47z",fill:"currentColor"}))}var $v,Yv,Jv=k(()=>{$v=P(Oh()),Yv=Xv});function Qv(e){return e_.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),e_.createElement("path",{d:"M6.8 11.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6zm6-7.2h-2.4v-.6A1.8 1.8 0 008.6 2H7.4a1.8 1.8 0 00-1.8 1.8v.6H3.2a.6.6 0 100 1.2h.6v6.6A1.8 1.8 0 005.6 14h4.8a1.8 1.8 0 001.8-1.8V5.6h.6a.6.6 0 100-1.2zm-6-.6a.6.6 0 01.6-.6h1.2a.6.6 0 01.6.6v.6H6.8v-.6zm4.2 8.4a.6.6 0 01-.6.6H5.6a.6.6 0 01-.6-.6V5.6h6v6.6zm-1.8-.6a.6.6 0 00.6-.6V7.4a.6.6 0 00-1.2 0V11a.6.6 0 00.6.6z",fill:"currentColor"}))}var e_,t_,n_,r_,i_,a_,o_,s_,l_,u_,c_,d_,h_,f_,p_,m_,g_,y_,v_,__,b_=k(()=>{e_=P(Oh()),t_=Qv}),x_=k(()=>{zv(),jv(),Nv(),Hv(),Gv(),Jv(),b_()}),w_=k(()=>{n_=P(Oh()),Zp(),Dv(),Cv(),x_(),i_=Wp.li(r_||(r_=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  display: flex;\n  justify-content: flex-start;\n  flex-direction: column;\n  align-items: flex-start;\n"]))),o_=Wp.div(a_||(a_=I([""]))),l_=Wp(o_)(s_||(s_=I(["\n  position: relative;\n  margin-top: 2px;\n  margin-bottom: 2px;\n  margin-left: calc(4px + var(--depth) * 16px);\n  padding-left: 4px;\n  padding-right: 8px;\n  gap: 4px;\n  height: 21px;\n  line-height: 0;\n  box-sizing: border-box;\n  display: flex;\n  flex-wrap: nowrap;\n  align-items: center;\n  pointer-events: none;\n  white-space: nowrap;\n\n  border-radius: 2px;\n  box-shadow: 0 3px 4px -1px rgba(0, 0, 0, 0.48);\n\n  color: rgba(255, 255, 255, 0.9);\n  background: rgba(40, 43, 47, 0.65);\n  backdrop-filter: blur(14px);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n\n  &.descendant-is-selected {\n    background: rgba(29, 53, 59, 0.7);\n  }\n\n  ",";\n  &:not(.not-selectable):not(.selected):hover {\n    background: rgba(59, 63, 69, 0.9);\n\n    border-bottom: 1px solid rgba(255, 255, 255, 0.24);\n  }\n\n  &:not(.not-selectable):not(.selected):active {\n    background: rgba(82, 88, 96, 0.9);\n    border-bottom: 1px solid rgba(255, 255, 255, 0.24);\n  }\n\n  &.selected {\n    background: rgba(30, 88, 102, 0.7);\n    border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n  }\n\n  @supports not (backdrop-filter: blur()) {\n    background: rgba(40, 43, 47, 0.95);\n  }\n"])),av),c_=zf(u_||(u_=I(["\n  font-weight: 500;\n  font-size: 11px;\n  & {\n  }\n"]))),h_=Wp.span(d_||(d_=I(["\n  ",";\n\n  ",";\n  position: relative;\n  // Compensate for border bottom\n  top: 0.5px;\n  display: flex;\n  height: 20px;\n  align-items: center;\n  box-sizing: border-box;\n"])),c_,av),p_=Wp.div(f_||(f_=I(["\n  font-weight: 500;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  opacity: 0.99;\n"]))),g_=Wp.span(m_||(m_=I(["\n  font-size: 9px;\n  position: relative;\n  display: block;\n  transition: transform 0.1s ease-out;\n\n  &:hover {\n    transform: rotate(-20deg);\n  }\n\n  ",".collapsed & {\n    transform: rotate(-90deg);\n\n    &:hover {\n      transform: rotate(-70deg);\n    }\n  }\n"])),i_),v_=Wp.ul(y_||(y_=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n\n  ",".collapsed & {\n    display: none;\n  }\n"])),i_),__=e=>{let{label:t,children:n,depth:r,select:i,selectionStatus:a,labelDecoration:o,collapsed:s=!1,setIsCollapsed:l}=e,u=void 0!==n;return n_.default.createElement(i_,{style:{"--depth":r},className:s?"collapsed":""},n_.default.createElement(l_,{className:a,onClick:null!=i?i:Ev,"data-header":!0},n_.default.createElement(p_,null,u?n_.default.createElement(g_,{onClick:e=>{e.stopPropagation(),e.preventDefault(),null==l||l(!s)}},n_.default.createElement(Mv,null)):n_.default.createElement(Kv,null)),n_.default.createElement(h_,null,n_.default.createElement("span",null,t)),o),u&&n_.default.createElement(v_,null,n))}});var k_,S_,E_,C_,P_,D_=k(()=>{k_=n(194),ne(),Th(),M(),S_=()=>{var e;let t=(0,k_.val)(O().projectsP),n=(null!=(e=(0,k_.val)(O().atomP.historic.panels.outlinePanel.selection))?e:[]).map(e=>{let n=t[e.projectId];if(!n)return;if("Project"===e.type)return n;if(!(0,k_.val)(n.sheetTemplatesP[e.sheetId]))return;let r=E_(n,e.sheetId);if(!r)return;if("Sheet"===e.type)return r;let i=(0,k_.val)(r.objectsP[e.objectKey]);return i||void 0});return Dh(n.filter(e=>"undefined"!=typeof e))},E_=(e,t)=>{let n=O().atomP.historic.projects.stateByProjectId[e.address.projectId],r=(0,k_.val)(n.stateBySheetId[t].selectedInstanceId),i=(0,k_.val)(e.sheetTemplatesP[t]);if(i){if(r)return(0,k_.val)(i.instancesP[r]);{let e=(0,k_.val)(i.instancesP);return e[function(e){return Object.keys(e)}(e)[0]]}}}}),I_=k(()=>{M(),C_=P(Oh()),w_(),Qh(),D_(),P_=e=>{let{sheetObject:t,depth:n,overrideLabel:r}=e,i=Rh(()=>S_(),[]);return C_.default.createElement(__,{select:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.studio.historic.panels.outline.selection.set([t])})},label:null!=r?r:t.address.objectKey,depth:n,selectionStatus:i.includes(t)?"selected":"not-selected"})}});function T_(e){var t;let n="namespace"===e.type?"namespace:".concat(e.sheet.address.sheetId,":").concat(e.path.join("/")):"Theatre_Project"===e.type?"project":"Theatre_Sheet"===e.type?"sheetInstance:".concat(e.address.sheetId,":").concat(e.address.sheetInstanceId):"unknown",r="namespace"===e.type?e.sheet.address.projectId:e.address.projectId;return{collapsed:null!=(t=Wh(O().atomP.ahistoric.projects.stateByProjectId[r].collapsedItemsInOutline[n]))&&t,setCollapsed:(0,A_.useCallback)(e=>{O().transaction(t=>{let{stateEditors:i}=t;i.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline.set({projectId:r,isCollapsed:e,itemKey:n})})},[n])}}var A_,z_=k(()=>{A_=P(Oh()),M(),Qh()});function O_(e){return B_.default.createElement(B_.default.Fragment,null,[...e.namespace.entries()].map(t=>{let[n,{object:r,nested:i}]=t;return B_.default.createElement(F_,{key:n,label:n,object:r,nested:i,visualIndentation:e.visualIndentation,path:e.path,sheet:e.sheet})}))}function F_(e){let{nested:t,label:n,object:r,sheet:i}=e,{collapsed:a,setCollapsed:o}=T_({type:"namespace",sheet:i,path:[...e.path,n]}),s=t&&B_.default.createElement(O_,{namespace:t,path:[...e.path,n],key:"namespaceTree("+n+")",visualIndentation:e.visualIndentation+1,sheet:i}),l=r&&B_.default.createElement(P_,{depth:e.visualIndentation,key:"objectPath("+r.address.objectKey+")",sheetObject:r,overrideLabel:n});return B_.default.createElement(B_.default.Fragment,{key:"".concat(n," - ").concat(e.visualIndentation)},l,s&&B_.default.createElement(__,{selectionStatus:"not-selectable",label:n,key:"baseItem(".concat(n,")"),depth:e.visualIndentation,children:s,collapsed:a,setIsCollapsed:o}))}function M_(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){let t=U_.get(e);return t||(t=e.address.objectKey.split(N_),console.assert(t.length>0,"expected not empty"),U_.set(e,t)),t}(t),[r,...i]=n,a=e.get(r);a||(a={nested:void 0,object:void 0,path:[...n]},e.set(r,a)),0===i.length?(console.assert(!a.object,"expect not to have existing object with same name",{existing:a,object:t}),a.object=t):(a.nested||(a.nested=new Map),M_(a.nested,t,i))}var j_,B_,R_,L_,N_,U_,V_,q_,H_,W_,Z_,K_,G_,X_,$_,Y_,J_,Q_,eb,tb,nb,rb,ib,ab,ob,sb,lb,ub,cb,db,hb,fb=k(()=>{Qh(),j_=n(194),B_=P(Oh()),Zp(),I_(),w_(),z_(),Wp.li(R_||(R_=I(["\n  color: ",";\n"])),e=>e.isSelected?"white":"hsl(1, 1%, 80%)"),L_=e=>{let{sheet:t,depth:n}=e;return Rh(()=>{let e=(0,j_.val)(t.objectsP),r=Object.values(e).filter(e=>null!=e),i=new Map;return r.forEach(e=>{M_(i,e)}),B_.default.createElement(O_,{namespace:i,visualIndentation:n,path:[],sheet:t})},[t,n])},N_=/\s*\/\s*/g,U_=new WeakMap}),pb=k(()=>{M(),D_(),Qh(),V_=P(Oh()),Zp(),fb(),w_(),z_(),H_=Wp.div(q_||(q_=I(["\n  display: flex;\n"]))),Wp.li(W_||(W_=I(["\n  color: ",";\n"])),e=>e.isSelected?"white":"hsl(1, 1%, 80%)"),K_=Wp.div(Z_||(Z_=I([""]))),G_=e=>{let{sheet:t,depth:n}=e,{collapsed:r,setCollapsed:i}=T_(t),a=(0,V_.useCallback)(()=>{O().transaction(e=>{let{stateEditors:n}=e;n.studio.historic.panels.outline.selection.set([t])})},[t]);return Rh(()=>{let e=S_();return V_.default.createElement(__,{depth:n,select:a,setIsCollapsed:i,collapsed:r,selectionStatus:e.some(e=>e===t)?"selected":e.some(e=>"Theatre_SheetObject"===e.type&&e.sheet===t)?"descendant-is-selected":"not-selected",label:V_.default.createElement(H_,null,t.address.sheetId,": ",t.address.sheetInstanceId)},V_.default.createElement(K_,null,V_.default.createElement(L_,{depth:n+1,sheet:t,key:"objectList"+t.address.sheetInstanceId})))},[n,r])}}),mb=k(()=>{Qh(),X_=n(194),$_=P(Oh()),Zp(),pb(),Wp.div(Y_||(Y_=I(["\n  display: flex;\n"]))),Wp.li(J_||(J_=I(["\n  color: ",";\n"])),e=>e.isSelected?"white":"hsl(1, 1%, 80%)"),Wp.div(Q_||(Q_=I([""]))),eb=e=>{let{sheetId:t,depth:n,project:r}=e;return Rh(()=>{let e=(0,X_.val)(r.sheetTemplatesP[t]);if(!e)return $_.default.createElement($_.default.Fragment,null);let i=(0,X_.val)(e.instancesP);return $_.default.createElement($_.default.Fragment,null,Object.entries(i).map(e=>{let[t,r]=e;return $_.default.createElement(G_,{key:r.address.sheetInstanceId,sheet:r,depth:n})}))},[n,t,r])}}),gb=k(()=>{D_(),Qh(),tb=P(Oh()),mb(),nb=e=>{let{project:t,depth:n}=e;return Rh(()=>{if(!t)return null;let e=function(e){return Object.keys((0,k_.val)(e.sheetTemplatesP))}(t);return tb.default.createElement(tb.default.Fragment,null,e.map(e=>tb.default.createElement(eb,{depth:n,sheetId:e,key:"sheet-".concat(e),project:t})))},[t,n])}}),yb=k(()=>{rb=P(Oh()),w_(),gb(),M(),Qh(),D_(),ib=n(194),Zp(),z_(),ob=Wp.div(ab||(ab=I(["\n  color: #ff6363;\n  margin-left: 11px;\n  background: #4c282d;\n  padding: 2px 8px;\n  border-radius: 2px;\n  font-size: 10px;\n  box-shadow: 0 2px 8px -4px black;\n"]))),sb=e=>{let{depth:t,project:n}=e,r=Rh(()=>S_(),[]),i=Rh(()=>{let e=n.address.projectId,t=(0,ib.val)(O().atomP.ephemeral.coreByProject[e].loadingState);return"browserStateIsNotBasedOnDiskState"===(null==t?void 0:t.type)},[n]),a=(0,rb.useCallback)(()=>{O().transaction(e=>{let{stateEditors:t}=e;t.studio.historic.panels.outline.selection.set([n])})},[n]),{collapsed:o,setCollapsed:s}=T_(n);return rb.default.createElement(__,{depth:t,label:n.address.projectId,setIsCollapsed:s,collapsed:o,labelDecoration:i?rb.default.createElement(ob,null,"Has Conflicts"):null,children:rb.default.createElement(nb,{project:n,depth:t+1}),selectionStatus:r.includes(n)?"selected":r.some(e=>e.address.projectId===n.address.projectId)?"descendant-is-selected":"not-selected",select:a})}}),vb=k(()=>{lb=n(194),Qh(),M(),ub=P(Oh()),Zp(),yb(),db=Wp.ul(cb||(cb=I(["\n  list-style: none;\n  margin: 0;\n  padding: 0;\n  padding-right: 4px;\n"]))),hb=e=>Rh(()=>{let e=(0,lb.val)(O().projectsP);return ub.default.createElement(db,null,Object.keys(e).map(t=>{let n=e[t];return ub.default.createElement(sb,{depth:0,project:n,key:"projectListItem-".concat(t)})}))},[])});function _b(e){let[t,n]=(0,bb.useState)(!1);return(0,bb.useEffect)(()=>{let r=r=>{let i=t?200:50,a="left"===e?r.x<i:r.x>window.innerWidth-i;a&&(a=r.y>56),n(!!a)};document.addEventListener("mousemove",r);let i=()=>{n(!1)};return document.addEventListener("mouseleave",i),()=>{document.removeEventListener("mousemove",r),document.removeEventListener("mouseleave",i)}},[t]),t}var bb,xb,wb,kb,Sb,Eb,Cb,Pb,Db,Ib,Tb,Ab,zb,Ob=k(()=>{bb=P(Oh())}),Fb=k(()=>{xb=P(Oh()),Zp(),Pv(),vb(),Qh(),M(),Ob(),wb=n(194),Cv(),kb="44px",Eb=Wp.div(Sb||(Sb=I(["\n  ",";\n  background-color: transparent;\n  position: absolute;\n  left: 8px;\n  z-index: ",";\n\n  top: calc("," + 8px);\n  height: fit-content;\n  max-height: calc(100% - ",");\n  overflow-y: scroll;\n  overflow-x: hidden;\n  padding: 0;\n  user-select: none;\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  scrollbar-width: none;\n\n  display: ",";\n\n  &:hover {\n    display: block;\n  }\n\n  // Create a small buffer on the bottom to aid selecting the bottom item in a long, scrolling list\n  &::after {\n    content: '';\n    display: block;\n    height: 20px;\n  }\n"])),av,fv.outlinePanel,kb,kb,e=>{let{pin:t}=e;return t?"block":"none"}),Cb=()=>{var e;let t=null==(e=Wh(O().atomP.ahistoric.pinOutline))||e,n=Wh(Ib),r=_b("left");return(0,xb.useLayoutEffect)(()=>{Pb.set(r)},[r]),(0,xb.useEffect)(()=>()=>{Db.set(!1),Pb.set(!1)},[]),xb.default.createElement(Eb,{pin:t||n,onMouseEnter:()=>{Db.set(!0)},onMouseLeave:()=>{Db.set(!1)}},xb.default.createElement(hb,null))},Pb=new wb.Atom(!1),Db=new wb.Atom(!1),Ib=(0,wb.prism)(()=>{let e=(0,wb.val)(Db.prism),t=(0,wb.val)(Pb.prism);return e||t})}),Mb=k(()=>{Zp(),Ab=Wp.input.attrs({type:"checkbox"})(Tb||(Tb=I(["\n  outline: none;\n"]))),zb=Ab});function jb(e){let{propConfig:t,editingTools:n,value:r,autoFocus:i}=e,a=(0,Bb.useCallback)(e=>{n.permanentlySetValue(!!e.target.checked)},[t,n]);return Bb.default.createElement(Lb,{checked:r,onChange:a,autoFocus:i})}var Bb,Rb,Lb,Nb,Ub=k(()=>{Bb=P(Oh()),Zp(),Mb(),Lb=Wp(zb)(Rb||(Rb=I(["\n  margin-left: 6px;\n\n  :focus {\n    outline: 1px solid #555;\n  }\n"]))),Nb=jb});function Vb(e){return t=>{e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}}var qb=k(()=>{});function Hb(e,t,n){(0,Wb.useEffect)(()=>{if(!e||!1===n)return;let r=Array.isArray(e)?e.filter(e=>e):[e],i=e=>{r.every(t=>!e.composedPath().includes(t))&&t(e)};return window.addEventListener("mousedown",i,{capture:!0,passive:!1}),()=>{window.removeEventListener("mousedown",i,{capture:!0,passive:!1})}},[e,n])}var Wb,Zb,Kb,Gb,Xb,$b,Yb,Jb,Qb,ex,tx=k(()=>{Wb=P(Oh())}),nx=k(()=>{Zb=P(Oh()),Zp(),Kb="--lockedCursor",Xb=Wp.div(Gb||(Gb=I(["\n  pointer-events: auto;\n  &.normal {\n    pointer-events: none;\n  }\n"]))),Yb=Wp.div($b||($b=I(["\n  position: absolute;\n  inset: 0;\n  pointer-events: none;\n\n  #pointer-root:not(.normal) > & {\n    pointer-events: auto;\n  }\n"]))),Jb=(0,Zb.createContext)({}),Qb=(e,t,n)=>{let r=(0,Zb.useContext)(Jb);(0,Zb.useLayoutEffect)(()=>{if(e)return r.getLock(t,n)},[e,t,n])},ex=e=>{var t,n,r,i;let[a,o]=(0,Zb.useState)([]),s=(0,Zb.useMemo)(()=>({getLock:(e,t)=>{let n={className:e,cursor:t};return o(e=>[...e,n]),()=>{o(e=>e.filter(e=>e!==n))}}}),[]),l=null!=(n=null==(t=a[0])?void 0:t.cursor)?n:"";return Zb.default.createElement(Jb.Provider,{value:s},Zb.default.createElement(Xb,{id:"pointer-root",className:(null!=(i=null==(r=a[0])?void 0:r.className)?i:"normal")+" "+e.className},Zb.default.createElement(Yb,{style:{cursor:l,[Kb]:l}},e.children)))}});function rx(e){return ax.default.createElement(ox.Provider,{value:e.logger},e.children)}function ix(e,t){let n=(0,ax.useContext)(ox);return(0,ax.useMemo)(()=>e?n.named(e,t):n,[n,e,t])}var ax,ox,sx=k(()=>{ax=P(Oh()),ox=ax.default.createContext(null)});function lx(e){let t=function(){let e=ix("PointerCapturing"),t=cx.default.useRef(null),n=()=>null!=t.current;return r=>{let i,a=e=>(i=e,t.current=e,e);return{capturing:{capturePointer(n){if(e._debug("Capturing pointer",{forDebugName:r,reason:n}),null!=t.current)throw new Error('"'.concat(r,'" attempted capturing pointer for "').concat(n,'" while already captured by "').concat(t.current.debugOwnerName,'" for "').concat(t.current.debugReason,'"'));let i=a({debugOwnerName:r,debugReason:n});return{isCapturing:()=>i===t.current,release:()=>i===t.current&&(e._debug("Releasing pointer",{forDebugName:r,reason:n}),a(null),!0)}},isPointerBeingCaptured:n},forceRelease(){i&&t.current===i&&(e._debug("Force releasing pointer",{localCapture:i}),a(null))}}}}();return cx.default.createElement(dx.Provider,{value:t},cx.default.createElement(hx,{children:e.children}))}function ux(e){let t=(0,cx.useContext)(dx),n=(0,cx.useMemo)(()=>t(e),[e,t]);return(0,cx.useEffect)(()=>()=>{n.forceRelease()},[n]),n.capturing}var cx,dx,hx,fx,px=k(()=>{cx=P(Oh()),sx(),dx=cx.default.createContext(null),hx=cx.default.memo(e=>{let{children:t}=e;return cx.default.createElement(cx.default.Fragment,null,t)})}),mx=k(()=>{fx="undefined"!=typeof window&&/^((?!chrome|android).)*safari/i.test(navigator.userAgent)});function gx(e,t){let n=(0,yx.useRef)(t);n.current=t;let r=t.shouldPointerLock&&!fx,i=(0,yx.useRef)({domDragStarted:!1}),{capturePointer:a}=ux("useDrag for ".concat(t.debugName)),o=(0,yx.useRef)({onDrag:Ev,onDragEnd:Ev,onClick:Ev}),s=(0,yx.useRef)(),[l,u]=Qy(!1);return(0,yx.useLayoutEffect)(()=>{if(!e)return;let u=()=>{let e=i.current.domDragStarted&&i.current.detection.detected;l.current!==e&&(l.current=e)},c=t=>{if(!i.current.domDragStarted)return;let n=i.current;if(!function(e,t){return(!t.detection.detected||t.detection.detected&&t.detection.dragEventCount<3)&&(Math.abs(e.movementX)>_x||Math.abs(e.movementY)>_x)}(t,n)&&(n.detection.detected||(n.detection.totalDistanceMoved+=Math.abs(t.movementY)+Math.abs(t.movementX),n.detection.totalDistanceMoved>vx&&(r&&e.requestPointerLock(),n.detection={detected:!0,dragMovement:{x:0,y:0},dragEventCount:0},u())),n.detection.detected)){n.detection.dragEventCount+=1;let{dragMovement:e}=n.detection;if(r)e.x+=t.movementX,e.y+=t.movementY;else{let{startPos:r}=n;e.x=t.screenX-r.x,e.y=t.screenY-r.y}o.current.onDrag(e.x,e.y,t,t.movementX,t.movementY)}},d=e=>{if(h(),!i.current.domDragStarted)return;let n=i.current.detection.detected;i.current={domDragStarted:!1},t.shouldPointerLock&&!fx&&document.exitPointerLock(),o.current.onDragEnd(n),window.focus(),n||o.current.onClick(e),u()},h=()=>{var e;null==(e=s.current)||e.release(),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",d)},f=e=>{n.current.disabled||i.current.domDragStarted&&i.current.detection.detected&&(n.current.dontBlockMouseDown||(e.stopPropagation(),e.preventDefault()),i.current.detection={detected:!1,totalDistanceMoved:0},u())},p=e=>{var t,r,l,h;null==(t=s.current)||t.release();let f=n.current;if(!0===f.disabled||!(null!=(r=f.buttons)?r:[0]).includes(e.button))return;let p=f.onDragStart(e);!1!==p&&(o.current.onDrag=p.onDrag,o.current.onDragEnd=null!=(l=p.onDragEnd)?l:Ev,o.current.onClick=null!=(h=p.onClick)?h:Ev,s.current=a("Drag start"),f.dontBlockMouseDown||(e.stopPropagation(),e.preventDefault()),i.current={domDragStarted:!0,startPos:{x:e.screenX,y:e.screenY},detection:{detected:!1,totalDistanceMoved:0}},u(),document.addEventListener("mousemove",c),document.addEventListener("mouseup",d))},m=e=>{p(e)};return e.addEventListener("mousedown",m),e.addEventListener("click",f),()=>{var t,n;h(),e.removeEventListener("mousedown",m),e.removeEventListener("click",f),i.current.domDragStarted&&(null==(n=(t=o.current).onDragEnd)||n.call(t,i.current.detection.detected)),i.current={domDragStarted:!1},u()}},[e]),Qb(u&&!!t.lockCSSCursorTo,"dragging",t.lockCSSCursorTo),[u]}var yx,vx,_x,bx=k(()=>{yx=P(Oh()),nx(),px(),Dv(),mx(),tv(),vx=3,_x=100});var xx,wx,kx,Sx,Ex,Cx,Px,Dx,Ix,Tx,Ax,zx,Ox,Fx=k(()=>{Th(),xx=P(Oh()),wx=P(Oh()),kx=P(Oh()),Zp(),qb(),tv(),tx(),bx(),Ex=Wp.div(Sx||(Sx=I(["\n  height: 100%;\n  width: 100%;\n  position: relative;\n  z-index: 0;\n  box-sizing: border-box;\n  display: flex;\n  align-items: center;\n\n  &:after {\n    position: absolute;\n    inset: 1px 0 2px;\n    display: block;\n    content: ' ';\n    background-color: transparent;\n    border: 1px solid transparent;\n    z-index: -2;\n    box-sizing: border-box;\n    border-radius: 1px;\n  }\n\n  &:hover,\n  &.dragging,\n  &.editingViaKeyboard {\n    &:after {\n      background-color: #10101042;\n      border-color: #00000059;\n    }\n  }\n"]))),Px=Wp.input(Cx||(Cx=I(["\n  background: transparent;\n  border: 1px solid transparent;\n  color: rgba(255, 255, 255, 0.9);\n  padding: 1px 6px;\n  font: inherit;\n  outline: none;\n  cursor: ew-resize;\n  text-align: left;\n  width: 100%;\n  height: calc(100% - 4px);\n  border-radius: 2px;\n\n  &:focus {\n    cursor: text;\n  }\n"]))),Ix=Wp.div(Dx||(Dx=I(["\n  position: absolute;\n  inset: 3px 2px 4px;\n  transform: scale(var(--percentage), 1);\n  transform-origin: top left;\n  background-color: #2d5561;\n  z-index: -1;\n  border-radius: 2px;\n  pointer-events: none;\n\n  ",".dragging &, ",".noFocus:hover & {\n    background-color: #338198;\n  }\n"])),Ex,Ex),Ax=Wp.div(Tx||(Tx=I(["\n  display: contents;\n"]))),zx=e=>!0,Ox=e=>{var t;let[n]=Qy({mode:"noFocus"}),r=null!=(t=e.isValid)?t:zx,i=(0,kx.useRef)(e);i.current=e;let a=(0,kx.useRef)(null);Hb(a.current,()=>{a.current.blur()},"editingViaKeyboard"===n.current.mode);let o=(0,kx.useRef)(null),s=(0,kx.useMemo)(()=>{let t,s=()=>{let e=n.current,t=parseFloat(e.currentEditedValueInString);isFinite(t)&&r(t)&&e.valueBeforeEditing!==t?i.current.permanentlySetValue(t):i.current.discardTemporaryValue()},l=()=>{let e=i.current.value;n.current={mode:"editingViaKeyboard",currentEditedValueInString:String(e),valueBeforeEditing:e},setTimeout(()=>{a.current.focus(),a.current.setSelectionRange(0,100)})};return{inputChange:e=>{let t=e.target,{value:a}=t,o=n.current;n.current=x(b({},o),{currentEditedValueInString:a});let s=parseFloat(a);!isFinite(s)||!r(s)||i.current.temporarilySetValue(s)},onBlur:()=>{"editingViaKeyboard"===n.current.mode&&(s(),n.current={mode:"noFocus"}),e.onBlur&&e.onBlur()},transitionToDraggingMode:()=>{var r;let s=i.current.value;t=null==(r=a.current)?void 0:r.getBoundingClientRect().width,n.current={mode:"dragging"};let l=s,u=s;return o.current=document.body.style.cursor,{onDrag(n,r,a,o){let s=a.altKey?o/10:o,l=u+e.nudge({deltaX:s,deltaFraction:s/t,magnitude:1});u=e.range?ms(l,e.range[0],e.range[1]):l,i.current.temporarilySetValue(u)},onDragEnd(e){e?(l===u?i.current.discardTemporaryValue():i.current.permanentlySetValue(u),n.current={mode:"noFocus"}):(i.current.discardTemporaryValue(),n.current={mode:"noFocus"})},onClick(){a.current.focus(),a.current.setSelectionRange(0,100)}}},onInputKeyDown:e=>{"Escape"===e.key?(i.current.discardTemporaryValue(),n.current={mode:"noFocus"},a.current.blur()):("Enter"===e.key||"Tab"===e.key)&&(s(),a.current.blur())},onClick:e=>{"noFocus"===n.current.mode&&(a.current.focus(),e.preventDefault()),e.stopPropagation()},onFocus:()=>{"noFocus"===n.current.mode?l():n.current.mode}}},[]);(0,xx.useEffect)(()=>()=>{s.onBlur()},[]);let l="editingViaKeyboard"!==n.current.mode?function(e){return isNaN(e)?"NaN":Pd(e)?e.toFixed(0):uh(e,3).toString()}(e.value):n.current.currentEditedValueInString;"number"==typeof l&&isNaN(l)&&(l="NaN");let u=[a];e.inputRef&&u.push(e.inputRef);let c=kx.default.createElement(Px,{key:"input",type:"text",onChange:s.inputChange,value:l,onBlur:s.onBlur,onKeyDown:s.onInputKeyDown,onClick:s.onClick,onFocus:s.onFocus,ref:Vb(u),onMouseDown:e=>{e.stopPropagation()},onDoubleClick:e=>{e.preventDefault(),e.stopPropagation()},autoFocus:e.autoFocus}),{range:d}=e,h=parseFloat(l),f=d?kx.default.createElement(Ix,{style:{"--percentage":ms((h-d[0])/(d[1]-d[0]),0,1)}}):null,[p,m]=(0,wx.useState)(null);return gx(p,{debugName:"form/BasicNumberInput",onDragStart:s.transitionToDraggingMode,lockCSSCursorTo:"ew-resize",shouldPointerLock:!0,disabled:"editingViaKeyboard"===n.current.mode}),kx.default.createElement(Ex,{className:e.className+" "+n.current.mode},kx.default.createElement(Ax,{ref:m},c),f)}});function Mx(e){let{propConfig:t,editingTools:n,value:r,autoFocus:i}=e,a=(0,jx.useCallback)(e=>t.nudgeFn(x(b({},e),{config:t})),[t]);return jx.default.createElement(Ox,{value:r,temporarilySetValue:n.temporarilySetValue,discardTemporaryValue:n.discardTemporaryValue,permanentlySetValue:n.permanentlySetValue,range:t.range,nudge:a,autoFocus:i})}var jx,Bx,Rx=k(()=>{Fx(),jx=P(Oh()),Bx=Mx});function Lx(e){let{value:t,onChange:n,options:r,autoFocus:i}=e,a=(0,Nx.useCallback)(e=>{n(String(e.target.value))},[n]);return Nx.default.createElement(Vx,{role:"radiogroup"},Object.keys(r).map((e,n)=>Nx.default.createElement(Hx,{key:"label-"+n,"data-checked":t===e},r[e],Nx.default.createElement(Zx,{type:"radio",checked:t===e,value:e,onChange:a,name:"switchbox",autoFocus:i}))))}var Nx,Ux,Vx,qx,Hx,Wx,Zx,Kx,Gx,Xx,$x,Yx=k(()=>{Ym(),Nx=P(Oh()),Zp(),Vx=Wp.form(Ux||(Ux=I(["\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  vertical-align: middle;\n  justify-content: stretch;\n  height: 24px;\n  width: 100%;\n"]))),Hx=Wp.label(qx||(qx=I(["\n  padding: 0 0.5em;\n  background: transparent;\n  /* background: #373748; */\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-grow: 1;\n  color: #a7a7a7;\n  border: 1px solid transparent;\n  box-sizing: border-box;\n  border-right-width: 0px;\n\n  & + &:last-child {\n    border-right-width: 1px;\n  }\n\n  ",":hover > & {\n    border-color: #1c2123;\n    /* background-color: #373748; */\n    /* color: ","; */\n  }\n\n  &&:hover {\n    background-color: #464654;\n  }\n\n  &&[data-checked='true'] {\n    color: white;\n    background: #3f3f4c;\n  }\n"])),Vx,Zm(.1,"white")),Zx=Wp.input(Wx||(Wx=I(["\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n  width: 0;\n  height: 0;\n"]))),Kx=Lx}),Jx=k(()=>{}),Qx=k(()=>{Gx=P(Oh()),Xx={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},$x=Gx.default.createContext&&Gx.default.createContext(Xx)});function ew(e){return e&&e.map(function(e,t){return rw.default.createElement(e.tag,iw({key:t},e.attr),ew(e.child))})}function tw(e){return function(t){return rw.default.createElement(nw,iw({attr:iw({},e.attr)},t),ew(e.child))}}function nw(e){var t=function(t){var n,r=e.attr,i=e.size,a=e.title,o=aw(e,["attr","size","title"]),s=i||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),rw.default.createElement("svg",iw({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:n,style:iw(iw({color:e.color||t.color},t.style),e.style),height:s,width:s,xmlns:"http://www.w3.org/2000/svg"}),a&&rw.default.createElement("title",null,a),e.children)};return void 0!==$x?rw.default.createElement($x.Consumer,null,function(e){return t(e)}):t(Xx)}var rw,iw,aw,ow=k(()=>{rw=P(Oh()),Qx(),iw=function(){return iw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},iw.apply(this,arguments)},aw=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}}),sw=k(()=>{Jx(),ow(),Qx()}),lw=k(()=>{sw()}),uw=k(()=>{sw()});function cw(e){return tw({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M289.94 256l95-95A24 24 0 00351 127l-95 95-95-95a24 24 0 00-34 34l95 95-95 95a24 24 0 1034 34l95-95 95 95a24 24 0 0034-34z"}}]})(e)}var dw=k(()=>{sw()}),hw=k(()=>{sw()}),fw=k(()=>{sw()});function pw(e){return tw({tag:"svg",attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.5 3L7 4.5 3.25 8 7 11.5 5.5 13l-5-5 5-5z"}}]})(e)}function mw(e){return tw({tag:"svg",attr:{viewBox:"0 0 8 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M7.5 8l-5 5L1 11.5 4.75 8 1 4.5 2.5 3l5 5z"}}]})(e)}var gw=k(()=>{sw()}),yw=k(()=>{sw()}),vw=k(()=>{sw()}),_w=k(()=>{sw()}),bw=k(()=>{sw()}),xw=k(()=>{sw()}),ww=k(()=>{sw()}),kw=k(()=>{sw()}),Sw=k(()=>{sw()}),Ew=k(()=>{sw()});function Cw(e){return tw({tag:"svg",attr:{fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"}}]})(e)}var Pw=k(()=>{sw()}),Dw=k(()=>{sw()}),Iw=k(()=>{sw()}),Tw=k(()=>{sw()});function Aw(e){return tw({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none"},child:[{tag:"path",attr:{d:"M6 9.65685L7.41421 11.0711L11.6569 6.82843L15.8995 11.0711L17.3137 9.65685L11.6569 4L6 9.65685Z",fill:"currentColor"}},{tag:"path",attr:{d:"M6 14.4433L7.41421 13.0291L11.6569 17.2717L15.8995 13.0291L17.3137 14.4433L11.6569 20.1001L6 14.4433Z",fill:"currentColor"}}]})(e)}var zw=k(()=>{sw()});function Ow(e){return tw({tag:"svg",attr:{viewBox:"0 0 16 16",fill:"currentColor"},child:[{tag:"path",attr:{d:"M14 10.44l-.413.56H2.393L2 10.46 7.627 5h.827L14 10.44z"}}]})(e)}var Fw=k(()=>{sw()}),Mw=k(()=>{lw(),uw(),dw(),hw(),fw(),gw(),yw(),vw(),_w(),bw(),xw(),ww(),kw(),Sw(),Ew(),Pw(),Dw(),Iw(),Tw(),zw(),Fw()});function jw(e){let{value:t,onChange:n,options:r,className:i,autoFocus:a}=e,o=(0,Bw.useCallback)(e=>{n(String(e.target.value))},[n]);return Bw.default.createElement(Lw,null,Bw.default.createElement(qw,{className:i,value:t,onChange:o,autoFocus:a},Object.keys(r).map((e,t)=>Bw.default.createElement("option",{key:"option-"+t,value:e},r[e]))),Bw.default.createElement(Uw,null,Bw.default.createElement(Aw,null)))}var Bw,Rw,Lw,Nw,Uw,Vw,qw,Hw,Ww=k(()=>{Bw=P(Oh()),Zp(),Mw(),Lw=Wp.div(Rw||(Rw=I(["\n  width: 100%;\n  position: relative;\n"]))),Uw=Wp.div(Nw||(Nw=I(["\n  position: absolute;\n  right: 0px;\n  top: 0;\n  bottom: 0;\n  width: 1.5em;\n  font-size: 14px;\n  display: flex;\n  align-items: center;\n  color: #6b7280;\n  pointer-events: none;\n"]))),qw=Wp.select(Vw||(Vw=I(["\n  appearance: none;\n  background-color: transparent;\n  box-sizing: border-box;\n  border: 1px solid transparent;\n  color: rgba(255, 255, 255, 0.85);\n  padding: 1px 6px;\n  font: inherit;\n  outline: none;\n  text-align: left;\n  width: 100%;\n  border-radius: 2px;\n  /*\n  looks like putting percentages in the height of a select box doesn't work in Firefox. Not sure why.\n  So we're hard-coding the height to 26px, unlike all other inputs that use a relative height.\n  */\n  height: 26px /* calc(100% - 4px); */;\n\n  @supports (-moz-appearance: none) {\n    /* Ugly hack to remove the extra left padding that shows up only in Firefox */\n    text-indent: -2px;\n  }\n\n  &:hover,\n  &:focus {\n    background-color: #10101042;\n    border-color: #00000059;\n  }\n"]))),Hw=jw});function Zw(e){let{propConfig:t,editingTools:n,value:r,autoFocus:i}=e,a=(0,Kw.useCallback)(e=>{n.permanentlySetValue(e)},[t,n]);return"menu"===t.as?Kw.default.createElement(Hw,{value:r,onChange:a,options:t.valuesAndLabels,autoFocus:i}):Kw.default.createElement(Kx,{value:r,onChange:a,options:t.valuesAndLabels,autoFocus:i})}var Kw,Gw,Xw,$w,Yw,Jw,Qw,ek,tk=k(()=>{Kw=P(Oh()),Yx(),Ww(),Gw=Zw}),nk=k(()=>{Zp(),Xw=P(Oh()),$w=P(Oh()),qb(),tv(),tx(),Jw=Wp.input.attrs({type:"text"})(Yw||(Yw=I(["\n  background: transparent;\n  border: 1px solid transparent;\n  color: rgba(255, 255, 255, 0.9);\n  padding: 1px 6px;\n  font: inherit;\n  outline: none;\n  cursor: text;\n  text-align: left;\n  width: 100%;\n  height: calc(100% - 4px);\n  border-radius: 2px;\n  border: 1px solid transparent;\n  box-sizing: border-box;\n\n  &:hover {\n    background-color: #10101042;\n    border-color: #00000059;\n  }\n\n  &:hover,\n  &:focus {\n    cursor: text;\n    background-color: #10101042;\n    border-color: #00000059;\n  }\n\n  &.invalid {\n    border-color: red;\n  }\n"]))),Qw=e=>!0,ek=e=>{var t,n;let[r]=Qy({mode:"noFocus"}),i=null!=(t=e.isValid)?t:Qw,a=(0,$w.useRef)(e);a.current=e;let o=(0,$w.useRef)(null);Hb(o.current,()=>{o.current.blur()},"editingViaKeyboard"===r.current.mode);let s=(0,$w.useMemo)(()=>{let e=()=>{let e=r.current,t=e.currentEditedValueInString;i(t)?e.valueBeforeEditing===t?a.current.discardTemporaryValue():a.current.permanentlySetValue(t):a.current.discardTemporaryValue()},t=()=>{let e=a.current.value;r.current={mode:"editingViaKeyboard",currentEditedValueInString:String(e),valueBeforeEditing:e},setTimeout(()=>{o.current.focus()})};return{inputChange:e=>{let t=e.target,{value:n}=t,o=r.current;r.current=x(b({},o),{currentEditedValueInString:n}),i(n)&&a.current.temporarilySetValue(n)},onBlur:()=>{var t,n;"editingViaKeyboard"===r.current.mode&&(e(),r.current={mode:"noFocus"}),null==(n=(t=a.current).onBlur)||n.call(t)},onInputKeyDown:t=>{"Escape"===t.key?(a.current.discardTemporaryValue(),r.current={mode:"noFocus"},o.current.blur()):("Enter"===t.key||"Tab"===t.key)&&(e(),o.current.blur())},onClick:e=>{"noFocus"===r.current.mode&&(o.current.focus(),e.preventDefault()),e.stopPropagation()},onFocus:()=>{"noFocus"===r.current.mode?t():r.current.mode}}},[]);(0,Xw.useEffect)(()=>()=>{s.onBlur()},[]);let l="editingViaKeyboard"!==r.current.mode?e.value:r.current.currentEditedValueInString,u=[o];return e.inputRef&&u.push(e.inputRef),$w.default.createElement(Jw,{key:"input",type:"text",className:"".concat(null!=(n=e.className)?n:""," ").concat(i(l)?"":"invalid"),onChange:s.inputChange,value:l,onBlur:s.onBlur,onKeyDown:s.onInputKeyDown,onClick:s.onClick,onFocus:s.onFocus,ref:Vb(u),onMouseDown:e=>{e.stopPropagation()},onDoubleClick:e=>{e.preventDefault(),e.stopPropagation()},autoFocus:e.autoFocus})}});function rk(e){let{editingTools:t,value:n,autoFocus:r}=e;return ik.default.createElement(ek,{value:n,temporarilySetValue:t.temporarilySetValue,discardTemporaryValue:t.discardTemporaryValue,permanentlySetValue:t.permanentlySetValue,autoFocus:r})}var ik,ak,ok=k(()=>{ik=P(Oh()),nk(),ak=rk});function sk(e){let{removeAlphaIfOpaque:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(255*e.a|256).toString(16).slice(1),r=(255*e.r|256).toString(16).slice(1)+(255*e.g|256).toString(16).slice(1)+(255*e.b|256).toString(16).slice(1)+(t&&"ff"===n?"":n);return"#".concat(r)}function lk(e){return x(b({},e),{toString(){return sk(this,{removeAlphaIfOpaque:!0})}})}var uk,ck=k(()=>{uk=/^#*([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i});function dk(e){let t=(0,hk.useRef)(e),n=(0,hk.useRef)(e=>{t.current&&t.current(e)});return t.current=e,n.current}var hk,fk,pk,mk,gk,yk,vk,_k,bk,xk,wk,kk,Sk,Ek,Ck,Pk,Dk,Ik,Tk,Ak,zk,Ok,Fk,Mk,jk,Bk,Rk,Lk,Nk,Uk,Vk,qk,Hk,Wk,Zk,Kk,Gk,Xk,$k,Yk,Jk,Qk,eS,tS,nS,rS,iS,aS,oS,sS,lS,uS,cS,dS,hS=k(()=>{hk=P(Oh())}),fS=k(()=>{fk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e>n?n:e<t?t:e}}),pS=k(()=>{pk=P(Oh()),mk=(0,pk.createContext)(void 0),gk=e=>{let{children:t}=e,[n,r]=(0,pk.useState)(!1);return pk.default.createElement(mk.Provider,{value:{editing:n,setEditing:r}},t)},yk=()=>(0,pk.useContext)(mk)}),mS=k(()=>{vk=P(Oh()),hS(),fS(),Zp(),pS(),_k=e=>"touches"in e,bk=(e,t)=>{for(let n=0;n<e.length;n++)if(e[n].identifier===t)return e[n];return e[0]},xk=e=>e&&e.ownerDocument.defaultView||self,wk=(e,t,n)=>{let r=e.getBoundingClientRect(),i=_k(t)?bk(t.touches,n):t;return{left:fk((i.pageX-(r.left+xk(e).pageXOffset))/r.width),top:fk((i.pageY-(r.top+xk(e).pageYOffset))/r.height)}},kk=e=>{!_k(e)&&e.preventDefault()},Sk=(e,t)=>t&&!_k(e),Ck=Wp.div(Ek||(Ek=I(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  border-radius: inherit;\n  outline: none;\n  /* Don't trigger the default scrolling behavior when the event is originating from this element */\n  touch-action: none;\n"]))),Pk=e=>{var t=e,{onMove:n,onKey:r}=t,i=w(t,["onMove","onKey"]);let a=(0,vk.useRef)(null),o=dk(n),s=dk(r),l=(0,vk.useRef)(null),u=(0,vk.useRef)(!1),{setEditing:c}=yk(),[d,h,f]=(0,vk.useMemo)(()=>{let e=e=>{kk(e),(_k(e)?e.touches.length>0:e.buttons>0)&&a.current?o(wk(a.current,e,l.current)):(c(!1),n(!1))},t=e=>{c(!1),n(!1)};function n(n){let r=u.current,i=a.current,o=xk(i),s=n?o.addEventListener:o.removeEventListener;s(r?"touchmove":"mousemove",e),s(r?"touchend":"mouseup",t)}return[e=>{let{nativeEvent:t}=e,r=a.current;if(r&&(kk(t),!Sk(t,u.current)&&r)){if(_k(t)){u.current=!0;let e=t.changedTouches||[];e.length&&(l.current=e[0].identifier)}r.focus(),c(!0),o(wk(r,t,l.current)),n(!0)}},e=>{let t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),s({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},n]},[s,o]);return(0,vk.useEffect)(()=>f,[f]),vk.default.createElement(Ck,x(b({},i),{onTouchStart:d,onMouseDown:d,ref:a,onKeyDown:h,tabIndex:0,role:"slider"}))},Dk=vk.default.memo(Pk)}),gS=k(()=>{Ik=P(Oh()),Zp(),mS(),Ak=Wp(Dk)(Tk||(Tk=I([""]))),Ok=Wp.div(zk||(zk=I(["\n  position: absolute;\n  z-index: 1;\n  box-sizing: border-box;\n  width: 16px;\n  height: 16px;\n  transform: translate(-50%, -50%);\n  background-color: #fff;\n  border: 1px solid #ffffff00;\n  border-radius: 2px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n\n  ",":focus & {\n    transform: translate(-50%, -50%) scale(1.1);\n  }\n"])),Ak),Mk=Wp.div(Fk||(Fk=I(["\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  pointer-events: none;\n  border-radius: inherit;\n"]))),jk=e=>{let{className:t,color:n,left:r,top:i=.5}=e,a={top:"".concat(100*i,"%"),left:"".concat(100*r,"%")};return Ik.default.createElement(Ok,{style:a,className:t},Ik.default.createElement(Mk,{style:{backgroundColor:n}}))}}),yS=k(()=>{Bk=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.pow(10,t);return Math.round(n*e)/n}}),vS=k(()=>{yS(),{grad:.9,turn:360,rad:360/(2*Math.PI)},Rk=e=>{let{h:t,s:n,v:r,a:i}=e,a=(200-n)*r/100;return{h:Bk(t),s:Bk(a>0&&a<200?n*r/100/(a<=100?a:200-a)*100:0),l:Bk(a/2),a:Bk(i,2)}},Lk=e=>{let{h:t,s:n,l:r}=Rk(e);return"hsl(".concat(t,", ").concat(n,"%, ").concat(r,"%)")},Nk=e=>{let{h:t,s:n,l:r,a:i}=Rk(e);return"hsla(".concat(t,", ").concat(n,"%, ").concat(r,"%, ").concat(i,")")},Uk=e=>{let{h:t,s:n,v:r,a:i}=e;t=t/360*6,n/=100,r/=100;let a=Math.floor(t),o=r*(1-n),s=r*(1-(t-a)*n),l=r*(1-(1-t+a)*n),u=a%6;return{r:Bk(255*[r,s,o,o,l,r][u]),g:Bk(255*[l,r,r,s,o,o][u]),b:Bk(255*[o,o,l,r,r,s][u]),a:Bk(i,2)}},Vk=e=>{let{r:t,g:n,b:r,a:i}=e,a=Math.max(t,n,r),o=a-Math.min(t,n,r),s=o?a===t?(n-r)/o:a===n?2+(r-t)/o:4+(t-n)/o:0;return{h:Bk(60*(s<0?s+6:s)),s:Bk(a?o/a*100:0),v:Bk(a/255*100),a:i}}}),_S=k(()=>{qk=P(Oh()),mS(),gS(),vS(),fS(),yS(),Zp(),Wk=Wp.div(Hk||(Hk=I(["\n  position: relative;\n  height: 16px;\n  border-radius: 2px;\n\n  background: linear-gradient(\n    to right,\n    #f00 0%,\n    #ff0 17%,\n    #0f0 33%,\n    #0ff 50%,\n    #00f 67%,\n    #f0f 83%,\n    #f00 100%\n  );\n"]))),Kk=Wp(jk)(Zk||(Zk=I(["\n  z-index: 2;\n"]))),Gk=e=>{let{className:t,hue:n,onChange:r}=e;return qk.default.createElement(Wk,{className:t},qk.default.createElement(Dk,{onMove:e=>{r({h:360*e.left})},onKey:e=>{r({h:fk(n+360*e.left,0,360)})},"aria-label":"Hue","aria-valuetext":Bk(n)},qk.default.createElement(Kk,{left:n/360,color:Lk({h:n,s:100,v:100,a:1})})))},Xk=qk.default.memo(Gk)}),bS=k(()=>{$k=P(Oh()),mS(),gS(),vS(),fS(),yS(),Zp(),Jk=Wp.div(Yk||(Yk=I(["\n  position: relative;\n  flex-grow: 1;\n  border-color: transparent; /* Fixes https://github.com/omgovich/react-colorful/issues/139 */\n  border-bottom: 12px solid #000;\n  border-radius: 2px;\n  background-image: linear-gradient(to top, #000, rgba(0, 0, 0, 0)),\n    linear-gradient(to right, #fff, rgba(255, 255, 255, 0));\n\n  // Improve elements rendering on light backgrounds\n  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);\n"]))),eS=Wp(jk)(Qk||(Qk=I(["\n  z-index: 3;\n"]))),tS=e=>{let{hsva:t,onChange:n}=e,r={backgroundColor:Lk({h:t.h,s:100,v:100,a:1})};return $k.default.createElement(Jk,{style:r},$k.default.createElement(Dk,{onMove:e=>{n({s:100*e.left,v:100-100*e.top})},onKey:e=>{n({s:fk(t.s+100*e.left,0,100),v:fk(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation ".concat(Bk(t.s),"%, Brightness ").concat(Bk(t.v),"%")},$k.default.createElement(eS,{top:1-t.v/100,left:t.s/100,color:Lk(t)})))},nS=$k.default.memo(tS)}),xS=k(()=>{rS=P(Oh()),mS(),gS(),vS(),fS(),yS(),Zp(),aS=Wp.div(iS||(iS=I(['\n  position: relative;\n  height: 16px;\n  border-radius: 2px;\n  // Checkerboard\n  background-color: #fff;\n  background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>\');\n']))),sS=Wp.div.attrs(e=>{let{colorFrom:t,colorTo:n}=e;return{style:{backgroundImage:"linear-gradient(90deg, ".concat(t,", ").concat(n,")")}}})(oS||(oS=I(["\n  content: '';\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  pointer-events: none;\n  border-radius: inherit;\n\n  // Improve rendering on light backgrounds\n  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.05);\n"]))),uS=Wp(jk)(lS||(lS=I(['\n  // Checkerboard\n  background-color: #fff;\n  background-image: url(\'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><rect x="8" width="8" height="8"/><rect y="8" width="8" height="8"/></svg>\');\n']))),cS=e=>{let{className:t,hsva:n,onChange:r}=e,i=Nk(Object.assign({},n,{a:0})),a=Nk(Object.assign({},n,{a:1}));return rS.default.createElement(aS,{className:t},rS.default.createElement(sS,{colorFrom:i,colorTo:a}),rS.default.createElement(Dk,{onMove:e=>{r({a:e.left})},onKey:e=>{r({a:fk(n.a+e.left)})},"aria-label":"Alpha","aria-valuetext":"".concat(Bk(100*n.a),"%")},rS.default.createElement(uS,{left:n.a,color:Nk(n)})))}}),wS=k(()=>{dS=(e,t)=>{if(e===t)return!0;for(let n in e)if(e[n]!==t[n])return!1;return!0}});var kS,SS,ES,CS,PS,DS,IS,TS,AS,zS,OS,FS,MS,jS,BS,RS,LS=k(()=>{kS=P(Oh()),wS(),hS(),pS()}),NS=k(()=>{SS=P(Oh()),_S(),bS(),xS(),LS(),Zp(),CS=Wp.div(ES||(ES=I(["\n  position: relative;\n  display: flex;\n  gap: 4px;\n  flex-direction: column;\n  width: 200px;\n  height: 200px;\n  user-select: none;\n  cursor: default;\n"]))),PS=e=>{var t=e,{className:n,colorModel:r,color:i=r.defaultColor,temporarilySetValue:a,permanentlySetValue:o,discardTemporaryValue:s}=t,l=w(t,["className","colorModel","color","temporarilySetValue","permanentlySetValue","discardTemporaryValue"]);let[u,c]=function(e,t,n,r){let{editing:i}=yk(),[a,o]=(0,kS.useState)(t),s=dk(n),l=dk(r),u=i?a:t,[c,d]=(0,kS.useState)(()=>e.toHsva(u)),h=(0,kS.useRef)({color:u,hsva:c}),f=(0,kS.useRef)({color:u,hsva:c});(0,kS.useEffect)(()=>{i&&o(h.current.color)},[i]),(0,kS.useEffect)(()=>{let t=e.fromHsva(c);i?!dS(c,h.current.hsva)&&!e.equal(t,h.current.color)&&(h.current={hsva:c,color:t},o(t),s(t)):!dS(c,f.current.hsva)&&!e.equal(t,f.current.color)&&(f.current={hsva:c,color:t},h.current={hsva:c,color:t},l(t))},[i,c,e,s,l]),(0,kS.useEffect)(()=>{if(!i&&!e.equal(u,f.current.color)){let t=e.toHsva(u);f.current={hsva:t,color:u},d(t)}},[i,u,e]);let p=(0,kS.useCallback)(e=>{d(t=>Object.assign({},t,e))},[]);return[c,p]}(r,i,a,o);return(0,SS.useEffect)(()=>()=>{s()},[]),SS.default.createElement(CS,b({},l),SS.default.createElement(nS,{hsva:u,onChange:c}),SS.default.createElement(Xk,{hue:u.h,onChange:c}),SS.default.createElement(cS,{hsva:u,onChange:c}))}}),US=k(()=>{DS=P(Oh()),NS(),wS(),vS(),pS(),IS=e=>({r:e.r/255,g:e.g/255,b:e.b/255,a:e.a}),TS=e=>({r:255*e.r,g:255*e.g,b:255*e.b,a:e.a}),AS={defaultColor:{r:0,g:0,b:0,a:1},toHsva:e=>Vk(TS(e)),fromHsva:e=>IS(Uk(e)),equal:dS},zS=e=>DS.default.createElement(gk,null,DS.default.createElement(PS,x(b({},e),{permanentlySetValue:t=>{e.permanentlySetValue(t)},colorModel:AS})))}),VS=k(()=>{US()}),qS=k(()=>{OS=P(Oh()),FS=function(e){(0,OS.useEffect)(e,[])}}),HS=k(()=>{MS=P(Oh()),qS(),jS=function(e){var t=(0,MS.useRef)(e);t.current=e,FS(function(){return function(){return t.current()}})}}),WS=k(()=>{BS=P(Oh()),HS(),RS=function(e){var t=(0,BS.useRef)(0),n=(0,BS.useState)(e),r=n[0],i=n[1],a=(0,BS.useCallback)(function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame(function(){i(e)})},[]);return jS(function(){cancelAnimationFrame(t.current)}),[r,a]}});var ZS,KS,GS,XS,$S=k(()=>{ZS="undefined"!=typeof window}),YS=k(()=>{KS=P(Oh()),WS(),$S(),GS=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=RS({width:ZS?window.innerWidth:e,height:ZS?window.innerHeight:t}),r=n[0],i=n[1];return(0,KS.useEffect)(function(){if(ZS){var e=function(){i({width:window.innerWidth,height:window.innerHeight})};return function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.addEventListener&&e.addEventListener.apply(e,t)}(window,"resize",e),function(){!function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e&&e.removeEventListener&&e.removeEventListener.apply(e,t)}(window,"resize",e)}}},[]),r},XS=GS});function JS(e){let[t,n]=(0,QS.useState)(null);return(0,QS.useLayoutEffect)(()=>(e&&n(e.getBoundingClientRect()),()=>{n(null)}),[e]),t}var QS,eE,tE,nE,rE=k(()=>{QS=P(Oh())}),iE=k(()=>{eE=P(Oh()),tE=(0,eE.createContext)({}),nE=tE});var aE,oE,sE,lE=k(()=>{}),uE=k(()=>{aE=P(Oh()),oE=P(Oh()),YS(),rE(),iE(),tv(),tx(),lE(),Dv(),Th(),sE=e=>{var t,n;let r=e.children(),[i,a]=Qy(null),o=r.props.style?b({},r.props.style):{};o.position="absolute";let s=JS(a),l=JS(e.target),u=XS(),[c,d]=(0,oE.useState)({});return(0,oE.useLayoutEffect)(()=>{var t,n,r;if(!s||!a||!l)return;let i=null!=(t=e.verticalGap)?t:8,o={},c=null!=(n=e.verticalPlacement)?n:"bottom",h=0,f=0;"bottom"===c?l.bottom+s.height+i<u.height?(c="bottom",h=l.bottom+i,o.top="0px"):l.top>s.height+i?(c="top",h=l.top-(s.height+i),o.bottom="0px",o.transform="rotateZ(180deg)"):c="overlay":"top"===c&&(l.top>s.height+i?(c="top",h=l.top-(s.height+i),o.bottom="0px",o.transform="rotateZ(180deg)"):l.bottom+s.height+i<u.height?(c="bottom",h=l.bottom+i,o.top="0px"):c="overlay");let p=0;if("overlay"!==c){let e=l.left+l.width/2;e<s.width/2?(f=i,p=Math.max(e-i,8)):e+s.width/2>u.width?(f=u.width-(i+s.width),p=Math.min(e-f,s.width-8)):(f=e-s.width/2,p=s.width/2),o.left=p+"px"}let{minX:m=-1/0,maxX:g=1/0,minY:y=-1/0,maxY:v=1/0}=null!=(r=e.constraints)?r:{},_=ms(f,m,g-s.width),b=ms(h,y,v+s.height);return a.style.left=_+"px",a.style.top=b+"px",d(o),e.onPointerOutside?function(e,t,n){let r=e.getBoundingClientRect(),i=e=>{(e.clientX<r.left-t||e.clientX>r.left+r.width+t||e.clientY<r.top-t||e.clientY>r.top+r.height+t)&&n(e)};return window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)}}(a,e.onPointerOutside.threshold,e.onPointerOutside.callback):void 0},[s,a,e.target,l,u,e.onPointerOutside]),Hb([a,null!=(t=e.target)?t:null],null!=(n=e.onClickOutside)?n:Ev),aE.default.createElement(nE.Provider,{value:c},(0,oE.cloneElement)(r,{ref:i,style:o}))}});function cE(e,t){let n=function(){},{isPointerBeingCaptured:r}=ux("usePopover"),[i,a]=Qy({isOpen:!1}),o=(0,dE.useRef)(e),s=(0,dE.useCallback)(e=>{'closing due to "'.concat(e,'"'),i.current={isOpen:!1}},[]),l=(0,dE.useCallback)((e,t)=>{var n;let a="function"==typeof o.current?o.current():o.current;i.current={isOpen:!0,clickPoint:{clientX:e.clientX,clientY:e.clientY},target:t,opts:a,onClickOutside:function(){c.childHasFocusRef.current||!1!==a.closeOnClickOutside&&s("clicked outside popover")},onPointerOutside:!1===a.closeWhenPointerIsDistant?void 0:{threshold:null!=(n=a.pointerDistanceThreshold)?n:100,callback:()=>{c.childHasFocusRef.current||r()||s("pointer outside")}}}},[]),u=(0,dE.useCallback)(function(){i.current.isOpen?s("toggled"):l(...arguments)},[]),c=function(e){let t=(0,dE.useContext)(fE);(0,dE.useEffect)(()=>{if(e.state.isOpen){let n=t.takeFocus();return e._debug("take focus"),()=>{e._debug("release focus"),n.releaseFocus()}}},[e.state.isOpen]);let n=(0,dE.useRef)(!1);return{childHasFocusRef:n,childPopoverLock:{takeFocus:()=>(n.current=!0,{releaseFocus(){n.current=!1}})}}}({_debug:n,state:a}),[,d]=(0,dE.useContext)(kO);(0,dE.useEffect)(()=>{let e;return a.isOpen&&(e=d()),()=>null==e?void 0:e()},[a.isOpen]);let h=(0,dE.useContext)(Gy);return{node:a.isOpen?(0,hE.createPortal)(dE.default.createElement(fE.Provider,{value:c.childPopoverLock},dE.default.createElement(sE,{children:t,target:a.target,onClickOutside:a.onClickOutside,onPointerOutside:a.onPointerOutside,constraints:a.opts.constraints,verticalGap:a.opts.verticalGap})),h):dE.default.createElement(dE.default.Fragment,null),open:l,close:s,toggle:u,isOpen:a.isOpen}}var dE,hE,fE,pE,mE,gE,yE,vE,_E,bE,xE,wE,kE,SE,EE,CE,PE,DE,IE,TE,AE,zE,OE=k(()=>{px(),tv(),dE=P(Oh()),hE=P(Bh()),Jy(),uE(),HF(),fE=dE.default.createContext({takeFocus:()=>({releaseFocus(){}})})}),FE=k(()=>{pE=P(Oh()),Zp(),iE(),gE=Wp.div(mE||(mE=I(["\n  position: absolute;\n  width: 0;\n  height: 0;\n  color: var(--popover-arrow-color);\n  pointer-events: none;\n"]))),vE=Wp.div(yE||(yE=I(["\n  width: 12px;\n  height: 8px;\n  position: absolute;\n  left: -7px;\n  top: -8px;\n  text-align: center;\n  line-height: 0;\n"]))),bE=Wp.path(_E||(_E=I(["\n  fill: var(--popover-bg);\n"]))),wE=Wp.path(xE||(xE=I(["\n  fill: var(--popover-inner-stroke);\n"]))),SE=Wp.path(kE||(kE=I(["\n  fill: var(--popover-outer-stroke);\n"]))),EE=(0,pE.forwardRef)((e,t)=>{let{className:n}=e,r=(0,pE.useContext)(nE);return pE.default.createElement(gE,{className:n,ref:t,style:b({},r)},pE.default.createElement(vE,null,pE.default.createElement("svg",{width:"12",height:"8",viewBox:"0 0 12 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},pE.default.createElement(SE,{d:"M6 0L0 6H12L6 0Z"}),pE.default.createElement(wE,{d:"M6 1.5L0 7.5H12L6 1.5Z"}),pE.default.createElement(bE,{d:"M6 3L0 9H12L6 3Z"}))))}),CE=EE}),ME=k(()=>{Cv(),Ym(),PE=P(Oh()),Zp(),FE(),DE=Xm(.05,"#2a2a31"),TE=Wp.div(IE||(IE=I(["\n  position: absolute;\n  --popover-bg: ",";\n  --popover-inner-stroke: #505159;\n  --popover-outer-stroke: #111;\n\n  background: var(--popover-bg);\n\n  color: white;\n  padding: 0;\n  margin: 0;\n  cursor: default;\n  ",";\n  border-radius: 3px;\n  z-index: 10000;\n  border: 1px solid var(--popover-inner-stroke);\n  box-shadow: 0 0 0 1px var(--popover-outer-stroke), 0 6px 8px -4px black;\n  backdrop-filter: blur(8px);\n\n  & a {\n    color: inherit;\n  }\n"])),DE,av),AE=PE.default.forwardRef((e,t)=>{let{children:n,className:r,showPopoverEdgeTriangle:i=!0}=e;return PE.default.createElement(TE,{className:r,ref:t},i?PE.default.createElement(CE,null):void 0,n)}),zE=AE});function jE(e){let{editingTools:t,value:n,autoFocus:r}=e,i=(0,BE.useRef)(null),a=(0,BE.useCallback)(e=>{let n=lk(function(e){let t=(e=e.trim().toLowerCase()).match(uk);if(!t)return{r:0,g:0,b:0,a:1};let n=function(e){switch(e.length){case 3:return"".concat(e.repeat(2),"ff");case 4:let t=e.substr(0,3),n=e[3];return"".concat(t.repeat(2)).concat(n.repeat(2));case 6:return"".concat(e,"ff")}return e}(t[1]);return{r:parseInt(n.substr(0,2),16)/255,g:parseInt(n.substr(2,2),16)/255,b:parseInt(n.substr(4,2),16)/255,a:parseInt(n.substr(6,2),16)/255}}(e));t.permanentlySetValue(n)},[t]),o=cE({debugName:"RgbaPropEditor"},()=>BE.default.createElement(ZE,null,BE.default.createElement(zS,{color:{r:n.r,g:n.g,b:n.b,a:n.a},temporarilySetValue:e=>{let n=lk(e);t.temporarilySetValue(n)},permanentlySetValue:e=>{let n=lk(e);t.permanentlySetValue(n)},discardTemporaryValue:t.discardTemporaryValue})));return BE.default.createElement(BE.default.Fragment,null,BE.default.createElement(LE,null,BE.default.createElement(UE,{rgbaColor:n,ref:i,onClick:e=>{o.toggle(e,i.current)}}),BE.default.createElement(qE,{value:sk(n,{removeAlphaIfOpaque:!0}),temporarilySetValue:HE,discardTemporaryValue:HE,permanentlySetValue:a,isValid:e=>!!e.match(uk),autoFocus:r})),o.node)}var BE,RE,LE,NE,UE,VE,qE,HE,WE,ZE,KE,GE=k(()=>{ck(),ck(),BE=P(Oh()),VS(),Zp(),OE(),nk(),ME(),LE=Wp.div(RE||(RE=I(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  gap: 4px;\n"]))),UE=Wp.div.attrs(e=>({style:{background:sk(e.rgbaColor)}}))(NE||(NE=I(["\n  height: 18px;\n  aspect-ratio: 1;\n  border-radius: 99999px;\n"]))),qE=Wp(ek)(VE||(VE=I(["\n  flex: 1;\n"]))),HE=()=>{},ZE=Wp.div(WE||(WE=I(["\n  position: absolute;\n  background-color: ",";\n  color: white;\n  margin: 0;\n  cursor: default;\n  border-radius: 3px;\n  z-index: 10000;\n  backdrop-filter: blur(8px);\n\n  padding: 4px;\n  pointer-events: all;\n\n  border: none;\n  box-shadow: none;\n"])),DE),KE=jE});function XE(e){let{propConfig:t,editingTools:n,value:r,autoFocus:i}=e,[a,o]=$E.default.useState();(0,$E.useEffect)(()=>{o(r?n.getAssetUrl(r):void 0)},[r]);let s=(0,$E.useCallback)(e=>T(this,null,function*(){let t=e.target.files[0];n.permanentlySetValue({type:"image",id:void 0});let i=yield n.createAsset(t);i?n.permanentlySetValue({type:"image",id:i}):n.permanentlySetValue(r),e.target.value=null}),[n,r]),l=!(null!=r&&r.id);return $E.default.createElement(JE,{empty:l},$E.default.createElement(iC,{empty:l,title:l?"Upload image":'"'.concat(r.id,'" (Click to upload new image)')},$E.default.createElement(oC,{type:"file",onChange:s,accept:"image/*,.hdr",autoFocus:i}),a?$E.default.createElement(lC,{src:a}):$E.default.createElement(eC,null)),!l&&$E.default.createElement(cC,{title:"Delete image",onClick:()=>{n.permanentlySetValue({type:"image",id:void 0})}},$E.default.createElement(t_,null)))}var $E,YE,JE,QE,eC,tC,nC,rC,iC,aC,oC,sC,lC,uC,cC,dC,hC=k(()=>{x_(),$E=P(Oh()),Zp(),JE=Wp.div(YE||(YE=I(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  gap: 4px;\n"]))),eC=Wp.div(QE||(QE=I(["\n  position: absolute;\n  inset: -5px;\n  // rotate 45deg\n  transform: rotate(45deg);\n  --checker-color: #ededed36;\n  &:hover {\n    --checker-color: #ededed77;\n  }\n  // checkerboard background with 4px squares\n  background-image: linear-gradient(\n      45deg,\n      var(--checker-color) 25%,\n      transparent 25%\n    ),\n    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),\n    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),\n    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);\n  background-size: 5px 5px;\n"]))),iC=Wp.label(rC||(rC=I(["\n  position: relative;\n  cursor: default;\n  box-sizing: border-box;\n\n  height: 18px;\n  aspect-ratio: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 16px;\n\n  overflow: hidden;\n  color: #ccc;\n  &:hover {\n    color: white;\n  }\n\n  border-radius: 99999px;\n  border: 1px solid hwb(220deg 40% 52%);\n  &:hover {\n    border-color: hwb(220deg 45% 52%);\n  }\n\n  ","\n"])),e=>e.empty?zf(tC||(tC=I([""]))):zf(nC||(nC=I([""])))),oC=Wp.input.attrs({type:"file"})(aC||(aC=I(["\n  display: none;\n"]))),lC=Wp.img(sC||(sC=I(["\n  position: absolute;\n  inset: 0;\n  height: 100%;\n  aspect-ratio: 1;\n\n  object-fit: cover;\n"]))),cC=Wp.button(uC||(uC=I(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: none;\n  background: transparent;\n  color: #a8a8a9;\n\n  border: none;\n  height: 100%;\n  aspect-ratio: 1/1;\n\n  opacity: 0;\n\n  ",":hover & {\n    opacity: 0.8;\n  }\n\n  &:hover {\n    opacity: 1;\n    color: white;\n  }\n"])),JE),dC=XE});function fC(e){let{propConfig:t,editingTools:n,value:r,autoFocus:i}=e,[a,o]=pC.default.useState();(0,pC.useEffect)(()=>{o(r?n.getAssetUrl(r):void 0)},[r]);let s=(0,pC.useCallback)(e=>T(this,null,function*(){let t=e.target.files[0];n.permanentlySetValue({type:"file",id:void 0});let i=yield n.createAsset(t);i?n.permanentlySetValue({type:"file",id:i}):n.permanentlySetValue(r),e.target.value=null}),[n,r]),l=!(null!=r&&r.id);return pC.default.createElement(gC,{empty:l},pC.default.createElement(wC,{empty:l,title:l?"Upload file":'"'.concat(r.id,'" (Click to upload new file)')},pC.default.createElement(SC,{type:"file",onChange:s,autoFocus:i}),a?pC.default.createElement(Kv,null):pC.default.createElement(vC,null)),!l&&pC.default.createElement(CC,{title:"Delete file",onClick:()=>{n.permanentlySetValue({type:"file",id:void 0})}},pC.default.createElement(t_,null)))}var pC,mC,gC,yC,vC,_C,bC,xC,wC,kC,SC,EC,CC,PC,DC,IC=k(()=>{x_(),pC=P(Oh()),Zp(),gC=Wp.div(mC||(mC=I(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  gap: 4px;\n"]))),vC=Wp.div(yC||(yC=I(["\n  position: absolute;\n  inset: -5px;\n  // rotate 45deg\n  transform: rotate(45deg);\n  --checker-color: #ededed36;\n  &:hover {\n    --checker-color: #ededed77;\n  }\n  // checkerboard background with 4px squares\n  background-image: linear-gradient(\n      45deg,\n      var(--checker-color) 25%,\n      transparent 25%\n    ),\n    linear-gradient(-45deg, var(--checker-color) 25%, transparent 25%),\n    linear-gradient(45deg, transparent 75%, var(--checker-color) 75%),\n    linear-gradient(-45deg, transparent 75%, var(--checker-color) 75%);\n  background-size: 5px 5px;\n"]))),wC=Wp.label(xC||(xC=I(["\n  position: relative;\n  cursor: default;\n  box-sizing: border-box;\n\n  height: 18px;\n  aspect-ratio: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 16px;\n\n  overflow: hidden;\n  color: #ccc;\n  &:hover {\n    color: white;\n  }\n\n  border-radius: 99999px;\n  border: 1px solid hwb(220deg 40% 52%);\n  &:hover {\n    border-color: hwb(220deg 45% 52%);\n  }\n\n  ","\n"])),e=>e.empty?zf(_C||(_C=I([""]))):zf(bC||(bC=I([""])))),SC=Wp.input.attrs({type:"file"})(kC||(kC=I(["\n  display: none;\n"]))),CC=Wp.button(EC||(EC=I(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: none;\n  background: transparent;\n  color: #a8a8a9;\n\n  border: none;\n  height: 100%;\n  aspect-ratio: 1/1;\n\n  opacity: 0;\n\n  ",":hover & {\n    opacity: 0.8;\n  }\n\n  &:hover {\n    opacity: 1;\n    color: white;\n  }\n"])),gC),PC=fC}),TC=k(()=>{Ub(),Rx(),tk(),ok(),GE(),hC(),IC(),DC={number:Bx,string:ak,boolean:Nb,stringLiteral:Gw,rgba:KE,image:dC,file:PC}});function AC(e){let t=new WeakMap;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))}var zC=k(()=>{});function OC(e){return"compound"===e.type||"enum"===e.type}function FC(e,t){if(!e)return;let[n,...r]=t;return void 0===n?e:OC(e)?FC("enum"===e.type?e.cases[n]:e.props[n],r):void 0}function MC(e,t){let n=t.deserializeAndSanitize(e);return void 0===n?t.default:n}function*jC(e,t){if("compound"!==e.type){if("enum"===e.type)throw new Error("Not implemented yet");return yield{path:t,conf:e}}for(let n in e.props)yield*z(jC(e.props[n],[...t,n]))}var BC,RC,LC,NC,UC,VC,qC,HC,WC,ZC,KC,GC=k(()=>{zC(),BC=AC(e=>{if("enum"===e.type)throw new Error("Not implemented yet for enums");for(let t in e.props){let n=e.props[t];if(!OC(n))return!0;if(BC(n))return!0}return!1})}),XC=k(()=>{RC="calc(var(--left-pad) + var(--depth) * var(--step))"}),$C=k(()=>{Zp(),NC=zf(LC||(LC=I(["\n  font-weight: 300;\n  font-size: 11px;\n  color: ",";\n  text-shadow: 0.5px 0.5px 2px rgba(0, 0, 0, 0.3);\n"])),e=>"self"===e.isHighlighted?"#CCC":"#919191")}),YC=k(()=>{Dv(),UC=P(Oh()),Zp(),VC=26,HC=Wp.li(qC||(qC=I(["\n  height: ","px;\n  padding: 0 12px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  font-size: 11px;\n  font-weight: 400;\n  position: relative;\n  color: ",";\n  cursor: ",";\n\n  &:after {\n    position: absolute;\n    inset: 2px 1px;\n    display: block;\n    content: ' ';\n    pointer-events: none;\n    z-index: -1;\n    border-radius: 3px;\n  }\n\n  &:hover:after {\n    background-color: ",";\n  }\n"])),VC,e=>e.enabled?"white":"#8f8f8f",e=>e.enabled?"normal":"not-allowed",e=>e.enabled?"rgba(63, 174, 191, 0.75)":"initial"),ZC=Wp.span(WC||(WC=I([""]))),KC=e=>UC.default.createElement(HC,{onClick:e.enabled?e.onClick:Ev,enabled:e.enabled,title:e.enabled?void 0:"Disabled"},UC.default.createElement(ZC,null,UC.default.createElement(UC.default.Fragment,null,e.label)))});var JC,QC,eP,tP,nP,rP,iP,aP,oP,sP,lP,uP,cP,dP,hP,fP=k(()=>{JC=P(Oh())}),pP=k(()=>{QC=P(Oh()),YC(),Zp(),Ym(),Cv(),tP=Wp.ul(eP||(eP=I(["\n  position: absolute;\n  min-width: ","px;\n  z-index: 10000;\n  background: ",";\n  backdrop-filter: blur(2px);\n  color: white;\n  list-style-type: none;\n  padding: 2px 0;\n  margin: 0;\n  border-radius: 1px;\n  cursor: default;\n  ",";\n  border-radius: 3px;\n"])),190,Xm(.2,"#111"),av),rP=Wp.div(nP||(nP=I(["\n  padding: 4px 10px;\n  border-bottom: 1px solid #6262626d;\n  color: #adadadb3;\n  font-size: 11px;\n  font-weight: 500;\n"]))),iP=QC.default.forwardRef((e,t)=>QC.default.createElement(tP,{ref:t},e.displayName?QC.default.createElement(rP,null,e.displayName):null,e.items.map((t,n)=>QC.default.createElement(KC,{key:"item-".concat(n),label:t.label,enabled:!1!==t.enabled,onClick:n=>{t.callback&&t.callback(n),e.onRequestClose()}})))),aP=iP}),mP=k(()=>{rE(),oP=P(Oh()),sP=P(Oh()),lP=P(Oh()),uP=P(Bh()),YS(),YC(),Jy(),fP(),pP(),cP=e=>{let[t,n]=(0,lP.useState)(null),r=JS(t),i=XS();(0,lP.useLayoutEffect)(()=>{if(!r||!t)return;let n=r.width/2,a=VC/2+(e.displayName?VC:0),o={left:e.clickPoint.clientX-n,top:e.clickPoint.clientY-a};o.left<0?o.left=0:o.left+r.width>i.width&&(o.left=i.width-r.width),o.top<0?o.top=0:o.top+r.height>i.height&&(o.top=i.height-r.height),t.style.left=o.left+"px",t.style.top=o.top+"px";let s=t=>{(t.clientX<o.left-20||t.clientX>o.left+r.width+20||t.clientY<o.top-20||t.clientY>o.top+r.height+20)&&e.onRequestClose()};return window.addEventListener("mousemove",s),()=>{window.removeEventListener("mousemove",s)}},[r,t,e.clickPoint,i,e.onRequestClose]);let a=(0,sP.useContext)(Gy);!function(e){let t=(0,JC.useRef)(e);t.current=e,(0,JC.useEffect)(()=>{let e=e=>t.current(e);return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[])}(t=>{"Escape"===t.key&&e.onRequestClose()});let o=(0,oP.useMemo)(()=>{let t=Array.isArray(e.items)?e.items:e.items();return t.length>0?t:[{label:e.displayName?"No actions for ".concat(e.displayName):"No actions found",enabled:!1}]},[e.items]);return(0,uP.createPortal)(lP.default.createElement(aP,{items:o,onRequestClose:e.onRequestClose,displayName:e.displayName,ref:n}),a)}}),gP=k(()=>{dP=P(Oh()),hP=(e,t)=>{let[n,r]=(0,dP.useState)({isOpen:!1}),i=(0,dP.useCallback)(()=>r({isOpen:!1}),[]);return(0,dP.useEffect)(()=>{if(!e||!0===t.disabled)return void r({isOpen:!1});let n=e=>{r({isOpen:!0,event:e}),e.preventDefault(),e.stopPropagation()};return e.addEventListener("contextmenu",n),()=>{e.removeEventListener("contextmenu",n)}},[e,t.disabled]),[n,i]}});function yP(e,t){let[n,r]=hP(e,t),[,i]=(0,vP.useContext)(kO);return(0,vP.useEffect)(()=>{var e;let r;return n.isOpen&&(null==(e=t.onOpen)||e.call(t),r=i()),()=>null==r?void 0:r()},[n.isOpen,t.onOpen]),[n.isOpen?vP.default.createElement(cP,{items:t.menuItems,displayName:t.displayName,clickPoint:n.event,onRequestClose:r}):_P,r,n.isOpen]}var vP,_P,bP=k(()=>{vP=P(Oh()),mP(),gP(),HF(),_P=vP.default.createElement(vP.default.Fragment,null)});function xP(e,t){return 0===t.length?e:jo(e,t)}var wP=k(()=>{Bo()});function kP(e,t){return null==e?null:e instanceof Element&&e.matches(t)?e:kP(e.parentElement,t)}var SP=k(()=>{});function EP(e,t){let n=e;for(let r of t)n=n[r];return n}var CP=k(()=>{});function PP(e){let t=IP.default.useContext(FP),n=t.usePresenceFlag(e);return{attrs:{[MP]:e},flag:n,useRelations(n,r){(0,TP.useEffect)(()=>e&&t.addRelatedFlags(e,n()),[e,...r])}}}function DP(e){let t=IP.default.useContext(FP),n=ix("PresenceListeners");(0,TP.useEffect)(()=>{let r;if(!e)return;let i=e=>{if(e.target instanceof Node){let i=kP(e.target,"[".concat(MP,"]"));if(i){let e=i.getAttribute(MP);return void(r!==e&&(r=e,t.setUserHover(e||void 0),n._debug("Updated current hover",{itemKey:e})))}null!=r&&(r=null,t.setUserHover(void 0),n._debug("Cleared current hover"))}};return e.addEventListener("mouseover",i),()=>{e.removeEventListener("mouseover",i),null!=r&&(r=null,n._debug("Cleared current hover as part of cleanup"))}},[e,t])}var IP,TP,AP,zP,OP,FP,MP,jP,BP,RP,LP,NP,UP,VP,qP,HP,WP,ZP,KP,GP,XP,$P,YP,JP,QP,eD,tD,nD,rD,iD,aD,oD,sD,lD,uD,cD,dD=k(()=>{IP=P(Oh()),TP=P(Oh()),sx(),AP=n(194),zP=n(194),Qh(),SP(),CP(),(OP=(0,AP.prism)(()=>{})).keepHot(),FP=IP.default.createContext(function(e){let t=new zP.Atom(void 0),n=new zP.Atom({}),r=new zP.Atom({}),i=0;return{addRelatedFlags(e,t){let n=String(++i),a=t.map(t=>{let i={flag:t.flag},a=[t.affects,e,n];return r.setByPointer(e=>EP(e,a),i),a});return()=>{for(let e of a)r.setByPointer(t=>EP(t,e),void 0)}},usePresenceFlag(i){if(e.enabled)return Lh((0,IP.useMemo)(()=>{if(!i)return OP;let e=t.prism,a=(0,AP.pointerToPrism)(n.pointer[i]),o=(0,AP.pointerToPrism)(r.pointer[i]);return(0,AP.prism)(()=>{if(a.getValue())return 2;{let t=o.getValue(),n=e.getValue(),r=t&&n&&t[n];if(r){let e;for(let t of Object.values(r))t&&(e&&e>=t.flag||(e=t.flag));return e}return}})},[i]))},setUserHover(e){let r=t.get();r!==e&&(r&&n.setByPointer(e=>e[r],!1),t.set(e),e&&n.setByPointer(t=>t[e],!0))}}}({enabled:!1})),MP="data-pi-key"}),hD=k(()=>{Cv(),Ym(),jP=P(Oh()),Zp(),dD(),RP=Wp.div(BP||(BP=I(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 16px;\n  margin: 0 0px 0 2px;\n  position: relative;\n  z-index: 0;\n  opacity: 0.7;\n\n  &:after {\n    position: absolute;\n    left: -14px;\n    right: -14px;\n    top: -2px;\n    bottom: -2px;\n    content: ' ';\n    display: none;\n    z-index: -1;\n    background: ",";\n  }\n\n  &:hover {\n    opacity: 1;\n    &:after {\n      display: block;\n    }\n  }\n"])),Xm(.2,"black")),NP=Wp.div(LP||(LP=I(["\n  background: none;\n  position: relative;\n  border: 0;\n  transition: transform 0.1s ease-out;\n  z-index: 0;\n  outline: none;\n  cursor: pointer;\n\n  &:after {\n    display: none;\n    ",":hover & {\n      display: block;\n    }\n    position: absolute;\n    left: -4px;\n    right: -4px;\n    top: -4px;\n    bottom: -4px;\n    content: ' ';\n    z-index: -1;\n  }\n"])),RP),UP={offColor:"#555",onColor:"#e0c917"},qP=Wp(NP)(VP||(VP=I(["\n  &:hover {\n    color: #e0c917;\n  }\n\n  color: ",";\n"])),e=>2===e.presence?"white":e.isOn?UP.onColor:UP.offColor),WP=zf(HP||(HP=I(["\n  pointer-events: none !important;\n"]))),KP=Wp(NP)(ZP||(ZP=I(["\n  color: ",";\n\n  ",";\n"])),e=>2===e.flag?"white":e.available?UP.onColor:UP.offColor,e=>e.available?av:WP),XP=Wp(KP)(GP||(GP=I(["\n  transform: translateX(2px);\n  ",":hover & {\n    transform: translateX(-7px);\n  }\n"])),RP),YP=Wp(KP)($P||($P=I(["\n  transform: translateX(-2px);\n  ",":hover & {\n    transform: translateX(7px);\n  }\n"])),RP),(e=>{let t=Wp.g(JP||(JP=I(["\n    stroke-width: 1;\n    ",":hover & path {\n      stroke-width: 3;\n    }\n  "])),KP);e.Prev=()=>jP.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},jP.default.createElement(t,{transform:"translate(6 3)"},jP.default.createElement("path",{d:"M4 1L1 4L4 7",stroke:"currentColor"}))),e.Next=()=>jP.default.createElement("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},jP.default.createElement(t,{transform:"translate(1 3)"},jP.default.createElement("path",{d:"M1 1L4 4L1 7",stroke:"currentColor"})));let n=Wp.g(QP||(QP=I(["\n    stroke-width: 0;\n    ",":hover & path {\n      stroke: currentColor;\n      stroke-width: 2;\n    }\n  "])),qP);e.Cur=()=>jP.default.createElement("svg",{width:"8",height:"12",viewBox:"0 0 8 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},jP.default.createElement(n,{transform:"translate(1 4)"},jP.default.createElement("path",{d:"M3 0L6 3L3 6L0 3L3 0Z",fill:"currentColor"})))})(eD||(eD={})),tD=e=>{var t,n,r,i,a;let o=PP(null==(t=e.prev)?void 0:t.itemKey),s=PP("on"===(null==(n=e.cur)?void 0:n.type)?e.cur.itemKey:void 0),l=PP(null==(r=e.next)?void 0:r.itemKey);return jP.default.createElement(RP,null,jP.default.createElement(XP,b({available:!!e.prev,onClick:null==(i=e.prev)?void 0:i.jump,flag:o.flag},o.attrs),jP.default.createElement(eD.Prev,null)),jP.default.createElement(qP,b({isOn:"on"===e.cur.type,onClick:e.cur.toggle,presence:s.flag},s.attrs),jP.default.createElement(eD.Cur,null)),jP.default.createElement(YP,b({available:!!e.next,onClick:null==(a=e.next)?void 0:a.jump,flag:l.flag},l.attrs),jP.default.createElement(eD.Next,null)))}}),fD=k(()=>{Ym(),nD=P(Oh()),Zp(),M(),hD(),GC(),rD={defaultState:{color:Xm(.95,"#C4C4C4"),hoverColor:Xm(.15,UP.onColor)},withStaticOverride:{color:Xm(.85,"#C4C4C4"),hoverColor:Xm(.15,UP.onColor)}},aD=Wp.div(iD||(iD=I(["\n  width: 16px;\n  margin: 0 0px 0 2px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n\n  color: ",";\n\n  &:hover {\n    color: ",";\n  }\n"])),e=>e.hasStaticOverride?rD.withStaticOverride.color:rD.defaultState.color,e=>e.hasStaticOverride?rD.withStaticOverride.hoverColor:rD.defaultState.hoverColor),sD=Wp.div(oD||(oD=I(["\n  width: 5px;\n  height: 5px;\n  border-radius: 1px;\n  transform: rotate(45deg);\n  /* border: 1px solid currentColor; */\n  background-color: currentColor;\n"]))),uD=Wp.div(lD||(lD=I(["\n  width: 5px;\n  height: 5px;\n  background-color: currentColor;\n  border-radius: 1px;\n  transform: rotate(45deg);\n"]))),cD=e=>{let{hasStaticOverride:t,obj:n,propConfig:r,pathToProp:i}=e;return nD.default.createElement(aD,{hasStaticOverride:t,onClick:()=>{O().transaction(e=>{let{stateEditors:t}=e;for(let{path:a,conf:o}of jC(r,i)){if(OC(o))continue;let e=x(b({},n.address),{pathToProp:a});t.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(e,r)}})},title:"Sequence this prop"},t?nD.default.createElement(uD,{title:"The default value is overridden"}):nD.default.createElement(sD,{title:"This is the default value for this prop"}))}});function pD(e){return JSON.stringify(mD(e))}function mD(e){return is(e)?Object.keys(e).sort().reduce((t,n)=>(t[n]=mD(e[n]),t),{}):Array.isArray(e)?e.map(mD):e}var gD,yD=k(()=>{Th()}),vD=k(()=>{gD=function(){let e="",t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21;for(;t--;)e+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[64*Math.random()|0];return e}});function _D(){return gD(10)}var bD,xD=k(()=>{yD(),vD(),bD={forSheet:()=>"sheet",forSheetObject:e=>pD({o:e.address.objectKey}),forSheetObjectProp:(e,t)=>pD({o:e.address.objectKey,p:t}),forTrackKeyframe:(e,t,n)=>pD({o:e.address.objectKey,t:t,k:n}),forSheetObjectAggregateKeyframe:(e,t)=>bD.forCompoundPropAggregateKeyframe(e,[],t),forSheetAggregateKeyframe:(e,t)=>pD({o:e.address.sheetId,pos:t}),forCompoundPropAggregateKeyframe:(e,t,n)=>pD({o:e.address.objectKey,p:t,pos:n})}});function wD(e,t,n){if(!t||0===t.data.keyframes.length)return SD;let r=kD.get(t.data);if(r&&r[0]===n)return r[1];function i(n){if(!t)return;let r=t.data.keyframes[n];return r&&{kf:r,track:t,itemKey:bD.forTrackKeyframe(e,t.id,r.id)}}let a=(()=>{let e=t.data.keyframes.findIndex(e=>e.position>=n);if(-1===e)return{prev:i(t.data.keyframes.length-1)};let r=i(e);return r.kf.position===n?{prev:i(e-1),cur:r,next:i(e+1)}:{next:r,prev:i(e-1)}})();return kD.set(t.data,[n,a]),a}var kD,SD,ED,CD=k(()=>{xD(),kD=new WeakMap,SD={}}),PD=k(()=>{ED={}});function DD(e){let{pointerToProp:t,obj:n,possibleSequenceTrackIds:r,listOfDescendantTrackIds:i}=e;return Rh(()=>{let e=(0,ID.getPointerParts)(t).path,r=(0,ID.val)(n.sheet.getSequence().positionPrism),a=i.map(e=>({trackId:e,track:(0,ID.val)(n.template.project.pointers.historic.sheetsById[n.address.sheetId].sequence.tracksByObject[n.address.objectKey].trackData[e])})).filter(e=>{let{track:t}=e;return!!t}).map(e=>x(b({},e),{nearbies:wD(n,{id:e.trackId,data:e.track,sheetObject:n},r)})),o=a.find(e=>{let{nearbies:t}=e;return!!t.cur}),s=a.every(e=>{let{nearbies:t}=e;return!!t.cur}),l=a.reduce((e,t)=>t.nearbies.prev&&(void 0===e||t.nearbies.prev.kf.position>e.kf.position)?t.nearbies.prev:e,void 0),u=a.reduce((e,t)=>t.nearbies.next&&(void 0===e||t.nearbies.next.kf.position<e.kf.position)?t.nearbies.next:e,void 0),c=()=>{s?O().transaction(e=>{e.unset(t)}):O().transaction(e=>{e.set(t,(0,ID.val)(t))})},d={cur:o?{type:"on",itemKey:bD.forCompoundPropAggregateKeyframe(n,e,r),toggle:c}:{toggle:c,type:"off"},prev:void 0!==l?{position:l.kf.position,itemKey:bD.forCompoundPropAggregateKeyframe(n,e,l.kf.position),jump:()=>{n.sheet.getSequence().position=l.kf.position}}:void 0,next:void 0!==u?{position:u.kf.position,itemKey:bD.forCompoundPropAggregateKeyframe(n,e,u.kf.position),jump:()=>{n.sheet.getSequence().position=u.kf.position}}:void 0};return TD.default.createElement(tD,b({},d))},[t,n,r,i])}var ID,TD,AD=k(()=>{M(),wP(),Qh(),ID=n(194),Bo(),TD=P(Oh()),fD(),GC(),xD(),CP(),hD(),CD(),PD()});function zD(e){return[e.projectId,e.sheetId,e.objectKey,...e.pathToProp]}function OD(e){let t={};return ph(t,e,!0),t}var FD,MD,jD,BD,RD=k(()=>{FD=n(194),MD=n(194),jD=n(194),CP(),bh(),BD=function(){let e=0,t=new MD.Atom({hasLock:!1});return{replaceLock(n,r){let i=e++,a=t.get();return a.hasLock&&a.cleanup(),t.set({hasLock:!0,lockId:i,cleanup:r,deepPath:OD(zD(n))}),function(){let e=t.get();e.hasLock&&e.lockId===i&&(e.cleanup(),t.set({hasLock:!1}))}},getIsPropHighlightedD(e){let n=EP(t.pointer.deepPath,zD(e));return(0,jD.prism)(()=>{let e=(0,FD.val)(n);return!0===e?"self":e?"descendent":null})}}}()});var LD=k(()=>{});function ND(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{return"string"==typeof e?e:"function"==typeof e||e instanceof Error?e.toString():t?function(e,t){return JSON.stringify(e,t,2).replace(/^([\{\[])\n (\s+)/,"$1$2").replace(/(\n[ ]+[\{\[])\n\s+/g,"$1 ").replace(/\n\s*([\]\}])/g," $1")}(e):JSON.stringify(e)}catch(n){return(null==e?void 0:e.name)||String(e)}}var UD=k(()=>{LD()});function VD(e,t){let n=arguments.length>1,r=ND("function"==typeof e?e():e),i=n?"\nInstead found: ".concat(ND(t)):"";throw new KD("Invariant: ".concat(r).concat(i),t)}var qD,HD,WD,ZD,KD,GD=k(()=>{UD(),qD=/^\s*at.+node:internal.+/gm,HD=/^\s*(at|[^@]+@) (?:Object\.)?invariant.+/gm,WD=/^\s*(at|[^@]+@).+test\-helpers.+/gm,ZD=/^\s*(at|[^@]+@).+(debounce|invariant|iif)\.[tj]s.*/gm,KD=class extends Error{constructor(e,t){var n;super(e),D(this,"found"),void 0!==t&&(this.found=t),this.stack=null==(n=this.stack)?void 0:n.replace(HD,"").replace(ZD,"").replace(WD,"").replace(qD,"")}}});function XD(e){let t=YD.default.memo(YD.default.forwardRef(function(t,n){let r=[],i={},a={ref:n};for(let e in t){let n=t[e];(0,$D.isPrism)(n)?(r.push(n),i[e]=n):a[e]=n}let o=(0,YD.useRef)(r.length);!function(e,t,n){e||(arguments.length>2?VD(t,n):VD(t))}(o.current===r.length,"expect same number of observable props on every invocation of deriver wrapped component.",{initial:o.current,count:r.length});let s=(0,YD.useMemo)(()=>function(e){return(0,$D.prism)(()=>{if(Array.isArray(e)){let t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e[n].getValue();return t}{let t={};for(let n in e)t[n]=(0,$D.val)(e[n]);return t}})}(i),r),l=Lh(s);return l&&YD.default.createElement(e,b(b({},a),l))}));return t.displayName="deriver(".concat(e.displayName,")"),t}var $D,YD,JD=k(()=>{$D=n(194),Qh(),YD=P(Oh()),GD()});function QD(e,t,n){return(0,nI.prism)(()=>{var r;let i=(0,nI.getPointerParts)(e).path,a=t.getValueByPointer(e),o=nI.prism.memo("editPropValue",()=>{let t=null;return{temporarilySetValue(n){t||(t=O().scrub()),t.capture(t=>{t.set(e,n)})},discardTemporaryValue(){t&&(t.discard(),t=null)},permanentlySetValue(n){t?(t.capture(t=>{t.set(e,n)}),t.commit(),t=null):O().transaction(t=>{t.set(e,n)})}}},[]),s={createAsset:e=>t.sheet.project.assetStorage.createAsset(e),getAssetUrl:e=>e.id?t.sheet.project.assetStorage.getAssetUrl(e.id):void 0},l=!0===(0,nI.val)(jo(O().atomP.ephemeral.projects.stateByProjectId[t.address.projectId].stateBySheetId[t.address.sheetId].stateByObjectKey[t.address.objectKey].valuesBeingScrubbed,(0,nI.getPointerParts)(e).path)),u=[],c=x(b(b({},o),s),{value:a,beingScrubbed:l,contextMenuItems:u,controlIndicators:tI.default.createElement(tI.default.Fragment,null)}),d=function(e){return!OC(e)}(n);if(d){let n=xP((0,nI.val)(t.template.getMapOfValidSequenceTracks_forStudio()),i);if("string"==typeof n){u.push({label:"Make static",callback:()=>{O().transaction(n=>{let{stateEditors:r}=n,a=x(b({},t.address),{pathToProp:i});r.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(x(b({},a),{value:t.getValueByPointer(e)}))})}});let a,o=n,s=nI.prism.sub("lcr",()=>{let e=(0,nI.val)(t.template.project.pointers.historic.sheetsById[t.address.sheetId].sequence.tracksByObject[t.address.objectKey].trackData[o]),n=(0,nI.val)(t.sheet.getSequence().positionPrism);return wD(t,e&&{data:e,id:o,sheetObject:t},n)},[o]);a=c.beingScrubbed?"Sequenced_OnKeyframe_BeingScrubbed":s.cur?"Sequenced_OnKeyframe":!0===(null==(r=s.prev)?void 0:r.kf.connectedRight)?"Sequenced_BeingInterpolated":"Sequened_NotBeingInterpolated";let l=()=>{s.cur?O().transaction(t=>{t.unset(e)}):O().transaction(t=>{t.set(e,c.value)})},d={cur:s.cur?{type:"on",itemKey:s.cur.itemKey,toggle:l}:{type:"off",toggle:l},prev:void 0!==s.prev?{itemKey:s.prev.itemKey,position:s.prev.kf.position,jump:()=>{t.sheet.getSequence().position=s.prev.kf.position}}:void 0,next:void 0!==s.next?{itemKey:s.next.itemKey,position:s.next.kf.position,jump:()=>{t.sheet.getSequence().position=s.next.kf.position}}:void 0},h=tI.default.createElement(tD,b({},d));return x(b({},c),{type:"Sequenced",shade:a,nearbyKeyframes:s,controlIndicators:h})}}let h=xP((0,nI.val)(t.template.getStaticValues()),i);return"undefined"!=typeof h&&u.push({label:"Reset to default",callback:()=>{O().transaction(t=>{let{unset:n}=t;n(e)})}}),d&&u.push({label:"Sequence",callback:()=>{O().transaction(e=>{let{stateEditors:r}=e,a=x(b({},t.address),{pathToProp:i});r.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(a,n)})}}),x(b({},c),"undefined"!=typeof h?{type:"Static",shade:c.beingScrubbed?"Static_BeingScrubbed":"Static",controlIndicators:tI.default.createElement(cD,{hasStaticOverride:!0,obj:t,pathToProp:i,propConfig:n})}:{type:"Default",shade:"Default",controlIndicators:tI.default.createElement(cD,{hasStaticOverride:!0,obj:t,pathToProp:i,propConfig:n})})})}function eI(e,t,n){let r=function(e,t,n){if(rI.has(e))return rI.get(e);{let r=QD(e,t,n);return rI.set(e,r),r}}(e,t,n);return Lh(r)}var tI,nI,rI,iI=k(()=>{Bo(),tI=P(Oh()),nI=n(194),M(),wP(),Qh(),GC(),fD(),CD(),hD(),rI=new WeakMap});function aI(e){let{propConfig:t,pointerToProp:n,obj:r,SimpleEditorComponent:i}=e,a=eI(n,r,t);return lI.default.createElement(Bx,{editingTools:a,propConfig:t,value:a.value})}function oI(e){let{pointerToProp:t,obj:n,propConfig:r,visualIndentation:i}=e;var a;let o=null!=(a=r.label)?a:id((0,sI.getPointerParts)(t).path),s=Object.entries(r.props),l=s.filter(e=>{let[t,n]=e;return OC(n)}),u=s.filter(e=>{let[t,n]=e;return!OC(n)}),[c,d]=Qy(null),h=function(e,t,n){let r=(0,ID.getPointerParts)(e).path;return Rh(()=>{if(!BC(n))return{type:"AllStatic",beingScrubbed:!1,contextMenuItems:[],controlIndicators:TD.default.createElement(cD,{hasStaticOverride:!1,obj:t,pathToProp:r,propConfig:n})};let i=[],a={beingScrubbed:!!(0,ID.val)(jo(O().atomP.ephemeral.projects.stateByProjectId[t.address.projectId].stateBySheetId[t.address.sheetId].stateByObjectKey[t.address.objectKey].valuesBeingScrubbed,(0,ID.getPointerParts)(e).path)),contextMenuItems:i,controlIndicators:TD.default.createElement(TD.default.Fragment,null)},o=xP((0,ID.val)(t.template.getMapOfValidSequenceTracks_forStudio()),r),s=void 0!==o&&0!==Object.keys(o).length,l=[],u=(0,ID.val)(t.template.getStaticButNotSequencedOverrides()),c=void 0!==xP(null!=u?u:ED,r);if(s)for(let e of jC(n,[])){if(OC(e.conf))continue;let t=xP(o,e.path);"string"!=typeof t?c=!0:l.push(t)}if((c||s)&&i.push({label:"Reset all to default",callback:()=>{O().transaction(t=>{let{unset:n}=t;n(e)})}}),s&&i.push({label:"Make all static",callback:()=>{O().transaction(i=>{let{stateEditors:a}=i;for(let{path:o,conf:s}of jC(n,[])){if(OC(s))continue;let n=x(b({},t.address),{pathToProp:[...r,...o]}),i=EP(e,o);a.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsStatic(x(b({},n),{value:t.getValueByPointer(i)}))}})}}),(!s||s&&c)&&i.push({label:"Sequence all",callback:()=>{O().transaction(e=>{let{stateEditors:i}=e;for(let{path:a,conf:o}of jC(n,r)){if(OC(o))continue;let e=x(b({},t.address),{pathToProp:a});i.coreByProject.historic.sheetsById.sequence.setPrimitivePropAsSequenced(e,n)}})}}),s){let n=ID.prism.memo("controlIndicators",()=>TD.default.createElement(DD,{pointerToProp:e,obj:t,possibleSequenceTrackIds:o,listOfDescendantTrackIds:l}),[o,l]);return x(b({},a),{type:"HasSequences",controlIndicators:n})}return x(b({},a),{type:"AllStatic",controlIndicators:TD.default.createElement(cD,{hasStaticOverride:c,obj:t,pathToProp:r,propConfig:n})})},[])}(t,n,r),[f]=yP(d,{menuItems:h.contextMenuItems}),p=l.length>0,m=(0,lI.useMemo)(()=>BD.getIsPropHighlightedD(x(b({},n.address),{pathToProp:(0,sI.getPointerParts)(t).path})),[t]),g="".concat(n.address.projectId,",").concat(n.address.sheetId,",").concat(n.address.sheetInstanceId,",").concat(n.address.objectKey,",").concat((0,sI.getPointerParts)(t).path.join()),y=EI(r);(0,lI.useLayoutEffect)(()=>{II.has(g)||II.set(g,new sI.Atom(y))},[g,r]);let v=II.get(g),_=Rh(()=>v?(0,uI.val)(v.pointer):y,[v]);return lI.default.createElement(dI,null,f,lI.default.createElement(fI,{style:{"--depth":i-1}},lI.default.createElement(mI,{isVectorProp:y},lI.default.createElement(yI,null,h.controlIndicators),lI.default.createElement(_I,{isHighlighted:m,ref:c},lI.default.createElement("span",null,o||"Props")),lI.default.createElement(xI,{isCollapsed:_,isVector:y,onClick:()=>{null==v||v.set(!v.get())}},lI.default.createElement(Cw,null))),y&&_&&lI.default.createElement(PI,null,[...s].map(e=>{let[r,i]=e;return lI.default.createElement(aI,{key:"prop-"+r,propConfig:i,pointerToProp:t[r],obj:n})}))),!_&&lI.default.createElement(SI,{style:{"--depth":i},depth:i,lastSubIsComposite:p},[...u,...l].map(e=>{let[r,a]=e;return lI.default.createElement(JI,{key:"prop-"+r,propConfig:a,pointerToProp:t[r],obj:n,visualIndentation:i+1})})))}var sI,lI,uI,cI,dI,hI,fI,pI,mI,gI,yI,vI,_I,bI,xI,wI,kI,SI,EI,CI,PI,DI,II,TI=k(()=>{GC(),sI=n(194),ad(),Ym(),lI=P(Oh()),Zp(),XC(),$C(),Cv(),tv(),eT(),bP(),AD(),RD(),JD(),Rx(),iI(),Qh(),uI=n(194),Mw(),zC(),dI=Wp.div(cI||(cI=I(["\n  --step: 15px;\n  --left-pad: 15px;\n  ",";\n  --right-width: 60%;\n"])),av),fI=Wp.div(hI||(hI=I(["\n  height: 30px;\n  display: flex;\n  align-items: stretch;\n  position: relative;\n"]))),mI=Wp.div(pI||(pI=I(["\n  padding-left: ",";\n  display: flex;\n  align-items: center;\n  overflow: hidden;\n  ",";\n"])),RC,e=>{let{isVectorProp:t}=e;return t?"width: calc(100% - var(--right-width))":""}),yI=Wp.div(gI||(gI=I(["\n  flexshrink: 0;\n"]))),_I=XD(Wp.div(vI||(vI=I(["\n  margin-left: 4px;\n  cursor: default;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  user-select: none;\n  &:hover {\n    color: white;\n  }\n  overflow: hidden;\n\n  ",";\n"])),()=>NC)),xI=Wp.span(bI||(bI=I(["\n  width: 28px;\n  height: 28px;\n  font-size: 9px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n\n  transition: transform 0.05s ease-out, color 0.1s ease-out;\n  transform: rotateZ(","deg);\n  color: #66686a;\n\n  visibility: ",";\n\n  ",":hover & {\n    visibility: visible;\n  }\n\n  &:hover {\n    transform: rotateZ(","deg);\n    color: #c0c4c9;\n  }\n"])),e=>e.isCollapsed?0:90,e=>!e.isVector&&e.isCollapsed||e.isVector&&!e.isCollapsed?"visible":"hidden",fI,e=>e.isCollapsed?15:75),wI=Xm(.05,"#282b2f"),SI=Wp.div(kI||(kI=I(["\n  /* background: ","; */\n  /* padding: "," 0; */\n"])),e=>{let{depth:t}=e;return Zm(.03*t,wI)},e=>e.lastSubIsComposite?0:"4px"),EI=AC(e=>{let t=Object.entries(e.props);return t.length<=3&&t.every(e=>{let[t,n]=e;return"number"===n.type&&["x","y","z"].includes(t)})}),PI=Wp.div(CI||(CI=I(["\n  display: flex;\n  align-items: center;\n  justify-content: stretch;\n  padding: 0 8px 0 2px;\n  box-sizing: border-box;\n  height: 100%;\n  width: var(--right-width);\n  flex-shrink: 0;\n  flex-grow: 0;\n"]))),DI=lI.default.memo(oI),II=new Map});function AI(e){let{isHighlighted:t}=e;return"self"===t?"#1857a4":"descendent"===t?"#0a2f5c":"initial"}var zI=k(()=>{});function OI(e){let{propConfig:t,pointerToProp:n,editingTools:r,children:i,isPropHighlightedD:a}=e;var o;let s=null!=(o=t.label)?o:id((0,FI.getPointerParts)(n).path),[l,u]=Qy(null),[c]=yP(u,{menuItems:r.contextMenuItems});return MI.default.createElement(BI,{isHighlighted:a},c,MI.default.createElement(LI,null,MI.default.createElement(qI,null,r.controlIndicators),MI.default.createElement(UI,{isHighlighted:a,ref:l,title:["obj","props",...(0,FI.getPointerParts)(n).path].join(".")},s)),MI.default.createElement(WI,null,i))}var FI,MI,jI,BI,RI,LI,NI,UI,VI,qI,HI,WI,ZI=k(()=>{FI=n(194),bP(),tv(),Th(),MI=P(Oh()),Zp(),Cv(),$C(),JD(),XC(),zI(),BI=XD(Wp.div(jI||(jI=I(["\n  display: flex;\n  height: 30px;\n  justify-content: flex-start;\n  align-items: stretch;\n  // We cannot calculate both the container (details panel) width and the descendant\n  // (this) width dynamically. This leads to the container width being calculated\n  // without this percentage being taken into consideration leads to horizontal\n  // clipping/scrolling--the same way as if we explicitly fixed either the container\n  // width, or the descendant width.\n  // The correct solution for tabulated UIs with dynamic container widths is to use\n  // CSS grid. For now I fixed this issue by just giving a great enough width\n  // to the details panel so most things don't break.\n  --right-width: 60%;\n  position: relative;\n  ",";\n\n  /* background-color: ","; */\n"])),av,AI)),LI=Wp.div(RI||(RI=I(["\n  box-sizing: border-box;\n  padding-left: ",";\n  padding-right: 4px;\n  display: flex;\n  flex-direction: row;\n  justify-content: flex-start;\n  align-items: stretch;\n  gap: 4px;\n  flex-grow: 0;\n  flex-shrink: 0;\n  width: calc(100% - var(--right-width));\n"])),RC),UI=XD(Wp.div(NI||(NI=I(["\n  text-align: left;\n  flex: 1 0;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex;\n  align-items: center;\n  user-select: none;\n  cursor: default;\n\n  ",";\n  &:hover {\n    color: white;\n  }\n"])),NC)),qI=Wp.div(VI||(VI=I(["\n  flex-basis: 8px;\n  flex: 0 0;\n  display: flex;\n  align-items: center;\n"]))),WI=Wp.div(HI||(HI=I(["\n  display: flex;\n  align-items: center;\n  justify-content: stretch;\n  padding: 0 8px 0 2px;\n  box-sizing: border-box;\n  height: 100%;\n  width: var(--right-width);\n  flex-shrink: 0;\n  flex-grow: 0;\n"])))});function KI(e){let{propConfig:t,pointerToProp:n,obj:r,SimpleEditorComponent:i}=e,a=eI(n,r,t),o=(0,GI.useMemo)(()=>BD.getIsPropHighlightedD(x(b({},r.address),{pathToProp:(0,XI.getPointerParts)(n).path})),[n]);return GI.default.createElement(OI,{editingTools:a,propConfig:t,pointerToProp:n,isPropHighlightedD:o},GI.default.createElement(i,{editingTools:a,propConfig:t,value:a.value}))}var GI,XI,$I,YI,JI,QI=k(()=>{GI=P(Oh()),iI(),ZI(),XI=n(194),RD(),$I=GI.default.memo(KI)}),eT=k(()=>{YI=P(Oh()),TC(),TI(),QI(),JI=e=>{let{propConfig:t,visualIndentation:n,pointerToProp:r,obj:i}=e;if("compound"===t.type)return YI.default.createElement(DI,{obj:i,visualIndentation:n,pointerToProp:r,propConfig:t});if("enum"===t.type)return YI.default.createElement(YI.default.Fragment,null);{let e=DC[t.type];return YI.default.createElement($I,{SimpleEditorComponent:e,obj:i,visualIndentation:n,pointerToProp:r,propConfig:t})}}});function tT(e){return nT.has(e)||nT.set(e,(rT++).toString()),nT.get(e)}var nT,rT,iT,aT,oT,sT,lT,uT,cT,dT,hT,fT,pT=k(()=>{nT=new WeakMap,rT=0}),mT=k(()=>{iT=P(Oh()),eT(),Qh(),pT(),Zp(),oT=Wp.div(aT||(aT=I(["\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  padding: 8px;\n"]))),lT=Wp.button(sT||(sT=I(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  outline: none;\n  border-radius: 2px;\n\n  color: #a8a8a9;\n  background: rgba(255, 255, 255, 0.1);\n\n  border: none;\n  height: 28px;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.15);\n  }\n\n  &:active {\n    background: rgba(255, 255, 255, 0.2);\n  }\n"]))),uT=e=>{let{objects:t}=e,n=t[0],r=Wh(n.template.configPointer),i=Wh(n.template._temp_actionsPointer);return iT.default.createElement(iT.default.Fragment,null,iT.default.createElement(JI,{key:tT(n),obj:n,pointerToProp:n.propsP,propConfig:r,visualIndentation:1}),iT.default.createElement(oT,null,i&&Object.entries(i).map(e=>{let[t,r]=e;return iT.default.createElement(lT,{key:t,onClick:()=>{r(n.publicApi)}},t)})))}}),gT=k(()=>{Zp(),dT=Wp.button(cT||(cT=I(["\n  text-align: center;\n  padding: 8px;\n  border-radius: 2px;\n  border: 1px solid #627b7b87;\n  background-color: #4b787d3d;\n  color: #eaeaea;\n  font-weight: 400;\n  display: block;\n  appearance: none;\n  flex-grow: 1;\n  cursor: ",";\n  opacity: ",";\n\n  &:hover {\n    background-color: #7dc1c878;\n    border-color: #9ebcbf;\n  }\n"])),e=>e.disabled?"none":"pointer",e=>e.disabled?.4:1),hT=dT}),yT=k(()=>{}),vT=k(()=>{yT(),fT=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:21,t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t}});function _T(){return fT(16)}var bT,xT,wT,kT,ST,ET,CT=k(()=>{vT()}),PT=k(()=>{bT=n(194),tv(),xT=P(Oh()),wT=(0,xT.createContext)(null),kT=0,ST=()=>{let e=(0,xT.useMemo)(()=>kT++,[]),{cur:t,set:n}=(0,xT.useContext)(wT),[r,i]=Qy(!1),a=(0,xT.useCallback)((t,r)=>{n(t?e:-1,r)},[]);return(0,xT.useEffect)(()=>t.onStale(()=>{let n=t.getValue()===e;r.current!==n&&(r.current=n)}),[t,e]),[i,a]},ET=e=>{let{children:t}=e,n=(0,xT.useMemo)(()=>new bT.Atom(-1),[]),r=n.prism,i=(0,xT.useMemo)(()=>{let e;return(t,r)=>{let i=void 0!==e;void 0!==e&&(clearTimeout(e),e=void 0),0===r||i?n.set(t):e=setTimeout(()=>{n.set(t),e=void 0},r)}},[]);return xT.default.createElement(wT.Provider,{value:{cur:r,set:i}},t)}});function DT(e,t){let n=!1!==e.enabled,[r,i]=ST(),[a,o]=Qy(null);(0,TT.useEffect)(()=>{if(!n)return;let t=a.current;if(!t)return;let r=()=>{var t;return i(!0,null!=(t=e.enterDelay)?t:400)},o=()=>{var t;return i(!1,null!=(t=e.exitDelay)?t:200)};return t.addEventListener("mouseenter",r),t.addEventListener("mouseleave",o),()=>{t.removeEventListener("mouseenter",r),t.removeEventListener("mouseleave",o)}},[a,n,e.enterDelay,e.exitDelay]);let s=(0,IT.useContext)(Gy);return[n&&r&&o?(0,zT.createPortal)(AT.default.createElement(sE,{children:t,target:o,onClickOutside:Ev,verticalPlacement:e.verticalPlacement,verticalGap:e.verticalGap}),s):AT.default.createElement(AT.default.Fragment,null),a,r]}var IT,TT,AT,zT,OT,FT,MT,jT,BT,RT,LT,NT,UT,VT,qT,HT,WT,ZT,KT,GT,XT,$T,YT,JT,QT,eA,tA,nA,rA,iA,aA,oA,sA,lA,uA,cA,dA,hA,fA=k(()=>{tv(),IT=P(Oh()),TT=P(Oh()),AT=P(Oh()),uE(),zT=P(Bh()),PT(),Jy(),Dv()}),pA=k(()=>{Zp(),ME(),FT=Wp(zE)(OT||(OT=I(["\n  padding: 1em;\n  max-width: 240px;\n  pointer-events: none !important;\n  --popover-outer-stroke: transparent;\n  --popover-inner-stroke: #45464d;\n"]))),MT=FT}),mA=k(()=>{Qh(),M(),jT=P(Oh()),Zp(),CT(),fA(),pA(),gT(),RT=Wp.div(BT||(BT=I(["\n  padding: 8px 10px;\n  position: relative;\n  background-color: #6d232352;\n  &:before {\n    position: absolute;\n    content: ' ';\n    display: block;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    width: 2px;\n    background-color: #ff000070;\n  }\n"]))),NT=Wp.div(LT||(LT=I(["\n  margin-bottom: 1em;\n  & a {\n    color: inherit;\n  }\n"]))),VT=Wp.div(UT||(UT=I(["\n  display: flex;\n  gap: 8px;\n"]))),qT=e=>{let{projectId:t}=e,n=Wh(O().atomP.ephemeral.coreByProject[t].loadingState);return n&&"browserStateIsNotBasedOnDiskState"===n.type?jT.default.createElement(HT,{loadingState:n,projectId:t}):null},HT=e=>{let{projectId:t,loadingState:n}=e,[r,i]=DT({},()=>jT.default.createElement(MT,null,"The browser's state will override the disk state.")),[a,o]=DT({},()=>jT.default.createElement(MT,null,"The disk's state will override the browser's state."));return jT.default.createElement(RT,null,jT.default.createElement(NT,null,"Browser state is not based on disk state."," ",jT.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Learn more.")),jT.default.createElement(VT,null,r,jT.default.createElement(hT,{onClick:()=>{O().transaction(e=>{let{drafts:r,stateEditors:i}=e;i.coreByProject.historic.revisionHistory.add({projectId:t,revision:n.onDiskState.revisionHistory[0]}),i.coreByProject.historic.revisionHistory.add({projectId:t,revision:_T()}),r.ephemeral.coreByProject[t].loadingState={type:"loaded"}})},ref:i},"Use browser's state"),a,jT.default.createElement(hT,{onClick:()=>{O().transaction(e=>{let{drafts:r}=e;r.historic.coreByProject[t]=n.onDiskState,r.ephemeral.coreByProject[t].loadingState={type:"loaded"}})},ref:o},"Use disk state")))},WT=qT}),gA=S((o,s)=>{var l;l=function(){return function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return i(t[o][1][e]||e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var a=void 0,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){var r=e("./utils"),i=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,i,o,s,l,u,c=[],d=0,h=e.length,f=h,p="string"!==r.getTypeOf(e);d<e.length;)f=h-d,i=p?(t=e[d++],n=d<h?e[d++]:0,d<h?e[d++]:0):(t=e.charCodeAt(d++),n=d<h?e.charCodeAt(d++):0,d<h?e.charCodeAt(d++):0),o=t>>2,s=(3&t)<<4|n>>4,l=1<f?(15&n)<<2|i>>6:64,u=2<f?63&i:64,c.push(a.charAt(o)+a.charAt(s)+a.charAt(l)+a.charAt(u));return c.join("")},n.decode=function(e){var t,n,r,o,s,l,u=0,c=0,d="data:";if(e.substr(0,5)===d)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|f):new Array(0|f);u<e.length;)t=a.indexOf(e.charAt(u++))<<2|(o=a.indexOf(e.charAt(u++)))>>4,n=(15&o)<<4|(s=a.indexOf(e.charAt(u++)))>>2,r=(3&s)<<6|(l=a.indexOf(e.charAt(u++))),h[c++]=t,64!==s&&(h[c++]=n),64!==l&&(h[c++]=r);return h}},{"./support":30,"./utils":32}],2:[function(e,t,n){var r=e("./external"),i=e("./stream/DataWorker"),a=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var r=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new r("STORE compression")},uncompressWorker:function(){return new r("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var r=e("./utils"),i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==r.getTypeOf(e)?function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}(0|t,e,e.length):function(e,t,n){var r=i,a=0+n;e^=-1;for(var o=0;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var r;r="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),a=e("./utils"),o=e("./stream/GenericWorker"),s=r?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}n.magic="\b\0",a.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new l("Deflate",e)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){function r(e,t){var n,r="";for(n=0;n<t;n++)r+=String.fromCharCode(255&e),e>>>=8;return r}function i(e,t,n,i,o,c){var d,h,f=e.file,p=e.compression,m=c!==s.utf8encode,g=a.transformTo("string",c(f.name)),y=a.transformTo("string",s.utf8encode(f.name)),v=f.comment,_=a.transformTo("string",c(v)),b=a.transformTo("string",s.utf8encode(v)),x=y.length!==f.name.length,w=b.length!==v.length,k="",S="",E="",C=f.dir,P=f.date,D={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(D.crc32=e.crc32,D.compressedSize=e.compressedSize,D.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),m||!x&&!w||(I|=2048);var T=0,A=0;C&&(T|=16),"UNIX"===o?(A=798,T|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,C)):(A=20,T|=63&(f.dosPermissions||0)),d=P.getUTCHours(),d<<=6,d|=P.getUTCMinutes(),d<<=5,d|=P.getUTCSeconds()/2,h=P.getUTCFullYear()-1980,h<<=4,h|=P.getUTCMonth()+1,h<<=5,h|=P.getUTCDate(),x&&(S=r(1,1)+r(l(g),4)+y,k+="up"+r(S.length,2)+S),w&&(E=r(1,1)+r(l(_),4)+b,k+="uc"+r(E.length,2)+E);var z="";return z+="\n\0",z+=r(I,2),z+=p.magic,z+=r(d,2),z+=r(h,2),z+=r(D.crc32,4),z+=r(D.compressedSize,4),z+=r(D.uncompressedSize,4),z+=r(g.length,2),z+=r(k.length,2),{fileRecord:u.LOCAL_FILE_HEADER+z+g+k,dirRecord:u.CENTRAL_FILE_HEADER+r(A,2)+z+r(_.length,2)+"\0\0\0\0"+r(T,4)+r(i,4)+g+k+_}}var a=e("../utils"),o=e("../stream/GenericWorker"),s=e("../utf8"),l=e("../crc32"),u=e("../signature");function c(e,t,n,r){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(c,o),c.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},c.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=i(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(e){this.accumulate=!1;var t,n=this.streamFiles&&!e.file.dir,a=i(e,n,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(a.dirRecord),n)this.push({data:(t=e,u.DATA_DESCRIPTOR+r(t.crc32,4)+r(t.compressedSize,4)+r(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:a.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,i=function(e,t,n,i,o){var s=a.transformTo("string",o(i));return u.CENTRAL_DIRECTORY_END+"\0\0\0\0"+r(e,2)+r(e,2)+r(t,4)+r(n,4)+r(s.length,2)+s}(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(r){}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var r=e("../compressions"),i=e("./ZipFileWorker");n.generateWorker=function(e,t,n){var a=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=function(e,t){var n=e||t,i=r[n];if(!i)throw new Error(n+" is not a valid compression method !");return i}(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},l=n.dir,u=n.date;n._compressWorker(i,s).withStreamInfo("file",{name:e,dir:l,date:u,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(a)}),a.entriesCount=o}catch(s){a.error(s)}return a}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(r.prototype=e("./object")).loadAsync=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.version="3.10.1",r.loadAsync=function(e,t){return(new r).loadAsync(e,t)},r.external=e("./external"),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var r=e("./utils"),i=e("./external"),a=e("./utf8"),o=e("./zipEntries"),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function u(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){n(e)}).on("end",function(){r.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(u(r[a]));return i.Promise.all(n)}).then(function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],l=s.fileNameStr,u=r.resolve(s.fileNameStr);n.file(u,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(u).unsafeOriginalName=l)}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var r=e("../utils"),i=e("../stream/GenericWorker");function a(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var r=e("readable-stream").Readable;function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){function r(e,t,n){var r,i=a.getTypeOf(t),s=a.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=m(e)),s.createFolders&&(r=p(e))&&g.call(this,r,!0);var d,y="string"===i&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!y),(t instanceof u&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string"),d=t instanceof u||t instanceof o?t:h.isNode&&h.isStream(t)?new f(e,t):a.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var v=new c(e,d,s);this.files[e]=v}var i=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),u=e("./compressedObject"),c=e("./zipObject"),d=e("./generate"),h=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||r.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(1!==arguments.length)return e=this.root+e,r.call(this,e,t,n),this;if(y(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(e){if(!e)return this;if(y(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var r=n.comment||this.comment||"";t=d.generateWorker(this,n,r)}catch(l){(t=new o("error")).error(l)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){var r=e("./DataReader");function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;0<=a;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var r=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){var r=e("./Uint8ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var r=e("./DataReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var r=e("./ArrayReader");function i(e){r.call(this,e)}e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var r=e("../utils"),i=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new s(e):i.uint8array?new l(r.transformTo("uint8array",e)):new a(r.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){var r=e("./GenericWorker"),i=e("../utils");function a(e){r.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var r=e("./GenericWorker"),i=e("../crc32");function a(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(a,r),a.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var r=e("../utils"),i=e("./GenericWorker");function a(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(a,i),a.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function r(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=r},{}],29:[function(e,t,n){var r=e("../utils"),i=e("./ConvertWorker"),a=e("./GenericWorker"),o=e("../base64"),s=e("../support"),l=e("../external"),u=null;if(s.nodestream)try{u=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}function c(e,t,n){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(s){this._worker=new a("error"),this._worker.error(s)}}c.prototype={accumulate:function(e){return function(e,t){return new l.Promise(function(n,i){var a=[],s=e._internalType,l=e._outputType,u=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],i(e)}).on("end",function(){try{var e=function(e,t,n){switch(e){case"blob":return r.newBlob(r.transformTo("arraybuffer",t),n);case"base64":return o.encode(t);default:return r.transformTo(e,t)}}(l,function(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(s,a),u);n(e)}catch(t){i(t)}a=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return"data"===e?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new u(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=c},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=0===new Blob([r],{type:"application/zip"}).size}catch(a){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=0===i.getBlob("application/zip").size}catch(o){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(a){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var r=e("./utils"),i=e("./support"),a=e("./nodejsUtils"),o=e("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function u(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,"utf-8"):function(e){var t,n,r,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(r=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(r-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t}(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,a,o=e.length,l=new Array(2*o);for(t=n=0;t<o;)if((i=e[t++])<128)l[n++]=i;else if(4<(a=s[i]))l[n++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<o;)i=i<<6|63&e[t++],a--;1<a?l[n++]=65533:i<65536?l[n++]=i:(i-=65536,l[n++]=55296|i>>10&1023,l[n++]=56320|1023&i)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),r.applyFromCharCode(l)}(e=r.transformTo(i.uint8array?"uint8array":"array",e))},r.inherits(u,o),u.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;(t=new Uint8Array(a.length+this.leftOver.length)).set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}(t),l=t;o!==t.length&&(i.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(l),meta:e.meta})},u.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=u,r.inherits(c,o),c.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var r=e("./support"),i=e("./base64"),a=e("./nodejsUtils"),o=e("./external");function s(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}e("setimmediate"),n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(a){throw new Error("Bug : can't construct the Blob.")}}};var u={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)"array"===t||"nodebuffer"===t?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return r.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return r.nodebuffer&&1===String.fromCharCode.apply(null,a.allocBuffer(1)).length}catch(e){return!1}}()}};function c(e){var t=65536,r=n.getTypeOf(e),i=!0;if("uint8array"===r?i=u.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=u.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return u.stringifyByChunk(e,r,t)}catch(a){t=Math.floor(t/2)}return u.stringifyByChar(e)}function d(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}n.applyFromCharCode=c;var h={};h.string={string:s,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},h.array={string:c,array:s,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},h.arraybuffer={string:function(e){return c(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:s,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:s,nodebuffer:function(e){return a.newBufferFrom(e)}},h.nodebuffer={string:c,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:s},n.transformTo=function(e,t){if(t=t||"",!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return h[r][e](t)},n.resolve=function(e){for(var t=e.split("/"),n=[],r=0;r<t.length;r++){var i=t[r];"."===i||""===i&&0!==r&&r!==t.length-1||(".."===i?n.pop():n.push(i))}return n.join("/")},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":r.nodebuffer&&a.isBuffer(e)?"nodebuffer":r.uint8array&&e instanceof Uint8Array?"uint8array":r.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,r="";for(n=0;n<(e||"").length;n++)r+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return r},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,a,s,u){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var c,d=n.getTypeOf(t);return d?("arraybuffer"===d?t=n.transformTo("uint8array",t):"string"===d&&(u?t=i.decode(t):a&&!0!==s&&(t=l(c=t,r.uint8array?new Uint8Array(c.length):new Array(c.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var r=e("./reader/readerFor"),i=e("./utils"),a=e("./signature"),o=e("./zipEntry"),s=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?"uint8array":"array",n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,r=this.zip64EndOfCentralSize-44;0<r;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(0<r)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw new Error("Corrupted zip: missing "+Math.abs(r)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var r=e("./reader/readerFor"),i=e("./utils"),a=e("./compressedObject"),o=e("./crc32"),s=e("./utf8"),l=e("./compressions"),u=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,n,r,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),n=e.readInt(2),r=e.readData(n),this.extraFields[t]={id:t,length:n,value:r};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(null!==r)this.fileCommentStr=r;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){function r(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var i=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),o=e("./utf8"),s=e("./compressedObject"),l=e("./stream/GenericWorker");r.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!r&&(t=t.pipe(new o.Utf8EncodeWorker)),!a&&r&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(s){(t=new l("error")).error(s)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof s&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new o.Utf8EncodeWorker)),s.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new a(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<u.length;d++)r.prototype[u[d]]=c;t.exports=r},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,r){(function(e){var n,r,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,o=new i(c),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),n=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)n="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,n=function(){l.port2.postMessage(0)}}var u=[];function c(){var e,t;r=!0;for(var n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}r=!1}t.exports=function(e){1!==u.push(e)||r||n()}}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,n){var r=e("immediate");function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&f(this,e)}function c(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function d(e,t,n){r(function(){var r;try{r=t(n)}catch(i){return a.reject(e,i)}r===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,r)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}var o=p(function(){t(i,r)});"error"===o.status&&r(o.value)}function p(e,t){var n={};try{n.value=e(t),n.status="success"}catch(r){n.status="error",n.value=r}return n}(t.exports=u).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var n=new this.constructor(i);return this.state!==l?d(n,this.state===s?e:t,this.outcome):this.queue.push(new c(n,e,t)),n},c.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){a.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},a.resolve=function(e,t){var n=p(h,t);if("error"===n.status)return a.reject(e,n.value);var r=n.value;if(r)f(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return a.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=new Array(n),s=0,l=-1,u=new this(i);++l<n;)c(e[l],l);return u;function c(e,i){t.resolve(e).then(function(e){o[i]=e,++s!==n||r||(r=!0,a.resolve(u,o))},function(e){r||(r=!0,a.reject(u,e))})}},u.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t,n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=-1,s=new this(i);++o<n;)t=e[o],this.resolve(t).then(function(e){r||(r=!0,a.resolve(s,e))},function(e){r||(r=!0,a.reject(s,e))});return s}},{immediate:36}],38:[function(e,t,n){var r={};(0,e("./lib/utils/common").assign)(r,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=r},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var r=e("./zlib/deflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=i.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==n)throw new Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?a.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(n=r.deflateSetDictionary(this.strm,c)))throw new Error(o[n]);this._dict_set=!0}}function c(e,t){var n=new u(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}u.prototype.push=function(e,t){var n,o,s=this.strm,u=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?s.input=a.string2buf(e):"[object ArrayBuffer]"===l.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new i.Buf8(u),s.next_out=0,s.avail_out=u),1!==(n=r.deflate(s,o))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(a.buf2binstring(i.shrinkBuf(s.output,s.next_out))):this.onData(i.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===o?(n=r.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==o||(this.onEnd(0),!(s.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=u,n.deflate=c,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var r=e("./zlib/inflate"),i=e("./utils/common"),a=e("./utils/strings"),o=e("./zlib/constants"),s=e("./zlib/messages"),l=e("./zlib/zstream"),u=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw new Error(s[n]);this.header=new u,r.inflateGetHeader(this.strm,this.header)}function h(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}d.prototype.push=function(e,t){var n,s,l,u,d,h,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,g=!1;if(this.ended)return!1;s=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=a.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new i.Buf8(p),f.next_out=0,f.avail_out=p),(n=r.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(h="string"==typeof m?a.string2buf(m):"[object ArrayBuffer]"===c.call(m)?new Uint8Array(m):m,n=r.inflateSetDictionary(this.strm,h)),n===o.Z_BUF_ERROR&&!0===g&&(n=o.Z_OK,g=!1),n!==o.Z_STREAM_END&&n!==o.Z_OK)return this.onEnd(n),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&n!==o.Z_STREAM_END&&(0!==f.avail_in||s!==o.Z_FINISH&&s!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=a.utf8border(f.output,f.next_out),u=f.next_out-l,d=a.buf2string(f.output,l),f.next_out=u,f.avail_out=p-u,u&&i.arraySet(f.output,f.output,l,u,0),this.onData(d)):this.onData(i.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&n!==o.Z_STREAM_END);return n===o.Z_STREAM_END&&(s=o.Z_FINISH),s===o.Z_FINISH?(n=r.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===o.Z_OK):s!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=d,n.inflate=h,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+r),i);else for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r,i,a,o;for(t=r=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),t=i=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){var r=e("./common"),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(u){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(u){a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),a=o=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:(n<2048?t[o++]=192|n>>>6:(n<65536?t[o++]=224|n>>>12:(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63),t[o++]=128|n>>>6&63),t[o++]=128|63&n);return t},n.buf2binstring=function(e){return l(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,u=new Array(2*s);for(n=r=0;n<s;)if((i=e[n++])<128)u[r++]=i;else if(4<(a=o[i]))u[r++]=65533,n+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&n<s;)i=i<<6|63&e[n++],a--;1<a?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return l(u,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;0<=n&&128==(192&e[n]);)n--;return n<0||0===n?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){t.exports=function(e,t,n,r){for(var i=65535&e,a=e>>>16&65535,o=0;0!==n;){for(n-=o=2e3<n?2e3:n;a=a+(i=i+t[r++]|0)|0,--o;);i%=65521,a%=65521}return i|a<<16}},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){var r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,i){var a=r,o=i+n;e^=-1;for(var s=i;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],46:[function(e,t,n){var r,i=e("../utils/common"),a=e("./trees"),o=e("./adler32"),s=e("./crc32"),l=e("./messages"),u=-2,c=258,d=262,h=113;function f(e,t){return e.msg=l[t],t}function p(e){return(e<<1)-(4<e?9:0)}function m(e){for(var t=e.length;0<=--t;)e[t]=0}function g(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(i.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function y(e,t){a._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,g(e.strm)}function v(e,t){e.pending_buf[e.pending++]=t}function _(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function b(e,t){var n,r,i=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,u=e.window,h=e.w_mask,f=e.prev,p=e.strstart+c,m=u[a+o-1],g=u[a+o];e.prev_length>=e.good_match&&(i>>=2),s>e.lookahead&&(s=e.lookahead);do{if(u[(n=t)+o]===g&&u[n+o-1]===m&&u[n]===u[a]&&u[++n]===u[a+1]){a+=2,n++;do{}while(u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&u[++a]===u[++n]&&a<p);if(r=c-(p-a),a=p-c,o<r){if(e.match_start=t,s<=(o=r))break;m=u[a+o-1],g=u[a+o]}}}while((t=f[t&h])>l&&0!=--i);return o<=e.lookahead?o:e.lookahead}function x(e){var t,n,r,a,l,u,c,h,f,p,m=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-d)){for(i.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=n=e.hash_size;r=e.head[--t],e.head[t]=m<=r?r-m:0,--n;);for(t=n=m;r=e.prev[--t],e.prev[t]=m<=r?r-m:0,--n;);a+=m}if(0===e.strm.avail_in)break;if(u=e.strm,c=e.window,h=e.strstart+e.lookahead,p=void 0,(f=a)<(p=u.avail_in)&&(p=f),n=0===p?0:(u.avail_in-=p,i.arraySet(c,u.input,u.next_in,p,h),1===u.state.wrap?u.adler=o(u.adler,c,p,h):2===u.state.wrap&&(u.adler=s(u.adler,c,p,h)),u.next_in+=p,u.total_in+=p,p),e.lookahead+=n,e.lookahead+e.insert>=3)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+3-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function w(e,t){for(var n,r;;){if(e.lookahead<d){if(x(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-d&&(e.match_length=b(e,n)),e.match_length>=3)if(r=a._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function k(e,t){for(var n,r,i;;){if(e.lookahead<d){if(x(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-d&&(e.match_length=b(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&4096<e.strstart-e.match_start)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-3,r=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(y(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((r=a._tr_tally(e,0,e.window[e.strstart-1]))&&y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}function S(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}function E(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(1146),this.dyn_dtree=new i.Buf16(122),this.bl_tree=new i.Buf16(78),m(this.dyn_ltree),m(this.dyn_dtree),m(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(16),this.heap=new i.Buf16(573),m(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(573),m(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:h,e.adler=2===t.wrap?0:1,t.last_flush=0,a._tr_init(t),0):f(e,u)}function P(e){var t,n=C(e);return 0===n&&((t=e.state).window_size=2*t.w_size,m(t.head),t.max_lazy_match=r[t.level].max_lazy,t.good_match=r[t.level].good_length,t.nice_match=r[t.level].nice_length,t.max_chain_length=r[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}function D(e,t,n,r,a,o){if(!e)return u;var s=1;if(-1===t&&(t=6),r<0?(s=0,r=-r):15<r&&(s=2,r-=16),a<1||9<a||8!==n||r<8||15<r||t<0||9<t||o<0||4<o)return f(e,u);8===r&&(r=9);var l=new E;return(e.state=l).strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new i.Buf8(2*l.w_size),l.head=new i.Buf16(l.hash_size),l.prev=new i.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new i.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,P(e)}r=[new S(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(x(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((0===e.strstart||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,y(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-d&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(y(e,!1),e.strm.avail_out),1)}),new S(4,4,8,4,w),new S(4,5,16,8,w),new S(4,6,32,32,w),new S(4,4,16,16,k),new S(8,16,32,32,k),new S(8,16,128,128,k),new S(8,32,128,256,k),new S(32,128,258,1024,k),new S(32,258,258,4096,k)],n.deflateInit=function(e,t){return D(e,t,8,15,8,0)},n.deflateInit2=D,n.deflateReset=P,n.deflateResetKeep=C,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,0):u},n.deflate=function(e,t){var n,i,o,l;if(!e||!e.state||5<t||t<0)return e?f(e,u):u;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&4!==t)return f(e,0===e.avail_out?-5:u);if(i.strm=e,n=i.last_flush,i.last_flush=t,42===i.status)if(2===i.wrap)e.adler=0,v(i,31),v(i,139),v(i,8),i.gzhead?(v(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),v(i,255&i.gzhead.time),v(i,i.gzhead.time>>8&255),v(i,i.gzhead.time>>16&255),v(i,i.gzhead.time>>24&255),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(v(i,255&i.gzhead.extra.length),v(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=s(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(v(i,0),v(i,0),v(i,0),v(i,0),v(i,0),v(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),v(i,3),i.status=h);else{var d=8+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=h,_(i,d),0!==i.strstart&&(_(i,e.adler>>>16),_(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending!==i.pending_buf_size));)v(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,v(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),g(e),o=i.pending,i.pending===i.pending_buf_size)){l=1;break}l=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,v(i,l)}while(0!==l);i.gzhead.hcrc&&i.pending>o&&(e.adler=s(e.adler,i.pending_buf,i.pending-o,o)),0===l&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&g(e),i.pending+2<=i.pending_buf_size&&(v(i,255&e.adler),v(i,e.adler>>8&255),e.adler=0,i.status=h)):i.status=h),0!==i.pending){if(g(e),0===e.avail_out)return i.last_flush=-1,0}else if(0===e.avail_in&&p(t)<=p(n)&&4!==t)return f(e,-5);if(666===i.status&&0!==e.avail_in)return f(e,-5);if(0!==e.avail_in||0!==i.lookahead||0!==t&&666!==i.status){var b=2===i.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(x(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):3===i.strategy?function(e,t){for(var n,r,i,o,s=e.window;;){if(e.lookahead<=c){if(x(e),e.lookahead<=c&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&0<e.strstart&&(r=s[i=e.strstart-1])===s[++i]&&r===s[++i]&&r===s[++i]){o=e.strstart+c;do{}while(r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&r===s[++i]&&i<o);e.match_length=c-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=a._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(y(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(y(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(y(e,!1),0===e.strm.avail_out)?1:2}(i,t):r[i.level].func(i,t);if(3!==b&&4!==b||(i.status=666),1===b||3===b)return 0===e.avail_out&&(i.last_flush=-1),0;if(2===b&&(1===t?a._tr_align(i):5!==t&&(a._tr_stored_block(i,0,0,!1),3===t&&(m(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),g(e),0===e.avail_out))return i.last_flush=-1,0}return 4!==t?0:i.wrap<=0?1:(2===i.wrap?(v(i,255&e.adler),v(i,e.adler>>8&255),v(i,e.adler>>16&255),v(i,e.adler>>24&255),v(i,255&e.total_in),v(i,e.total_in>>8&255),v(i,e.total_in>>16&255),v(i,e.total_in>>24&255)):(_(i,e.adler>>>16),_(i,65535&e.adler)),g(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?0:1)},n.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&103!==t&&t!==h&&666!==t?f(e,u):(e.state=null,t===h?f(e,-3):0):u},n.deflateSetDictionary=function(e,t){var n,r,a,s,l,c,d,h,f=t.length;if(!e||!e.state||2===(s=(n=e.state).wrap)||1===s&&42!==n.status||n.lookahead)return u;for(1===s&&(e.adler=o(e.adler,t,f,0)),n.wrap=0,f>=n.w_size&&(0===s&&(m(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new i.Buf8(n.w_size),i.arraySet(h,t,f-n.w_size,n.w_size,0),t=h,f=n.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=f,e.next_in=0,e.input=t,x(n);n.lookahead>=3;){for(r=n.strstart,a=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[r+3-1])&n.hash_mask,n.prev[r&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=r,r++,--a;);n.strstart=r,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,n){t.exports=function(e,t){var n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b,x,w,k,S,E,C;n=e.state,r=e.next_in,E=e.input,i=r+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),l=n.dmax,u=n.wsize,c=n.whave,d=n.wnext,h=n.window,f=n.hold,p=n.bits,m=n.lencode,g=n.distcode,y=(1<<n.lenbits)-1,v=(1<<n.distbits)-1;e:do{p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),_=m[f&y];t:for(;;){if(f>>>=b=_>>>24,p-=b,0===(b=_>>>16&255))C[a++]=65535&_;else{if(!(16&b)){if(!(64&b)){_=m[(65535&_)+(f&(1<<b)-1)];continue t}if(32&b){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}x=65535&_,(b&=15)&&(p<b&&(f+=E[r++]<<p,p+=8),x+=f&(1<<b)-1,f>>>=b,p-=b),p<15&&(f+=E[r++]<<p,p+=8,f+=E[r++]<<p,p+=8),_=g[f&v];n:for(;;){if(f>>>=b=_>>>24,p-=b,!(16&(b=_>>>16&255))){if(!(64&b)){_=g[(65535&_)+(f&(1<<b)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&_,p<(b&=15)&&(f+=E[r++]<<p,(p+=8)<b&&(f+=E[r++]<<p,p+=8)),l<(w+=f&(1<<b)-1)){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=b,p-=b,(b=a-o)<w){if(c<(b=w-b)&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(S=h,(k=0)===d){if(k+=u-b,b<x){for(x-=b;C[a++]=h[k++],--b;);k=a-w,S=C}}else if(d<b){if(k+=u+d-b,(b-=d)<x){for(x-=b;C[a++]=h[k++],--b;);if(k=0,d<x){for(x-=b=d;C[a++]=h[k++],--b;);k=a-w,S=C}}}else if(k+=d-b,b<x){for(x-=b;C[a++]=h[k++],--b;);k=a-w,S=C}for(;2<x;)C[a++]=S[k++],C[a++]=S[k++],C[a++]=S[k++],x-=3;x&&(C[a++]=S[k++],1<x&&(C[a++]=S[k++]))}else{for(k=a-w;C[a++]=C[k++],C[a++]=C[k++],C[a++]=C[k++],2<(x-=3););x&&(C[a++]=C[k++],1<x&&(C[a++]=C[k++]))}break}}break}}while(r<i&&a<s);r-=x=p>>3,f&=(1<<(p-=x<<3))-1,e.next_in=r,e.next_out=a,e.avail_in=r<i?i-r+5:5-(r-i),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=p}},{}],49:[function(e,t,n){var r=e("../utils/common"),i=e("./adler32"),a=e("./crc32"),o=e("./inffast"),s=e("./inftrees"),l=-2;function u(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function c(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function d(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(852),t.distcode=t.distdyn=new r.Buf32(592),t.sane=1,t.back=-1,0):l}function h(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,d(e)):l}function f(e,t){var n,r;return e&&e.state?(r=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?l:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,h(e))):l}function p(e,t){var n,r;return e?(r=new c,(e.state=r).window=null,0!==(n=f(e,t))&&(e.state=null),n):l}var m,g,y=!0;function v(e){if(y){var t;for(m=new r.Buf32(512),g=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(1,e.lens,0,288,m,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(2,e.lens,0,32,g,0,e.work,{bits:5}),y=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function _(e,t,n,i){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(a=o.wsize-o.wnext)&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),(i-=a)?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}n.inflateReset=h,n.inflateReset2=f,n.inflateResetKeep=d,n.inflateInit=function(e){return p(e,15)},n.inflateInit2=p,n.inflate=function(e,t){var n,c,d,h,f,p,m,g,y,b,x,w,k,S,E,C,P,D,I,T,A,z,O,F,M=0,j=new r.Buf8(4),B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;12===(n=e.state).mode&&(n.mode=13),f=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,c=e.input,p=e.avail_in,g=n.hold,y=n.bits,b=p,x=m,z=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;y<16;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(2&n.wrap&&35615===g){j[n.check=0]=255&g,j[1]=g>>>8&255,n.check=a(n.check,j,2,0),y=g=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&g)<<8)+(g>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&g)){e.msg="unknown compression method",n.mode=30;break}if(y-=4,A=8+(15&(g>>>=4)),0===n.wbits)n.wbits=A;else if(A>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<A,e.adler=n.check=1,n.mode=512&g?10:12,y=g=0;break;case 2:for(;y<16;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(n.flags=g,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=g>>8&1),512&n.flags&&(j[0]=255&g,j[1]=g>>>8&255,n.check=a(n.check,j,2,0)),y=g=0,n.mode=3;case 3:for(;y<32;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.head&&(n.head.time=g),512&n.flags&&(j[0]=255&g,j[1]=g>>>8&255,j[2]=g>>>16&255,j[3]=g>>>24&255,n.check=a(n.check,j,4,0)),y=g=0,n.mode=4;case 4:for(;y<16;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.head&&(n.head.xflags=255&g,n.head.os=g>>8),512&n.flags&&(j[0]=255&g,j[1]=g>>>8&255,n.check=a(n.check,j,2,0)),y=g=0,n.mode=5;case 5:if(1024&n.flags){for(;y<16;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.length=g,n.head&&(n.head.extra_len=g),512&n.flags&&(j[0]=255&g,j[1]=g>>>8&255,n.check=a(n.check,j,2,0)),y=g=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(p<(w=n.length)&&(w=p),w&&(n.head&&(A=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,c,h,w,A)),512&n.flags&&(n.check=a(n.check,c,w,h)),p-=w,h+=w,n.length-=w),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===p)break e;for(w=0;A=c[h+w++],n.head&&A&&n.length<65536&&(n.head.name+=String.fromCharCode(A)),A&&w<p;);if(512&n.flags&&(n.check=a(n.check,c,w,h)),p-=w,h+=w,A)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===p)break e;for(w=0;A=c[h+w++],n.head&&A&&n.length<65536&&(n.head.comment+=String.fromCharCode(A)),A&&w<p;);if(512&n.flags&&(n.check=a(n.check,c,w,h)),p-=w,h+=w,A)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;y<16;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(g!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}y=g=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;y<32;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}e.adler=n.check=u(g),y=g=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=y,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){g>>>=7&y,y-=7&y,n.mode=27;break}for(;y<3;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}switch(n.last=1&g,y-=1,3&(g>>>=1)){case 0:n.mode=14;break;case 1:if(v(n),n.mode=20,6!==t)break;g>>>=2,y-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}g>>>=2,y-=2;break;case 14:for(g>>>=7&y,y-=7&y;y<32;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if((65535&g)!=(g>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&g,y=g=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(w=n.length){if(p<w&&(w=p),m<w&&(w=m),0===w)break e;r.arraySet(d,c,h,w,f),p-=w,h+=w,m-=w,f+=w,n.length-=w;break}n.mode=12;break;case 17:for(;y<14;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(n.nlen=257+(31&g),g>>>=5,y-=5,n.ndist=1+(31&g),g>>>=5,y-=5,n.ncode=4+(15&g),g>>>=4,y-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;y<3;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.lens[B[n.have++]]=7&g,g>>>=3,y-=3}for(;n.have<19;)n.lens[B[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,O={bits:n.lenbits},z=s(0,n.lens,0,19,n.lencode,0,n.work,O),n.lenbits=O.bits,z){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,P=65535&M,!((E=M>>>24)<=y);){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(P<16)g>>>=E,y-=E,n.lens[n.have++]=P;else{if(16===P){for(F=E+2;y<F;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(g>>>=E,y-=E,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}A=n.lens[n.have-1],w=3+(3&g),g>>>=2,y-=2}else if(17===P){for(F=E+3;y<F;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}y-=E,A=0,w=3+(7&(g>>>=E)),g>>>=3,y-=3}else{for(F=E+7;y<F;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}y-=E,A=0,w=11+(127&(g>>>=E)),g>>>=7,y-=7}if(n.have+w>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;w--;)n.lens[n.have++]=A}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,O={bits:n.lenbits},z=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,O),n.lenbits=O.bits,z){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,O={bits:n.distbits},z=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,O),n.distbits=O.bits,z){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=p&&258<=m){e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=y,o(e,x),f=e.next_out,d=e.output,m=e.avail_out,h=e.next_in,c=e.input,p=e.avail_in,g=n.hold,y=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;C=(M=n.lencode[g&(1<<n.lenbits)-1])>>>16&255,P=65535&M,!((E=M>>>24)<=y);){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(C&&!(240&C)){for(D=E,I=C,T=P;C=(M=n.lencode[T+((g&(1<<D+I)-1)>>D)])>>>16&255,P=65535&M,!(D+(E=M>>>24)<=y);){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}g>>>=D,y-=D,n.back+=D}if(g>>>=E,y-=E,n.back+=E,n.length=P,0===C){n.mode=26;break}if(32&C){n.back=-1,n.mode=12;break}if(64&C){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&C,n.mode=22;case 22:if(n.extra){for(F=n.extra;y<F;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.length+=g&(1<<n.extra)-1,g>>>=n.extra,y-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;C=(M=n.distcode[g&(1<<n.distbits)-1])>>>16&255,P=65535&M,!((E=M>>>24)<=y);){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(!(240&C)){for(D=E,I=C,T=P;C=(M=n.distcode[T+((g&(1<<D+I)-1)>>D)])>>>16&255,P=65535&M,!(D+(E=M>>>24)<=y);){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}g>>>=D,y-=D,n.back+=D}if(g>>>=E,y-=E,n.back+=E,64&C){e.msg="invalid distance code",n.mode=30;break}n.offset=P,n.extra=15&C,n.mode=24;case 24:if(n.extra){for(F=n.extra;y<F;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}n.offset+=g&(1<<n.extra)-1,g>>>=n.extra,y-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===m)break e;if(w=x-m,n.offset>w){if((w=n.offset-w)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}k=w>n.wnext?(w-=n.wnext,n.wsize-w):n.wnext-w,w>n.length&&(w=n.length),S=n.window}else S=d,k=f-n.offset,w=n.length;for(m<w&&(w=m),m-=w,n.length-=w;d[f++]=S[k++],--w;);0===n.length&&(n.mode=21);break;case 26:if(0===m)break e;d[f++]=n.length,m--,n.mode=21;break;case 27:if(n.wrap){for(;y<32;){if(0===p)break e;p--,g|=c[h++]<<y,y+=8}if(x-=m,e.total_out+=x,n.total+=x,x&&(e.adler=n.check=n.flags?a(n.check,d,x,f-x):i(n.check,d,x,f-x)),x=m,(n.flags?g:u(g))!==n.check){e.msg="incorrect data check",n.mode=30;break}y=g=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;y<32;){if(0===p)break e;p--,g+=c[h++]<<y,y+=8}if(g!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}y=g=0}n.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;default:return l}return e.next_out=f,e.avail_out=m,e.next_in=h,e.avail_in=p,n.hold=g,n.bits=y,(n.wsize||x!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&_(e,e.output,e.next_out,x-e.avail_out)?(n.mode=31,-4):(b-=e.avail_in,x-=e.avail_out,e.total_in+=b,e.total_out+=x,n.total+=x,n.wrap&&x&&(e.adler=n.check=n.flags?a(n.check,d,x,e.next_out-x):i(n.check,d,x,e.next_out-x)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==b&&0===x||4===t)&&0===z&&(z=-5),z)},n.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},n.inflateGetHeader=function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,0):l},n.inflateSetDictionary=function(e,t){var n,r=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?l:11===n.mode&&i(1,t,r,0)!==n.check?-3:_(e,t,r,r)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var r=e("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,u,c,d,h){var f,p,m,g,y,v,_,b,x,w=h.bits,k=0,S=0,E=0,C=0,P=0,D=0,I=0,T=0,A=0,z=0,O=null,F=0,M=new r.Buf16(16),j=new r.Buf16(16),B=null,R=0;for(k=0;k<=15;k++)M[k]=0;for(S=0;S<l;S++)M[t[n+S]]++;for(P=w,C=15;1<=C&&0===M[C];C--);if(C<P&&(P=C),0===C)return u[c++]=20971520,u[c++]=20971520,h.bits=1,0;for(E=1;E<C&&0===M[E];E++);for(P<E&&(P=E),k=T=1;k<=15;k++)if(T<<=1,(T-=M[k])<0)return-1;if(0<T&&(0===e||1!==C))return-1;for(j[1]=0,k=1;k<15;k++)j[k+1]=j[k]+M[k];for(S=0;S<l;S++)0!==t[n+S]&&(d[j[t[n+S]]++]=S);if(v=0===e?(O=B=d,19):1===e?(O=i,F-=257,B=a,R-=257,256):(O=o,B=s,-1),k=E,y=c,I=S=z=0,m=-1,g=(A=1<<(D=P))-1,1===e&&852<A||2===e&&592<A)return 1;for(;;){for(_=k-I,x=d[S]<v?(b=0,d[S]):d[S]>v?(b=B[R+d[S]],O[F+d[S]]):(b=96,0),f=1<<k-I,E=p=1<<D;u[y+(z>>I)+(p-=f)]=_<<24|b<<16|x,0!==p;);for(f=1<<k-1;z&f;)f>>=1;if(0!==f?(z&=f-1,z+=f):z=0,S++,0==--M[k]){if(k===C)break;k=t[n+d[S]]}if(P<k&&(z&g)!==m){for(0===I&&(I=P),y+=E,T=1<<(D=k-I);D+I<C&&!((T-=M[D+I])<=0);)D++,T<<=1;if(A+=1<<D,1===e&&852<A||2===e&&592<A)return 1;u[m=z&g]=P<<24|D<<16|y-c}}return 0!==z&&(u[y+z]=k-I<<24|64<<16),h.bits=P,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,n){var r=e("../utils/common");function i(e){for(var t=e.length;0<=--t;)e[t]=0}var a=256,o=286,s=30,l=15,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=new Array(576);i(f);var p=new Array(60);i(p);var m=new Array(512);i(m);var g=new Array(256);i(g);var y=new Array(29);i(y);var v,_,b,x=new Array(s);function w(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}function k(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function S(e){return e<256?m[e]:m[256+(e>>>7)]}function E(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function C(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,E(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function P(e,t,n){C(e,n[2*t],n[2*t+1])}function D(e,t){for(var n=0;n|=1&e,e>>>=1,n<<=1,0<--t;);return n>>>1}function I(e,t,n){var r,i,a=new Array(16),o=0;for(r=1;r<=l;r++)a[r]=o=o+n[r-1]<<1;for(i=0;i<=t;i++){var s=e[2*i+1];0!==s&&(e[2*i]=D(a[s]++,s))}}function T(e){var t;for(t=0;t<o;t++)e.dyn_ltree[2*t]=0;for(t=0;t<s;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function A(e){8<e.bi_valid?E(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function z(e,t,n,r){var i=2*t,a=2*n;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function O(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&z(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!z(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function F(e,t,n){var r,i,o,s,l=0;if(0!==e.last_lit)for(;r=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===r?P(e,i,t):(P(e,(o=g[i])+a+1,t),0!==(s=u[o])&&C(e,i-=y[o],s),P(e,o=S(--r),n),0!==(s=c[o])&&C(e,r-=x[o],s)),l<e.last_lit;);P(e,256,t)}function M(e,t){var n,r,i,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<u;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(i=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=o[2*i+1]);for(t.max_code=c,n=e.heap_len>>1;1<=n;n--)O(e,a,n);for(i=u;n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],O(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*i]=a[2*n]+a[2*r],e.depth[i]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=i,e.heap[1]=i++,O(e,a,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,r,i,a,o,s,u=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,m=t.stat_desc.max_length,g=0;for(a=0;a<=l;a++)e.bl_count[a]=0;for(u[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)m<(a=u[2*u[2*(r=e.heap[n])+1]+1]+1)&&(a=m,g++),u[2*r+1]=a,c<r||(e.bl_count[a]++,o=0,p<=r&&(o=f[r-p]),s=u[2*r],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(d[2*r+1]+o)));if(0!==g){do{for(a=m-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[m]--,g-=2}while(0<g);for(a=m;0!==a;a--)for(r=e.bl_count[a];0!==r;)c<(i=e.heap[--n])||(u[2*i+1]!==a&&(e.opt_len+=(a-u[2*i+1])*u[2*i],u[2*i+1]=a),r--)}}(e,t),I(a,c,e.bl_count)}function j(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=o,o=t[2*(r+1)+1],++s<l&&i===o||(s<u?e.bl_tree[2*i]+=s:0!==i?(i!==a&&e.bl_tree[2*i]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=i,u=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4))}function B(e,t,n){var r,i,a=-1,o=t[1],s=0,l=7,u=4;for(0===o&&(l=138,u=3),r=0;r<=n;r++)if(i=o,o=t[2*(r+1)+1],!(++s<l&&i===o)){if(s<u)for(;P(e,i,e.bl_tree),0!=--s;);else 0!==i?(i!==a&&(P(e,i,e.bl_tree),s--),P(e,16,e.bl_tree),C(e,s-3,2)):s<=10?(P(e,17,e.bl_tree),C(e,s-3,3)):(P(e,18,e.bl_tree),C(e,s-11,7));a=i,u=(s=0)===o?(l=138,3):i===o?(l=6,3):(l=7,4)}}i(x);var R=!1;function L(e,t,n,i){var a,o,s;C(e,0+(i?1:0),3),o=t,s=n,A(a=e),E(a,s),E(a,~s),r.arraySet(a.pending_buf,a.window,o,s,a.pending),a.pending+=s}n._tr_init=function(e){R||(function(){var e,t,n,r,i,a=new Array(16);for(r=n=0;r<28;r++)for(y[r]=n,e=0;e<1<<u[r];e++)g[n++]=r;for(g[n-1]=r,r=i=0;r<16;r++)for(x[r]=i,e=0;e<1<<c[r];e++)m[i++]=r;for(i>>=7;r<s;r++)for(x[r]=i<<7,e=0;e<1<<c[r]-7;e++)m[256+i++]=r;for(t=0;t<=l;t++)a[t]=0;for(e=0;e<=143;)f[2*e+1]=8,e++,a[8]++;for(;e<=255;)f[2*e+1]=9,e++,a[9]++;for(;e<=279;)f[2*e+1]=7,e++,a[7]++;for(;e<=287;)f[2*e+1]=8,e++,a[8]++;for(I(f,287,a),e=0;e<s;e++)p[2*e+1]=5,p[2*e]=D(e,5);v=new w(f,u,257,o,l),_=new w(p,c,0,s,l),b=new w(new Array(0),d,0,19,7)}(),R=!0),e.l_desc=new k(e.dyn_ltree,v),e.d_desc=new k(e.dyn_dtree,_),e.bl_desc=new k(e.bl_tree,b),e.bi_buf=0,e.bi_valid=0,T(e)},n._tr_stored_block=L,n._tr_flush_block=function(e,t,n,r){var i,o,s=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<a;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),M(e,e.l_desc),M(e,e.d_desc),s=function(e){var t;for(j(e,e.dyn_ltree,e.l_desc.max_code),j(e,e.dyn_dtree,e.d_desc.max_code),M(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=n+5,n+4<=i&&-1!==t?L(e,t,n,r):4===e.strategy||o===i?(C(e,2+(r?1:0),3),F(e,f,p)):(C(e,4+(r?1:0),3),function(e,t,n,r){var i;for(C(e,t-257,5),C(e,n-1,5),C(e,r-4,4),i=0;i<r;i++)C(e,e.bl_tree[2*h[i]+1],3);B(e,e.dyn_ltree,t-1),B(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),F(e,e.dyn_ltree,e.dyn_dtree)),T(e),r&&A(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(g[n]+a+1)]++,e.dyn_dtree[2*S(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){var t;C(e,2,3),P(e,256,f),16===(t=e).bi_valid?(E(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,n){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(e){if(!e.setImmediate){var t,n,r,i,a=1,o={},s=!1,l=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,t="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){d(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(i="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",h,!1):e.attachEvent("onmessage",h),function(t){e.postMessage(i+t,"*")}):e.MessageChannel?((r=new MessageChannel).port1.onmessage=function(e){d(e.data)},function(e){r.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(n=l.documentElement,function(e){var t=l.createElement("script");t.onreadystatechange=function(){d(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(d,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),r=0;r<n.length;r++)n[r]=arguments[r+1];var i={callback:e,args:n};return o[a]=i,t(a),a++},u.clearImmediate=c}function c(e){delete o[e]}function d(e){if(s)setTimeout(d,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{c(e),s=!1}}}}function h(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&d(+t.data.slice(i.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},"object"==typeof o&&"undefined"!=typeof s?s.exports=l():(i=[],void 0===(a="function"===typeof(r=l)?r.apply(t,i):r)||(e.exports=a))}),yA=k(()=>{ZT=P(Oh(),1),KT=P(Oh(),1),GT=e=>"function"==typeof e,XT=(e,t)=>GT(e)?e(t):e,$T=(()=>{let e=0;return()=>(++e).toString()})(),(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),YT=new Map,JT=e=>{if(YT.has(e))return;let t=setTimeout(()=>{YT.delete(e),rA({type:4,toastId:e})},1e3);YT.set(e,t)},QT=e=>{let t=YT.get(e);t&&clearTimeout(t)},eA=(e,t)=>{switch(t.type){case 0:return x(b({},e),{toasts:[t.toast,...e.toasts].slice(0,20)});case 1:return t.toast.id&&QT(t.toast.id),x(b({},e),{toasts:e.toasts.map(e=>e.id===t.toast.id?b(b({},e),t.toast):e)});case 2:let{toast:n}=t;return e.toasts.find(e=>e.id===n.id)?eA(e,{type:1,toast:n}):eA(e,{type:0,toast:n});case 3:let{toastId:r}=t;return r?JT(r):e.toasts.forEach(e=>{JT(e.id)}),x(b({},e),{toasts:e.toasts.map(e=>e.id===r||void 0===r?x(b({},e),{visible:!1}):e)});case 4:return void 0===t.toastId?x(b({},e),{toasts:[]}):x(b({},e),{toasts:e.toasts.filter(e=>e.id!==t.toastId)});case 5:return x(b({},e),{pausedAt:t.time});case 6:let i=t.time-(e.pausedAt||0);return x(b({},e),{pausedAt:void 0,toasts:e.toasts.map(e=>x(b({},e),{pauseDuration:e.pauseDuration+i}))})}},tA=[],nA={toasts:[],pausedAt:void 0},rA=e=>{nA=eA(nA,e),tA.forEach(e=>{e(nA)})},iA={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},aA=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,n]=(0,ZT.useState)(nA);(0,ZT.useEffect)(()=>(tA.push(n),()=>{let e=tA.indexOf(n);e>-1&&tA.splice(e,1)}),[t]);let r=t.toasts.map(t=>{var n,r;return x(b(b(b({},e),e[t.type]),t),{duration:t.duration||(null==(n=e[t.type])?void 0:n.duration)||(null==e?void 0:e.duration)||iA[t.type],style:b(b(b({},e.style),null==(r=e[t.type])?void 0:r.style),t.style)})});return x(b({},t),{toasts:r})},oA=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blank",n=arguments.length>2?arguments[2]:void 0;return x(b({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0},n),{id:(null==n?void 0:n.id)||$T()})},(lA=(e,t)=>sA("blank")(e,t)).error=(sA=e=>(t,n)=>{let r=oA(t,e,n);return rA({type:2,toast:r}),r.id})("error"),lA.success=sA("success"),lA.loading=sA("loading"),lA.custom=sA("custom"),lA.dismiss=e=>{rA({type:3,toastId:e})},lA.remove=e=>rA({type:4,toastId:e}),lA.promise=(e,t,n)=>{let r=lA.loading(t.loading,b(b({},n),null==n?void 0:n.loading));return e.then(e=>(lA.success(XT(t.success,e),b(b({id:r},n),null==n?void 0:n.success)),e)).catch(e=>{lA.error(XT(t.error,e),b(b({id:r},n),null==n?void 0:n.error))}),e},uA=(e,t)=>{rA({type:1,toast:{id:e,height:t}})},cA=()=>{rA({type:5,time:Date.now()})},dA=e=>{let{toasts:t,pausedAt:n}=aA(e);(0,KT.useEffect)(()=>{if(n)return;let e=Date.now(),r=t.map(t=>{if(t.duration===1/0)return;let n=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(n<0))return setTimeout(()=>lA.dismiss(t.id),n);t.visible&&lA.dismiss(t.id)});return()=>{r.forEach(e=>e&&clearTimeout(e))}},[t,n]);let r=(0,KT.useCallback)(()=>{n&&rA({type:6,time:Date.now()})},[n]),i=(0,KT.useCallback)((e,n)=>{let{reverseOrder:r=!1,gutter:i=8,defaultPosition:a}=n||{},o=t.filter(t=>(t.position||a)===(e.position||a)&&t.height),s=o.findIndex(t=>t.id===e.id),l=o.filter((e,t)=>t<s&&e.visible).length;return o.filter(e=>e.visible).slice(...r?[l+1]:[0,l]).reduce((e,t)=>e+(t.height||0)+i,0)},[t]);return{toasts:t,handlers:{updateHeight:uA,startPause:cA,endPause:r,calculateOffset:i}}},hA=lA});function vA(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function _A(e,t){if(t){if(OA.test(e))return e.replace(FA,RA)}else if(MA.test(e))return e.replace(jA,RA);return e}function bA(e){return e.replace(LA,(e,t)=>"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):"")}function xA(e,t){e="string"==typeof e?e:e.source,t=t||"";let n={replace:(t,r)=>(r=(r=r.source||r).replace(NA,"$1"),e=e.replace(t,r),n),getRegex:()=>new RegExp(e,t)};return n}function wA(e,t,n){if(e){let e;try{e=decodeURIComponent(bA(n)).replace(UA,"").toLowerCase()}catch(r){return null}if(0===e.indexOf("javascript:")||0===e.indexOf("vbscript:")||0===e.indexOf("data:"))return null}t&&!VA.test(n)&&(n=function(e,t){qA[" "+e]||(HA.test(e)?qA[" "+e]=e+"/":qA[" "+e]=EA(e,"/",!0)),e=qA[" "+e];let n=-1===e.indexOf(":");return"//"===t.substring(0,2)?n?t:e.replace(WA,"$1")+t:"/"===t.charAt(0)?n?t:e.replace(ZA,"$1")+t:e+t}(t,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(i){return null}return n}function kA(e){let t,n,r=1;for(;r<arguments.length;r++)for(n in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function SA(e,t){let n=e.replace(/\|/g,(e,t,n)=>{let r=!1,i=t;for(;--i>=0&&"\\"===n[i];)r=!r;return r?"|":" |"}).split(/ \|/),r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function EA(e,t,n){let r=e.length;if(0===r)return"";let i=0;for(;i<r;){let a=e.charAt(r-i-1);if(a!==t||n){if(a===t||!n)break;i++}else i++}return e.slice(0,r-i)}function CA(e){e&&e.sanitize&&!e.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function PA(e,t){if(t<1)return"";let n="";for(;t>1;)1&t&&(n+=e),t>>=1,e+=e;return n+e}function DA(e,t,n,r){let i=t.href,a=t.title?_A(t.title):null,o=e[1].replace(/\\([\[\]])/g,"$1");if("!"!==e[0].charAt(0)){r.state.inLink=!0;let e={type:"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,e}return{type:"image",raw:n,href:i,title:a,text:_A(o)}}function IA(e){return e.replace(/---/g,"\u2014").replace(/--/g,"\u2013").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1\u2018").replace(/'/g,"\u2019").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1\u201c").replace(/"/g,"\u201d").replace(/\.{3}/g,"\u2026")}function TA(e){let t,n,r="",i=e.length;for(t=0;t<i;t++)n=e.charCodeAt(t),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}function AA(e,t,n){if("undefined"==typeof e||null===e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if("function"==typeof t&&(n=t,t=null),CA(t=kA({},AA.defaults,t||{})),n){let r,a=t.highlight;try{r=YA.lex(e,t)}catch(i){return n(i)}let o=function(e){let i;if(!e)try{t.walkTokens&&AA.walkTokens(r,t.walkTokens),i=tz.parse(r,t)}catch(o){e=o}return t.highlight=a,e?n(e):n(null,i)};if(!a||a.length<3||(delete t.highlight,!r.length))return o();let s=0;return AA.walkTokens(r,function(e){"code"===e.type&&(s++,setTimeout(()=>{a(e.text,e.lang,function(t,n){if(t)return o(t);null!=n&&n!==e.text&&(e.text=n,e.escaped=!0),s--,0===s&&o()})},0))}),void(0===s&&o())}function r(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+_A(e.message+"",!0)+"</pre>";throw e}try{let n=YA.lex(e,t);if(t.walkTokens){if(t.async)return Promise.all(AA.walkTokens(n,t.walkTokens)).then(()=>tz.parse(n,t)).catch(r);AA.walkTokens(n,t.walkTokens)}return tz.parse(n,t)}catch(a){r(a)}}var zA,OA,FA,MA,jA,BA,RA,LA,NA,UA,VA,qA,HA,WA,ZA,KA,GA,XA,$A,YA,JA,QA,ez,tz,nz,rz,iz,az,oz,sz,lz,uz,cz,dz,hz,fz,pz,mz,gz,yz,vz,_z,bz,xz,wz,kz,Sz,Ez,Cz,Pz,Dz,Iz,Tz,Az,zz,Oz,Fz,Mz,jz,Bz=k(()=>{zA={async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1},OA=/[&<>"']/,FA=/[&<>"']/g,MA=/[<>"']|&(?!#?\w+;)/,jA=/[<>"']|&(?!#?\w+;)/g,BA={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},RA=e=>BA[e],LA=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,NA=/(^|[^\[])\^/g,UA=/[^\w:]/g,VA=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i,qA={},HA=/^[^:]+:\/*[^/]*$/,WA=/^([^:]+:)[\s\S]*$/,ZA=/^([^:]+:\/*[^/]*)[\s\S]*$/,KA={exec:function(){}},GA=class{constructor(e){this.options=e||zA}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:EA(e,"\n")}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],n=function(e,t){let n=e.match(/^(\s+)(?:```)/);if(null===n)return t;let r=n[1];return t.split("\n").map(e=>{let t=e.match(/^\s+/);if(null===t)return e;let[n]=t;return n.length>=r.length?e.slice(r.length):e}).join("\n")}(e,t[3]||"");return{type:"code",raw:e,lang:t[2]?t[2].trim():t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(/#$/.test(e)){let t=EA(e,"#");(this.options.pedantic||!t||/ $/.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=t[0].replace(/^ *>[ \t]?/gm,"");return{type:"blockquote",raw:t[0],tokens:this.lexer.blockTokens(e,[]),text:e}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n,r,i,a,o,s,l,u,c,d,h,f,p=t[1].trim(),m=p.length>1,g={type:"list",raw:"",ordered:m,start:m?+p.slice(0,-1):"",loose:!1,items:[]};p=m?"\\d{1,9}\\".concat(p.slice(-1)):"\\".concat(p),this.options.pedantic&&(p=m?p:"[*+-]");let y=new RegExp("^( {0,3}".concat(p,")((?:[\t ][^\\n]*)?(?:\\n|$))"));for(;e&&(f=!1,(t=y.exec(e))&&!this.rules.block.hr.test(e));){if(n=t[0],e=e.substring(n.length),u=t[2].split("\n",1)[0],c=e.split("\n",1)[0],this.options.pedantic?(a=2,h=u.trimLeft()):(a=t[2].search(/[^ ]/),a=a>4?1:a,h=u.slice(a),a+=t[1].length),s=!1,!u&&/^ *$/.test(c)&&(n+=c+"\n",e=e.substring(c.length+1),f=!0),!f){let t=new RegExp("^ {0,".concat(Math.min(3,a-1),"}(?:[*+-]|\\d{1,9}[.)])((?: [^\\n]*)?(?:\\n|$))")),r=new RegExp("^ {0,".concat(Math.min(3,a-1),"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)")),i=new RegExp("^ {0,".concat(Math.min(3,a-1),"}(?:```|~~~)")),o=new RegExp("^ {0,".concat(Math.min(3,a-1),"}#"));for(;e&&(d=e.split("\n",1)[0],u=d,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!(i.test(u)||o.test(u)||t.test(u)||r.test(e)));){if(u.search(/[^ ]/)>=a||!u.trim())h+="\n"+u.slice(a);else{if(s)break;h+="\n"+u}!s&&!u.trim()&&(s=!0),n+=d+"\n",e=e.substring(d.length+1)}}g.loose||(l?g.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(h),r&&(i="[ ] "!==r[0],h=h.replace(/^\[[ xX]\] +/,""))),g.items.push({type:"list_item",raw:n,task:!!r,checked:i,loose:!1,text:h}),g.raw+=n}g.items[g.items.length-1].raw=n.trimRight(),g.items[g.items.length-1].text=h.trimRight(),g.raw=g.raw.trimRight();let v=g.items.length;for(o=0;o<v;o++){this.lexer.state.top=!1,g.items[o].tokens=this.lexer.blockTokens(g.items[o].text,[]);let e=g.items[o].tokens.filter(e=>"space"===e.type),t=e.every(e=>{let t=e.raw.split(""),n=0;for(let r of t)if("\n"===r&&(n+=1),n>1)return!0;return!1});!g.loose&&e.length&&t&&(g.loose=!0,g.items[o].loose=!0)}return g}}html(e){let t=this.rules.block.html.exec(e);if(t){let e={type:"html",raw:t[0],pre:!this.options.sanitizer&&("pre"===t[1]||"script"===t[1]||"style"===t[1]),text:t[0]};if(this.options.sanitize){let n=this.options.sanitizer?this.options.sanitizer(t[0]):_A(t[0]);e.type="paragraph",e.text=n,e.tokens=this.lexer.inline(n)}return e}}def(e){let t=this.rules.block.def.exec(e);if(t)return t[3]&&(t[3]=t[3].substring(1,t[3].length-1)),{type:"def",tag:t[1].toLowerCase().replace(/\s+/g," "),raw:t[0],href:t[2],title:t[3]}}table(e){let t=this.rules.block.table.exec(e);if(t){let e={type:"table",header:SA(t[1]).map(e=>({text:e})),align:t[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(e.header.length===e.align.length){e.raw=t[0];let n,r,i,a,o=e.align.length;for(n=0;n<o;n++)/^ *-+: *$/.test(e.align[n])?e.align[n]="right":/^ *:-+: *$/.test(e.align[n])?e.align[n]="center":/^ *:-+ *$/.test(e.align[n])?e.align[n]="left":e.align[n]=null;for(o=e.rows.length,n=0;n<o;n++)e.rows[n]=SA(e.rows[n],e.header.length).map(e=>({text:e}));for(o=e.header.length,r=0;r<o;r++)e.header[r].tokens=this.lexer.inline(e.header[r].text);for(o=e.rows.length,r=0;r<o;r++)for(a=e.rows[r],i=0;i<a.length;i++)a[i].tokens=this.lexer.inline(a[i].text);return e}}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:_A(t[1])}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(t[0]):_A(t[0]):t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&/^</.test(e)){if(!/>$/.test(e))return;let t=EA(e.slice(0,-1),"\\");if((e.length-t.length)%2===0)return}else{let e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=e.length,r=0,i=0;for(;i<n;i++)if("\\"===e[i])i++;else if(e[i]===t[0])r++;else if(e[i]===t[1]&&(r--,r<0))return i;return-1}(t[2],"()");if(e>-1){let n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){let e=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),/^</.test(n)&&(n=this.options.pedantic&&!/>$/.test(e)?n.slice(1):n.slice(1,-1)),DA(t,{href:n&&n.replace(this.rules.inline._escapes,"$1"),title:r&&r.replace(this.rules.inline._escapes,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=(n[2]||n[1]).replace(/\s+/g," ");if(e=t[e.toLowerCase()],!e||!e.href){let e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return DA(n,e,n[0],this.lexer)}}emStrong(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=this.rules.inline.emStrong.lDelim.exec(e);if(!r||r[3]&&n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088F\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5C\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDC-\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C8A\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7DC\uA7F1-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDDC0-\uDDF3\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD40-\uDD59\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDD40-\uDD65\uDD6F-\uDD85\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDEC2-\uDEC7\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE3F\uDE40\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61\uDF80-\uDF89\uDF8B\uDF8E\uDF90-\uDFB5\uDFB7\uDFD1\uDFD3]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDED0-\uDEE3\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8\uDFC0-\uDFE0\uDFF0-\uDFF9]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDDB0-\uDDDB\uDDE0-\uDDE9\uDEE0-\uDEF2\uDF02\uDF04-\uDF10\uDF12-\uDF33\uDF50-\uDF59\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD80E\uD80F\uD81C-\uD822\uD840-\uD868\uD86A-\uD86D\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD88C][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2F\uDC41-\uDC46\uDC60-\uDFFF]|\uD810[\uDC00-\uDFFA]|\uD811[\uDC00-\uDE46]|\uD818[\uDD00-\uDD1D\uDD30-\uDD39]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDD40-\uDD6C\uDD70-\uDD79\uDE40-\uDE96\uDEA0-\uDEB8\uDEBB-\uDED3\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3\uDFF2-\uDFF6]|\uD823[\uDC00-\uDCD5\uDCFF-\uDD1E\uDD80-\uDDF2]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD32\uDD50-\uDD52\uDD55\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD833[\uDCF0-\uDCF9]|\uD834[\uDEC0-\uDED3\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]|\uD838[\uDC30-\uDC6D\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDCD0-\uDCEB\uDCF0-\uDCF9\uDDD0-\uDDED\uDDF0-\uDDFA\uDEC0-\uDEDE\uDEE0-\uDEE2\uDEE4\uDEE5\uDEE7-\uDEED\uDEF0-\uDEF4\uDEFE\uDEFF\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEAD\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0\uDFF0-\uDFFF]|\uD87B[\uDC00-\uDE5D]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD88D[\uDC00-\uDC79])/))return;let i=r[1]||r[2]||"";if(!i||i&&(""===n||this.rules.inline.punctuation.exec(n))){let n,i,a=r[0].length-1,o=a,s=0,l="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(l.lastIndex=0,t=t.slice(-1*e.length+a);null!=(r=l.exec(t));){if(n=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!n)continue;if(i=n.length,r[3]||r[4]){o+=i;continue}if((r[5]||r[6])&&a%3&&!((a+i)%3)){s+=i;continue}if(o-=i,o>0)continue;if(i=Math.min(i,i+o+s),Math.min(a,i)%2){let t=e.slice(1,a+r.index+i);return{type:"em",raw:e.slice(0,a+r.index+i+1),text:t,tokens:this.lexer.inlineTokens(t)}}let t=e.slice(2,a+r.index+i-1);return{type:"strong",raw:e.slice(0,a+r.index+i+1),text:t,tokens:this.lexer.inlineTokens(t)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(/\n/g," "),n=/[^ ]/.test(e),r=/^ /.test(e)&&/ $/.test(e);return n&&r&&(e=e.substring(1,e.length-1)),e=_A(e,!0),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e,t){let n=this.rules.inline.autolink.exec(e);if(n){let e,r;return"@"===n[2]?(e=_A(this.options.mangle?t(n[1]):n[1]),r="mailto:"+e):(e=_A(n[1]),r=e),{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}url(e,t){let n;if(n=this.rules.inline.url.exec(e)){let e,r;if("@"===n[2])e=_A(this.options.mangle?t(n[0]):n[0]),r="mailto:"+e;else{let t;do{t=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(t!==n[0]);e=_A(n[0]),r="www."===n[1]?"http://"+e:e}return{type:"link",raw:n[0],text:e,href:r,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e,t){let n=this.rules.inline.text.exec(e);if(n){let e;return e=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):_A(n[0]):n[0]:_A(this.options.smartypants?t(n[0]):n[0]),{type:"text",raw:n[0],text:e}}}},(XA={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:KA,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/})._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/,XA._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/,XA.def=xA(XA.def).replace("label",XA._label).replace("title",XA._title).getRegex(),XA.bullet=/(?:[*+-]|\d{1,9}[.)])/,XA.listItemStart=xA(/^( *)(bull) */).replace("bull",XA.bullet).getRegex(),XA.list=xA(XA.list).replace(/bull/g,XA.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+XA.def.source+")").getRegex(),XA._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",XA._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,XA.html=xA(XA.html,"i").replace("comment",XA._comment).replace("tag",XA._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),XA.paragraph=xA(XA._paragraph).replace("hr",XA.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",XA._tag).getRegex(),XA.blockquote=xA(XA.blockquote).replace("paragraph",XA.paragraph).getRegex(),XA.normal=kA({},XA),XA.gfm=kA({},XA.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),XA.gfm.table=xA(XA.gfm.table).replace("hr",XA.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",XA._tag).getRegex(),XA.gfm.paragraph=xA(XA._paragraph).replace("hr",XA.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",XA.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",XA._tag).getRegex(),XA.pedantic=kA({},XA.normal,{html:xA("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",XA._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:KA,paragraph:xA(XA.normal._paragraph).replace("hr",XA.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",XA.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()}),($A={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:KA,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[^*]+(?=[^*])|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[^_]+(?=[^_])|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:KA,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/})._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",$A.punctuation=xA($A.punctuation).replace(/punctuation/g,$A._punctuation).getRegex(),$A.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,$A.escapedEmSt=/\\\*|\\_/g,$A._comment=xA(XA._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),$A.emStrong.lDelim=xA($A.emStrong.lDelim).replace(/punct/g,$A._punctuation).getRegex(),$A.emStrong.rDelimAst=xA($A.emStrong.rDelimAst,"g").replace(/punct/g,$A._punctuation).getRegex(),$A.emStrong.rDelimUnd=xA($A.emStrong.rDelimUnd,"g").replace(/punct/g,$A._punctuation).getRegex(),$A._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,$A._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,$A._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,$A.autolink=xA($A.autolink).replace("scheme",$A._scheme).replace("email",$A._email).getRegex(),$A._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,$A.tag=xA($A.tag).replace("comment",$A._comment).replace("attribute",$A._attribute).getRegex(),$A._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,$A._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,$A._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,$A.link=xA($A.link).replace("label",$A._label).replace("href",$A._href).replace("title",$A._title).getRegex(),$A.reflink=xA($A.reflink).replace("label",$A._label).replace("ref",XA._label).getRegex(),$A.nolink=xA($A.nolink).replace("ref",XA._label).getRegex(),$A.reflinkSearch=xA($A.reflinkSearch,"g").replace("reflink",$A.reflink).replace("nolink",$A.nolink).getRegex(),$A.normal=kA({},$A),$A.pedantic=kA({},$A.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:xA(/^!?\[(label)\]\((.*?)\)/).replace("label",$A._label).getRegex(),reflink:xA(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",$A._label).getRegex()}),$A.gfm=kA({},$A.normal,{escape:xA($A.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),$A.gfm.url=xA($A.gfm.url,"i").replace("email",$A.gfm._extended_email).getRegex(),$A.breaks=kA({},$A.gfm,{br:xA($A.br).replace("{2,}","*").getRegex(),text:xA($A.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()}),YA=class e{constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||zA,this.options.tokenizer=this.options.tokenizer||new GA,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={block:XA.normal,inline:$A.normal};this.options.pedantic?(t.block=XA.pedantic,t.inline=$A.pedantic):this.options.gfm&&(t.block=XA.gfm,this.options.breaks?t.inline=$A.breaks:t.inline=$A.gfm),this.tokenizer.rules=t}static get rules(){return{block:XA,inline:$A}}static lex(t,n){return new e(n).lex(t)}static lexInline(t,n){return new e(n).inlineTokens(t)}lex(e){let t;for(e=e.replace(/\r\n|\r/g,"\n"),this.blockTokens(e,this.tokens);t=this.inlineQueue.shift();)this.inlineTokens(t.src,t.tokens);return this.tokens}blockTokens(e){let t,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];for(e=this.options.pedantic?e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e.replace(/^( *)(\t+)/gm,(e,t,n)=>t+"    ".repeat(n.length));e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(n=>!!(t=n.call({lexer:this},e,a))&&(e=e.substring(t.raw.length),a.push(t),!0)))){if(t=this.tokenizer.space(e)){e=e.substring(t.raw.length),1===t.raw.length&&a.length>0?a[a.length-1].raw+="\n":a.push(t);continue}if(t=this.tokenizer.code(e)){e=e.substring(t.raw.length),n=a[a.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?a.push(t):(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue[this.inlineQueue.length-1].src=n.text);continue}if(t=this.tokenizer.fences(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.heading(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.hr(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.blockquote(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.list(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.html(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.def(e)){e=e.substring(t.raw.length),n=a[a.length-1],!n||"paragraph"!==n.type&&"text"!==n.type?this.tokens.links[t.tag]||(this.tokens.links[t.tag]={href:t.href,title:t.title}):(n.raw+="\n"+t.raw,n.text+="\n"+t.raw,this.inlineQueue[this.inlineQueue.length-1].src=n.text);continue}if(t=this.tokenizer.table(e)){e=e.substring(t.raw.length),a.push(t);continue}if(t=this.tokenizer.lheading(e)){e=e.substring(t.raw.length),a.push(t);continue}if(r=e,this.options.extensions&&this.options.extensions.startBlock){let t,n=1/0,i=e.slice(1);this.options.extensions.startBlock.forEach(function(e){t=e.call({lexer:this},i),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(r=e.substring(0,n+1))}if(this.state.top&&(t=this.tokenizer.paragraph(r))){n=a[a.length-1],i&&"paragraph"===n.type?(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):a.push(t),i=r.length!==e.length,e=e.substring(t.raw.length);continue}if(t=this.tokenizer.text(e)){e=e.substring(t.raw.length),n=a[a.length-1],n&&"text"===n.type?(n.raw+="\n"+t.raw,n.text+="\n"+t.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=n.text):a.push(t);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,a}inline(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e){let t,n,r,i,a,o,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],l=e;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(i=this.tokenizer.rules.inline.reflinkSearch.exec(l));)e.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(l=l.slice(0,i.index)+"["+PA("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(i=this.tokenizer.rules.inline.blockSkip.exec(l));)l=l.slice(0,i.index)+"["+PA("a",i[0].length-2)+"]"+l.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;null!=(i=this.tokenizer.rules.inline.escapedEmSt.exec(l));)l=l.slice(0,i.index)+"++"+l.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;e;)if(a||(o=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(n=>!!(t=n.call({lexer:this},e,s))&&(e=e.substring(t.raw.length),s.push(t),!0)))){if(t=this.tokenizer.escape(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.tag(e)){e=e.substring(t.raw.length),n=s[s.length-1],n&&"text"===t.type&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):s.push(t);continue}if(t=this.tokenizer.link(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(t.raw.length),n=s[s.length-1],n&&"text"===t.type&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):s.push(t);continue}if(t=this.tokenizer.emStrong(e,l,o)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.codespan(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.br(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.del(e)){e=e.substring(t.raw.length),s.push(t);continue}if(t=this.tokenizer.autolink(e,TA)){e=e.substring(t.raw.length),s.push(t);continue}if(!this.state.inLink&&(t=this.tokenizer.url(e,TA))){e=e.substring(t.raw.length),s.push(t);continue}if(r=e,this.options.extensions&&this.options.extensions.startInline){let t,n=1/0,i=e.slice(1);this.options.extensions.startInline.forEach(function(e){t=e.call({lexer:this},i),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(r=e.substring(0,n+1))}if(t=this.tokenizer.inlineText(r,IA)){e=e.substring(t.raw.length),"_"!==t.raw.slice(-1)&&(o=t.raw.slice(-1)),a=!0,n=s[s.length-1],n&&"text"===n.type?(n.raw+=t.raw,n.text+=t.text):s.push(t);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return s}},JA=class{constructor(e){this.options=e||zA}code(e,t,n){let r=(t||"").match(/\S*/)[0];if(this.options.highlight){let t=this.options.highlight(e,r);null!=t&&t!==e&&(n=!0,e=t)}return e=e.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+_A(r,!0)+'">'+(n?e:_A(e,!0))+"</code></pre>\n":"<pre><code>"+(n?e:_A(e,!0))+"</code></pre>\n"}blockquote(e){return"<blockquote>\n".concat(e,"</blockquote>\n")}html(e){return e}heading(e,t,n,r){if(this.options.headerIds){let i=this.options.headerPrefix+r.slug(n);return"<h".concat(t,' id="').concat(i,'">').concat(e,"</h").concat(t,">\n")}return"<h".concat(t,">").concat(e,"</h").concat(t,">\n")}hr(){return this.options.xhtml?"<hr/>\n":"<hr>\n"}list(e,t,n){let r=t?"ol":"ul";return"<"+r+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+r+">\n"}listitem(e){return"<li>".concat(e,"</li>\n")}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(e){return"<p>".concat(e,"</p>\n")}table(e,t){return t&&(t="<tbody>".concat(t,"</tbody>")),"<table>\n<thead>\n"+e+"</thead>\n"+t+"</table>\n"}tablerow(e){return"<tr>\n".concat(e,"</tr>\n")}tablecell(e,t){let n=t.header?"th":"td";return(t.align?"<".concat(n,' align="').concat(t.align,'">'):"<".concat(n,">"))+e+"</".concat(n,">\n")}strong(e){return"<strong>".concat(e,"</strong>")}em(e){return"<em>".concat(e,"</em>")}codespan(e){return"<code>".concat(e,"</code>")}br(){return this.options.xhtml?"<br/>":"<br>"}del(e){return"<del>".concat(e,"</del>")}link(e,t,n){if(null===(e=wA(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<a href="'+_A(e)+'"';return t&&(r+=' title="'+t+'"'),r+=">"+n+"</a>",r}image(e,t,n){if(null===(e=wA(this.options.sanitize,this.options.baseUrl,e)))return n;let r='<img src="'.concat(e,'" alt="').concat(n,'"');return t&&(r+=' title="'.concat(t,'"')),r+=this.options.xhtml?"/>":">",r}text(e){return e}},QA=class{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}},ez=class{constructor(){this.seen={}}serialize(e){return e.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(e,t){let n=e,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[e];do{r++,n=e+"-"+r}while(this.seen.hasOwnProperty(n))}return t||(this.seen[e]=r,this.seen[n]=0),n}slug(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serialize(e);return this.getNextSafeSlug(n,t.dryrun)}},tz=class e{constructor(e){this.options=e||zA,this.options.renderer=this.options.renderer||new JA,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new QA,this.slugger=new ez}static parse(t,n){return new e(n).parse(t)}static parseInline(t,n){return new e(n).parseInline(t)}parse(e){let t,n,r,i,a,o,s,l,u,c,d,h,f,p,m,g,y,v,_,b=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],x="",w=e.length;for(t=0;t<w;t++)if(c=e[t],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[c.type]&&(_=this.options.extensions.renderers[c.type].call({parser:this},c),!1!==_||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)))x+=_||"";else switch(c.type){case"space":continue;case"hr":x+=this.renderer.hr();continue;case"heading":x+=this.renderer.heading(this.parseInline(c.tokens),c.depth,bA(this.parseInline(c.tokens,this.textRenderer)),this.slugger);continue;case"code":x+=this.renderer.code(c.text,c.lang,c.escaped);continue;case"table":for(l="",s="",i=c.header.length,n=0;n<i;n++)s+=this.renderer.tablecell(this.parseInline(c.header[n].tokens),{header:!0,align:c.align[n]});for(l+=this.renderer.tablerow(s),u="",i=c.rows.length,n=0;n<i;n++){for(o=c.rows[n],s="",a=o.length,r=0;r<a;r++)s+=this.renderer.tablecell(this.parseInline(o[r].tokens),{header:!1,align:c.align[r]});u+=this.renderer.tablerow(s)}x+=this.renderer.table(l,u);continue;case"blockquote":u=this.parse(c.tokens),x+=this.renderer.blockquote(u);continue;case"list":for(d=c.ordered,h=c.start,f=c.loose,i=c.items.length,u="",n=0;n<i;n++)m=c.items[n],g=m.checked,y=m.task,p="",m.task&&(v=this.renderer.checkbox(g),f?m.tokens.length>0&&"paragraph"===m.tokens[0].type?(m.tokens[0].text=v+" "+m.tokens[0].text,m.tokens[0].tokens&&m.tokens[0].tokens.length>0&&"text"===m.tokens[0].tokens[0].type&&(m.tokens[0].tokens[0].text=v+" "+m.tokens[0].tokens[0].text)):m.tokens.unshift({type:"text",text:v}):p+=v),p+=this.parse(m.tokens,f),u+=this.renderer.listitem(p,y,g);x+=this.renderer.list(u,d,h);continue;case"html":x+=this.renderer.html(c.text);continue;case"paragraph":x+=this.renderer.paragraph(this.parseInline(c.tokens));continue;case"text":for(u=c.tokens?this.parseInline(c.tokens):c.text;t+1<w&&"text"===e[t+1].type;)c=e[++t],u+="\n"+(c.tokens?this.parseInline(c.tokens):c.text);x+=b?this.renderer.paragraph(u):u;continue;default:{let e='Token with "'+c.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return x}parseInline(e,t){t=t||this.renderer;let n,r,i,a="",o=e.length;for(n=0;n<o;n++)if(r=e[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(i=this.options.extensions.renderers[r.type].call({parser:this},r),!1!==i||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)))a+=i||"";else switch(r.type){case"escape":case"text":a+=t.text(r.text);break;case"html":a+=t.html(r.text);break;case"link":a+=t.link(r.href,r.title,this.parseInline(r.tokens,t));break;case"image":a+=t.image(r.href,r.title,r.text);break;case"strong":a+=t.strong(this.parseInline(r.tokens,t));break;case"em":a+=t.em(this.parseInline(r.tokens,t));break;case"codespan":a+=t.codespan(r.text);break;case"br":a+=t.br();break;case"del":a+=t.del(this.parseInline(r.tokens,t));break;default:{let e='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(e);throw new Error(e)}}return a}},AA.options=AA.setOptions=function(e){return kA(AA.defaults,e),function(e){zA=e}(AA.defaults),AA},AA.getDefaults=vA,AA.defaults=zA,AA.use=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];let r,i=kA({},...t),a=AA.defaults.extensions||{renderers:{},childTokens:{}};t.forEach(e=>{if(e.extensions&&(r=!0,e.extensions.forEach(e=>{if(!e.name)throw new Error("extension name required");if(e.renderer){let t=a.renderers?a.renderers[e.name]:null;a.renderers[e.name]=t?function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];let a=e.renderer.apply(this,r);return!1===a&&(a=t.apply(this,r)),a}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");a[e.level]?a[e.level].unshift(e.tokenizer):a[e.level]=[e.tokenizer],e.start&&("block"===e.level?a.startBlock?a.startBlock.push(e.start):a.startBlock=[e.start]:"inline"===e.level&&(a.startInline?a.startInline.push(e.start):a.startInline=[e.start]))}e.childTokens&&(a.childTokens[e.name]=e.childTokens)})),e.renderer){let t=AA.defaults.renderer||new JA;for(let n in e.renderer){let r=t[n];t[n]=function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];let s=e.renderer[n].apply(t,a);return!1===s&&(s=r.apply(t,a)),s}}i.renderer=t}if(e.tokenizer){let t=AA.defaults.tokenizer||new GA;for(let n in e.tokenizer){let r=t[n];t[n]=function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];let s=e.tokenizer[n].apply(t,a);return!1===s&&(s=r.apply(t,a)),s}}i.tokenizer=t}if(e.walkTokens){let t=AA.defaults.walkTokens;i.walkTokens=function(n){let r=[];return r.push(e.walkTokens.call(this,n)),t&&(r=r.concat(t.call(this,n))),r}}r&&(i.extensions=a),AA.setOptions(i)})},AA.walkTokens=function(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(AA,r)),r.type){case"table":for(let e of r.header)n=n.concat(AA.walkTokens(e.tokens,t));for(let e of r.rows)for(let r of e)n=n.concat(AA.walkTokens(r.tokens,t));break;case"list":n=n.concat(AA.walkTokens(r.items,t));break;default:AA.defaults.extensions&&AA.defaults.extensions.childTokens&&AA.defaults.extensions.childTokens[r.type]?AA.defaults.extensions.childTokens[r.type].forEach(function(e){n=n.concat(AA.walkTokens(r[e],t))}):r.tokens&&(n=n.concat(AA.walkTokens(r.tokens,t)))}return n},AA.parseInline=function(e,t){if("undefined"==typeof e||null===e)throw new Error("marked.parseInline(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");CA(t=kA({},AA.defaults,t||{}));try{let n=YA.lexInline(e,t);return t.walkTokens&&AA.walkTokens(n,t.walkTokens),tz.parseInline(n,t)}catch(n){if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",t.silent)return"<p>An error occurred:</p><pre>"+_A(n.message+"",!0)+"</pre>";throw n}},AA.Parser=tz,AA.parser=tz.parse,AA.Renderer=JA,AA.TextRenderer=QA,AA.Lexer=YA,AA.lexer=YA.lex,AA.Tokenizer=GA,AA.Slugger=ez,AA.parse=AA,AA.options,AA.setOptions,AA.use,AA.walkTokens,AA.parseInline,tz.parse,YA.lex}),Rz=k(()=>{Zp(),pA(),rz=Wp(MT)(nz||(nz=I(["\n  padding: 6px;\n"]))),iz=rz}),Lz=k(()=>{az=P(Oh()),yA(),Zp(),Cv(),Qh(),M(),Bz(),fA(),Rz(),oz=e=>{let{title:t,message:n}=e;return"".concat(t," ").concat(n)},sz=(()=>{let e=new Map;return{add:t=>{let n=oz(t);e.has(n)?e.set(n,e.get(n)+1):e.set(n,1)},delete:t=>{let n=oz(t);e.has(n)&&e.get(n)>1?e.set(n,e.get(n)-1):e.delete(n)},clear:()=>{e.clear()},check:t=>e.has(oz(t))}})(),lz=(()=>{let e=new Map;return{add:t=>{e.has(t)?e.set(t,e.get(t)+1):e.set(t,1)},delete:t=>{e.has(t)&&e.get(t)>1?e.set(t,e.get(t)-1):e.delete(t)},clear:()=>{e.clear()},check:t=>e.has(t),get types(){return Array.of(...e.keys())}}})(),cz=Wp.div(uz||(uz=I(["\n  width: 100%;\n  border-radius: 4px;\n  display: flex;\n  gap: 12px;\n  ",";\n  background-color: rgba(40, 43, 47, 0.8);\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);\n  backdrop-filter: blur(14px);\n\n  @supports not (backdrop-filter: blur()) {\n    background: rgba(40, 43, 47, 0.95);\n  }\n"])),av),hz=Wp.div(dz||(dz=I(["\n  font-size: 14px;\n  font-weight: bold;\n  color: #fff;\n"]))),pz=Wp.div(fz||(fz=I(["\n  flex: 1;\n  flex-direction: column;\n  width: 0;\n  display: flex;\n  padding: 16px 0;\n  gap: 12px;\n"]))),gz=Wp.div(mz||(mz=I(["\n  color: #b4b4b4;\n  font-size: 12px;\n  line-height: 1.4;\n\n  a {\n    color: rgba(255, 255, 255, 0.9);\n  }\n\n  em {\n    font-style: italic;\n  }\n\n  strong {\n    font-weight: bold;\n    color: #d5d5d5;\n  }\n\n  p {\n    margin-bottom: 8px;\n  }\n\n  code {\n    font-family: monospace;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 1px 1px 2px;\n    border-radius: 4px;\n    border: 1px solid rgba(255, 255, 255, 0.08);\n    white-space: pre-wrap;\n  }\n\n  pre > code {\n    white-space: pre;\n    display: block;\n    overflow: auto;\n    padding: 4px;\n  }\n\n  pre {\n    white-space: pre-wrap;\n    margin-bottom: 8px;\n  }\n"]))),vz=Wp.button(yz||(yz=I(["\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 500;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: none;\n  border: none;\n  padding-left: 12px;\n  padding-right: 12px;\n  border-left: 1px solid rgba(255, 255, 255, 0.05);\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.05);\n  }\n"]))),_z={info:"#3b82f6",success:"#10b981",warning:"#f59e0b",error:"#ef4444"},xz=Wp.div(bz||(bz=I(["\n  display: flex;\n  justify-content: center;\n  margin-left: 12px;\n  padding-top: 21px;\n\n  ::before {\n    content: '';\n    width: 8px;\n    height: 8px;\n    border-radius: 999999px;\n    background-color: ",";\n  }\n"])),e=>{let{type:t}=e;return _z[t]}),wz=e=>function(t,n){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];(arguments.length>3&&void 0!==arguments[3]&&arguments[3]||!sz.check({title:t,message:n}))&&(sz.add({title:t,message:n}),lz.add(e),hA.custom(i=>az.default.createElement(cz,null,az.default.createElement(xz,{type:e}),az.default.createElement(pz,null,az.default.createElement(hz,null,t),az.default.createElement(gz,{dangerouslySetInnerHTML:{__html:AA.parse(n)}}),r.length>0&&az.default.createElement(gz,null,az.default.createElement("span",null,"Docs:"," ",r.map((e,t)=>az.default.createElement(az.Fragment,{key:t},t>0&&", ",az.default.createElement("a",{target:"_blank",href:e.url},e.title)))))),az.default.createElement(vz,{onClick:()=>{hA.remove(i.id),sz.delete({title:t,message:n}),lz.delete(e)}},"Close")),{duration:1/0}))},kz={warning:wz("warning"),success:wz("success"),info:wz("info"),error:wz("error")},Ez=Wp.div(Sz||(Sz=I(["\n  display: flex;\n  justify-content: ",";\n  gap: 12px;\n"])),e=>{let{align:t}=e;return"center"===t?"center":"flex-end"}),Pz=Wp.button(Cz||(Cz=I(["\n  position: relative;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  ",";\n  background-color: rgba(40, 43, 47, 0.8);\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);\n  backdrop-filter: blur(14px);\n  border: none;\n  padding: 12px;\n  color: #fff;\n  overflow: hidden;\n\n  ::before {\n    content: '';\n    position: absolute;\n    inset: 0;\n  }\n\n  :hover::before {\n    background: ",";\n  }\n\n  @supports not (backdrop-filter: blur()) {\n    background: rgba(40, 43, 47, 0.95);\n  }\n"])),av,e=>{let{danger:t}=e;return t?"rgba(255, 0, 0, 0.1)":"rgba(255, 255, 255, 0.1)"}),Iz=Wp.div(Dz||(Dz=I(["\n  z-index: 10;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  position: fixed;\n  right: 92px;\n  top: 50px;\n  width: 500px;\n  height: 85vh;\n  min-height: 400px;\n"]))),Az=Wp.div(Tz||(Tz=I(["\n  overflow: hidden;\n  pointer-events: auto;\n  border-radius: 4px;\n\n  & > div {\n    display: flex;\n    flex-direction: column-reverse;\n    gap: 8px;\n    overflow: scroll;\n    height: 100%;\n  }\n"]))),Oz=Wp.div(zz||(zz=I(["\n  width: fit-content;\n  padding: 8px;\n  border-radius: 4px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n  color: #b4b4b4;\n  font-size: 12px;\n  line-height: 1.4;\n"]))),Fz=()=>{let{hasNotifications:e}=jz();return DT({enabled:!e},()=>az.default.createElement(iz,null,az.default.createElement(Oz,null,az.default.createElement(hz,null,"No notifications"),"Notifications will appear here when you get them.")))},Mz=()=>{var e;let{toasts:t,handlers:n}=dA(),{startPause:r,endPause:i}=n,a=null!=(e=Wh(O().atomP.ahistoric.pinNotifications))&&e;return az.default.createElement(Iz,null,a?t.length>0&&az.default.createElement(Az,{onMouseEnter:r,onMouseLeave:i},az.default.createElement("div",null,t.map(e=>az.default.createElement("div",{key:e.id},e.message(e))))):null,az.default.createElement(Ez,{align:"side"},a&&t.length>0&&az.default.createElement(Pz,{onClick:()=>{lz.clear(),sz.clear(),hA.remove()},danger:!0},"Clear")))},jz=()=>{let{toasts:e}=dA();return{hasNotifications:e.length>0}}});function Nz(e,t){var n;let r=Object.values(null!=(n=(0,Uz.val)(e.pointers.historic.sheetsById))?n:{}),i=r.flatMap(e=>{var t;return Object.values(null!=(t=null==e?void 0:e.staticOverrides.byObject)?t:{})}).flatMap(e=>Object.values(null!=e?e:{})),a=[...r.flatMap(e=>{var t,n;return Object.values(null!=(n=null==(t=null==e?void 0:e.sequence)?void 0:t.tracksByObject)?n:{})}).flatMap(e=>{var t;return Object.values(null!=(t=null==e?void 0:e.trackData)?t:{})}).flatMap(e=>null==e?void 0:e.keyframes).map(e=>null==e?void 0:e.value)];return i.forEach(e=>{j(e,e=>{a.push(e)},[])}),a.filter(e=>(null==e?void 0:e.type)&&(t?(null==e?void 0:e.type)==t:"string"==typeof(null==e?void 0:e.type))).map(e=>e.id).filter((e,t,n)=>null!==e&&""!==e&&n.indexOf(e)===t)}var Uz,Vz=k(()=>{Uz=n(194),L()});function qz(e,t){let n=new File([e],t),r=URL.createObjectURL(n),i=Object.assign(document.createElement("a"),{href:r,target:"_blank",rel:"noopener"});i.setAttribute("download",t),i.click(),setTimeout(()=>{URL.revokeObjectURL(r)},4e4)}var Hz,Wz,Zz,Kz,Gz,Xz,$z,Yz,Jz,Qz,eO,tO,nO,rO,iO,aO,oO,sO,lO,uO=k(()=>{M(),ME(),OE(),Hz=P(Oh()),Zp(),gT(),mA(),Wz=P(gA()),Lz(),Vz(),Kz=Wp.div(Zz||(Zz=I([""]))),Xz=Wp.div(Gz||(Gz=I(["\n  padding: 8px 10px;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n"]))),Yz=Wp(zE)($z||($z=I(["\n  display flex;\n  flex-direction: column;\n  gap: 1em;\n  width: 280px;\n  padding: 1em;\n"]))),Jz=e=>{let{projects:t}=e,n=t[0],r=n.address.projectId,i=r.replace(/[^\w\d'_\-]+/g," ").trim(),a="".concat(i,".theatre-project-state.json"),[o,s]=(0,Hz.useState)(!1),l=(0,Hz.useCallback)(()=>T(void 0,null,function*(){var e,t;let r=Nz(n),o=new Map;try{yield Promise.all(r.map(e=>T(void 0,null,function*(){let t=n.assetStorage.getAssetUrl(e),r=yield fetch(t);r.ok&&o.set(e,yield r.blob())})))}catch(l){return void kz.error("Failed to access assets","Export aborted. Failed to access assets at ".concat(null!=(t=null==(e=n.config.assets)?void 0:e.baseUrl)?t:"/",". This is likely due to a CORS issue."))}if(o.size>0){let e=new Wz.default;for(let[t,n]of o)e.file(t,n);qz(yield e.generateAsync({type:"blob"}),"".concat(i,".assets.zip"))}qz(JSON.stringify(O().createContentOfSaveFile(n.address.projectId),null,2),a),s(!0),setTimeout(()=>{s(!1)},2e3)}),[n,a]),u=cE({debugName:"ProjectDetails",pointerDistanceThreshold:50},()=>Hz.default.createElement(Yz,null,Hz.default.createElement("p",null,"This will create a JSON file with the state of your project. You can commit this file to your git repo and include it in your production bundle."),Hz.default.createElement("p",null,"If your project uses assets, this will also create a zip file with all the assets that you can unpack in your public folder."),Hz.default.createElement("a",{href:"https://www.theatrejs.com/docs/latest/manual/projects#state",target:"_blank"},"Here is a quick guide on how to export to production.")));return Hz.default.createElement(Hz.default.Fragment,null,u.node,Hz.default.createElement(Kz,null,Hz.default.createElement(WT,{projectId:r}),Hz.default.createElement(Xz,null,Hz.default.createElement(hT,{onMouseEnter:e=>u.open(e,e.target),onClick:o?void 0:l,disabled:o},o?"(Exported)":"Export ".concat(r," to JSON")))))}}),cO=k(()=>{Qz=P(Oh()),Zp(),x_(),tO=Wp.div(eO||(eO=I(["\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  gap: 24px;\n"]))),rO=Wp.div(nO||(nO=I(["\n  display: flex;\n  flex-direction: column;\n  gap: 11px;\n  color: rgba(255, 255, 255, 0.9);\n"]))),aO=Wp.div(iO||(iO=I(["\n  color: rgba(145, 145, 145, 0.8);\n"]))),sO=Wp.a(oO||(oO=I(["\n  color: #919191;\n  font-size: 10px;\n  text-decoration-color: #40434a;\n  text-underline-offset: 3px;\n"]))),lO=()=>Qz.default.createElement(tO,null,Qz.default.createElement(rO,null,Qz.default.createElement(aO,null,Qz.default.createElement(Av,null)),Qz.default.createElement("div",null,"Please select an object from the ",Qz.default.createElement("u",null,"Outline Menu")," to see its properties.")),Qz.default.createElement(sO,{href:"https://www.theatrejs.com/docs/latest/manual/objects",target:"_blank"},"Learn more about Objects"))});function dO(){let[e,t]=(0,hO.useState)(!1);return[e,(0,hO.useMemo)(()=>{let e=new Set;return()=>{let n=()=>{e.delete(n),t(e.size>0)};return e.add(n),t(!0),n}},[])]}var hO,fO,pO,mO,gO,yO,vO,_O,bO,xO,wO,kO,SO,EO,CO,PO,DO,IO,TO,AO,zO,OO,FO,MO,jO,BO,RO,LO,NO,UO,VO,qO,HO,WO,ZO,KO,GO,XO,$O,YO,JO,QO,eF,tF,nF,rF,iF,aF,oF,sF,lF,uF,cF,dF,hF,fF,pF,mF,gF,yF,vF,_F,bF,xF,wF,kF,SF,EF,CF,PF,DF,IF,TF,AF,zF,OF,FF,MF,jF,BF,RF,LF,NF,UF,VF,qF=k(()=>{hO=P(Oh())}),HF=k(()=>{D_(),Qh(),fO=P(Oh()),Zp(),ne(),Pv(),Cv(),mT(),uO(),M(),Ob(),pO=n(194),cO(),qF(),dD(),gO=Wp.div(mO||(mO=I(["\n  ",";\n  background-color: rgba(40, 43, 47, 0.8);\n  position: fixed;\n  right: 8px;\n  top: 50px;\n  // Temporary, see comment about CSS grid in SingleRowPropEditor.\n  width: 280px;\n  height: fit-content;\n  z-index: ",";\n\n  box-shadow: 0 1px 1px rgba(0, 0, 0, 0.25), 0 2px 6px rgba(0, 0, 0, 0.15);\n  backdrop-filter: blur(14px);\n  border-radius: 2px;\n\n  display: ",";\n\n  &:hover {\n    display: block;\n  }\n\n  @supports not (backdrop-filter: blur()) {\n    background: rgba(40, 43, 47, 0.95);\n  }\n"])),av,fv.propsPanel,e=>{let{pin:t}=e;return t?"block":"none"}),vO=Wp.div(yO||(yO=I(["\n  margin: 0 10px;\n  color: #919191;\n  font-weight: 500;\n  font-size: 10px;\n  user-select: none;\n  ",";\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"])),av),bO=Wp.div(_O||(_O=I(["\n  height: ",";\n  display: flex;\n  align-items: center;\n"])),"32px"),wO=Wp.div(xO||(xO=I(["\n  ",";\n  max-height: calc(100vh - 100px);\n  overflow-y: scroll;\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  scrollbar-width: none;\n  padding: 0;\n  user-select: none;\n\n  /* Set the font-size for input values in the detail panel */\n  font-size: 12px;\n"])),av),kO=(0,fO.createContext)([!1,()=>()=>{}]),SO=e=>{let t=!1!==Wh(O().atomP.ahistoric.pinDetails),n=_b("right");(0,fO.useLayoutEffect)(()=>{CO.set(n)},[n]),(0,fO.useEffect)(()=>()=>{PO.set(!1),CO.set(!1)},[]);let[r]=(0,fO.useContext)(kO),i=t||n||r,[a,o]=(0,fO.useState)(null);return DP(a),Rh(()=>{let e=S_(),t=e.find(H);if(t)return fO.default.createElement(gO,{"data-testid":"DetailPanel-Object",pin:i,ref:o,onMouseEnter:()=>{PO.set(!0)},onMouseLeave:()=>{PO.set(!1)}},fO.default.createElement(bO,null,fO.default.createElement(vO,{title:"".concat(t.sheet.address.sheetId,": ").concat(t.sheet.address.sheetInstanceId," > ").concat(t.address.objectKey)},fO.default.createElement(gv,null,t.sheet.address.sheetId," "),fO.default.createElement(vv,null,":","\xa0"),fO.default.createElement(gv,null,t.sheet.address.sheetInstanceId," "),fO.default.createElement(vv,null,"\xa0\u2192\xa0"),fO.default.createElement(gv,null,t.address.objectKey))),fO.default.createElement(wO,null,fO.default.createElement(uT,{objects:[t]})));let n=e.find(U);return n?fO.default.createElement(gO,{pin:i},fO.default.createElement(bO,null,fO.default.createElement(vO,{title:"".concat(n.address.projectId)},fO.default.createElement(gv,null,n.address.projectId," "))),fO.default.createElement(wO,null,fO.default.createElement(Jz,{projects:[n]}))):fO.default.createElement(gO,{pin:i,onMouseEnter:()=>{PO.set(!0)},onMouseLeave:()=>{PO.set(!1)}},fO.default.createElement(lO,null))},[i])},EO=()=>{let e=dO();return fO.default.createElement(kO.Provider,{value:e},fO.default.createElement(SO,null))},CO=new pO.Atom(!1),PO=new pO.Atom(!1),(0,pO.prism)(()=>{let e=(0,pO.val)(PO.prism),t=(0,pO.val)(CO.prism);return e||t})}),WF=k(()=>{DO=n(194),Qh(),M(),qF(),IO=P(Oh()),YS(),TO=(e,t)=>{let n=e.left/t.width,r=(e.left+e.width)/t.width,i=e.top/t.height,a=(e.height+e.top)/t.height;return{edges:{left:n<=.5?{from:"screenLeft",distance:n}:{from:"screenRight",distance:1-n},right:r<=.5?{from:"screenLeft",distance:r}:{from:"screenRight",distance:1-r},top:i<=.5?{from:"screenTop",distance:i}:{from:"screenBottom",distance:1-i},bottom:a<=.5?{from:"screenTop",distance:a}:{from:"screenBottom",distance:1-a}}}},AO=IO.default.createContext(null),zO=()=>(0,IO.useContext)(AO),OO=e=>{let{panelId:t,children:n,defaultPosition:r,minDims:i}=e,a=XS(800,200),[o,s]=dO(),{stuff:l}=Rh(()=>{var e;let{edges:n}=null!=(e=(0,DO.val)(O().atomP.historic.panelPositions[t]))?e:r,l=Math.floor(a.width*("screenLeft"===n.left.from?n.left.distance:1-n.left.distance)),u=Math.floor(a.width*("screenLeft"===n.right.from?n.right.distance:1-n.right.distance)),c=Math.floor(a.height*("screenTop"===n.top.from?n.top.distance:1-n.top.distance)),d=Math.floor(a.height*("screenTop"===n.bottom.from?n.bottom.distance:1-n.bottom.distance)),h=Math.max(u-l,i.width),f=Math.max(d-c,i.height);return{stuff:{dims:DO.prism.memo("dims",()=>({width:h,left:l,top:c,height:f}),[h,l,c,f]),panelId:t,minDims:i,boundsHighlighted:o,addBoundsHighlightLock:s}}},[t,a,o,s]);return IO.default.createElement(AO.Provider,{value:l},n)}}),ZF=k(()=>{tv(),M(),bx(),FO=P(Oh()),Zp(),WF(),nx(),Th(),Pv(),jO=Wp.div(MO||(MO=I(["\n  cursor: move;\n"]))),BO=e=>{let t=zO(),n=(0,FO.useRef)(t);n.current=t;let[r,i]=Qy(null),a=(0,FO.useMemo)(()=>({debugName:"PanelDragZone",lockCursorTo:"move",onDragStart(){let e,r=n.current,i=t.addBoundsHighlightLock();return{onDrag(t,n){let i=x(b({},r.dims),{top:ms(r.dims.top+n,0,window.innerHeight-Sv),left:ms(r.dims.left+t,-r.dims.width+Sv,window.innerWidth-Sv)}),a=TO(i,{width:window.innerWidth,height:window.innerHeight});null==e||e.discard(),e=O().tempTransaction(e=>{let{stateEditors:t}=e;t.studio.historic.panelPositions.setPanelPosition({position:a,panelId:r.panelId})})},onDragEnd(t){i(),t?null==e||e.commit():null==e||e.discard()}}}}),[]),[o]=gx(i,a);Qb(o,"dragging","move");let[s,l]=(0,FO.useMemo)(()=>{let e;return[function(){if(e){let t=e;e=void 0,t()}e=t.addBoundsHighlightLock()},function(){if(e){let t=e;e=void 0,t()}}]},[]);return FO.default.createElement(jO,x(b({},e),{ref:r,onMouseEnter:s,onMouseLeave:l}))}}),KF=k(()=>{tv(),M(),bx(),Ym(),RO=P(Oh()),Zp(),WF(),Cv(),Th(),Pv(),NO=Wp.div(LO||(LO=I(["\n  position: absolute;\n  ",";\n  &:after {\n    position: absolute;\n    inset: -5px;\n    display: block;\n    content: ' ';\n  }\n\n  opacity: 0;\n  background-color: #478698;\n\n  &.isHighlighted {\n    opacity: 0.7;\n  }\n\n  &.isDragging {\n    opacity: 1;\n    /* background-color: ","; */\n  }\n\n  &:hover {\n    opacity: 1;\n  }\n"])),av,Km(.2,"#478698")),VO=Wp(NO)(UO||(UO=I(["\n  /**\n  The horizintal/vertical resize handles have z-index:-1 and are offset 1px outside of the panel\n  to make sure they don't occlude any element that pops out of the panel (like the Playhead in SequenceEditorPanel).\n\n  This means that panels will always need an extra 1px margin for their resize handles to be visible, but that's not a problem\n  that we have to deal with right now (if it is at all a problem).\n  \n   */\n  z-index: -1;\n"]))),HO=Wp(VO)(qO||(qO=I(["\n  left: 0px;\n  right: 0px;\n  height: 1px;\n"]))),ZO=Wp(HO)(WO||(WO=I(["\n  top: -1px;\n"]))),GO=Wp(HO)(KO||(KO=I(["\n  bottom: -1px;\n"]))),$O=Wp(VO)(XO||(XO=I(["\n  z-index: -1;\n  top: -1px;\n  bottom: -1px;\n  width: 1px;\n"]))),JO=Wp($O)(YO||(YO=I(["\n  left: -1px;\n"]))),eF=Wp($O)(QO||(QO=I(["\n  right: -1px;\n"]))),nF=Wp(NO)(tF||(tF=I(["\n  // The angles have z-index: 10 to make sure they _do_ occlude other elements in the panel.\n  z-index: 10;\n  width: 8px;\n  height: 8px;\n"]))),iF=Wp(nF)(rF||(rF=I(["\n  top: 0;\n  left: 0;\n"]))),oF=Wp(nF)(aF||(aF=I(["\n  top: 0;\n  right: 0;\n"]))),lF=Wp(nF)(sF||(sF=I(["\n  bottom: 0;\n  left: 0;\n"]))),cF=Wp(nF)(uF||(uF=I(["\n  bottom: 0;\n  right: 0;\n"]))),dF={Top:ZO,TopLeft:iF,TopRight:oF,Bottom:GO,BottomLeft:lF,BottomRight:cF,Left:JO,Right:eF},hF={Top:"ns-resize",Bottom:"ns-resize",Left:"ew-resize",Right:"ew-resize",TopLeft:"nw-resize",TopRight:"ne-resize",BottomLeft:"sw-resize",BottomRight:"se-resize"},fF=e=>{let{which:t}=e,n=zO(),r=(0,RO.useRef)(n);r.current=n;let[i,a]=Qy(null),o=(0,RO.useMemo)(()=>({debugName:"PanelResizeHandle",lockCursorTo:hF[t],onDragStart(){let e,i=r.current,a=n.addBoundsHighlightLock();return{onDrag(n,r){let a=b({},i.dims);if(t.startsWith("Bottom"))a.height=Math.max(a.height+r,i.minDims.height);else if(t.startsWith("Top")){let e=a.top+a.height,t=ms(a.top+r,0,Math.min(e-i.minDims.height,window.innerHeight-Sv)),n=e-t;a.height=n,a.top=t}if(t.endsWith("Left")){let e=a.left+a.width,t=Math.min(a.left+n,Math.min(e-i.minDims.width,window.innerWidth-Sv)),r=e-t;a.width=r,a.left=t}else t.endsWith("Right")&&(a.width=Math.max(a.width+n,Math.max(i.minDims.width,Sv-i.dims.left)));let o=TO(a,{width:window.innerWidth,height:window.innerHeight});null==e||e.discard(),e=O().tempTransaction(e=>{let{stateEditors:t}=e;t.studio.historic.panelPositions.setPanelPosition({position:o,panelId:i.panelId})})},onDragEnd(t){a(),t?null==e||e.commit():null==e||e.discard()}}}}),[t]),[s]=gx(a,o),l=dF[t],u=t.length<=6;return RO.default.createElement(l,{ref:i,className:[s?"isDragging":"",n.boundsHighlighted&&u?"isHighlighted":""].join(" "),style:{cursor:hF[t]}})}}),GF=k(()=>{pF=P(Oh()),KF(),mF=e=>pF.default.createElement(pF.default.Fragment,null,pF.default.createElement(fF,{which:"Bottom"}),pF.default.createElement(fF,{which:"Top"}),pF.default.createElement(fF,{which:"Left"}),pF.default.createElement(fF,{which:"Right"}),pF.default.createElement(fF,{which:"TopLeft"}),pF.default.createElement(fF,{which:"TopRight"}),pF.default.createElement(fF,{which:"BottomLeft"}),pF.default.createElement(fF,{which:"BottomRight"}))}),XF=k(()=>{Cv(),gF=P(Oh()),Zp(),WF(),GF(),vF=Wp.div(yF||(yF=I(["\n  position: absolute;\n  user-select: none;\n  box-sizing: border-box;\n  ",";\n  /* box-shadow: 1px 2px 10px -5px black; */\n\n  z-index: 1000;\n"])),av),_F=gF.default.forwardRef((e,t)=>{let n=zO(),r=e,{style:i,children:a}=r,o=w(r,["style","children"]);return gF.default.createElement(vF,x(b({ref:t},o),{style:b({width:n.dims.width+"px",height:n.dims.height+"px",top:n.dims.top+"px",left:n.dims.left+"px"},null!=i?i:{})}),gF.default.createElement(mF,null),a)}),bF=_F}),$F=S((o,s)=>{var l;l=function(e,t){var n=function(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}}),t.default=e,Object.freeze(t)}(t);function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var i={error:null},a=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state=i,t.updatedWithError=!1,t.resetErrorBoundary=function(){for(var e,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];null==t.props.onReset||(e=t.props).onReset.apply(e,r),t.reset()},t}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var a=t.prototype;return a.reset=function(){this.updatedWithError=!1,this.setState(i)},a.componentDidCatch=function(e,t){var n,r;null==(n=(r=this.props).onError)||n.call(r,e,t)},a.componentDidMount=function(){null!==this.state.error&&(this.updatedWithError=!0)},a.componentDidUpdate=function(e){var t,n,r=this.state.error,i=this.props.resetKeys;null===r||this.updatedWithError?null!==r&&function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length||e.some(function(e,n){return!Object.is(e,t[n])})}(e.resetKeys,i)&&(null==(t=(n=this.props).onResetKeysChange)||t.call(n,e.resetKeys,i),this.reset()):this.updatedWithError=!0},a.render=function(){var e=this.state.error,t=this.props,r=t.fallbackRender,i=t.FallbackComponent,a=t.fallback;if(null!==e){var o={error:e,resetErrorBoundary:this.resetErrorBoundary};if(n.isValidElement(a))return a;if("function"==typeof r)return r(o);if(i)return n.createElement(i,o);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(n.Component);e.ErrorBoundary=a,e.useErrorHandler=function(e){var t=n.useState(null),r=t[0],i=t[1];if(null!=e)throw e;if(null!=r)throw r;return i},e.withErrorBoundary=function(e,t){var r=function(r){return n.createElement(a,t,n.createElement(e,r))},i=e.displayName||e.name||"Unknown";return r.displayName="withErrorBoundary("+i+")",r},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof o&&"undefined"!=typeof s?l(o,Oh()):(i=[t,n(43)],void 0===(a="function"===typeof(r=l)?r.apply(t,i):r)||(e.exports=a))}),YF=k(()=>{xF=P(Oh()),Zp(),Pv(),WF(),ZF(),XF(),wF=P($F()),Mw(),M(),Pv(),kF={edges:{left:{from:"screenLeft",distance:.3},right:{from:"screenRight",distance:.3},top:{from:"screenTop",distance:.3},bottom:{from:"screenBottom",distance:.3}}},SF={width:300,height:300},EF=e=>{let{paneInstance:t}=e;return xF.default.createElement(OO,{panelId:"pane-".concat(t.instanceId),defaultPosition:kF,minDims:SF},xF.default.createElement(LF,{paneInstance:t}))},PF=Wp(bF)(CF||(CF=I(["\n  display: flex;\n  flex-direction: column;\n\n  box-shadow: 0px 5px 12px -4px rgb(0 0 0 / 22%);\n  z-index: ",";\n"])),fv.pluginPanes),IF=Wp.div(DF||(DF=I(["\n  width: 100%;\n"]))),AF=Wp.div(TF||(TF=I(["\n  display: flex;\n  align-items: center;\n  opacity: 1;\n  position: absolute;\n  right: 4px;\n  top: 0;\n  bottom: 0;\n"]))),OF=Wp.button(zF||(zF=I(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border-radius: 2px;\n  font-size: 11px;\n  height: 10px;\n  width: 18px;\n  color: #adadadb3;\n  background: transparent;\n  border: none;\n  cursor: pointer;\n  &:hover {\n    color: white;\n  }\n"]))),MF=Wp(bv)(FF||(FF=I(["\n  position: relative;\n  overflow: hidden;\n\n  &:after {\n    z-index: 10;\n    position: absolute;\n    inset: 0;\n    display: block;\n    content: ' ';\n    pointer-events: none;\n\n    #pointer-root:not(.normal) & {\n      pointer-events: auto;\n    }\n  }\n"]))),BF=Wp.div(jF||(jF=I(["\n  padding: 12px;\n\n  & > pre {\n    border: 1px solid #ff62624f;\n    background-color: rgb(255 0 0 / 5%);\n    margin: 8px 0;\n    padding: 8px;\n    font-family: monospace;\n    overflow: scroll;\n    color: #ff9896;\n  }\n"]))),RF=e=>xF.default.createElement(BF,null,"An Error occurred rendering this pane. Open the console for more info.",xF.default.createElement("pre",null,JSON.stringify({message:e.error.message,stack:e.error.stack},null,2))),LF=e=>{let{paneInstance:t}=e,[n,r]=(0,xF.useState)(null),i=t.definition.mount;(0,xF.useLayoutEffect)(()=>{if(!n)return;let e=i({paneId:t.instanceId,node:n});return"function"==typeof e?e:void 0},[n,i,t.instanceId]);let a=(0,xF.useCallback)(()=>{O().paneManager.destroyPane(t.instanceId)},[t]);return xF.default.createElement(PF,{"data-testid":"theatre-pane-wrapper-".concat(t.instanceId)},xF.default.createElement(BO,null,xF.default.createElement(kv,null,xF.default.createElement(AF,null,xF.default.createElement(OF,{onClick:a,title:"Close Pane"},xF.default.createElement(cw,null))),xF.default.createElement(IF,null,t.instanceId))),xF.default.createElement(wF.ErrorBoundary,{FallbackComponent:RF},xF.default.createElement(MF,{"data-testid":"theatre-pane-content-".concat(t.instanceId),ref:r})))},NF=EF}),JF=k(()=>{UF=n(194),VF=(e,t)=>{let n=UF.prism.memo(e,()=>new UF.Atom(t),[]);return n.set(t),n}});function QF(e,t){(0,eM.useLayoutEffect)(()=>{if(!e||"propWithChildren"!==t.type&&"primitiveProp"!==t.type&&"sheetObject"!==t.type)return;let n=null,r=x(b({},t.sheetObject.address),{pathToProp:"sheetObject"===t.type?[]:t.pathToProp});function i(){n=BD.replaceLock(r,()=>{})}function a(){null==n||n()}return e.addEventListener("mouseenter",i),e.addEventListener("mouseleave",a),()=>{null==n||n(),e.removeEventListener("mouseenter",i),e.removeEventListener("mouseleave",a)}},[e])}var eM,tM,nM,rM,iM,aM,oM,sM,lM,uM,cM,dM,hM,fM,pM,mM=k(()=>{eM=P(Oh()),RD()}),gM=k(()=>{Cv(),tM=P(Oh()),Mw(),Zp(),$C(),mM(),rM=Wp.li(nM||(nM=I(["\n  --depth: ",";\n  margin: 0;\n  padding: 0;\n  list-style: none;\n"])),e=>e.depth),aM=Wp.div(iM||(iM=I(["\n  border-bottom: 1px solid #7695b705;\n"]))),sM=Wp(aM)(oM||(oM=I(["\n  padding-left: calc(8px + var(--depth) * 20px);\n\n  display: flex;\n  align-items: stretch;\n  color: ",";\n\n  box-sizing: border-box;\n\n  ",";\n"])),ov.panel.body.compoudThing.label.color,e=>e.isSelected&&"background: blue"),uM=Wp.span(lM||(lM=I(["\n  ",";\n  overflow-x: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  padding-right: 4px;\n  line-height: 26px;\n  flex-wrap: nowrap;\n\n  ",":hover & {\n    color: #ccc;\n  }\n"])),NC,sM),dM=Wp.span(cM||(cM=I(["\n  width: 12px;\n  padding: 8px;\n  font-size: 9px;\n  display: flex;\n  align-items: center;\n\n  transition: transform 0.05s ease-out, color 0.1s ease-out;\n  transform: rotateZ(","deg);\n  color: #66686a;\n\n  &:hover {\n    transform: rotateZ(","deg);\n    color: #c0c4c9;\n  }\n"])),e=>e.isCollapsed?0:90,e=>e.isCollapsed?15:75),fM=Wp.ul(hM||(hM=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n"]))),pM=e=>{let{leaf:t,label:n,children:r,isSelectable:i,isSelected:a,toggleSelect:o,toggleCollapsed:s,isCollapsed:l}=e,u=Array.isArray(r)&&r.length>0,c=(0,tM.useRef)(null);return QF(c.current,t),t.shouldRender?tM.default.createElement(rM,{depth:t.depth},tM.default.createElement(sM,{ref:c,style:{height:t.nodeHeight+"px"},isSelectable:!0===i,isSelected:!0===a,onClick:o,isEven:t.n%2===0},tM.default.createElement(dM,{isCollapsed:l,onClick:s},tM.default.createElement(Cw,null)),tM.default.createElement(uM,null,n)),u&&tM.default.createElement(fM,null,r)):null}});function yM(e){var t;let n=[];for(;;){let r=n.length,i=null==(t=e[0])?void 0:t[r];if(void 0===i)return n;for(let t of e)if(i!==t[r])return n;n.push(i)}}var vM,_M,bM=k(()=>{zC(),vM=AC(e=>JSON.stringify(e)),_M=e=>JSON.parse(e)});var xM,wM=k(()=>{xM=P(Oh())});function kM(e){let[t,n]=(0,SM.useState)(!1);return function(e,t){let n=(0,xM.useRef)({combo:e,listener:t});n.current={combo:e,listener:t},(0,xM.useEffect)(()=>{function e(e){e.key===n.current.combo&&n.current.listener({down:!0,event:e})}function t(e){e.key===n.current.combo&&n.current.listener({down:!1,event:e})}function r(e){n.current.listener({down:!1,event:void 0})}return document.addEventListener("keydown",e),document.addEventListener("keyup",t),window.addEventListener("blur",r),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t),window.removeEventListener("blur",r)}},[])}(e,e=>{let{down:t}=e;n(t)}),t}var SM,EM=k(()=>{SM=P(Oh()),wM()});var CM,PM,DM=k(()=>{CM=n(194),PM=P(Oh())});function IM(e,t,n){let r=t((0,TM.pointer)({root:{},path:[]}));ph(e,(0,TM.getPointerParts)(r).path,n)}var TM,AM,zM,OM=k(()=>{TM=n(194),bh()}),FM=k(()=>{AM="data-pos",zM={checkIfMouseEventSnapToPos(e,t){let n=e.composedPath().find(e=>e instanceof Element&&e!==(null==t?void 0:t.ignore)&&e.hasAttribute(AM));if(n){let e=parseFloat(n.getAttribute(AM));if(isFinite(e))return e}return null},includePositionSnapAttrs:e=>({[AM]:e})}});function MM(e){let t="sheet"===e.type?function(e){return e.children.flatMap(BM)}(e):BM(e);return{byPosition:jM(t),tracks:t}}function jM(e){let t=new Map;for(let n of e)for(let e of n.data.keyframes){let r=t.get(e.position);r||(r=[],t.set(e.position,r)),r.push({kf:e,track:n,itemKey:bD.forTrackKeyframe(n.sheetObject,n.id,e.id)})}return t}function BM(e){return e.children.flatMap(e=>"propWithChildren"===e.type?BM(e):function(e){let t=e.sheetObject,n=t.address.projectId,r=O().atomP.historic.coreByProject[n].sheetsById[t.address.sheetId].sequence.tracksByObject[t.address.objectKey],i=(0,LM.val)(r.trackIdByPropPath[vM(e.pathToProp)]);if(!i)return[];let a=(0,LM.val)(r.trackData[i]);return a?[{id:i,data:a,sheetObject:t}]:[]}(e))}function RM(e,t){return Dh(e.children.flatMap(e=>"propWithChildren"===e.type?RM(e,t):function(e,t){var n,r;let i=e.sheetObject,a=i.address.projectId,o=O().atomP.historic.coreByProject[a].sheetsById[i.address.sheetId].sequence.tracksByObject[i.address.objectKey],s=(0,LM.val)(o.trackIdByPropPath[vM(e.pathToProp)]);return s&&null!=(r=null==(n=t[i.address.objectKey])?void 0:n[s])?r:[]}(e,t)))}var LM,NM=k(()=>{M(),LM=n(194),xD(),bM(),Th()});var UM,VM,qM,HM,WM,ZM,KM,GM,XM,$M,YM,JM,QM,ej,tj,nj,rj,ij,aj,oj,sj,lj,uj,cj,dj,hj,fj,pj,mj,gj,yj,vj,_j,bj,xj,wj,kj,Sj,Ej=k(()=>{M(),bx(),EM(),DM(),OM(),tv(),Qh(),UM=n(194),VM=P(Oh()),Zp(),FM(),NM(),sx(),HM=Wp.div(qM||(qM=I(["\n  cursor: ",";\n"])),e=>e.isShiftDown?"cell":"default"),WM=e=>{let{layoutP:t,children:n,height:r}=e,[i,a]=Qy(null),o=kM("Shift"),s=function(e,t){let[n,r]=Qy(null),i=ix("useCaptureSelection");return gx(t,(0,VM.useMemo)(()=>({debugName:"DopeSheetSelectionView/useCaptureSelection",dontBlockMouseDown:!0,lockCSSCursorTo:"cell",onDragStart(r){if(!r.shiftKey||r.target instanceof HTMLInputElement)return!1;let a=t.getBoundingClientRect(),o=r.clientX-a.left-(0,UM.val)(e.scaledSpace.leftPadding),s=(0,UM.val)(e.scaledSpace.toUnitSpace)(o);return n.current={h:[s,s],v:[r.clientY-a.top,r.clientY-a.top]},(0,UM.val)(e.selectionAtom).set({current:void 0}),{onDrag(r,a,o){let s=t.getBoundingClientRect(),l=o.clientX-s.left-(0,UM.val)(e.scaledSpace.leftPadding),u=(0,UM.val)(e.scaledSpace.toUnitSpace)(l);n.current={h:[n.current.h[0],u],v:[n.current.v[0],o.clientY-s.top]};let c=ZM.boundsToSelection(i,(0,UM.val)(e),n.current);(0,UM.val)(e.selectionAtom).set({current:c})},onDragEnd(e){n.current=null}}}}),[e,t,n])),r}(t,a);return(0,VM.useRef)(s).current=s,VM.default.createElement(HM,{style:{height:r+"px"},ref:i,isShiftDown:o,className:"selectionview"},s&&VM.default.createElement($M,{state:s,layoutP:t}),n)},(e=>{let t=(e,t,n,i,a)=>{let o=MM(n);if(n.top+n.nodeHeight/2+5>i.v[0]&&n.top+n.nodeHeight/2-5<i.v[1])for(let[r,s]of o.byPosition){let e=t.scaledSpace.toUnitSpace(5);if(!(r+e<=i.h[0]||r-e>=i.h[1]))for(let t of s)IM(a,e=>e[t.track.sheetObject.address.objectKey].byTrackId[t.track.id].byKeyframeId[t.kf.id],!0)}r(e,t,n,i,a)},n={sheet(e,n,r,i,a){t(e,n,r,i,a)},propWithChildren(e,n,r,i,a){t(e,n,r,i,a)},sheetObject(e,n,r,i,a){t(e,n,r,i,a)},primitiveProp(e,t,n,r,i){let{sheetObject:a,trackId:o}=n,s=(0,UM.val)(O().atomP.historic.coreByProject[a.address.projectId].sheetsById[a.address.sheetId].sequence.tracksByObject[a.address.objectKey].trackData[o]);if(!(r.v[0]>n.top+n.heightIncludingChildren/2+5||n.top+n.heightIncludingChildren/2-5>r.v[1]))for(let l of s.keyframes)if(!(l.position+t.scaledSpace.toUnitSpace(5)<=r.h[0])){if(l.position-t.scaledSpace.toUnitSpace(5)>=r.h[1])break;IM(i,e=>e[a.address.objectKey].byTrackId[o].byKeyframeId[l.id],!0)}}},r=(e,t,n,r,a)=>{if("children"in n)for(let o of n.children)i(e,t,o,r,a)};function i(e,t,i,a,o){if(!i.shouldRender||a.v[0]>i.top+i.heightIncludingChildren||i.top>a.v[1])return;let s=n[i.type];s?s(e,t,i,a,o):r(e,t,i,a,o)}e.boundsToSelection=function(e,t,n){let r={};n=XM(n);let a=t.tree;i(e.utilFor.internal(),t,a,n,r);let o=t.tree.sheet;return{type:"DopeSheetSelection",byObjectKey:r,getDragHandlers:e=>({debugName:"DopeSheetSelectionView/boundsToSelection",onDragStart(){let n,i=t.scaledSpace.toUnitSpace;return{onDrag(t,a,s){n&&(n.discard(),n=void 0);let l=zM.checkIfMouseEventSnapToPos(s,{ignore:e.domNode}),u=null!=l?l-e.positionAtStartOfDrag:i(t);n=O().tempTransaction(t=>{let{stateEditors:n}=t,i=n.coreByProject.historic.sheetsById.sequence.transformKeyframes;for(let a of Object.keys(r)){let{byTrackId:t}=r[a];for(let n of Object.keys(t)){let{byKeyframeId:r}=t[n];i({trackId:n,keyframeIds:Object.keys(r),translate:u,scale:1,origin:0,snappingFunction:o.getSequence().closestGridPosition,objectKey:a,projectId:e.projectId,sheetId:e.sheetId})}}})},onDragEnd(e){e?null==n||n.commit():null==n||n.discard()}}}}),delete(){O().transaction(e=>{let{stateEditors:t}=e,n=t.coreByProject.historic.sheetsById.sequence.deleteKeyframes;for(let i of Object.keys(r)){let{byTrackId:e}=r[i];for(let t of Object.keys(e)){let{byKeyframeId:r}=e[t];n(x(b({},o.address),{objectKey:i,trackId:t,keyframeIds:Object.keys(r)}))}}})}}}})(ZM||(ZM={})),GM=Wp.div(KM||(KM=I(["\n  position: absolute;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px dashed rgba(255, 255, 255, 0.4);\n  box-sizing: border-box;\n"]))),XM=e=>({h:[...e.h].sort((e,t)=>e-t),v:[...e.v].sort((e,t)=>e-t)}),$M=e=>{let{state:t,layoutP:n}=e,r=function(e){let t=(0,PM.useMemo)(()=>new CM.Atom(e),[]);return(0,PM.useLayoutEffect)(()=>{t.set(e)},[e]),t}(t);return Rh(()=>{let e=(0,UM.val)(r.pointer),t=XM(e),i=(0,UM.val)(n.scaledSpace.fromUnitSpace),a=(0,UM.val)(n.scaledSpace.leftPadding),o=t.h.map(i).map(e=>e+a),s=t.v[0],l=t.v[1]-t.v[0],u=o[0],c=o[1]-o[0];return VM.default.createElement(GM,{style:{top:s+"px",height:l+"px",left:u+"px",width:c+"px"}})},[n,r])},YM=WM}),Cj=k(()=>{Dv(),JM=P(Oh()),Zp(),OK(),ej=Wp.div(QM||(QM=I(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  z-index: ",";\n\n  &::-webkit-scrollbar {\n    display: none;\n  }\n\n  scrollbar-width: none;\n"])),()=>pK.scrollableArea),tj=(0,JM.createContext)(Ev),nj=()=>(0,JM.useContext)(tj),rj=e=>{let t=(0,JM.useRef)(null),n=(0,JM.useCallback)(e=>{t.current.scrollBy(0,e.deltaY)},[]);return JM.default.createElement(tj.Provider,{value:n},JM.default.createElement(ej,{ref:t},e.children))}}),Pj=k(()=>{ij='data:image/svg+xml,<svg width="34" height="34" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">%0A  <path d="M1 7V1H7" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M7 33H1L1 27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M33 27V33H27" stroke="%2374FFDE" stroke-width="0.25" />%0A  <path d="M27 1L33 1V7" stroke="%2374FFDE" stroke-width="0.25" />%0A</svg>'}),Dj=k(()=>{aj=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return"\n  left: ".concat(-.5*e,"px;\n  top: ").concat(-.5*t,"px;\n  width: ").concat(e,"px;\n  height: ").concat(t,"px;\n")}}),Ij=k(()=>{oj=n(194),sj=(0,oj.prism)(()=>{let[e,t]=oj.prism.state("pos",null);return oj.prism.effect("setupListeners",()=>{let e=e=>{t(e)};return document.addEventListener("mousemove",e),()=>{document.removeEventListener("mousemove",e)}},[]),e}),lj=sj}),Tj=k(()=>{uj=n(194),Ij(),Th(),cj=P(Oh()),dj=(0,cj.createContext)(null),hj=0,fj=e=>{let{children:t,layoutP:n}=e,r=(0,cj.useMemo)(()=>new uj.Atom([]),[]),i={currentD:(0,cj.useMemo)(()=>(0,uj.prism)(()=>{let e=uj.prism.memo("p",()=>_j(n),[n]).getValue(),t=(0,uj.val)(r.pointer);return t.length>0?id(t).position:e}),[n]),getLock:(0,cj.useCallback)(()=>{let e=hj++;return r.reduce(t=>[...t,{id:e,position:[-1,0]}]),{set:t=>{r.reduce(n=>{let r=n.findIndex(t=>t.id===e);if(-1===r)return console.warn("Lock is already freed. This is a bug."),n;let i=[...n];return i.splice(r,1,{id:e,position:[t,-1===t?0:1]}),i})},unlock:()=>{r.reduce(t=>t.filter(t=>t.id!==e))}}},[])};return cj.default.createElement(dj.Provider,{value:i},t)},pj=()=>(0,cj.useContext)(dj).currentD,mj=()=>{let{getLock:e}=(0,cj.useContext)(dj),t=(0,cj.useRef)();return(0,cj.useLayoutEffect)(()=>()=>{var e;null==(e=t.current)||e.unlock()},[]),(0,cj.useMemo)(()=>{let n;return(r,i)=>{var a,o;(null==n?void 0:n.shouldLock)!==r&&(r?t.current=e():null==(a=t.current)||a.unlock()),(null==n?void 0:n.pos)!==i&&r&&(null==(o=t.current)||o.set(i)),n={shouldLock:r,pos:i}}},[e])},gj=(e,t)=>{let{getLock:n}=(0,cj.useContext)(dj),r=(0,cj.useRef)();(0,cj.useLayoutEffect)(()=>{if(e)return r.current=n(),()=>{r.current.unlock()}},[e,n]),(0,cj.useLayoutEffect)(()=>{e&&r.current.set(t)},[t,e])},yj=e=>({[vj]:"hide"===e?e:e.toFixed(3)}),vj="data-theatre-lock-framestamp-to",_j=e=>(0,uj.prism)(()=>{let t=(0,uj.val)(e.rightDims),n=(0,uj.val)(e.clippedSpace.toUnitSpace),r=(0,uj.val)(lj);if(!r)return[-1,0];for(let e of r.composedPath()){if(!(e instanceof HTMLElement||e instanceof SVGElement))break;if(e.hasAttribute(vj)){let t=e.getAttribute(vj);if("string"!=typeof t)continue;if("hide"===t)return[-1,0];let n=parseFloat(t);if(isFinite(n)&&n>=0)return[n,2]}}let{clientX:i,clientY:a}=r,{screenX:o,screenY:s,width:l,height:u}=t;if(Sd(i,o,o+l)&&Sd(a,s+16,s+u)){return[n(i-o),3]}return[-1,0]}),bj=fj}),Aj=k(()=>{Cv(),nx(),Zp(),Pj(),Dj(),FM(),Tj(),Sj={BEING_DRAGGED_CLASS:xj="beingDragged",CSS:zf(wj||(wj=I(["\n    position: absolute;\n    ",";\n    ",";\n\n    &."," {\n      pointer-events: none !important;\n    }\n  "])),aj(12),av,xj),CSS_WHEN_SOMETHING_DRAGGING:zf(kj||(kj=I(["\n    pointer-events: auto;\n    cursor: var(",");\n\n    // \u2e22\u2e24\u2e23\u2e25 thing\n    // This box extends the hitzone so the user does not\n    // accidentally leave the hitzone\n    &:hover:after {\n      position: absolute;\n      top: calc(50% - ","px);\n      left: calc(50% - ","px);\n      width: ","px;\n      height: ","px;\n      display: block;\n      content: ' ';\n      background: url(",") no-repeat 100% 100%;\n      // This icon might also fit: GiConvergenceTarget\n    }\n  "])),Kb,17,17,34,34,ij),reactProps:e=>x(b(b({},yj(e.position)),zM.includePositionSnapAttrs(e.position)),{className:e.isDragging?Sj.BEING_DRAGGED_CLASS:""})}});function zj(){Hj.set({mode:"snapToAll"})}function Oj(){Hj.set({mode:"snapToNone"})}function Fj(e){Hj.set({mode:"snapToSome",positions:e})}function Mj(e,t){return Object.fromEntries(Object.entries(e).map(e=>{let[n,r]=e;return[n,Object.fromEntries(Object.entries(r.trackData).map(e=>{let[r,i]=e;return[r,i.keyframes.filter(e=>t(e,{trackId:r,trackData:i,objectKey:n})).map(e=>e.position)]}))]}))}var jj,Bj,Rj,Lj,Nj,Uj,Vj,qj,Hj,Wj,Zj=k(()=>{jj=n(194),Bj=n(194),Rj=P(Oh()),Zp(),Aj(),Nj=Wp.div(Lj||(Lj=I(["\n  z-index: 1;\n  cursor: ew-resize;\n\n  ","\n\n  #pointer-root.draggingPositionInSequenceEditor & {\n    ","\n  }\n"])),Sj.CSS,Sj.CSS_WHEN_SOMETHING_DRAGGING),Vj=Wp.div(Uj||(Uj=I(["\n  position: absolute;\n"]))),qj=e=>Rj.default.createElement(Vj,{style:{top:"".concat(e.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,Bj.val)(e.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(e.position,"px))")}},Rj.default.createElement(Nj,b({},Sj.reactProps({isDragging:!1,position:e.position})))),Hj=new jj.Atom({mode:"snapToNone"}),Wj=Hj.prism});function Kj(e,t){let n=nj();(0,$j.useLayoutEffect)(()=>{if(!t)return;let r=r=>{if(r.ctrlKey){r.preventDefault(),r.stopPropagation();let n=r.clientX-t.getBoundingClientRect().left,i=(0,Xj.val)(e.clippedSpace.toUnitSpace)(n),a=(0,Xj.val)(e.clippedSpace.range),o=1+.03*Gj(r.deltaY,[-50,50]),s=Od(a,e=>(e-i)*o+i),l=(0,Xj.val)(e.sheet).getSequence().length,u=l+.25*l;return void(0,Xj.val)(e.clippedSpace.setRange)(function(e,t){return Od(e,e=>Gj(e,t))}(s,[0,u]))}if(r.shiftKey){r.preventDefault(),r.stopPropagation();let t=(0,Xj.val)(e.sheet).getSequence().length,n=(0,Xj.val)(e.clippedSpace.range),i=(n.end-n.start)/t,a=.05*Gj(r.deltaY||r.deltaX,[-50,50])*i,o=Od(n,e=>e+a);return void(0,Xj.val)(e.clippedSpace.setRange)(o)}{n(r),r.preventDefault(),r.stopPropagation();let t=(0,Xj.val)(e.scaledSpace.toUnitSpace)(1*r.deltaX),i=(0,Xj.val)(e.clippedSpace.range),a=Od(i,e=>e+t);return void(0,Xj.val)(e.clippedSpace.setRange)(a)}},i={capture:!0,passive:!1};return t.addEventListener("wheel",r,i),()=>{t.removeEventListener("wheel",r,i)}},[t,e]),gx(t,(0,$j.useMemo)(()=>({onDragStart(t){let r=(0,Xj.val)(e.clippedSpace.range),i=(0,Xj.val)(e.clippedSpace.setRange),a=(0,Xj.val)(e.scaledSpace.toUnitSpace);return t.preventDefault(),t.stopPropagation(),{onDrag(e,t,o,s,l){n({deltaY:-l});let u=-a(e),c=Od(r,e=>e+u);i(c)}}},debugName:"HorizontallyScrollableArea Middle Button Drag",buttons:[1],lockCSSCursorTo:"grabbing"}),[e]))}function Gj(e,t){let[n,r]=t;return Math.max(Math.min(e,r),n)}var Xj,$j,Yj,Jj,Qj,eB,tB,nB,rB,iB,aB,oB,sB,lB,uB=k(()=>{bx(),tv(),Qh(),Xj=n(194),Th(),$j=P(Oh()),Zp(),Cj(),Cv(),nx(),FM(),Zj(),Jj=Wp.div(Yj||(Yj=I(["\n  position: absolute;\n\n  right: 0;\n  overflow-x: scroll;\n  overflow-y: hidden;\n  ",";\n\n  // hide the scrollbar on Gecko\n  scrollbar-width: none;\n\n  // hide the scrollbar on Webkit/Blink\n  &::-webkit-scrollbar {\n    display: none;\n  }\n"])),av),Qj=$j.default.memo(e=>{let{layoutP:t,children:n,height:r}=e,{width:i,unitSpaceToScaledSpaceMultiplier:a}=Rh(()=>({width:(0,Xj.val)(t.rightDims.width),unitSpaceToScaledSpaceMultiplier:(0,Xj.val)(t.scaledSpace.fromUnitSpace)(1)}),[t]),[o,s]=Qy(null);return Kj(t,s),function(e,t){let n=(0,$j.useMemo)(()=>({debugName:"HorizontallyScrollableArea",onDragStart(n){if(n.target instanceof HTMLInputElement||n.shiftKey||n.altKey||n.ctrlKey||n.metaKey||n.composedPath().some(e=>e instanceof HTMLElement&&!0===e.draggable))return!1;let r=n.clientX-t.getBoundingClientRect().left,i=ms((0,Xj.val)(e.clippedSpace.toUnitSpace)(r),0,1/0),a=(0,Xj.val)(e.seeker.setIsSeeking),o=(0,Xj.val)(e.sheet).getSequence();o.position=i;let s=i,l=(0,Xj.val)(e.scaledSpace.toUnitSpace);return a(!0),zj(),{onDrag(e,t,n){let r=l(e),i=ms(s+r,0,o.length),a=zM.checkIfMouseEventSnapToPos(n,{});null!=a&&(i=a),o.position=i},onDragEnd(){a(!1),Oj()}}}}),[e,t]),[r]=gx(t,n);Qb(r,"draggingPositionInSequenceEditor","ew-resize")}(t,s),function(e,t){(0,$j.useLayoutEffect)(()=>{if(!t)return;let n=(0,Xj.prism)(()=>{let t=(0,Xj.val)(e.clippedSpace.range);return(0,Xj.val)(e.scaledSpace.fromUnitSpace)(t.start)}),r=()=>{let e=n.getValue();t.scrollLeft=e},i=n.onStale(r);r();let a=setTimeout(r,100);return()=>{clearTimeout(a),i()}},[e,t])}(t,s),$j.default.createElement(Jj,{ref:o,style:{width:i+"px",height:r+"px","--unitSpaceToScaledSpaceMultiplier":a}},n)}),eB=Qj}),cB=k(()=>{tB=P(Oh()),Zp(),rB=Wp.li(nB||(nB=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  box-sizing: border-box;\n  position: relative;\n"]))),aB=Wp.div(iB||(iB=I(["\n  box-sizing: border-box;\n  width: 100%;\n  position: relative;\n\n  &:before {\n    position: absolute;\n    display: block;\n    content: ' ';\n    left: -40px;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    box-sizing: border-box;\n    border-bottom: 1px solid #252b3869;\n    background: ",";\n  }\n"])),e=>e.isEven?"transparent":"#6b8fb505"),sB=Wp.ul(oB||(oB=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n"]))),lB=e=>{let{leaf:t,children:n,node:r,isCollapsed:i}=e,a=Array.isArray(n)&&n.length>0;return t.shouldRender?tB.default.createElement(rB,null,tB.default.createElement(aB,{style:{height:t.nodeHeight+"px"},isEven:t.n%2===0},r),a&&tB.default.createElement(sB,null,n)):null}}),dB=S((e,t)=>{!function(){var n={};"undefined"!=typeof e?t.exports=n:this.fuzzy=n,n.simpleFilter=function(e,t){return t.filter(function(t){return n.test(e,t)})},n.test=function(e,t){return null!==n.match(e,t)},n.match=function(e,t,n){n=n||{};var r,i=0,a=[],o=t.length,s=0,l=0,u=n.pre||"",c=n.post||"",d=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var h=0;h<o;h++)r=t[h],d[h]===e[i]?(r=u+r+c,i+=1,l+=1+l):l=0,s+=l,a[a.length]=r;return i===e.length?(s=d===e?1/0:s,{rendered:a.join(""),score:s}):null},n.filter=function(e,t,r){return t&&0!==t.length?"string"!=typeof e?t:(r=r||{},t.reduce(function(t,i,a,o){var s=i;r.extract&&(s=r.extract(i));var l=n.match(e,s,r);return null!=l&&(t[t.length]={string:l.rendered,score:l.score,index:a,original:i}),t},[]).sort(function(e,t){return t.score-e.score||e.index-t.index})):[]}}()});var hB,fB,pB,mB=k(()=>{hB=P(Oh())}),gB=k(()=>{fB="rgba(26, 28, 30, 0.97);",pB="#272B2F"});function yB(e,t,n,r){let i=function(e,t){let[n,r]=(0,hB.useState)(!1),i=(0,hB.useRef)(t);return n||(i.current=t),(0,hB.useMemo)(()=>e(r),i.current)}(t=>({debugName:"CurveSegmentEditor/useKeyframeDrag",lockCSSCursorTo:"move",onDragStart:()=>(t(!0),{onDrag(t,i){e&&n.onCurveChange(r(t,i))},onDragEnd(e){t(!1),n.onCancelCurveChange()}})}),[e,n.onCurveChange,n.onCancelCurveChange]);gx(t,i)}var vB,_B,bB,xB,wB,kB,SB,EB,CB,PB,DB,IB,TB,AB,zB=k(()=>{vB=P(Oh()),bx(),tv(),gs(),Zp(),Cv(),mB(),gB(),_B=.12,bB=1.24,xB=.01,wB=.99/7,kB="#3EAAA4",SB="#3EAAA4",EB="#B3B3B3",CB=["goldenrod","cornflowerblue","dodgerblue","lawngreen"],DB=Wp.circle(PB||(PB=I(["\n  stroke-width: 0.1px;\n  vector-effect: non-scaling-stroke;\n  r: 0.04px;\n  pointer-events: none;\n  transition: r 0.15s;\n  fill: ",";\n"])),"#3eaaa4"),TB=Wp.circle(IB||(IB=I(["\n  stroke-width: 0.1px;\n  vector-effect: non-scaling-stroke;\n  r: 0.09px;\n  cursor: move;\n  ",";\n  &:hover {\n    opacity: 0.4;\n  }\n  &:hover + "," {\n    fill: ",";\n  }\n"])),av,DB,"#67dfd8"),AB=e=>{let{curveConnection:{left:t,right:n},backgroundConnections:r}=e,i=Math.min(0,1-n.handles[1],1-t.handles[3]),a=Math.max(1,1-n.handles[1],1-t.handles[3]),o=Math.max(1,a-i),s=e=>(e-i)/o,[l,u]=Qy(null),c=bB/((null==u?void 0:u.clientWidth)||1),d=bB/((null==u?void 0:u.clientHeight)||1),[h,f]=Qy(null);yB(u,f,e,(e,r)=>[ms(t.handles[2]+e*c,0,1),t.handles[3]-r*d,n.handles[0],n.handles[1]]);let[p,m]=Qy(null);yB(u,m,e,(e,r)=>{let i=ms(n.handles[0]+e*c,0,1),a=n.handles[1]-r*d;return[t.handles[2],t.handles[3],i,a]});let g=e=>"M0 ".concat(s(1)," C").concat(e.left.handles[2]," ").concat(s(1-e.left.handles[3])," ").concat(e.right.handles[0]," ").concat(s(1-e.right.handles[1])," 1 ").concat(s(0));return vB.default.createElement("svg",{height:"100%",width:"100%",ref:l,viewBox:"".concat(-_B," ").concat(-_B," ").concat(bB," ").concat(bB),xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"none",fill:"none"},vB.default.createElement("linearGradient",{id:"myGradient",gradientTransform:"rotate(90)"},vB.default.createElement("stop",{offset:s(-1),stopColor:"#3EAAA4"}),vB.default.createElement("stop",{offset:s(0),stopColor:SB}),vB.default.createElement("stop",{offset:s(.3),stopColor:"#3EAAA4"}),vB.default.createElement("stop",{offset:s(.5),stopColor:"#3EAAA4"}),vB.default.createElement("stop",{offset:s(.7),stopColor:"#3EAAA4"}),vB.default.createElement("stop",{offset:s(1),stopColor:kB}),vB.default.createElement("stop",{offset:s(2),stopColor:"#3EAAA4"})),vB.default.createElement("pattern",{id:"dot-background-pattern-1",width:wB,height:wB/o,y:-i/o},vB.default.createElement("rect",{width:xB,height:xB,fill:EB,opacity:.3})),vB.default.createElement("rect",{x:0,y:0,width:"1",height:1,fill:"url(#dot-background-pattern-1)"}),vB.default.createElement("pattern",{id:"dot-background-pattern-2",width:wB,height:wB},vB.default.createElement("rect",{width:xB,height:xB,fill:EB})),vB.default.createElement("rect",{x:0,y:s(0),width:"1",height:s(1)-s(0),fill:"url(#dot-background-pattern-2)"}),t.type&&"bezier"!==t.type?vB.default.createElement(vB.default.Fragment,null,vB.default.createElement("line",{x1:0,y1:s(1),x2:1,y2:s(1),stroke:EB,strokeWidth:"0.01"}),vB.default.createElement("line",{x1:1,y1:s(1),x2:1,y2:0,stroke:EB,strokeWidth:"0.01"}),vB.default.createElement("circle",{cx:0,cy:1,r:"0.025",stroke:SB,strokeWidth:"0.02",fill:pB}),vB.default.createElement("circle",{cx:1,cy:0,r:"0.025",stroke:SB,strokeWidth:"0.02",fill:pB})):vB.default.createElement(vB.default.Fragment,null,vB.default.createElement("line",{x1:0,y1:s(1),x2:t.handles[2],y2:s(1-t.handles[3]),stroke:EB,strokeWidth:"0.01"}),vB.default.createElement("line",{x1:1,y1:s(0),x2:n.handles[0],y2:s(1-n.handles[1]),stroke:EB,strokeWidth:"0.01"}),vB.default.createElement("path",{d:g(e.curveConnection),stroke:"none",fill:"url('#myGradient')",opacity:"0.1"}),r.map((e,t)=>vB.default.createElement("path",{key:e.objectKey+"/"+e.left.id,d:g(e),stroke:CB[t%CB.length],opacity:.6,strokeWidth:"0.01"})),vB.default.createElement("path",{d:g(e.curveConnection),stroke:"url('#myGradient')",strokeWidth:"0.02"}),vB.default.createElement("circle",{cx:0,cy:s(1),r:"0.025",stroke:kB,strokeWidth:"0.02",fill:pB}),vB.default.createElement("circle",{cx:1,cy:s(0),r:"0.025",stroke:SB,strokeWidth:"0.02",fill:pB}),vB.default.createElement(TB,{ref:h,cx:t.handles[2],cy:s(1-t.handles[3]),fill:kB,opacity:.2}),vB.default.createElement(DB,{cx:t.handles[2],cy:s(1-t.handles[3])}),vB.default.createElement(TB,{ref:p,cx:n.handles[0],cy:s(1-n.handles[1]),fill:SB,opacity:.2}),vB.default.createElement(DB,{cx:n.handles[0],cy:s(1-n.handles[1])})))}});function OB(e){return e.map(e=>e.toFixed(3)).join(", ")}function FB(e){if(!e||(null==e?void 0:e.length)>jB)return null;let t=e.split(",");if(4!==t.length)return null;let n=t.map(e=>Number(e.trim()));return!n.every(e=>isFinite(e))||n[0]<0||n[0]>1||n[2]<0||n[2]>1?null:n}function MB(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{threshold:.02};if(!e||!t)return!1;let r=0;for(let i=0;i<4;i++)r+=Math.abs(e[i]-t[i]);return r<n.threshold}var jB,BB,RB,LB,NB,UB,VB,qB,HB,WB,ZB,KB,GB,XB,$B,YB,JB,QB=k(()=>{jB=128,BB=[{label:"Quad Out",value:"0.250, 0.460, 0.450, 0.940"},{label:"Quad In Out",value:"0.455, 0.030, 0.515, 0.955"},{label:"Quad In",value:"0.550, 0.085, 0.680, 0.530"},{label:"Cubic Out",value:"0.215, 0.610, 0.355, 1.000"},{label:"Cubic In Out",value:"0.645, 0.045, 0.355, 1.000"},{label:"Cubic In",value:"0.550, 0.055, 0.675, 0.190"},{label:"Quart Out",value:"0.165, 0.840, 0.440, 1.000"},{label:"Quart In Out",value:"0.770, 0.000, 0.175, 1.000"},{label:"Quart In",value:"0.895, 0.030, 0.685, 0.220"},{label:"Quint Out",value:"0.230, 1.000, 0.320, 1.000"},{label:"Quint In Out",value:"0.860, 0.000, 0.070, 1.000"},{label:"Quint In",value:"0.755, 0.050, 0.855, 0.060"},{label:"Sine Out",value:"0.390, 0.575, 0.565, 1.000"},{label:"Sine In Out",value:"0.445, 0.050, 0.550, 0.950"},{label:"Sine In",value:"0.470, 0.000, 0.745, 0.715"},{label:"Expo Out",value:"0.190, 1.000, 0.220, 1.000"},{label:"Expo In Out",value:"1.000, 0.000, 0.000, 1.000"},{label:"Expo In",value:"0.780, 0.000, 0.810, 0.00"},{label:"Circ Out",value:"0.075, 0.820, 0.165, 1.000"},{label:"Circ In Out",value:"0.785, 0.135, 0.150, 0.860"},{label:"Circ In",value:"0.600, 0.040, 0.980, 0.335"},{label:"Back Out",value:"0.175, 0.885, 0.320, 1.275"},{label:"Back In Out",value:"0.680, -0.550, 0.265, 1.550"},{label:"Back In",value:"0.600, -0.280, 0.735, 0.045"},{label:"linear",value:"0.5, 0.5, 0.5, 0.5"},{label:"In Out",value:"0.42,0,0.58,1"},{label:"Hold",value:"0, 0, Infinity, Infinity"}]}),eR=k(()=>{RB=P(Oh()),LB=.75,NB=.1,UB="#4f4f4f",VB="rgba(255, 255, 255, 0.1)",qB=e=>1-e,HB=e=>{let{easing:t,isSelected:n}=e,r=n?"#F5F5F5":"#888888",i="".concat(-LB," ").concat(-LB," ").concat(2.5," ").concat(2.5);if(t){let e=[t[0],qB(t[1])],n=[t[2],qB(t[3])];return RB.default.createElement("svg",{height:"100%",width:"100%",viewBox:i,fill:"none",xmlns:"http://www.w3.org/2000/svg"},RB.default.createElement("line",{x1:"0",y1:"1",x2:e[0],y2:e[1],stroke:UB,strokeWidth:"0.1"}),RB.default.createElement("line",{x1:"1",y1:"0",x2:n[0],y2:n[1],stroke:UB,strokeWidth:"0.1"}),RB.default.createElement("circle",{cx:e[0],cy:e[1],r:.1,fill:VB}),RB.default.createElement("circle",{cx:n[0],cy:n[1],r:.1,fill:VB}),RB.default.createElement("circle",{cx:e[0],cy:e[1],r:NB,fill:UB}),RB.default.createElement("circle",{cx:n[0],cy:n[1],r:NB,fill:UB}),RB.default.createElement("path",{d:"M0 1 C".concat(e[0]," ").concat(e[1]," ").concat(n[0]," \n        ").concat(n[1]," 1 0"),stroke:r,strokeWidth:"0.08"}),RB.default.createElement("circle",{cx:0,cy:1,r:NB,fill:r}),RB.default.createElement("circle",{cx:1,cy:0,r:NB,fill:r}))}return RB.default.createElement("svg",{height:"100%",width:"100%",viewBox:i,fill:"none",xmlns:"http://www.w3.org/2000/svg"},RB.default.createElement("line",{x1:"0",y1:"1",x2:1,y2:1,stroke:r,strokeWidth:"0.08"}),RB.default.createElement("line",{x1:"1",y1:"0",x2:1,y2:1,stroke:r,strokeWidth:"0.08"}),RB.default.createElement("circle",{cx:0,cy:1,r:NB,fill:r}),RB.default.createElement("circle",{cx:1,cy:0,r:NB,fill:r}))}}),tR=k(()=>{fA(),WB=P(Oh()),Zp(),QB(),eR(),qb(),gB(),ME(),GB=Wp.div(KB||(KB=I(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  aspect-ratio: 1;\n\n  transition: background-color 0.15s;\n  background-color: ",";\n  border-radius: 2px;\n  cursor: pointer;\n  outline: none;\n\n  ","\n\n  &:hover {\n    background-color: #31353a;\n  }\n\n  &:focus {\n    background-color: #383d42;\n  }\n"])),pB,e=>{let{isSelected:t}=e;return t&&zf(ZB||(ZB=I(["\n      background-color: #383d42;\n    "])))}),$B=Wp(zE)(XB||(XB=I(["\n  padding: 0.5em;\n  color: white;\n  max-width: 240px;\n  pointer-events: none !important;\n  --popover-bg: black;\n  --popover-outer-stroke: transparent;\n  --popover-inner-stroke: transparent;\n  box-shadow: none;\n"]))),YB=WB.default.forwardRef((e,t)=>{let[n,r]=DT({enabled:!0,verticalPlacement:e.tooltipPlacement,verticalGap:0},()=>WB.default.createElement($B,{showPopoverEdgeTriangle:!1},e.easing.label));return WB.default.createElement(GB,b({ref:Vb([r,t])},e),n,WB.default.createElement(HB,{easing:FB(e.easing.value),isSelected:e.isSelected}))}),JB=YB});var nR,rR=k(()=>{nR=P(Oh()),SR()});function iR(e,t,n){var r;null==(r=e.current)||r.discard(),e.current=null;let i=FB(n);e.current=null===i?function(e){return O().tempTransaction(t=>{let{stateEditors:n}=t,{setKeyframeType:r}=n.coreByProject.historic.sheetsById.sequence;for(let{projectId:i,sheetId:a,objectKey:o,trackId:s,left:l}of e)r({projectId:i,sheetId:a,objectKey:o,trackId:s,keyframeId:l.id,keyframeType:"hold"})})}(t):function(e,t){return O().tempTransaction(n=>{let{stateEditors:r}=n,{setHandlesForKeyframe:i,setKeyframeType:a}=r.coreByProject.historic.sheetsById.sequence;for(let{projectId:o,sheetId:s,objectKey:l,trackId:u,left:c,right:d}of e)i({projectId:o,sheetId:s,objectKey:l,trackId:u,keyframeId:c.id,start:[t[0],t[1]]}),i({projectId:o,sheetId:s,objectKey:l,trackId:u,keyframeId:d.id,end:[t[2],t[3]]}),a({projectId:o,sheetId:s,objectKey:l,trackId:u,keyframeId:c.id,keyframeType:"bezier"})})}(t,i)}function aR(e){var t;null==(t=e.current)||t.discard(),e.current=null}function oR(e,t){return()=>setTimeout(e,t)}var sR,lR,uR,cR,dR,hR,fR,pR,mR,gR,yR,vR,_R,bR,xR,wR,kR,SR=k(()=>{sR=n(194),lR=P(Oh()),Zp(),uR=P(dB()),M(),zB(),tR(),QB(),gB(),tv(),rR(),dR=Wp.div(cR||(cR=I(["\n  background: ",";\n  display: grid;\n  grid-template-areas:\n    'search  tween'\n    'presets tween';\n  grid-template-rows: 32px 1fr;\n  grid-template-columns: ","px 120px;\n  gap: 1px;\n  height: 120px;\n"])),fB,159),fR=Wp.div(hR||(hR=I(["\n  overflow: auto;\n  grid-area: presets;\n\n  display: grid;\n  grid-template-columns: repeat(",", 1fr);\n  grid-auto-rows: min-content;\n  gap: 1px;\n\n  overflow-y: scroll;\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none; /* Internet Explorer 10+ */\n  &::-webkit-scrollbar {\n    /* WebKit */\n    width: 0;\n    height: 0;\n  }\n"])),3),mR=Wp.input.attrs({type:"text"})(pR||(pR=I(["\n  background-color: ",";\n  border: none;\n  border-radius: 2px;\n  color: rgba(255, 255, 255, 0.8);\n  padding: 6px;\n  font-size: 12px;\n  outline: none;\n  cursor: text;\n  text-align: left;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n\n  grid-area: search;\n\n  &:hover {\n    background-color: #212121;\n  }\n\n  &:focus {\n    background-color: rgba(16, 16, 16, 0.26);\n    outline: 1px solid rgba(0, 0, 0, 0.35);\n  }\n"])),pB),yR=Wp.div(gR||(gR=I(["\n  grid-area: tween;\n  background: ",";\n"])),pB),_R=Wp.div(vR||(vR=I(["\n  grid-column: 1 / 4;\n  padding: 6px;\n  color: #888888;\n"]))),bR=e=>{let t=(0,lR.useMemo)(()=>[e.curveConnection,...e.additionalConnections],[e.curveConnection,...e.additionalConnections]),n=(0,lR.useRef)(null);(0,lR.useEffect)(()=>{let e=kR(t);return()=>{var t;e(),null==(t=n.current)||t.commit()}},[n]);let r=[e.curveConnection.left.handles[2],e.curveConnection.left.handles[3],e.curveConnection.right.handles[0],e.curveConnection.right.handles[1]],i=(0,lR.useRef)(null);(0,lR.useLayoutEffect)(()=>{var e,t;null==(e=i.current)||e.select(),null==(t=i.current)||t.focus()},[i.current]);let[a,o]=(0,lR.useState)(OB(r)),s=e=>{void 0!==e&&(u(1),o(e.target.value),FB(e.target.value)&&d(e.target.value))},[l,u]=(0,lR.useState)(0);(0,lR.useEffect)(()=>{2===l?o(OB(r)):3===l&&""!==a&&o("")},t);let[c,d]=(0,lR.useState)(OB(r)),[h,f]=(0,lR.useState)(null);(0,lR.useEffect)(()=>{var e;0!==l&&3!==l&&iR(n,t,null!=(e=null!=h?h:c)?e:"")},[h,c,l]),t.some(function(e){let{left:t,right:n}=e;return e=>{let{left:r,right:i}=e;return t.handles[2]!==r.handles[2]||t.handles[3]!==r.handles[3]||n.handles[0]!==i.handles[0]||n.handles[1]!==i.handles[1]}}(e.curveConnection))&&0===l&&u(3);let p=(0,lR.useMemo)(()=>/^[A-Za-z]/.test(a)?uR.default.filter(a,BB,{extract:e=>e.label}).map(e=>e.original):BB,[a]);(0,lR.useEffect)(()=>{1===l&&p[0]&&d(p[0].value)},[p]);let m=t=>{"Escape"===t.key?(aR(n),e.onRequestClose("key Escape"),t.stopPropagation()):"Enter"===t.key&&(e.onRequestClose("key Enter"),t.stopPropagation())},g=()=>f(null),y=(0,lR.useRef)(BB.reduce((e,t)=>(e[t.label]={current:null},e),{})),[v,_]=Qy(null),[b,x]=(0,lR.useState)(0);(0,lR.useEffect)(()=>{let e=()=>{var e;x(null!=(e=null==_?void 0:_.scrollTop)?e:0)};return null==_||_.addEventListener("scroll",e),()=>null==_?void 0:_.removeEventListener("scroll",e)},[_]);let w=function(e){var t;let[n,r]=(0,nR.useState)(null),i=t=>{if(null===n)return void(e.items.length>0&&r(0));let i=n+t*e.uiColumns,a=i<0,o=i>e.items.length-1;if(a||o)return e.canVerticleExit&&e.canVerticleExit(a?"top":"bottom")?void r(null):void 0;r(i)},a=t=>{r(null===n?function(e,t){return(e%t+t)%t}(t,e.items.length):n+t<0?null:Math.min(n+t,e.items.length-1))};return{focusFirstItem(){r(0)},onParentEltKeyDown:e=>{if("ArrowRight"===e.key)a(1);else if("ArrowLeft"===e.key)a(-1);else if("ArrowUp"===e.key)i(-1);else{if("ArrowDown"!==e.key)return 0;i(1)}return 1},gridItems:e.items.map((t,i)=>e.renderItem({isSelected:i===n,item:t,select(n){r(i),1===e.onSelectItem(t)&&(null==n||n.preventDefault(),null==n||n.stopPropagation())}})),currentSelection:null!=(t=e.items[null!=n?n:-1])?t:null}}({items:p,uiColumns:3,onSelectItem:r=>(iR(n,t,r.value),e.onRequestClose("selected easing option"),1),canVerticleExit(e){var t,n;return"top"===e?(null==(t=i.current)||t.select(),null==(n=i.current)||n.focus(),1):0},renderItem:e=>{let{item:t,select:n}=e;var i,a;return lR.default.createElement(JB,{key:t.label,easing:t,tabIndex:0,onKeyDown:m,ref:y.current[t.label],onMouseOver:()=>(e=>{0===l&&u(2),f(e.value)})(t),onMouseOut:g,onClick:n,tooltipPlacement:(null!=(a=null==(i=y.current[t.label].current)?void 0:i.offsetTop)?a:0)-(null!=b?b:0)<78?"bottom":"top",isSelected:MB(r,FB(t.value))})}});return(0,lR.useLayoutEffect)(()=>{var e,t;if(null!==w.currentSelection&&document.activeElement!==i.current){let n=null==(t=null==(e=y.current)?void 0:e[w.currentSelection.label])?void 0:t.current;null==n||n.focus(),d(w.currentSelection.value),/^[A-Za-z]/.test(a)||o(w.currentSelection.value)}},[w.currentSelection]),lR.default.createElement(dR,null,lR.default.createElement(mR,{value:a,placeholder:3===l?"Multiple easings selected":"Search presets...",onPaste:oR(s),onChange:s,ref:i,onKeyDown:t=>{var r,i;u(1),("ArrowDown"===t.key||"ArrowUp"===t.key)&&t.preventDefault(),"ArrowDown"===t.key?(w.focusFirstItem(),null==(i=null==(r=y.current[p[0].label])?void 0:r.current)||i.focus()):"Escape"===t.key?(aR(n),e.onRequestClose("key Escape")):"Enter"===t.key&&e.onRequestClose("key Enter")}}),lR.default.createElement(fR,{ref:v,onKeyDown:e=>w.onParentEltKeyDown(e)},w.gridItems,0===w.gridItems.length?lR.default.createElement(_R,null,"No results found"):void 0),lR.default.createElement(yR,{onClick:()=>{var e;return null==(e=i.current)?void 0:e.focus()}},lR.default.createElement(AB,{curveConnection:e.curveConnection,backgroundConnections:e.additionalConnections,onCurveChange:e=>{var t,n;u(2);let r=OB(e);o(r),d(r),null==(t=i.current)||t.select(),null==(n=i.current)||n.focus()},onCancelCurveChange:()=>{}})))},({isCurveEditorOpenD:xR,isConnectionEditingInCurvePopover:wR,getLock:kR}=(()=>{let e=new sR.Atom([]);return{getLock:t=>(e.set(t),function(){e.set([])}),isCurveEditorOpenD:(0,sR.prism)(()=>e.prism.getValue().length>0),isConnectionEditingInCurvePopover:t=>(sR.prism.ensurePrism(),e.prism.getValue().some(e=>{let{left:n,right:r}=e;return t.left.id===n.id&&t.right.id===r.id}))}})())});function ER(e,t){for(let{keyframeId:n}of function(e){var t,n,r;let i=[];for(let[a,o]of Object.entries(null!=(t=null==e?void 0:e.byObjectKey)?t:{}))for(let[e,t]of Object.entries(null!=(n=null==o?void 0:o.byTrackId)?n:{}))for(let n of Object.keys(null!=(r=null==t?void 0:t.byKeyframeId)?r:{}))i.push({objectKey:a,trackId:e,keyframeId:n});return i}(t))if(e.left.id===n)return!0;return!1}function CR(e,t,n){return(0,AR.prism)(()=>{if(void 0===n)return[];let r=[];for(let{objectKey:i,trackId:a}of TR(n)){let o=(0,AR.val)(O().atomP.historic.coreByProject[e].sheetsById[t].sequence.tracksByObject[i].trackData[a]);o&&(r=r.concat(IR(o.keyframes).filter(e=>ER(e,n)).map(n=>{let{left:r,right:o}=n;return{left:r,right:o,trackId:a,objectKey:i,sheetId:t,projectId:e}})))}return r})}function PR(e,t,n){var r;if(void 0===n)return[];let i=[];for(let{objectKey:o,trackId:s,keyframeIds:l}of TR(n))i=i.concat(null!=(r=DR({projectId:e,sheetId:t,objectKey:o,trackId:s,keyframeIds:l}))?r:[]);let a=yM(i.map(e=>e.pathToProp));return i.map(e=>{let{keyframe:t,pathToProp:n}=e;return{keyframe:t,pathToProp:n.slice(a.length)}})}function DR(e){let{projectId:t,sheetId:n,objectKey:r,trackId:i,keyframeIds:a}=e,o=(0,AR.val)(O().atomP.historic.coreByProject[t].sheetsById[n].sequence.tracksByObject[r]),s=null==o?void 0:o.trackData[i];if(!s)return null;let l=function(e){let t={};for(let[n,r]of Object.entries(e))t[r]=n;return t}((null==o?void 0:o.trackIdByPropPath)||{})[i];if(!l)return null;let u=[r,..._M(l)];return a.map(e=>({keyframe:s.keyframes.find(t=>t.id===e),pathToProp:u})).filter(e=>{let{keyframe:t}=e;return void 0!==t})}function IR(e){return e.map((t,n)=>({left:t,right:e[n+1]})).slice(0,-1)}function TR(e){var t,n,r;let i=[];for(let[a,o]of Object.entries(null!=(t=null==e?void 0:e.byObjectKey)?t:{}))for(let[e,t]of Object.entries(null!=(n=null==o?void 0:o.byTrackId)?n:{}))i.push({objectKey:a,trackId:e,keyframeIds:Object.keys(null!=(r=null==t?void 0:t.byKeyframeId)?r:{})});return i}var AR,zR=k(()=>{AR=n(194),M(),bM()});function OR(e,t){return(0,FR.useMemo)(()=>function(e,t){let n=null,r=t=>O().tempTransaction(n=>e(n,t));function i(){null==n||n.discard(),n=null}let a={createAsset:t.sheet.project.assetStorage.createAsset,getAssetUrl:e=>e.id?t.sheet.project.assetStorage.getAssetUrl(e.id):void 0};return b({temporarilySetValue(e){i(),n=r(e)},discardTemporaryValue:i,permanentlySetValue(e){i(),r(e).commit()}},a)}(e,t),[])}var FR,MR=k(()=>{M(),FR=P(Oh())});function jR(e){var t;if("sheetObject"===e.type)return RR.default.createElement(RR.default.Fragment,null,RR.default.createElement(VR,{style:{paddingLeft:"".concat(e.indent*qR,"px")}},e.sheetObject.address.objectKey),e.children.map((t,n)=>RR.default.createElement(jR,x(b({key:n},t),{autoFocusInput:e.autoFocusInput&&0===n,indent:e.indent+1}))));if("propWithChildren"===e.type){let n=null!=(t=e.propConfig.label)?t:id(e.pathToProp);return RR.default.createElement(RR.default.Fragment,null,RR.default.createElement(VR,{style:{paddingLeft:"".concat(e.indent*qR,"px")}},n),e.children.map((t,n)=>RR.default.createElement(jR,x(b({key:n},t),{autoFocusInput:e.autoFocusInput&&0===n,indent:e.indent+1}))))}return RR.default.createElement(BR,x(b({},e),{autoFocusInput:e.autoFocusInput,indent:e.indent}))}function BR(e){var t;let n=null!=(t=e.propConfig.label)?t:id(e.pathToProp),r=function(e){let t=e.sheetObject;return OR((n,r)=>{let{stateEditors:i}=n,a=x(b({},e.keyframe),{value:r});i.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},t.address),{trackId:e.trackId,keyframes:[a],snappingFunction:t.sheet.getSequence().closestGridPosition}))},t)}(e);if("enum"===e.propConfig.type)return RR.default.createElement(RR.default.Fragment,null);{let t=DC[e.propConfig.type];return RR.default.createElement(NR,null,RR.default.createElement(VR,null,RR.default.createElement("span",{style:{paddingLeft:"".concat(e.indent*qR,"px")}},n)),RR.default.createElement(WR,null,RR.default.createElement(t,{editingTools:r,propConfig:e.propConfig,value:MC(e.keyframe.value,e.propConfig),autoFocus:e.autoFocusInput})))}}var RR,LR,NR,UR,VR,qR,HR,WR,ZR=k(()=>{RR=P(Oh()),Zp(),TC(),ad(),MR(),GC(),NR=Wp.div(LR||(LR=I(["\n  display: flex;\n  align-items: stretch;\n  min-width: 200px;\n\n  select {\n    min-width: 100px;\n  }\n"]))),VR=Wp.div(UR||(UR=I(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  line-height: 13px;\n  letter-spacing: 0.01em;\n  padding: 6px 6px 6px 0;\n\n  width: 40%;\n\n  color: #919191;\n\n  overflow: hidden;\n"]))),qR=10,WR=Wp.div(HR||(HR=I(["\n  display: flex;\n  align-items: center;\n  width: 60%;\n"])))});function KR(e){return cE({debugName:"useKeyframeInlineEditorPopover"},()=>GR.default.createElement(zE,{showPopoverEdgeTriangle:!0},GR.default.createElement("div",{style:{margin:"1px 2px 1px 10px"}},Array.isArray(e)?e.map((e,t)=>GR.default.createElement(jR,x(b({key:t},e),{autoFocusInput:0===t,indent:0}))):void 0)))}var GR,XR=k(()=>{GR=P(Oh()),OE(),ME(),ZR()});var $R,YR,JR,QR,eL,tL,nL,rL,iL,aL,oL,sL,lL,uL,cL,dL,hL,fL,pL,mL,gL=k(()=>{$R=P(Oh()),Zp(),M(),bP(),bx(),tv(),YR=n(194),Tj(),nx(),FM(),Dj(),sx(),zR(),Cv(),Zj(),XR(),dD(),QR=(JR=6)+2,eL={normalColor:"#40AAA4",selectedColor:"#F2C95C",inlineEditorOpenColor:"#FCF3DC",selectedAndInlineEditorOpenColor:"#CBEBEA"},tL=e=>{let{isSelected:t,isInlineEditorPopoverOpen:n}=e;return t&&n?eL.inlineEditorOpenColor:t?eL.selectedColor:n?eL.selectedAndInlineEditorOpenColor:eL.normalColor},rL=Wp.div(nL||(nL=I(["\n  position: absolute;\n  ","\n\n  background: ",";\n  transform: rotateZ(45deg);\n\n  ",";\n\n  z-index: 1;\n  pointer-events: none;\n"])),aj(JR),e=>tL(e),e=>2===e.flag?"outline: 2px solid white;":""),aL=Wp.div(iL||(iL=I(["\n  position: absolute;\n  ","\n\n  background: ",";\n\n  ",";\n\n  z-index: 1;\n  pointer-events: none;\n"])),aj(1.5*JR),e=>tL(e),e=>2===e.flag?"outline: 2px solid white;":""),sL=Wp.div(oL||(oL=I(["\n  z-index: 1;\n  cursor: ew-resize;\n\n  position: absolute;\n  ",";\n  ",";\n\n  & + "," {\n    ","\n  }\n\n  &:hover + "," {\n    ","\n  }\n"])),aj(12),av,rL,e=>e.isInlineEditorPopoverOpen?aj(QR):"",rL,aj(QR)),lL=e=>{let t=ix("SingleKeyframeDot",e.keyframe.id),n=PP(e.itemKey),[r,i]=Qy(null),[a]=function(e,t,n){return yP(e,{displayName:"Keyframe",menuItems:()=>{let e=PR(n.leaf.sheetObject.address.projectId,n.leaf.sheetObject.address.sheetId,n.selection);return[{label:e.length>0?"Copy (selection)":"Copy",callback:()=>{e.length>0?O().transaction(t=>{t.stateEditors.studio.ahistoric.setClipboardKeyframes(e)}):O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:n.keyframe,pathToProp:n.leaf.pathToProp}])})}},{label:void 0!==n.selection?"Delete (selection)":"Delete",callback:()=>{n.selection?n.selection.delete():O().transaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},n.leaf.sheetObject.address),{keyframeIds:[n.keyframe.id],trackId:n.leaf.trackId}))})}}]},onOpen(){t._debug("Show keyframe",n)}})}(i,t,e),{node:o,toggle:s,isOpen:l}=KR([{type:"primitiveProp",keyframe:e.keyframe,pathToProp:e.leaf.pathToProp,propConfig:e.leaf.propConf,sheetObject:e.leaf.sheetObject,trackId:e.leaf.trackId}]),[u]=function(e,t,n){let r=(0,$R.useRef)(t);r.current=t;let{onClickFromDrag:i}=n,a=(0,$R.useMemo)(()=>({debugName:"KeyframeDot/useDragKeyframe",onDragStart(t){let n=r.current;if(Fj(Mj((0,YR.val)(O().atomP.historic.coreByProject[n.leaf.sheetObject.address.projectId].sheetsById[n.leaf.sheetObject.address.sheetId].sequence.tracksByObject),function(e,t){let{trackId:r,objectKey:i}=t;var a,o;return e.id!==n.keyframe.id&&!(n.selection&&null!=(o=null==(a=n.selection.byObjectKey[i])?void 0:a.byTrackId[r])&&o.byKeyframeId[e.id])})),n.selection){let{selection:r,leaf:a}=n,{sheetObject:o}=a,s=r.getDragHandlers(x(b({},o.address),{domNode:e,positionAtStartOfDrag:n.track.data.keyframes[n.index].position})).onDragStart(t);return s&&x(b({},s),{onClick:i,onDragEnd:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null==(e=s.onDragEnd)||e.call(s,...n),Oj()}})}let a,o=n,s=(0,YR.val)(o.layoutP.scaledSpace.toUnitSpace);return{onDrag(t,n,r){var i;let l=o.track.data.keyframes[o.index],u=Math.max(null!=(i=zM.checkIfMouseEventSnapToPos(r,{ignore:e}))?i:l.position+s(t),0);null==a||a.discard(),a=void 0,a=O().tempTransaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},o.leaf.sheetObject.address),{trackId:o.leaf.trackId,keyframes:[x(b({},l),{position:u})],snappingFunction:(0,YR.val)(o.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(e){e?null==a||a.commit():null==a||a.discard(),Oj()},onClick(e){i(e)}}}}),[i]),[o]=gx(e,a);return gj(o,t.keyframe.position),Qb(o,"draggingPositionInSequenceEditor","ew-resize"),[o]}(i,e,{onClickFromDrag(e){s(e,r.current)}}),c=!e.keyframe.type||"bezier"===e.keyframe.type;return $R.default.createElement($R.default.Fragment,null,$R.default.createElement(sL,b({ref:r,isInlineEditorPopoverOpen:l},n.attrs)),c?$R.default.createElement(rL,{isSelected:!!e.selection,isInlineEditorPopoverOpen:l,flag:n.flag}):$R.default.createElement(aL,{isSelected:!!e.selection,isInlineEditorPopoverOpen:l,flag:n.flag}),o,a)},uL=lL}),yL=k(()=>{Ym(),cL=P(Oh()),Zp(),gL(),dL=JR/2+1,hL={normalColor:"#365b59",selectedColor:"#8A7842",barColor:e=>{let t=e.isSelected?hL.selectedColor:hL.normalColor;return e.isPopoverOpen?Gm(.2,Km(.2,t)):t},hoverColor:e=>{let t=e.isSelected?hL.selectedColor:hL.normalColor;return e.isPopoverOpen?Gm(.2,Km(.2,t)):Gm(.1,Km(.1,t))}},pL=Wp.div(fL||(fL=I(["\n  position: absolute;\n  background: ",";\n  height: ","px;\n  width: ","px;\n\n  left: 0;\n  top: -","px;\n  transform-origin: top left;\n  z-index: 0;\n  cursor: ew-resize;\n\n  &:after {\n    display: block;\n    position: absolute;\n    content: ' ';\n    top: -4px;\n    bottom: -4px;\n    left: 0;\n    right: 0;\n  }\n\n  &:hover {\n    background: ",";\n  }\n"])),hL.barColor,dL,1e3,dL/2,hL.hoverColor),mL=cL.default.forwardRef((e,t)=>{let n={isPopoverOpen:e.isPopoverOpen,isSelected:e.isSelected};return cL.default.createElement(pL,x(b({},n),{ref:t,style:{transform:"scaleX(calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(e.connectorLengthInUnitSpace/1e3,"))")},onClick:t=>{var n;null==(n=e.openPopover)||n.call(e,t)}}),e.children)})});var vL,_L,bL,xL,wL,kL,SL,EL,CL,PL,DL,IL,TL,AL,zL=k(()=>{M(),bP(),bx(),tv(),vL=n(194),_L=P(Oh()),bL=P(Oh()),OE(),ME(),SR(),yL(),gB(),Qh(),zR(),zR(),Zp(),wL=Wp(zE)(xL||(xL=I(["\n  --popover-outer-stroke: transparent;\n  --popover-inner-stroke: ",";\n"])),fB),kL=e=>{let{index:t,track:n}=e,r=n.data.keyframes[t],i=n.data.keyframes[t+1],[a,o]=Qy(null),{node:s,toggle:l,close:u}=cE(()=>{let t=(0,vL.val)(e.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:t.screenX+5,maxX:t.screenX+t.width-5}}},()=>_L.default.createElement(SL,x(b({},e),{closePopover:u}))),[c]=function(e,t,n,r){return yP(t,{displayName:"Tween",menuItems:()=>{let t=PR(e.leaf.sheetObject.address.projectId,e.leaf.sheetObject.address.sheetId,e.selection);return[{label:t.length>0?"Copy (selection)":"Copy",callback:()=>{t.length>0?O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes(t)}):O().transaction(t=>{t.stateEditors.studio.ahistoric.setClipboardKeyframes([{keyframe:n,pathToProp:e.leaf.pathToProp},{keyframe:r,pathToProp:e.leaf.pathToProp}])})}},{label:e.selection?"Delete (selection)":"Delete",callback:()=>{e.selection?e.selection.delete():O().transaction(t=>{let{stateEditors:i}=t;i.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},e.leaf.sheetObject.address),{keyframeIds:[n.id,r.id],trackId:e.leaf.trackId}))})}}]}})}(e,o,r,i);!function(e,t){let n=(0,bL.useRef)(t);n.current=t;let r=(0,bL.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(t){let r,i=n.current;if(i.selection){let{selection:n,leaf:r}=i,{sheetObject:a}=r;return n.getDragHandlers(x(b({},a.address),{domNode:e,positionAtStartOfDrag:i.track.data.keyframes[i.index].position})).onDragStart(t)}let a=i,o=(0,vL.val)(a.layoutP.sheet).getSequence(),s=(0,vL.val)(a.layoutP.scaledSpace.toUnitSpace);return{onDrag(e,t,n){let i=s(e);r&&(r.discard(),r=void 0),r=O().tempTransaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.transformKeyframes(x(b({},a.leaf.sheetObject.address),{trackId:a.leaf.trackId,keyframeIds:[a.keyframe.id,a.track.data.keyframes[a.index+1].id],translate:i,scale:1,origin:0,snappingFunction:o.closestGridPosition}))})},onDragEnd(e){e?r&&r.commit():r&&r.discard()}}}}),[]);gx(e,r)}(o,e);let d=i.position-r.position,h={isPopoverOpen:Rh(()=>wR(x(b({},e.leaf.sheetObject.address),{trackId:e.leaf.trackId,left:r,right:i})),[e.leaf.sheetObject.address,e.leaf.trackId,r,i]),isSelected:void 0!==e.selection};return _L.default.createElement(_L.default.Fragment,null,_L.default.createElement(mL,x(b({ref:a,connectorLengthInUnitSpace:d},h),{openPopover:e=>{o&&l(e,o)}}),s),c)},SL=_L.default.forwardRef((e,t)=>{let{index:n,track:{data:r},selection:i}=e,a=r.keyframes[n],o=r.keyframes[n+1],s=e.leaf.trackId,l=e.leaf.sheetObject.address,u=Rh(()=>CR(l.projectId,l.sheetId,i).getValue(),[l,i]),c=b({left:a,right:o,trackId:s},l);return _L.default.createElement(wL,{showPopoverEdgeTriangle:!1,ref:t},_L.default.createElement(bR,{curveConnection:c,additionalConnections:u,onRequestClose:e.closePopover}))})}),OL=k(()=>{EL=n(194),CL=P(Oh()),Zp(),zL(),gL(),DL=Wp.div(PL||(PL=I(["\n  position: absolute;\n"]))),IL=CL.default.createElement(CL.default.Fragment,null),TL=CL.default.memo(e=>{let{index:t,track:{data:n}}=e,r=n.keyframes[t],i=n.keyframes[t+1],a=r.connectedRight&&!!i;return CL.default.createElement(DL,{style:{top:"".concat(e.leaf.nodeHeight/2,"px"),left:"calc(".concat((0,EL.val)(e.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(r.position,"px))")}},CL.default.createElement(uL,x(b({},e),{itemKey:e.itemKey})),a?CL.default.createElement(kL,b({},e)):IL)}),AL=TL});function FL(e,t){return{label:"Paste Keyframes",enabled:t.length>0,callback:()=>{var n;let r=(0,ML.val)(e.layoutP.sheet).getSequence(),i=null==(n=t[0])?void 0:n.pathToProp,a=t.filter(e=>{let{keyframe:t,pathToProp:n}=e;return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(i,n)}).map(e=>{let{keyframe:t,pathToProp:n}=e;return t});O().transaction(t=>{let{stateEditors:n}=t;var i;r.position=r.closestGridPosition(r.position);let o=null==(i=function(e){let t=null;for(let n of e)(null===t||n.position<t.position)&&(t=n);return t}(a))?void 0:i.position;for(let s of a)n.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(x(b({},e.leaf.sheetObject.address),{trackId:e.leaf.trackId,position:r.position+s.position-o,handles:s.handles,value:s.value,snappingFunction:r.closestGridPosition,type:s.type}))})}}}var ML,jL,BL,RL,LL,NL,UL,VL,qL,HL=k(()=>{Qh(),ML=n(194),jL=P(Oh()),Zp(),OL(),bP(),tv(),M(),bM(),Zj(),xD(),RL=Wp.div(BL||(BL=I(["\n  position: relative;\n  height: 100%;\n  width: 100%;\n"]))),(LL=jL.default.memo(e=>{var t;let{layoutP:n,trackData:r,leaf:i}=e,[a,o]=Qy(null),{selectedKeyframeIds:s,selection:l}=Rh(()=>{let e=(0,ML.val)(n.selectionAtom),t=(0,ML.val)(e.pointer.current.byObjectKey[i.sheetObject.address.objectKey].byTrackId[i.trackId].byKeyframeId);return t?{selectedKeyframeIds:t,selection:(0,ML.val)(e.pointer.current)}:{selectedKeyframeIds:{},selection:void 0}},[n,i.trackId]),[u,c,d]=function(e,t){return yP(e,{displayName:"Keyframe Track",menuItems:()=>{var e;let n=null!=(e=(0,ML.val)(O().atomP.ahistoric.clipboard.keyframesWithRelativePaths))?e:[];return[FL(t,n)]}})}(o,e),h=Wh(Wj),f="snapToSome"===h.mode?null==(t=h.positions[i.sheetObject.address.objectKey])?void 0:t[i.trackId]:[],p="snapToAll"===h.mode,m=(0,jL.useMemo)(()=>({data:r,id:i.trackId,sheetObject:e.leaf.sheetObject}),[r,i.trackId]),g=r.keyframes.map((e,t)=>jL.default.createElement(AL,{key:"keyframe-"+e.id,itemKey:bD.forTrackKeyframe(i.sheetObject,i.trackId,e.id),keyframe:e,index:t,track:m,layoutP:n,leaf:i,selection:!0===s[e.id]?l:void 0})),y=f.map(e=>jL.default.createElement(qj,{key:"snap-target-"+e,layoutP:n,leaf:i,position:e})),v=p?r.keyframes.map(e=>jL.default.createElement(qj,{key:"additionalSnapTarget-".concat(e.id),layoutP:n,leaf:i,position:e.position})):null;return jL.default.createElement(RL,{ref:a,style:{background:d?"#444850 ":"unset"}},g,y,jL.default.createElement(jL.default.Fragment,null,v),u)})).displayName="BasicKeyframedTrack",NL=LL}),WL=k(()=>{M(),Qh(),UL=n(194),VL=P(Oh()),cB(),HL(),sx(),qL=e=>{let{leaf:t,layoutP:n}=e,r=ix("PrimitivePropRow",t.pathToProp.join());return Rh(()=>{let{sheetObject:e}=t,{trackId:i}=t,a=(0,UL.val)(O().atomP.historic.coreByProject[e.address.projectId].sheetsById[e.address.sheetId].sequence.tracksByObject[e.address.objectKey].trackData[i]);return"BasicKeyframedTrack"!==(null==a?void 0:a.type)?(r.errorDev("trackData type ".concat(null==a?void 0:a.type," is not yet supported on the sequence editor")),VL.default.createElement(lB,{leaf:t,isCollapsed:!1,node:VL.default.createElement("div",null)})):VL.default.createElement(lB,{leaf:t,isCollapsed:!1,node:VL.default.createElement(NL,{layoutP:n,trackData:a,leaf:t})})},[t,n])}});var ZL=k(()=>{});function KL(e){let{index:t,aggregateKeyframes:n,selection:r}=e;return Rh(GL(e),[t,n,r,e.viewModel])}function GL(e){let{index:t,aggregateKeyframes:n,selection:r}=e,{projectId:i,sheetId:a}="sheet"===e.viewModel.type?e.viewModel.sheet.address:e.viewModel.sheetObject.address;return()=>{let o=n[t],s=n[t+1],l=s&&o.keyframes.length===s.keyframes.length&&o.keyframes.every((e,t)=>{let{track:n}=e;return s.keyframes[t].track===n})?{length:s.position-o.position,selected:0===o.selected&&0===s.selected}:null,u=l?o.keyframes.map((e,t)=>{let{kf:n,track:r}=e;return x(b({},r.sheetObject.address),{trackId:r.id,left:n,right:s.keyframes[t].kf})}):[],c=function(e){return e()}(()=>{let e=XL.prism.memo("selectedConnections",()=>CR(i,a,r),[i,a,r]).getValue();return[...u,...e]}),d=u.every(e=>wR(e));return{itemKey:XL.prism.memo("itemKey",()=>"sheet"===e.viewModel.type?bD.forSheetAggregateKeyframe(e.viewModel.sheet,o.position):"sheetObject"===e.viewModel.type?bD.forSheetObjectAggregateKeyframe(e.viewModel.sheetObject,o.position):bD.forCompoundPropAggregateKeyframe(e.viewModel.sheetObject,e.viewModel.pathToProp,o.position),[e.viewModel,o.position]),cur:o,connected:l,isAggregateEditingInCurvePopover:d,allConnections:c}}}var XL,$L=k(()=>{XL=n(194),xD(),SR(),Qh(),zR(),ZL()});var YL,JL,QL,eN,tN,nN,rN=k(()=>{YL=n(194),JL=P(Oh()),yL(),OE(),tv(),M(),bx(),SR(),$L(),Zp(),ME(),zR(),bP(),bM(),eN=Wp(zE)(QL||(QL=I(["\n  --popover-outer-stroke: transparent;\n  --popover-inner-stroke: rgba(26, 28, 30, 0.97);\n"]))),tN=JL.default.forwardRef((e,t)=>{let{allConnections:n}=KL(e);return JL.default.createElement(eN,{showPopoverEdgeTriangle:!1,ref:t},JL.default.createElement(bR,{curveConnection:n[0],additionalConnections:n,onRequestClose:e.closePopover}))}),nN=e=>{let[t,n]=Qy(null),{editorProps:r}=e,[i]=function(e,t){return yP(t,{displayName:"Aggregate Tween",menuItems:()=>{let t=e.utils.allConnections.reduce((e,t)=>{var n;return e.concat(null!=(n=DR(x(b({},t),{keyframeIds:[t.left.id,t.right.id]})))?n:[])},[]),n=yM(t.map(e=>e.pathToProp)),r=t.map(e=>{let{keyframe:t,pathToProp:r}=e;return{keyframe:t,pathToProp:r.slice(n.length)}}),i=e.editorProps.viewModel,a="sheet"===i.type?i.sheet.address:i.sheetObject.address;return[{label:"Copy",callback:()=>{if(e.editorProps.selection){let t=PR(a.projectId,a.sheetId,e.editorProps.selection);O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes(t)})}else O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes(r)})}},{label:"Delete",callback:()=>{e.editorProps.selection?e.editorProps.selection.delete():O().transaction(t=>{let{stateEditors:n}=t;for(let r of e.utils.allConnections)n.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},a),{objectKey:r.objectKey,keyframeIds:[r.left.id,r.right.id],trackId:r.trackId}))})}}]}})}(e,n),[a]=function(e,t){let n=(0,JL.useRef)(t);n.current=t;let r=(0,JL.useMemo)(()=>({debugName:"useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(t){let r,i=n.current,a=i.aggregateKeyframes[i.index].keyframes,{selection:o,viewModel:s}=i,l="sheet"===s.type?s.sheet.address:s.sheetObject.address;if(o&&0===i.aggregateKeyframes[i.index].selected)return o.getDragHandlers(x(b({},l),{domNode:e,positionAtStartOfDrag:i.aggregateKeyframes[i.index].position})).onDragStart(t);let u=i,c=(0,YL.val)(u.layoutP.sheet).getSequence(),d=(0,YL.val)(u.layoutP.scaledSpace.toUnitSpace);return{onDrag(e,t,n){let i=d(e);r&&(r.discard(),r=void 0),r=O().tempTransaction(e=>{let{stateEditors:t}=e;for(let n of a)t.coreByProject.historic.sheetsById.sequence.transformKeyframes(x(b({},n.track.sheetObject.address),{trackId:n.track.id,keyframeIds:[n.kf.id,n.track.data.keyframes[n.track.data.keyframes.indexOf(n.kf)+1].id],translate:i,scale:1,origin:0,snappingFunction:c.closestGridPosition}))})},onDragEnd(e){e?r&&r.commit():r&&r.discard()}}}}),[]);return gx(e,r)}(n,e.editorProps),{node:o,toggle:s,close:l}=cE(()=>{let e=(0,YL.val)(r.layoutP.rightDims);return{debugName:"Connector",constraints:{minX:e.screenX+5,maxX:e.screenX+e.width-5}}},()=>JL.default.createElement(tN,x(b({},r),{closePopover:l}))),{connected:u,isAggregateEditingInCurvePopover:c}=e.utils;return u||a?JL.default.createElement(JL.default.Fragment,null,JL.default.createElement(mL,{ref:t,connectorLengthInUnitSpace:u?u.length:0,isSelected:!!u&&u.selected,isPopoverOpen:c,openPopover:e=>{n&&s(e,n)}}),o,i):JL.default.createElement(JL.default.Fragment,null)}});function iN(e){let t={isSelected:e.isSelected,flag:e.flag};return aN.default.createElement(sN,null,e.isAllHere?aN.default.createElement(mN,b({},t)):aN.default.createElement(gN,b({},t)))}var aN,oN,sN,lN,uN,cN,dN,hN,fN,pN,mN,gN,yN=k(()=>{aN=P(Oh()),Zp(),Dj(),Cv(),sN=Wp.div(oN||(oN=I(["\n  position: absolute;\n  ","\n  z-index: 1;\n"])),aj(16)),uN=Wp.div(lN||(lN=I(["\n  z-index: 2;\n  cursor: ew-resize;\n\n  position: absolute;\n  ",";\n  ",";\n\n  &:hover\n    + ",",\n    #pointer-root.draggingPositionInSequenceEditor\n    &:hover\n    + "," {\n    ","\n  }\n"])),aj(12),av,sN,sN,aj(18)),cN="#F2C95C",dN="#40AAA4",hN="#45747C",fN=e=>0===e.isSelected?cN:1===e.isSelected?dN:hN,pN=e=>0===e.isSelected?cN:1===e.isSelected?dN:hN,mN=e=>aN.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},aN.default.createElement("rect",{x:"4.46443",y:"10.0078",width:"5",height:"5",transform:"rotate(-45 4.46443 10.0078)",fill:"#212327",stroke:pN(e)}),aN.default.createElement("rect",{x:"3.75732",y:"6.01953",width:"6",height:"6",transform:"rotate(-45 3.75732 6.01953)",fill:fN(e),stroke:2===e.flag?"white":void 0,strokeWidth:2===e.flag?"2px":void 0})),gN=e=>aN.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},aN.default.createElement("rect",{x:"4.46443",y:"8",width:"5",height:"5",transform:"rotate(-45 4.46443 8)",fill:"#23262B",stroke:2===e.flag?"white":fN(e),strokeWidth:2===e.flag?"2px":void 0}))});function vN(e,t){let n=e.children.map(e=>"propWithChildren"===e.type?vN(e,t):_N(e,t)).filter(wN);return 0===n.length?null:{type:"propWithChildren",pathToProp:e.pathToProp,propConfig:e.propConf,children:n}}function _N(e,t){let n=t.find(t=>t.track.id===e.trackId);return n?{type:"primitiveProp",keyframe:n.kf,pathToProp:e.pathToProp,propConfig:e.propConf,sheetObject:e.sheetObject,trackId:e.trackId}:null}function bN(e){var t,n,r,i;let{cur:a}=e.utils,o=KR("sheet"===e.editorProps.viewModel.type?null:"sheetObject"===e.editorProps.viewModel.type?null!=(n=null==(t=function(e,t){let n=e.children.map(e=>"propWithChildren"===e.type?vN(e,t):_N(e,t)).filter(wN);return 0===n.length?null:{type:"sheetObject",sheetObject:e.sheetObject,children:n}}(e.editorProps.viewModel,a.keyframes))?void 0:t.children)?n:null:null!=(i=null==(r=vN(e.editorProps.viewModel,a.keyframes))?void 0:r.children)?i:null),s=PP(e.utils.itemKey);s.useRelations(()=>a.keyframes.map(e=>({affects:e.itemKey,flag:2})),[a.keyframes.map(e=>e.track.id).join("-")]);let[l,u]=Qy(null),[c]=function(e,t){return yP(t,{displayName:"Aggregate Keyframe",menuItems:()=>{let t=e.editorProps.viewModel,n=e.editorProps.selection;return[{label:n?"Copy (selection)":"Copy",callback:()=>{if(n){let{projectId:e,sheetId:r}="sheet"===t.type?t.sheet.address:t.sheetObject.address,i=PR(e,r,n);O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes(i)})}else{let n=e.utils.cur.keyframes.flatMap(e=>{var t;return null!=(t=DR(x(b({},e.track.sheetObject.address),{trackId:e.track.id,keyframeIds:[e.kf.id]})))?t:[]}),r=yM(["sheet"===t.type?[]:"sheetObject"===t.type?[t.sheetObject.address.objectKey]:"propWithChildren"===t.type?[t.sheetObject.address.objectKey,...t.pathToProp]:[],...n.map(e=>e.pathToProp)]),i=n.map(e=>{let{keyframe:t,pathToProp:n}=e;return{keyframe:t,pathToProp:n.slice(r.length)}});O().transaction(e=>{e.stateEditors.studio.ahistoric.setClipboardKeyframes(i)})}}},{label:n?"Delete (selection)":"Delete",callback:()=>{n?n.delete():O().transaction(t=>{let{stateEditors:n}=t;for(let r of e.utils.cur.keyframes)n.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},r.track.sheetObject.address),{keyframeIds:[r.kf.id],trackId:r.track.id}))})}}]}})}(e,u);return xN.default.createElement(xN.default.Fragment,null,xN.default.createElement(uN,x(b(b({ref:l},s.attrs),zM.includePositionSnapAttrs(a.position)),{onClick:t=>"sheet"!==e.editorProps.viewModel.type?o.open(t,l.current):null})),xN.default.createElement(iN,{flag:s.flag,isAllHere:a.allHere,isSelected:a.selected}),c,o.node)}var xN,wN,kN,SN,EN,CN,PN,DN,IN=k(()=>{xN=P(Oh()),tv(),dD(),bP(),yN(),M(),zR(),bM(),FM(),XR(),wN=e=>null!==e}),TN=k(()=>{kN=n(194),SN=P(Oh()),Zp(),rN(),$L(),IN(),CN=Wp.div(EN||(EN=I(["\n  position: absolute;\n"]))),PN=SN.default.memo(e=>{let t=KL(e);return SN.default.createElement(CN,{style:{top:"".concat(e.viewModel.nodeHeight/2,"px"),left:"calc(".concat((0,kN.val)(e.layoutP.scaledSpace.leftPadding),"px + calc(var(--unitSpaceToScaledSpaceMultiplier) * ").concat(t.cur.position,"px))")}},SN.default.createElement(bN,{editorProps:e,utils:t}),SN.default.createElement(nN,{editorProps:e,utils:t}))}),DN=PN});function AN(e){let{layoutP:t,aggregatedKeyframes:n,viewModel:r}=e,i=ix("AggregatedKeyframeTrack"),[a,o]=Qy(null),{selectedPositions:s,selection:l}=function(e,t){return Rh(()=>(0,BN.val)(function(e,t){return(0,BN.prism)(()=>{let n=(0,BN.val)(e.selectionAtom),r=(0,BN.val)(n.pointer.current);if(!r)return UN;let i=new Map;for(let[e,a]of t.byPosition){let t=zN(a,r);void 0!==t&&t!==KN&&i.set(e,t)}return{selectedPositions:i,selection:(0,BN.val)(n.pointer.current)}})}(e,t)),[e,t])}(t,n),[u,c,d]=function(e,t,n){return yP(e,{onOpen:n,displayName:"Aggregate Keyframe Track",menuItems:()=>{var e;let n=null!=(e=(0,BN.pointerToPrism)(O().atomP.ahistoric.clipboard.keyframesWithRelativePaths).getValue())?e:[];return[ON(t,n)]}})}(o,e,()=>i._debug("see aggregatedKeyframes",e.aggregatedKeyframes)),h=(0,RN.useMemo)(()=>[...n.byPosition.entries()].sort((e,t)=>e[0]-t[0]).map(e=>{let[t,r]=e;return{position:t,keyframes:r,selected:s.get(t),allHere:r.length===n.tracks.length}}),[n,s]),f=Wh(Wj),p="snapToAll"===f.mode,m="snapToSome"===f.mode?f.positions:ED,g=(0,RN.useMemo)(()=>"sheet"===r.type?function(e,t){return Dh(e.children.flatMap(e=>RM(e,t)))}(r,m):RM(r,m),[m]).map(e=>RN.default.createElement(qj,{key:"snap-target-"+e,layoutP:t,leaf:r,position:e})),y=(0,RN.useMemo)(()=>h.map((e,n)=>{let{position:i,keyframes:a}=e;return{position:i,editorProps:{index:n,layoutP:t,viewModel:r,aggregateKeyframes:h,selection:s.has(i)?l:void 0}}}),[h,r,s]),[v]=function(e,t,n){let r=ix("useDragForAggregateKeyframeDot"),i=mj(),a=(0,RN.useMemo)(()=>({debugName:"AggregateKeyframeDot/useDragKeyframe",onDragStart(a){r._debug("onDragStart",{target:a.target});let o=Number(a.target.dataset.pos),s=t(o);if(!s)return r._debug("no props found for ",{positionToFind:o}),!1;i(!0,o);let l=(0,BN.prism)(GL(s)).getValue().cur.keyframes,u="sheet"===s.viewModel.type?s.viewModel.sheet.address:s.viewModel.sheetObject.address,c=Mj((0,BN.val)(O().atomP.historic.coreByProject[u.projectId].sheetsById[u.sheetId].sequence.tracksByObject),function(e,t){let{trackId:n,objectKey:r}=t;var i,a;return l.every(t=>e.id!==t.kf.id)&&!(s.selection&&null!=(a=null==(i=s.selection.byObjectKey[r])?void 0:i.byTrackId[n])&&a.byKeyframeId[e.id])});if(Fj(c),s.selection&&0===s.aggregateKeyframes[s.index].selected){let{selection:t,viewModel:r}=s,i=t.getDragHandlers(x(b({},u),{domNode:e,positionAtStartOfDrag:l[0].kf.position})).onDragStart(a);return i&&x(b({},i),{onClick:n.onClickFromDrag,onDragEnd:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];null==(e=i.onDragEnd)||e.call(i,...n),Oj()}})}let d,h=s,f=(0,BN.val)(h.layoutP.scaledSpace.toUnitSpace);return{onDrag(e,t,n){var r;let a=Math.max(null!=(r=zM.checkIfMouseEventSnapToPos(n,{}))?r:l[0].kf.position+f(e),0);i(!0,a),null==d||d.discard(),d=void 0,d=O().tempTransaction(e=>{let{stateEditors:t}=e;for(let n of l){let e=n.kf;t.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},n.track.sheetObject.address),{trackId:n.track.id,keyframes:[x(b({},e),{position:a})],snappingFunction:(0,BN.val)(h.layoutP.sheet).getSequence().closestGridPosition}))}})},onDragEnd(e){i(!1,-1),e?null==d||d.commit():(null==d||d.discard(),n.onClickFromDrag(a)),Oj()},onClick(e){n.onClickFromDrag(e)}}}}),[t,n.onClickFromDrag]),[o]=gx(e,a);return Qb(o,"draggingPositionInSequenceEditor","ew-resize"),[o]}(o,e=>{var t;return null==(t=y.find(t=>t.position===e))?void 0:t.editorProps},{onClickFromDrag(e){}}),_=y.map((e,n)=>RN.default.createElement(RN.Fragment,{key:"agg-"+h[n].keyframes[0].kf.id},p&&RN.default.createElement(qj,{layoutP:t,leaf:r,position:e.position}),RN.default.createElement(DN,b({},e.editorProps))));return RN.default.createElement(NN,{ref:a,style:{background:d?"#444850 ":"unset"}},_,g,u)}function zN(e,t){var n,r,i;let a;for(let{track:o,kf:s}of e){let e=!0===(null==(i=null==(r=null==(n=t.byObjectKey[o.sheetObject.address.objectKey])?void 0:n.byTrackId[o.id])?void 0:r.byKeyframeId)?void 0:i[s.id]);void 0===a?a=e?WN:KN:e?a===KN&&(a=ZN):a===WN&&(a=ZN)}return a}function ON(e,t){return{label:"Paste Keyframes",enabled:t.length>0,callback:()=>{let n=(0,BN.val)(e.layoutP.sheet).getSequence();"sheet"===e.viewModel.type?function(e,t,n){var r;let{projectId:i,sheetId:a,sheetInstanceId:o}=e.sheet.address;if(t.every(e=>{let{pathToProp:t}=e;return 0===t.length}))for(let s of e.children.map(e=>e.sheetObject)){let e=(0,BN.pointerToPrism)(O().atomP.historic.coreByProject[i].sheetsById[a].sequence.tracksByObject[s.address.objectKey]).getValue(),o=Object.keys(null!=(r=null==e?void 0:e.trackData)?r:{});FN(s.address,o,t,n)}else{let e=(0,BN.pointerToPrism)(O().atomP.historic.coreByProject[i].sheetsById[a].sequence.tracksByObject).getValue();MN(t.map(t=>{let{keyframe:n,pathToProp:r}=t;var s,l;let u=r[0],c=r.slice(1),d=vM([...c]),h=(null!=(l=null==(s=null==e?void 0:e[u])?void 0:s.trackIdByPropPath)?l:{})[d];return h?{keyframe:n,trackId:h,address:{objectKey:u,projectId:i,sheetId:a,sheetInstanceId:o}}:null}).filter(e=>null!==e),n)}}(e.viewModel,t,n):function(e,t,n){var r;let{projectId:i,sheetId:a,objectKey:o}=e.sheetObject.address,s=(0,BN.pointerToPrism)(O().atomP.historic.coreByProject[i].sheetsById[a].sequence.tracksByObject[o]).getValue();if(t.every(e=>{let{pathToProp:t}=e;return 0===t.length})){let i=Object.keys(null!=(r=null==s?void 0:s.trackData)?r:{});if("sheetObject"===e.type)FN(e.sheetObject.address,i,t,n);else{let r=(null==s?void 0:s.trackIdByPropPath)||{},i=Object.entries(r).filter(t=>{let[n,r]=t;return void 0!==r&&function(e,t){return t.every((t,n)=>t===e[n])}(_M(n),e.pathToProp)}).map(e=>{let[t,n]=e;return n});FN(e.sheetObject.address,i,t,n)}}else{let r=(null==s?void 0:s.trackIdByPropPath)||{},i="propWithChildren"===e.type?e.pathToProp:[];MN(t.map(t=>{let{keyframe:n,pathToProp:a}=t,o=vM([...i,...a]),s=r[o];return s?{keyframe:n,trackId:s,address:e.sheetObject.address}:null}).filter(e=>null!==e),n)}}(e.viewModel,t,n)}}}function FN(e,t,n,r){var i;r.position=r.closestGridPosition(r.position);let a=null==(i=jN(n.map(e=>{let{keyframe:t}=e;return t})))?void 0:i.position;O().transaction(i=>{let{stateEditors:o}=i;for(let s of t)for(let{keyframe:t}of n)o.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(x(b({},e),{trackId:s,position:r.position+t.position-a,handles:t.handles,value:t.value,snappingFunction:r.closestGridPosition,type:t.type}))})}function MN(e,t){var n;t.position=t.closestGridPosition(t.position);let r=null==(n=jN(e.map(e=>{let{keyframe:t}=e;return t})))?void 0:n.position;O().transaction(n=>{let{stateEditors:i}=n;for(let{keyframe:a,trackId:o,address:s}of e)i.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(x(b({},s),{trackId:o,position:t.position+a.position-r,handles:a.handles,value:a.value,snappingFunction:t.closestGridPosition,type:a.type}))})}function jN(e){let t=null;for(let n of e)(null===t||n.position<t.position)&&(t=n);return t}var BN,RN,LN,NN,UN,VN,qN,HN,WN,ZN,KN,GN,XN,$N,YN,JN,QN,eU,tU,nU,rU,iU,aU,oU,sU=k(()=>{var e;Qh(),BN=n(194),RN=P(Oh()),Zp(),bP(),tv(),TN(),NM(),sx(),$L(),FM(),bx(),Tj(),nx(),M(),bM(),Zj(),PD(),Zj(),NM(),NN=Wp.div(LN||(LN=I(["\n  position: relative;\n  height: 100%;\n  width: 100%;\n"]))),UN=Object.freeze({selectedPositions:new Map,selection:void 0}),VN=RN.default.memo(AN),qN=VN,(e=HN||{})[e.AllSelected=0]="AllSelected",e[e.AtLeastOneUnselected=1]="AtLeastOneUnselected",e[e.NoneSelected=2]="NoneSelected",HN=e,({AllSelected:WN,AtLeastOneUnselected:ZN,NoneSelected:KN}=HN)}),lU=k(()=>{Qh(),GN=P(Oh()),WL(),cB(),sU(),NM(),sx(),XN=(e,t)=>"propWithChildren"===e.type?GN.default.createElement($N,{layoutP:t,viewModel:e,key:"prop"+e.pathToProp[e.pathToProp.length-1]}):GN.default.createElement(qL,{layoutP:t,leaf:e,key:"prop"+e.pathToProp[e.pathToProp.length-1]}),$N=e=>{let{viewModel:t,layoutP:n}=e,r=ix("RightPropWithChildrenRow",t.pathToProp.join());return Rh(()=>{let e=MM(t);return GN.default.createElement(rx,{logger:r},GN.default.createElement(lB,{leaf:t,node:GN.default.createElement(qN,{layoutP:n,aggregatedKeyframes:e,viewModel:t}),isCollapsed:t.isCollapsed},t.children.map(e=>XN(e,n))))},[t,n])}}),uU=k(()=>{Qh(),YN=P(Oh()),lU(),cB(),NM(),sU(),JN=e=>{let{leaf:t,layoutP:n}=e;return Rh(()=>{let e=MM(t);return YN.default.createElement(lB,{leaf:t,node:YN.default.createElement(qN,{layoutP:n,aggregatedKeyframes:e,viewModel:t}),isCollapsed:t.isCollapsed},t.children.map(e=>XN(e,n)))},[t,n])}}),cU=k(()=>{Qh(),QN=P(Oh()),uU(),cB(),NM(),sU(),eU=e=>{let{leaf:t,layoutP:n}=e;return Rh(()=>{let e=MM(t);return QN.default.createElement(lB,{leaf:t,node:QN.default.createElement(qN,{layoutP:n,aggregatedKeyframes:e,viewModel:t}),isCollapsed:t.isCollapsed},t.children.map(e=>QN.default.createElement(JN,{layoutP:n,key:"sheetObject-"+e.sheetObject.address.objectKey,leaf:e})))},[t,n])}}),dU=k(()=>{Qh(),tU=n(194),nU=P(Oh()),Zp(),Ej(),uB(),cU(),rU=1e6,aU=Wp.ul(iU||(iU=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n  position: absolute;\n  left: 0;\n  width: ","px;\n"])),rU),oU=e=>{let{layoutP:t}=e;return Rh(()=>{let e=(0,tU.val)(t.tree),n=(0,tU.val)(t.tree.top)+Math.max((0,tU.val)(t.tree.heightIncludingChildren),(0,tU.val)(t.dopeSheetDims.height));return nU.default.createElement(nU.default.Fragment,null,nU.default.createElement(eB,{layoutP:t,height:n},nU.default.createElement(YM,{layoutP:t,height:n},nU.default.createElement(aU,{style:{top:e.top+"px"}},nU.default.createElement(eU,{leaf:e,layoutP:t})))))},[t])}});function hU(e,t,n,r){let i="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(e,"px)"),a="calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(t,") * 1px)");0===n&&(n=1e-4);let o="calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(n,")");0===r&&(r=.001);let s="calc(var(--graphEditorVerticalSpace) * ".concat(-1*r,")");return"translate(".concat(i,", ").concat(a,") scale(").concat(o,", ").concat(s,")")}var fU,pU,mU,gU,yU=k(()=>{GC(),M(),bP(),tv(),fU=P(Oh()),Zp(),mU=Wp.path(pU||(pU=I(["\n  stroke-width: 2;\n  stroke: var(--main-color);\n  fill: none;\n  vector-effect: non-scaling-stroke;\n"]))),gU=e=>{let{index:t,trackData:n}=e,r=n.keyframes[t],i=n.keyframes[t+1],a=i.position-r.position,[o,s]=Qy(null),[l]=function(e,t){let{index:n,trackData:r}=t,i=r.keyframes[n],a=r.keyframes[n+1];return yP(e,{menuItems:()=>[{label:"Delete",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e,{deleteKeyframes:r}=n.coreByProject.historic.sheetsById.sequence;r(x(b({},t.sheetObject.address),{trackId:t.trackId,keyframeIds:[i.id,a.id]}))})}}]})}(s,e),u=e.isScalar?MC(r.value,e.propConfig):0,c=e.isScalar?MC(i.value,e.propConfig):1,d=e.extremumSpace.fromValueSpace(u),h=e.extremumSpace.fromValueSpace(c)-d,f=hU(r.position,d,a,h),p=r.handles[2],m=r.handles[3],g=i.handles[0],y=i.handles[1],v="M 0 0 C ".concat(p," ").concat(m," ").concat(g," ").concat(y," 1 1");return fU.default.createElement(fU.default.Fragment,null,fU.default.createElement(mU,{ref:o,d:r.type&&"bezier"!==r.type?"M 0 0 L 1 0 L 1 1":v,style:{transform:f}}),l)}});var vU,_U,bU,xU,wU,kU,SU,EU,CU,PU=k(()=>{M(),bP(),bx(),tv(),vU=n(194),Th(),_U=P(Oh()),Zp(),yU(),Cv(),xU=Wp.circle(bU||(bU=I(["\n  stroke-width: 1px;\n  vector-effect: non-scaling-stroke;\n  fill: var(--main-color);\n  r: 2px;\n  pointer-events: none;\n"]))),kU=Wp.circle(wU||(wU=I(["\n  stroke-width: 6px;\n  vector-effect: non-scaling-stroke;\n  r: 6px;\n  fill: transparent;\n  cursor: move;\n  ",";\n  &:hover {\n  }\n  &:hover + "," {\n    r: 6px;\n  }\n"])),av,xU),EU=Wp.path(SU||(SU=I(["\n  stroke-width: 1;\n  stroke: var(--main-color);\n  /* stroke: gray; */\n  fill: none;\n  vector-effect: non-scaling-stroke;\n"]))),CU=e=>{let[t,n]=Qy(null),{index:r,trackData:i}=e,a=i.keyframes[r],o=i.keyframes[r+1],[s]=function(e,t){return yP(e,{menuItems:()=>[{label:"Delete",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},t.sheetObject.address),{keyframeIds:[t.keyframe.id],trackId:t.trackId}))})}}]})}(n,e);!function(e,t){let n=(0,_U.useRef)(t);n.current=t,gx(e,(0,_U.useMemo)(()=>({debugName:"CurveHandler/useOurDrags",lockCSSCursorTo:"move",onDragStart(){let e,r=n.current,i=(0,vU.val)(r.layoutP.scaledSpace.toUnitSpace),a=(0,vU.val)(r.layoutP.graphEditorVerticalSpace.toExtremumSpace),o=r.extremumSpace.lock();return{onDrag(n,o){e&&(e.discard(),e=void 0);let{index:s,trackData:l}=r,u=l.keyframes[s],c=l.keyframes[s+1],d=i(n)/(c.position-u.position),h=a(-o),f=r.extremumSpace.deltaToValueSpace(h),p=t.isScalar?u.value:0,m=f/((t.isScalar?c.value:1)-p);if("left"===r.which){let t=ms(u.handles[2]+d,0,1),n=u.handles[3]+m;e=O().tempTransaction(e=>{let{stateEditors:i}=e;i.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},r.sheetObject.address),{snappingFunction:(0,vU.val)(r.layoutP.sheet).getSequence().closestGridPosition,trackId:r.trackId,keyframes:[x(b({},u),{handles:[u.handles[0],u.handles[1],t,n]})]}))})}else{let t=ms(c.handles[0]+d,0,1),n=c.handles[1]+m;e=O().tempTransaction(e=>{let{stateEditors:i}=e;i.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},r.sheetObject.address),{trackId:r.trackId,snappingFunction:(0,vU.val)(r.layoutP.sheet).getSequence().closestGridPosition,keyframes:[x(b({},c),{handles:[t,n,c.handles[2],c.handles[3]]})]}))})}},onDragEnd(t){o(),t?e&&e.commit():e&&e.discard()}}}}),[]))}(n,e);let l="left"===e.which?a.handles[2]:o.handles[0],u=a.position+(o.position-a.position)*l,c="left"===e.which?a.handles[3]:o.handles[1],d=e.isScalar?a.value:0,h=e.isScalar?o.value:1,f=d+(h-d)*c,p=e.extremumSpace.fromValueSpace(f),m=p-e.extremumSpace.fromValueSpace("left"===e.which?d:h),g=hU("left"===e.which?a.position:o.position,e.extremumSpace.fromValueSpace("left"===e.which?d:h),u-("left"===e.which?a.position:o.position),m);return _U.default.createElement("g",null,_U.default.createElement(kU,{ref:t,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(u," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(p,") * 1px)")}}),_U.default.createElement(xU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(u," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(p,") * 1px)")}}),_U.default.createElement(EU,{d:"M 0 0 L 1 1",style:{transform:g}}),s)}});var DU,IU,TU,AU,zU,OU,FU,MU=k(()=>{M(),bP(),bx(),tv(),DU=n(194),IU=P(Oh()),Zp(),Tj(),Tj(),Cv(),nx(),FM(),XR(),dD(),AU=Wp.circle(TU||(TU=I(["\n  fill: var(--main-color);\n  stroke-width: 1px;\n  vector-effect: non-scaling-stroke;\n\n  r: 2px;\n"]))),OU=Wp.circle(zU||(zU=I(["\n  stroke-width: 6px;\n  vector-effect: non-scaling-stroke;\n  r: 6px;\n  fill: transparent;\n  ",";\n\n  &:hover + "," {\n    r: 6px;\n  }\n\n  #pointer-root.normal & {\n    cursor: move;\n  }\n\n  #pointer-root.draggingPositionInSequenceEditor & {\n    pointer-events: auto;\n    cursor: var(",");\n  }\n\n  &.beingDragged {\n    pointer-events: none !important;\n  }\n"])),av,AU,Kb),FU=e=>{let[t,n]=Qy(null),{index:r,trackData:i}=e,a=i.keyframes[r],[o]=function(e,t){return yP(e,{menuItems:()=>[{label:"Delete",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},t.sheetObject.address),{keyframeIds:[t.keyframe.id],trackId:t.trackId}))})}}]})}(n,e),s=PP(e.itemKey),l=a.value,u=e.extremumSpace.fromValueSpace(l),c=KR([{type:"primitiveProp",keyframe:e.keyframe,pathToProp:e.pathToProp,propConfig:e.propConfig,sheetObject:e.sheetObject,trackId:e.trackId}]),d=function(e){let[t,n]=(0,IU.useState)(!1);gj(t,e.props.keyframe.position);let r=(0,IU.useRef)(e.props);r.current=e.props;let i=(0,IU.useMemo)(()=>({debugName:"GraphEditorDotScalar/useDragKeyframe",lockCSSCursorTo:"move",onDragStart(t){n(!0);let i,a=!!t.altKey,o=r.current,s=(0,DU.val)(o.layoutP.scaledSpace.toUnitSpace),l=(0,DU.val)(o.layoutP.graphEditorVerticalSpace.toExtremumSpace),u=o.extremumSpace.lock();return{onDrag(e,t){let n=o.trackData.keyframes[o.index],r=s(e),u=l(-t),c=o.extremumSpace.deltaToValueSpace(u),d=[],h=x(b({},n),{position:n.position+r,value:n.value+c,handles:[...n.handles]});if(d.push(h),a){let e=o.trackData.keyframes[o.index-1];if(e&&Math.abs(n.value-e.value)>0){let t=x(b({},e),{handles:[...e.handles]});d.push(t),t.handles[3]=function(e,t,n,r,i){return(r-t)*e/(i-n)}(e.handles[3],e.value,e.value,n.value,h.value)}let t=o.trackData.keyframes[o.index+1];if(t&&Math.abs(n.value-t.value)>0){let e=x(b({},t),{handles:[...t.handles]});d.push(e),e.handles[1]=function(e,t,n,r,i){return((t-r)*e+r-t+n-i)/(n-i)}(e.handles[1],e.value,e.value,n.value,h.value)}}null==i||i.discard(),i=O().tempTransaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},o.sheetObject.address),{trackId:o.trackId,keyframes:d,snappingFunction:(0,DU.val)(o.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(r){n(!1),u(),r?null==i||i.commit():(null==i||i.discard(),e.onDetectedClick(t))}}}}),[]);return gx(e.node,i),Qb(t,"draggingPositionInSequenceEditor","move"),t}({node:n,props:e,onDetectedClick:e=>c.toggle(e,e.target instanceof Element?e.target:n)});return IU.default.createElement(IU.default.Fragment,null,IU.default.createElement(OU,x(b(b(b({ref:t,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(a.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(u,") * 1px)")}},yj(a.position)),zM.includePositionSnapAttrs(a.position)),s.attrs),{className:d?"beingDragged":""})),IU.default.createElement(AU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(a.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(u,") * 1px)"),fill:2===s.flag?"white":void 0}}),c.node,o)}});var jU,BU,RU,LU,NU,UU,VU,qU,HU,WU,ZU,KU,GU,XU,$U,YU,JU=k(()=>{M(),bP(),bx(),tv(),jU=n(194),BU=P(Oh()),Zp(),Tj(),Tj(),Cv(),nx(),FM(),XR(),dD(),LU=Wp.circle(RU||(RU=I(["\n  fill: var(--main-color);\n  stroke-width: 1px;\n  vector-effect: non-scaling-stroke;\n\n  r: 2px;\n"]))),UU=Wp.circle(NU||(NU=I(["\n  stroke-width: 6px;\n  vector-effect: non-scaling-stroke;\n  r: 6px;\n  fill: transparent;\n  ",";\n\n  &:hover + "," {\n    r: 6px;\n  }\n\n  #pointer-root.normal & {\n    cursor: ew-resize;\n  }\n\n  #pointer-root.draggingPositionInSequenceEditor & {\n    pointer-events: auto;\n    cursor: var(",");\n  }\n\n  &.beingDragged {\n    pointer-events: none !important;\n  }\n"])),av,LU,Kb),VU=e=>{let[t,n]=Qy(null),{index:r,trackData:i,itemKey:a}=e,o=i.keyframes[r],[s]=function(e,t){return yP(e,{menuItems:()=>[{label:"Delete",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.coreByProject.historic.sheetsById.sequence.deleteKeyframes(x(b({},t.sheetObject.address),{keyframeIds:[t.keyframe.id],trackId:t.trackId}))})}}]})}(n,e),l=PP(a),u="left"===e.which?0:1,c=KR([{type:"primitiveProp",keyframe:e.keyframe,pathToProp:e.pathToProp,propConfig:e.propConfig,sheetObject:e.sheetObject,trackId:e.trackId}]),d=function(e){let[t,n]=(0,BU.useState)(!1);gj(t,e.props.keyframe.position);let r=(0,BU.useRef)(e.props);r.current=e.props;let i=(0,BU.useMemo)(()=>({debugName:"GraphEditorDotNonScalar/useDragKeyframe",lockCSSCursorTo:"ew-resize",onDragStart(t){n(!0);let i,a=r.current,o=(0,jU.val)(a.layoutP.scaledSpace.toUnitSpace),s=a.extremumSpace.lock();return{onDrag(e,t){let n=a.trackData.keyframes[a.index],r=o(e),s=[],l=x(b({},n),{position:n.position+r,value:n.value,handles:[...n.handles]});s.push(l),null==i||i.discard(),i=O().tempTransaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.replaceKeyframes(x(b({},a.sheetObject.address),{trackId:a.trackId,keyframes:s,snappingFunction:(0,jU.val)(a.layoutP.sheet).getSequence().closestGridPosition}))})},onDragEnd(r){n(!1),s(),r?null==i||i.commit():(null==i||i.discard(),e.onDetectedClick(t))}}}}),[]);return gx(e.node,i),Qb(t,"draggingPositionInSequenceEditor","ew-resize"),t}({node:n,props:e,onDetectedClick:e=>c.toggle(e,e.target instanceof Element?e.target:n)}),h=e.extremumSpace.fromValueSpace(u);return BU.default.createElement(BU.default.Fragment,null,BU.default.createElement(UU,x(b(b(b({ref:t,style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(h,") * 1px)")}},l.attrs),yj(o.position)),zM.includePositionSnapAttrs(o.position)),{className:d?"beingDragged":""})),BU.default.createElement(LU,{style:{cx:"calc(var(--unitSpaceToScaledSpaceMultiplier) * ".concat(o.position," * 1px)"),cy:"calc((var(--graphEditorVerticalSpace) - var(--graphEditorVerticalSpace) * ".concat(h,") * 1px)"),fill:2===l.flag?"white":void 0}}),c.node,s)}}),QU=k(()=>{qU=P(Oh()),Zp(),yU(),WU=Wp.path(HU||(HU=I(["\n  stroke-width: 2;\n  stroke: var(--main-color);\n  stroke-dasharray: 3 2;\n  fill: none;\n  vector-effect: non-scaling-stroke;\n  opacity: 0.3;\n"]))),ZU=e=>{let{index:t,trackData:n}=e,r=hU(n.keyframes[t].position,e.extremumSpace.fromValueSpace(0),0,e.extremumSpace.fromValueSpace(1)-e.extremumSpace.fromValueSpace(0));return qU.default.createElement(qU.default.Fragment,null,qU.default.createElement(WU,{d:"M 0 0 L 1 1",style:{transform:r}}))}}),eV=k(()=>{KU=P(Oh()),Zp(),yU(),PU(),MU(),JU(),QU(),XU=Wp.g(GU||(GU=I(["\n  /* position: absolute; */\n"]))),$U=KU.default.createElement(KU.default.Fragment,null),YU=e=>{let{index:t,trackData:n,isScalar:r}=e,i=n.keyframes[t],a=n.keyframes[t+1],o=i.connectedRight&&!!a&&a.value!==i.value;return KU.default.createElement(XU,null,o?KU.default.createElement(KU.default.Fragment,null,KU.default.createElement(gU,b({},e)),!i.type||"bezier"===i.type&&KU.default.createElement(KU.default.Fragment,null,KU.default.createElement(CU,x(b({},e),{which:"left"})),KU.default.createElement(CU,x(b({},e),{which:"right"})))):$U,r?KU.default.createElement(FU,b({},e)):KU.default.createElement(KU.default.Fragment,null,KU.default.createElement(VU,x(b({},e),{which:"left"})),KU.default.createElement(VU,x(b({},e),{which:"right"})),KU.default.createElement(ZU,b({},e))))}});var tV,nV,rV,iV,aV,oV,sV=k(()=>{xD(),tV=P(Oh()),HV(),eV(),GC(),Qh(),nV=tV.default.memo(e=>{let{layoutP:t,trackData:n,sheetObject:r,trackId:i,color:a,pathToProp:o}=e,s=FC(Wh(r.template.configPointer),o);if(OC(s))return console.error("Composite prop types cannot be keyframed"),tV.default.createElement(tV.default.Fragment,null);let[l,u]=(0,tV.useState)(!1),c=(0,tV.useMemo)(()=>{let e=new Set;return function(){let t=0===e.size;function n(){let t=e.size>0;e.delete(n),t&&0===e.size&&u(!1)}return e.add(n),t&&u(!0),n}},[]),d=(0,tV.useMemo)(()=>{let e="number"===s.type?function(e,t){let n=1/0,r=-1/0;function i(e){n=Math.min(e,n),r=Math.max(e,r)}return e.forEach((n,r)=>{let a=MC(n.value,t);if(i(a),!n.connectedRight)return;let o=e[r+1];if(!o)return;let s=("number"==typeof o.value?o.value:1)-a;i(a+n.handles[3]*s),i(a+o.handles[1]*s)}),[n,r]}(n.keyframes,s):function(e){let t=0,n=1;function r(e){t=Math.min(e,t),n=Math.max(e,n)}return e.forEach((t,n)=>{if(!t.connectedRight)return;let i=e[n+1];i&&(r(t.handles[3]),r(i.handles[1]))}),[t,n]}(n.keyframes),t=t=>t*(e[1]-e[0]);return{fromValueSpace:t=>(t-e[0])/(e[1]-e[0]),toValueSpace:n=>e[0]+t(n),deltaToValueSpace:t,lock:c}},[n.keyframes]),h=(0,tV.useRef)(void 0);l||(h.current=d);let f=n.keyframes.map((e,l)=>tV.default.createElement(YU,{pathToProp:o,propConfig:s,itemKey:bD.forTrackKeyframe(r,i,e.id),keyframe:e,index:l,trackData:n,layoutP:t,sheetObject:r,trackId:i,isScalar:"number"===s.type,key:e.id,extremumSpace:h.current,color:a}));return tV.default.createElement("g",{style:{"--main-color":SV[a].iconColor}},f)}),rV=nV}),lV=k(()=>{M(),Qh(),iV=n(194),aV=P(Oh()),sV(),oV=e=>Rh(()=>{let{sheetObject:t,trackId:n}=e,r=(0,iV.val)(O().atomP.historic.coreByProject[t.address.projectId].sheetsById[t.address.sheetId].sequence.tracksByObject[t.address.objectKey].trackData[n]);return"BasicKeyframedTrack"!==(null==r?void 0:r.type)?(console.error("trackData type ".concat(null==r?void 0:r.type," is not yet supported on the graph editor")),aV.default.createElement(aV.default.Fragment,null)):aV.default.createElement(rV,x(b({},e),{trackData:r}))},[e.trackId,e.layoutP])});function uV(e,t){let{clippedSpaceRange:n,clippedSpaceWidth:r,fps:i,gapWidth:a=120}=e,o=1/i,s=r/(i*(n.end-n.start)),l=Math.floor(a/s),u=(l<i?cV(i).find(e=>e>=l):i*Math.floor(l/i))*o,c=Math.floor(n.start/u),d=Math.ceil(n.end/u);for(let h=c;h<=d;h++){let e=h*u;t(e,e%1===0)}}var cV,dV=k(()=>{Th(),cV=co(e=>{let t=[];for(let n=1;n<=e;n++)e%n===0&&t.push(n);return t})});var hV,fV,pV,mV,gV,yV,vV,_V,bV,xV,wV,kV,SV,EV,CV,PV,DV,IV,TV,AV,zV,OV,FV,MV,jV,BV,RV,LV,NV,UV,VV,qV=k(()=>{hV=n(194),fV=P(Oh()),Zp(),dV(),M(),mV=Wp.div(pV||(pV=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  pointer-events: none;\n"]))),yV=Wp.canvas(gV||(gV=I(["\n  position: relative;\n  left: 0;\n"]))),vV=e=>{let t=e;return t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1},_V=()=>window.devicePixelRatio||1,bV=e=>_V()/vV(e),xV=e=>{let{layoutP:t,width:n,height:r}=e,i=(0,fV.useRef)(null),[a,o]=(0,fV.useState)(null),{ctx:s,ratio:l}=(0,fV.useMemo)(()=>{if(!a)return{};let e=a.getContext("2d");return{ctx:e,ratio:bV(e)}},[a]);return(0,fV.useLayoutEffect)(()=>{if(!s)return;a.width=n*l,a.height=r*l;let e=(0,hV.prism)(()=>{let e=(0,hV.val)(t.sheet).getSequence();return{ctx:s,clippedSpaceRange:(0,hV.val)(t.clippedSpace.range),clippedSpaceWidth:(0,hV.val)(t.clippedSpace.width),unitSpaceToClippedSpace:(0,hV.val)(t.clippedSpace.fromUnitSpace),height:r,leftPadding:(0,hV.val)(t.scaledSpace.leftPadding),fps:e.subUnitsPerUnit,snapToGrid:t=>e.closestGridPosition(t)}}).onChange(O().ticker,e=>{s.save(),s.scale(l,l),function(e){let{clippedSpaceWidth:t,height:n,ctx:r,unitSpaceToClippedSpace:i,snapToGrid:a}=e;r.clearRect(0,0,t,n),uV(e,(e,t)=>{let o=a(e),s=Math.floor(i(o));r.strokeStyle=t?"rgba(225, 225, 225, 0.04)":"rgba(255, 255, 255, 0.01)",r.beginPath(),r.moveTo(s,0),r.lineTo(s,n),r.stroke(),r.closePath()})}(e),s.restore()},!0);return()=>{e()}},[s,n,r,t]),fV.default.createElement(mV,{ref:i,style:{width:n+"px"}},fV.default.createElement(yV,{ref:o,style:{width:n+"px",height:r+"px"}}))}}),HV=k(()=>{M(),bM(),wP(),Qh(),wV=n(194),kV=P(Oh()),Zp(),dU(),uB(),lV(),qV(),Ym(),SV={1:{iconColor:"#b98b08"},2:{iconColor:"#70a904"},3:{iconColor:"#2e928a"},4:{iconColor:"#a943bb"},5:{iconColor:"#b90808"},6:{iconColor:"#b4bf0e"}},CV=Wp.div(EV||(EV=I(["\n  position: absolute;\n  right: 0;\n  bottom: 0;\n  background: ",";\n"])),Xm(.03,"#1a1c1e")),DV=Wp.svg(PV||(PV=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin: 0;\n  pointer-events: none;\n"]))),IV=e=>{let{layoutP:t}=e;return Rh(()=>{let e=(0,wV.val)(t.sheet),n=(0,wV.val)(O().atomP.historic.projects.stateByProjectId[e.address.projectId].stateBySheetId[e.address.sheetId].sequenceEditor.selectedPropsByObject),r=(0,wV.val)(t.graphEditorDims.height),i=(0,wV.val)(t.scaledSpace.fromUnitSpace)(1),a=[];if(n)for(let[s,l]of Object.entries(n)){let n=e.getObject(s);if(!n)continue;let r=(0,wV.val)(n.template.getMapOfValidSequenceTracks_forStudio());for(let[e,i]of Object.entries(l)){let o=_M(e),l=xP(r,o);l&&a.push(kV.default.createElement(oV,{key:"graph-".concat(s,"-").concat(e),sheetObject:n,pathToProp:o,layoutP:t,trackId:l,color:i}))}}let o=(0,wV.val)(t.rightDims.width);return kV.default.createElement(CV,{style:{width:o+"px",height:r+"px","--unitSpaceToScaledSpaceMultiplier":i,"--graphEditorVerticalSpace":"".concat((0,wV.val)(t.graphEditorVerticalSpace.space))}},kV.default.createElement(xV,{layoutP:t,width:o,height:r}),kV.default.createElement(eB,{layoutP:t,height:r},kV.default.createElement(DV,{width:rU,height:r,viewBox:"0 0 ".concat(rU," ").concat(r)},kV.default.createElement("g",{style:{transform:"translate(".concat((0,wV.val)(t.scaledSpace.leftPadding),"px, ").concat((0,wV.val)(t.graphEditorDims.padding.top),"px)")}},a))))},[t])}}),WV=k(()=>{M(),bM(),CP(),Qh(),TV=n(194),AV=P(Oh()),Zp(),iI(),hD(),HV(),gM(),$C(),mM(),zV={label:{color:"#9a9a9a"}},FV=Wp(rM)(OV||(OV=I([""]))),jV=Wp(aM)(MV||(MV=I(["\n  display: flex;\n  color: ",";\n  padding-right: 12px;\n  align-items: center;\n  justify-content: flex-end;\n  box-sizing: border-box;\n"])),zV.label.color),RV=Wp.button(BV||(BV=I(["\n  background: none;\n  border: none;\n  outline: none;\n  display: flex;\n  box-sizing: border-box;\n  font-size: 14px;\n  align-items: center;\n  height: 100%;\n  margin-left: 12px;\n  color: ",";\n\n  &:not([disabled]):hover {\n    color: white;\n  }\n"])),e=>e.isSelected?SV[e.graphEditorColor].iconColor:UP.offColor),LV=()=>AV.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"10",height:"12",viewBox:"0 0 640 512"},AV.default.createElement("g",{transform:"translate(0 100)"},AV.default.createElement("path",{fill:"currentColor",d:"M368 32h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32V64c0-17.67-14.33-32-32-32zM208 88h-84.75C113.75 64.56 90.84 48 64 48 28.66 48 0 76.65 0 112s28.66 64 64 64c26.84 0 49.75-16.56 59.25-40h79.73c-55.37 32.52-95.86 87.32-109.54 152h49.4c11.3-41.61 36.77-77.21 71.04-101.56-3.7-8.08-5.88-16.99-5.88-26.44V88zm-48 232H64c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32zM576 48c-26.84 0-49.75 16.56-59.25 40H432v72c0 9.45-2.19 18.36-5.88 26.44 34.27 24.35 59.74 59.95 71.04 101.56h49.4c-13.68-64.68-54.17-119.48-109.54-152h79.73c9.5 23.44 32.41 40 59.25 40 35.34 0 64-28.65 64-64s-28.66-64-64-64zm0 272h-96c-17.67 0-32 14.33-32 32v96c0 17.67 14.33 32 32 32h96c17.67 0 32-14.33 32-32v-96c0-17.67-14.33-32-32-32z"}))),UV=Wp.span(NV||(NV=I(["\n  margin-right: 4px;\n  ",";\n\n  ",":hover & {\n    color: #ccc;\n  }\n"])),NC,jV),VV=e=>{let{leaf:t}=e;var n;let r=EP(t.sheetObject.propsP,t.pathToProp),i=t.sheetObject,{controlIndicators:a}=eI(r,i,t.propConf),o=Rh(()=>{let e=t.sheetObject.address,n=vM(t.pathToProp);return(0,TV.val)(O().atomP.historic.projects.stateByProjectId[e.projectId].stateBySheetId[e.sheetId].sequenceEditor.selectedPropsByObject[e.objectKey][n])},[t]),s=(0,AV.useRef)(!1),l="string"==typeof o;s.current=l;let u=(0,AV.useCallback)(()=>{let e=t.sheetObject.address;O().transaction(n=>{let{stateEditors:r}=n;s.current?r.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removePropFromGraphEditor(x(b({},e),{pathToProp:t.pathToProp})):(r.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.addPropToGraphEditor(x(b({},e),{pathToProp:t.pathToProp})),r.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!0}))})},[t]),c=null!=(n=t.propConf.label)?n:t.pathToProp[t.pathToProp.length-1],d=(0,AV.useRef)(null);return QF(d.current,t),AV.default.createElement(FV,{depth:t.depth},AV.default.createElement(jV,{ref:d,isEven:t.n%2===0,style:{height:t.nodeHeight+"px"},isSelected:!0===l},AV.default.createElement(UV,null,c),a,AV.default.createElement(RV,{onClick:u,isSelected:!0===l,graphEditorColor:null!=o?o:"1",style:{opacity:1},disabled:!1},AV.default.createElement(LV,null))))}});function ZV(e,t){O().transaction(n=>{let{stateEditors:r}=n;r.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.sequenceEditorCollapsableItems.set(x(b({},t.sheetAddress),{studioSheetItemKey:t.sheetItemKey,isCollapsed:e}))})}var KV,GV,XV,$V,YV,JV,QV,eq,tq,nq,rq,iq,aq,oq,sq,lq,uq,cq,dq,hq,fq,pq,mq=k(()=>{M()}),gq=k(()=>{KV=P(Oh()),gM(),WV(),mq(),GV=e=>{let t="prop"+e.pathToProp[e.pathToProp.length-1];return e.shouldRender?"propWithChildren"===e.type?KV.default.createElement(XV,{leaf:e,key:t}):KV.default.createElement(VV,{leaf:e,key:t}):KV.default.createElement(KV.default.Fragment,{key:t})},XV=e=>{let{leaf:t}=e;return KV.default.createElement(pM,{leaf:t,label:t.pathToProp[t.pathToProp.length-1],isCollapsed:t.isCollapsed,toggleCollapsed:()=>ZV(!t.isCollapsed,{sheetAddress:t.sheetObject.address,sheetItemKey:t.sheetItemKey})},t.children.map(e=>GV(e)))}}),yq=k(()=>{$V=P(Oh()),gM(),gq(),mq(),M(),YV=e=>{let{leaf:t}=e;return $V.default.createElement(pM,{leaf:t,label:t.sheetObject.address.objectKey,isCollapsed:t.isCollapsed,toggleSelect:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.studio.historic.panels.outline.selection.set([t.sheetObject])})},toggleCollapsed:()=>ZV(!t.isCollapsed,{sheetAddress:t.sheetObject.address,sheetItemKey:t.sheetItemKey})},t.children.map(e=>GV(e)))}}),vq=k(()=>{Qh(),JV=P(Oh()),yq(),gM(),mq(),pT(),QV=e=>{let{leaf:t}=e;return Rh(()=>JV.default.createElement(pM,{leaf:t,label:t.sheet.address.sheetId,isCollapsed:t.isCollapsed,toggleCollapsed:()=>{ZV(!t.isCollapsed,{sheetAddress:t.sheet.address,sheetItemKey:t.sheetItemKey})}},t.children.map(e=>JV.default.createElement(YV,{key:"sheetObject-"+tT(e.sheetObject),leaf:e}))),[t])}}),_q=k(()=>{Qh(),eq=n(194),tq=P(Oh()),Zp(),vq(),rq=Wp.div(nq||(nq=I(["\n  position: absolute;\n  left: 0;\n  overflow-x: visible;\n"]))),aq=Wp.ul(iq||(iq=I(["\n  margin: 0;\n  padding: 0;\n  list-style: none;\n"]))),oq=e=>{let{layoutP:t}=e;return Rh(()=>{let e=(0,eq.val)(t.tree),n=(0,eq.val)(t.leftDims.width);return tq.default.createElement(rq,{style:{width:n+"px",top:e.top+"px"}},tq.default.createElement(aq,null,tq.default.createElement(QV,{leaf:e})))},[t])}}),bq=k(()=>{Cv(),OK(),Qh(),Ym(),sq=P(Oh()),Zp(),qV(),uq=Wp.div(lq||(lq=I(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  z-index: ",";\n  overflow: hidden;\n  background: ",";\n  pointer-events: none;\n"])),()=>pK.rightBackground,Xm(.01,Zm(.03,ov.panel.bg))),cq=e=>{let{layoutP:t}=e,n=Wh(t.rightDims.width),r=Wh(t.panelDims.height);return sq.default.createElement(uq,{style:{width:n+"px"}},sq.default.createElement(xV,{width:n,height:r,layoutP:t}))}}),xq=k(()=>{Qh(),dq=P(Oh()),Zp(),_q(),bq(),dU(),Cj(),fq=Wp.div(hq||(hq=I(["\n  position: absolute;\n  left: 0;\n  right: 0;\n"]))),pq=e=>{let{layoutP:t}=e,n=Wh(t.dopeSheetDims.height);return dq.default.createElement(fq,{style:{height:n+"px"}},dq.default.createElement(cq,{layoutP:t}),dq.default.createElement(rj,null,dq.default.createElement(oq,{layoutP:t}),dq.default.createElement(oU,{layoutP:t})))}});var wq,kq=k(()=>{wq=n(194)});function Sq(e){return function(t,n){return e(t,n())}}function Eq(e){return Object.freeze({audience:Cq(e,8)?"internal":Cq(e,16)?"dev":"public",category:Cq(e,4)?"troubleshooting":Cq(e,2)?"todo":"general",level:Cq(e,512)?512:Cq(e,256)?256:Cq(e,128)?128:64})}function Cq(e,t){return(e&t)===t}function Pq(e,t){return(32===(32&t)||(16===(16&t)?e.dev:8===(8&t)&&e.internal))&&e.min<=t}function Dq(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:console,t=x(b({},Mq),{includes:b({},Mq.includes)}),n={styled:Aq.bind(t,e),noStyle:zq.bind(t,e)},r=Tq.bind(t);function i(){return t.loggingConsoleStyle&&t.loggerConsoleStyle?n.styled:n.noStyle}return t.create=i(),{configureLogger(e){var n;"console"===e?(t.loggerConsoleStyle=Mq.loggerConsoleStyle,t.create=i()):"console"===e.type?(t.loggerConsoleStyle=null!=(n=e.style)?n:Mq.loggerConsoleStyle,t.create=i()):"keyed"===e.type?(t.creatExt=t=>e.keyed(t.names),t.create=r):"named"===e.type&&(t.creatExt=Iq.bind(null,e.named),t.create=r)},configureLogging(e){var n,r,a,o,s;t.includes.dev=null!=(n=e.dev)?n:Mq.includes.dev,t.includes.internal=null!=(r=e.internal)?r:Mq.includes.internal,t.includes.min=null!=(a=e.min)?a:Mq.includes.min,t.include=null!=(o=e.include)?o:Mq.include,t.loggingConsoleStyle=null!=(s=e.consoleStyle)?s:Mq.loggingConsoleStyle,t.create=i()},getLogger:()=>t.create({names:[]})}}function Iq(e,t){let n=[];for(let{name:r,key:i}of t.names)n.push(null==i?r:"".concat(r," (").concat(i,")"));return e(n)}function Tq(e){let t=b(b({},this.includes),this.include(e)),n=this.filtered,r=this.named.bind(this,e),i=this.creatExt(e),a=Pq(t,524),o=Pq(t,522),s=Pq(t,521),l=Pq(t,529),u=Pq(t,545),c=Pq(t,265),d=Pq(t,268),h=Pq(t,273),f=Pq(t,289),p=Pq(t,137),m=Pq(t,145),g=Pq(t,73),y=Pq(t,81),v=a?i.error.bind(i,Fq._hmm):n.bind(e,524),_=o?i.error.bind(i,Fq._todo):n.bind(e,522),x=s?i.error.bind(i,Fq._error):n.bind(e,521),w=l?i.error.bind(i,Fq.errorDev):n.bind(e,529),k=u?i.error.bind(i,Fq.errorPublic):n.bind(e,545),S=d?i.warn.bind(i,Fq._kapow):n.bind(e,268),E=c?i.warn.bind(i,Fq._warn):n.bind(e,265),C=h?i.warn.bind(i,Fq.warnDev):n.bind(e,273),P=f?i.warn.bind(i,Fq.warnPublic):n.bind(e,273),D=p?i.debug.bind(i,Fq._debug):n.bind(e,137),I=m?i.debug.bind(i,Fq.debugDev):n.bind(e,145),T=g?i.trace.bind(i,Fq._trace):n.bind(e,73),A=y?i.trace.bind(i,Fq.traceDev):n.bind(e,81),z={_hmm:v,_todo:_,_error:x,errorDev:w,errorPublic:k,_kapow:S,_warn:E,warnDev:C,warnPublic:P,_debug:D,debugDev:I,_trace:T,traceDev:A,lazy:{_hmm:a?Sq(v):v,_todo:o?Sq(_):_,_error:s?Sq(x):x,errorDev:l?Sq(w):w,errorPublic:u?Sq(k):k,_kapow:d?Sq(S):S,_warn:c?Sq(E):E,warnDev:h?Sq(C):C,warnPublic:f?Sq(P):P,_debug:p?Sq(D):D,debugDev:m?Sq(I):I,_trace:g?Sq(T):T,traceDev:y?Sq(A):A},named:r,utilFor:{internal:()=>({debug:z._debug,error:z._error,warn:z._warn,trace:z._trace,named:(e,t)=>z.named(e,t).utilFor.internal()}),dev:()=>({debug:z.debugDev,error:z.errorDev,warn:z.warnDev,trace:z.traceDev,named:(e,t)=>z.named(e,t).utilFor.dev()}),public:()=>({error:z.errorPublic,warn:z.warnPublic,debug(e,t){z._warn('(public "debug" filtered out) '.concat(e),t)},trace(e,t){z._warn('(public "trace" filtered out) '.concat(e),t)},named:(e,t)=>z.named(e,t).utilFor.public()})}};return z}function Aq(e,t){let n=b(b({},this.includes),this.include(t)),r=[],i="";for(let l=0;l<t.names.length;l++){let{name:e,key:n}=t.names[l];if(i+=" %c".concat(e),r.push(this.style.css(e)),null!=n){let e="%c#".concat(n);i+=e,r.push(this.style.css(e))}}let a=this.filtered,o=this.named.bind(this,t),s=[i,...r];return Oq(a,t,n,e,s,function(e){let t=e.slice(0);for(let n=1;n<t.length;n++)t[n]+=";background-color:#e0005a;padding:2px;color:white";return t}(s),o)}function zq(e,t){let n=b(b({},this.includes),this.include(t)),r="";for(let a=0;a<t.names.length;a++){let{name:e,key:n}=t.names[a];r+=" ".concat(e),null!=n&&(r+="#".concat(n))}let i=[r];return Oq(this.filtered,t,n,e,i,i,this.named.bind(this,t))}function Oq(e,t,n,r,i,a,o){let s=Pq(n,524),l=Pq(n,522),u=Pq(n,521),c=Pq(n,529),d=Pq(n,545),h=Pq(n,265),f=Pq(n,268),p=Pq(n,273),m=Pq(n,289),g=Pq(n,137),y=Pq(n,145),v=Pq(n,73),_=Pq(n,81),b=s?r.error.bind(r,...i):e.bind(t,524),x=l?r.error.bind(r,...i):e.bind(t,522),w=u?r.error.bind(r,...i):e.bind(t,521),k=c?r.error.bind(r,...i):e.bind(t,529),S=d?r.error.bind(r,...i):e.bind(t,545),E=f?r.warn.bind(r,...a):e.bind(t,268),C=h?r.warn.bind(r,...i):e.bind(t,265),P=p?r.warn.bind(r,...i):e.bind(t,273),D=m?r.warn.bind(r,...i):e.bind(t,273),I=g?r.info.bind(r,...i):e.bind(t,137),T=y?r.info.bind(r,...i):e.bind(t,145),A=v?r.debug.bind(r,...i):e.bind(t,73),z=_?r.debug.bind(r,...i):e.bind(t,81),O={_hmm:b,_todo:x,_error:w,errorDev:k,errorPublic:S,_kapow:E,_warn:C,warnDev:P,warnPublic:D,_debug:I,debugDev:T,_trace:A,traceDev:z,lazy:{_hmm:s?Sq(b):b,_todo:l?Sq(x):x,_error:u?Sq(w):w,errorDev:c?Sq(k):k,errorPublic:d?Sq(S):S,_kapow:f?Sq(E):E,_warn:h?Sq(C):C,warnDev:p?Sq(P):P,warnPublic:m?Sq(D):D,_debug:g?Sq(I):I,debugDev:y?Sq(T):T,_trace:v?Sq(A):A,traceDev:_?Sq(z):z},named:o,utilFor:{internal:()=>({debug:O._debug,error:O._error,warn:O._warn,trace:O._trace,named:(e,t)=>O.named(e,t).utilFor.internal()}),dev:()=>({debug:O.debugDev,error:O.errorDev,warn:O.warnDev,trace:O.traceDev,named:(e,t)=>O.named(e,t).utilFor.dev()}),public:()=>({error:O.errorPublic,warn:O.warnPublic,debug(e,t){O._warn('(public "debug" filtered out) '.concat(e),t)},trace(e,t){O._warn('(public "trace" filtered out) '.concat(e),t)},named:(e,t)=>O.named(e,t).utilFor.public()})}};return O}var Fq,Mq,jq,Bq,Rq,Lq,Nq,Uq=k(()=>{Fq={_hmm:Eq(524),_todo:Eq(522),_error:Eq(521),errorDev:Eq(529),errorPublic:Eq(545),_kapow:Eq(268),_warn:Eq(265),warnDev:Eq(273),warnPublic:Eq(289),_debug:Eq(137),debugDev:Eq(145),_trace:Eq(73),traceDev:Eq(81)},Mq={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(e,t,n){return this.create({names:[...e.names,{name:t,key:n}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(e){if(e.length<5)return e;let t=e.replace(this.collapseOnRE,"");return this.cssMemo.has(t)||this.cssMemo.set(t,this.css(e)),t},css(e){var t,n,r,i;let a=this.cssMemo.get(e);if(a)return a;let o="color:".concat(null!=(n=null==(t=this.color)?void 0:t.call(this,e))?n:"hsl(".concat((e.charCodeAt(0)+e.charCodeAt(e.length-1))%360,", 100%, 60%)"));return null!=(r=this.bold)&&r.test(e)&&(o+=";font-weight:600"),null!=(i=this.italic)&&i.test(e)&&(o+=";font-style:italic"),this.cssMemo.set(e,o),o}}}}),Vq=k(()=>{Uq(),Uq(),(jq=Dq(console,{_debug:function(){},_error:function(){}})).configureLogging({dev:!0,min:64}),Bq=jq.getLogger().named("Theatre.js (default logger)").utilFor.dev()}),qq=k(()=>{xD(),Rq=n(194),Vq(),Pv(),Lq=28,Nq=(e,t)=>{var n;Rq.prism.ensurePrism();let r=!0,i=xv+Lq,a=0,o=t.atomP.ahistoric.projects.stateByProjectId[e.address.projectId].stateBySheetId[e.address.sheetId].sequence.collapsableItems,s=o.byId[bD.forSheet()].isCollapsed,l=null!=(n=(0,Rq.pointerToPrism)(s).getValue())&&n,u={type:"sheet",isCollapsed:l,sheet:e,children:[],sheetItemKey:bD.forSheet(),shouldRender:r,top:xv,depth:0,n:a,nodeHeight:Lq,heightIncludingChildren:-1};a+=1;for(let f of Object.values((0,Rq.val)(e.objectsP)))f&&c(f,u.children,u.depth+1,!l);function c(e,t,n,r){var s;let l=(0,Rq.val)(e.template.getMapOfValidSequenceTracks_forStudio()),u=(0,Rq.val)(e.template.configPointer);if(0===Object.keys(l).length)return;let c=o.byId[bD.forSheetObject(e)].isCollapsed,h=null!=(s=(0,Rq.pointerToPrism)(c).getValue())&&s,f={type:"sheetObject",isCollapsed:h,sheetItemKey:bD.forSheetObject(e),shouldRender:r,top:i,children:[],depth:n,n:a,sheetObject:e,nodeHeight:r?Lq:0,heightIncludingChildren:-1};t.push(f),r&&(a+=1,i+=f.nodeHeight),d(e,l,[],u,f.children,n+1,r&&!h),f.heightIncludingChildren=i-f.top}function d(e,t,n,r,i,a,o){for(let[s,l]of Object.entries(t)){h(e,l,[...n,s],r.props[s],i,a,o)}}function h(e,t,n,r,s,l,u){"compound"===r.type?function(e,t,n,r,s,l,u,c){var h;let f=o.byId[bD.forSheetObjectProp(e,r)].isCollapsed,p=null!=(h=(0,Rq.pointerToPrism)(f).getValue())&&h,m={type:"propWithChildren",isCollapsed:p,propConf:n,pathToProp:r,sheetItemKey:bD.forSheetObjectProp(e,r),sheetObject:e,shouldRender:c,top:i,children:[],nodeHeight:c?Lq:0,heightIncludingChildren:-1,depth:u,trackMapping:t,n:a};l.push(m),c&&(i+=m.nodeHeight,a+=1),d(e,t,r,s,m.children,u+1,c&&!p),m.heightIncludingChildren=i-m.top}(e,t,r,n,r,s,l,u):"enum"===r.type?Bq.warn("Prop type enum is not yet supported in the sequence editor"):function(e,t,n,r,o,s,l){let u={type:"primitiveProp",propConf:r,depth:s,sheetItemKey:bD.forSheetObjectProp(e,n),sheetObject:e,pathToProp:n,shouldRender:l,top:i,nodeHeight:l?Lq:0,heightIncludingChildren:l?Lq:0,trackId:t,n:a};o.push(u),a+=1,i+=u.nodeHeight}(e,t,n,r,s,l,u)}return u.heightIncludingChildren=i-u.top,u}});function Hq(e,t){let n=O(),r=n.atomP.ahistoric.projects.stateByProjectId[e.address.projectId].stateBySheetId[e.address.sheetId],i=n.atomP.historic.projects.stateByProjectId[e.address.projectId].stateBySheetId[e.address.sheetId];return(0,Wq.prism)(()=>{var a;let o=function(e,t,n){return wq.prism.memo(e,()=>(0,wq.prism)(t),n).getValue()}("tree",()=>Nq(e,n),[]),s=(0,Wq.val)(t),l=(0,Wq.val)(n.atomP.historic.panels.sequenceEditor.graphEditor),u=(0,Wq.val)(i.sequenceEditor.selectedPropsByObject),c=!!u&&Object.keys(u).length>0,{leftDims:d,rightDims:h,graphEditorDims:f,dopeSheetDims:p,horizontalScrollbarDims:m}=Wq.prism.memo("leftDims",()=>{var e;let t={width:Math.floor(s.width*Zq),height:s.height,screenX:s.screenX,screenY:s.screenY},n={width:s.width-t.width,height:s.height,screenX:s.screenX+t.width,screenY:s.screenY},r=c&&!0===(null==l?void 0:l.isOpen),i=Math.floor((r?ms(null!=(e=null==l?void 0:l.height)?e:.5,.1,.7):0)*s.heightWithoutBorder),a=0+i,o=s.height-a,u={width:s.width,height:o,screenX:s.screenX,screenY:s.screenY};return{leftDims:t,rightDims:n,graphEditorDims:{isAvailable:c,isOpen:r,width:n.width,height:i,screenX:s.screenX,screenY:s.screenY+o,padding:{top:20,bottom:20}},dopeSheetDims:u,horizontalScrollbarDims:{bottom:0}}},[s,l,c]),g=Wq.prism.memo("graphEditorVerticalSpace",()=>{let e=f.height-f.padding.top-f.padding.bottom;return{space:e,fromExtremumSpace:t=>t*e,toExtremumSpace:t=>t/e}},[f]),[y,v]=Wq.prism.state("isSeeking",!1),_={isSeeking:y,setIsSeeking:v},w=null!=(a=(0,Wq.val)(r.sequence.clippedSpaceRange))?a:Kq,k=Wq.prism.memo("scaledSpace",()=>{let e=w.end-w.start,t=h.width,n=e/t,r=t/e;return{fromUnitSpace:e=>e*r,toUnitSpace:e=>e*n,leftPadding:10}},[w,h.width]),S=Wq.prism.memo("setClippedSpaceRange",()=>function(t){n.transaction(n=>{let{stateEditors:r}=n,i=b({},t);if(i.end<=i.start&&(i.end=i.start+1),i.start<0){let e=i.end-i.start;i.start=0,i.end=e}r.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.clippedSpaceRange.set(x(b({},e.address),{range:i}))})},[]),E=Wq.prism.memo("clippedSpace",()=>({range:w,width:h.width,fromUnitSpace:e=>k.fromUnitSpace(e-w.start)+k.leftPadding,toUnitSpace:e=>k.toUnitSpace(e-k.leftPadding)+w.start,setRange:S}),[w,h.width,k,S]),C=Wq.prism.memo("selection.current",()=>new Wq.Atom({}),[]);return VF("finalAtom",{sheet:e,tree:o,panelDims:s,leftDims:d,rightDims:h,dopeSheetDims:p,horizontalScrollbarDims:m,seeker:_,unitSpace:{},scaledSpace:k,clippedSpace:E,graphEditorDims:f,graphEditorVerticalSpace:g,selectionAtom:C}).pointer})}var Wq,Zq,Kq,Gq=k(()=>{M(),kq(),JF(),Wq=n(194),qq(),Th(),Zq=.2,Kq={start:0,end:10}});function Xq(e){let{fullSecondStampsContainer:t,sequencePositionFormatter:n,snapToGrid:r,unitSpaceToClippedSpace:i}=e,a="";uV(e,(e,t)=>{let o=r(e),s=i(o);a+=t?$q(n.formatFullUnitForGrid(o),s,"full-unit"):$q(n.formatSubUnitForGrid(o),s,"sub-unit")}),t.innerHTML=a}function $q(e,t,n){return'<span class="'.concat(n,'" style="transform: translate3d(').concat(t.toFixed(1),'px, -50%, 0);">').concat(e,"</span>")}var Yq,Jq,Qq,eH,tH,nH,rH,iH,aH,oH,sH=k(()=>{Yq=n(194),Ym(),Jq=P(Oh()),Zp(),dV(),M(),eH=Wp.div(Qq||(Qq=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  pointer-events: none;\n"]))),tH={fullUnitStampColor:"#6a6a6a",stampFontSize:"10px",get subUnitStampColor(){return Zm(.2,tH.fullUnitStampColor)}},rH=Wp.div(nH||(nH=I(["\n  position: absolute;\n  top: 0;\n  height: 100%;\n  left: 0;\n  overflow: hidden;\n  z-index: 2;\n  will-change: transform;\n  pointer-events: none;\n"]))),aH=Wp.div(iH||(iH=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n\n  & > span {\n    position: absolute;\n    display: block;\n    top: 9px;\n    left: -10px;\n    color: ",";\n    text-align: center;\n    font-size: ",";\n    width: 20px;\n\n    &.full-unit {\n      color: ",";\n    }\n\n    &.sub-unit {\n      color: ",";\n    }\n  }\n\n  pointer-events: none;\n"])),tH.fullUnitStampColor,tH.stampFontSize,tH.fullUnitStampColor,tH.subUnitStampColor),oH=e=>{let{layoutP:t,width:n}=e,r=(0,Jq.useRef)(null),[i,a]=(0,Jq.useState)(null);return(0,Jq.useLayoutEffect)(()=>{if(i)return(0,Yq.prism)(()=>{let e=(0,Yq.val)(t.sheet).getSequence();return{fullSecondStampsContainer:i,clippedSpaceRange:(0,Yq.val)(t.clippedSpace.range),clippedSpaceWidth:(0,Yq.val)(t.clippedSpace.width),unitSpaceToClippedSpace:(0,Yq.val)(t.clippedSpace.fromUnitSpace),leftPadding:(0,Yq.val)(t.scaledSpace.leftPadding),fps:e.subUnitsPerUnit,sequencePositionFormatter:e.positionFormatter,snapToGrid:t=>e.closestGridPosition(t)}}).onChange(O().ticker,Xq,!0)},[i,n,t]),Jq.default.createElement(eH,{ref:r,style:{width:n+"px"}},Jq.default.createElement(rH,{style:{width:n+"px"}},Jq.default.createElement(aH,{ref:a})))}});var lH,uH=k(()=>{lH=P(Oh())});var cH,dH,hH,fH,pH,mH,gH,yH,vH,_H,bH,xH,wH,kH,SH,EH=k(()=>{cH=n(194),Qh(),Cv(),M(),KH(),bP(),bx(),tv(),dH=P(Oh()),Zp(),Tj(),hH={enabled:{backgroundColor:"#2C2F34",stroke:"#646568"},disabled:{backgroundColor:"#282a2cc5",stroke:"#595a5d"},hover:{backgroundColor:"#34373D",stroke:"#C8CAC0"},dragging:{backgroundColor:"#3F444A",stroke:"#C8CAC0"},thumbWidth:9,hitZoneWidth:26,rangeStripMinWidth:30},pH=Wp.div(fH||(fH=I(["\n  position: absolute;\n  height: ","px;\n  background-color: ",";\n  cursor: grab;\n  top: 0;\n  left: 0;\n  width: ","px;\n  transform-origin: left top;\n  &:hover {\n    background-color: ",";\n  }\n  &.dragging {\n    background-color: ",";\n    cursor: grabbing !important;\n  }\n  ",";\n\n  /* covers the one pixel space between the focus range strip and the top strip\n  of the sequence editor panel, which would have caused that one pixel to act\n  like a panel drag zone */\n  &:after {\n    display: block;\n    content: ' ';\n    position: absolute;\n    bottom: -1px;\n    height: 1px;\n    left: 0;\n    right: 0;\n    background: transparent;\n    pointer-events: normal;\n    z-index: -1;\n  }\n"])),()=>OH-1,e=>e.enabled?hH.enabled.backgroundColor:hH.disabled.backgroundColor,1e3,hH.hover.backgroundColor,hH.dragging.backgroundColor,av),mH=e=>{let{layoutP:t}=e,n=(0,dH.useMemo)(()=>(0,cH.prism)(()=>{let{projectId:e,sheetId:n}=(0,cH.val)(t.sheet).address;return(0,cH.val)(O().atomP.ahistoric.projects.stateByProjectId[e].stateBySheetId[n].sequence.focusRange)}),[t]),[r,i]=Qy(null),[a]=yP(i,{menuItems:()=>{let e=(0,cH.val)(t.sheet),r=n.getValue();return[{label:"Delete focus range",callback:()=>{O().tempTransaction(t=>{let{stateEditors:n}=t;n.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.unset(b({},e.address))}).commit()}},{label:null!=r&&r.enabled?"Disable focus range":"Enable focus range",callback:()=>{void 0!==r&&O().tempTransaction(t=>{let{stateEditors:n}=t;n.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(x(b({},e.address),{range:r.range,enabled:!r.enabled}))}).commit()}}]}}),o=Wh(t.scaledSpace.toUnitSpace),s=Wh(t.sheet),l=(0,dH.useMemo)(()=>{let e,r;return{debugName:"FocusRangeStrip",onDragStart(i){let a,l=n.getValue();if(!l)return!1;let u=l.range.start,c=l.range.end,d=!1,h=(0,cH.val)(t.sheet).getSequence();return{onDrag(t){if(l=n.getValue(),l){d=!0;let n=o(t),i=u+n,f=c+n;f<i&&(f=i),[e,r]=function(e,t){let n=0,[r,i]=e,[a,o]=t;return i-r>o-a?[a,o]:(r<a&&(n=0-r),i>o&&(n=o-i),[r+n,i+n])}([i,f],[0,h.length]).map(e=>h.closestGridPosition(e)),a&&a.discard(),a=O().tempTransaction(t=>{let{stateEditors:n}=t;var i;n.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(x(b({},s.address),{range:{start:e,end:r},enabled:null==(i=null==l?void 0:l.enabled)||i}))})}},onDragEnd(){l&&(d&&void 0!==a?a.commit():a&&a.discard())}}},lockCSSCursorTo:"grabbing"}},[s,o]),[u]=gx(i,l);return gj(u,-1),Rh(()=>{let e,i,o=n.getValue(),s=(null==o?void 0:o.range)||{start:0,end:0},l=(0,cH.val)(t.clippedSpace.fromUnitSpace)(s.start),c=(0,cH.val)(t.clippedSpace.fromUnitSpace)(s.end);return l<0&&(l=0),c>(0,cH.val)(t.clippedSpace.width)&&(c=(0,cH.val)(t.clippedSpace.width)),l>c?(i=0,e=0):(i=l,e=(c-l)/1e3),o?dH.default.createElement(dH.default.Fragment,null,a,dH.default.createElement(pH,{id:"range-strip",enabled:o.enabled,className:"".concat(u?"dragging":""," ").concat(o.enabled?"enabled":""),ref:r,style:{transform:"translateX(".concat(i,"px) scale(").concat(e,", 1)")}})):dH.default.createElement(dH.default.Fragment,null)},[t,r,n,a,u])}}),CH=k(()=>{gH=n(194),Qh(),M(),KH(),nx(),bx(),tv(),yH=P(Oh()),Zp(),Tj(),EH(),FM(),_H=Wp.div(vH||(vH=I(["\n  position: absolute;\n  top: 0;\n  // the right handle has to be pulled back by its width since its right side indicates its position, not its left side\n  left: ","px;\n  transform-origin: left top;\n  width: ","px;\n  height: ","px;\n  z-index: 3;\n\n  --bg: ",";\n\n  stroke: ",";\n  user-select: none;\n\n  cursor: ",";\n\n  // no pointer events unless pointer-root is in normal mode _and_ the\n  // focus range is enabled\n  #pointer-root & {\n    pointer-events: none;\n  }\n\n  #pointer-root.normal & {\n    pointer-events: auto;\n  }\n\n  #pointer-root.draggingPositionInSequenceEditor & {\n    pointer-events: auto;\n    cursor: var(",");\n  }\n\n  &.dragging {\n    pointer-events: none !important;\n  }\n\n  // highlight the handle if it's hovered, or the whole strip is hovverd\n  ",":hover ~ &, &:hover {\n    --bg: ",";\n    stroke: ",";\n  }\n\n  // highlight the handle when it's being dragged or the whole strip is being dragged.\n  // using dragging.dragging to give this selector priority, as it seems to be overridden\n  // by the hover selector above\n  &.dragging,\n  ",".dragging.dragging ~ & {\n    --bg: ",";\n    stroke: ",";\n  }\n\n  #pointer-root.draggingPositionInSequenceEditor &:hover {\n    --bg: ",";\n    stroke: #40aaa4;\n  }\n\n  background-color: var(--bg);\n\n  // a larger hit zone\n  &:before {\n    display: block;\n    content: ' ';\n    position: absolute;\n    inset: -8px;\n  }\n"])),e=>"start"===e.type?0:-hH.thumbWidth,hH.thumbWidth,()=>OH-1,e=>{let{enabled:t}=e;return t?hH.enabled.backgroundColor:hH.disabled.backgroundColor},hH.enabled.stroke,e=>"start"===e.type?"w-resize":"e-resize",Kb,()=>pH,hH.hover.backgroundColor,hH.hover.stroke,()=>pH,hH.dragging.backgroundColor,hH.dragging.stroke,hH.dragging.backgroundColor),xH=Wp.div(bH||(bH=I(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n\n  background: linear-gradient(\n    ","deg,\n    var(--bg) 0%,\n    #ffffff00 100%\n  );\n\n  width: 12px;\n  left: ","px;\n"])),e=>"start"===e.type?90:-90,e=>"start"===e.type?hH.thumbWidth:1-hH.thumbWidth),kH=Wp.div(wH||(wH=I(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n\n  background: linear-gradient(\n    ","deg,\n    "," 0%,\n    #ffffff00 100%\n  );\n\n  width: 12px;\n  left: ","px;\n"])),e=>"start"===e.type?-90:90,()=>FH.backgroundColor,e=>"start"===e.type?-12:hH.thumbWidth),SH=e=>{let{layoutP:t,thumbType:n}=e;var r;let[i,a]=Qy(null),o=(0,yH.useMemo)(()=>(0,gH.prism)(()=>{let{projectId:e,sheetId:n}=(0,gH.val)(t.sheet).address;return(0,gH.val)(O().atomP.ahistoric.projects.stateByProjectId[e].stateBySheetId[n].sequence.focusRange)}),[t]),s=(0,yH.useMemo)(()=>({debugName:"FocusRangeThumb",onDragStart(){let e,r,i=(0,gH.val)(t.sheet),s={start:0,end:i.getSequence().length},l=o.getValue()||{range:s,enabled:!1},u=l.enabled,c=l.range[n],d=(0,gH.val)(t.scaledSpace.toUnitSpace),h=d(hH.rangeStripMinWidth);return{onDrag(t,l,f){var p;let m,g=zM.checkIfMouseEventSnapToPos(f,{ignore:a});if(null==g){let e=d(t);m=c+e}else m=g;r=(null==(p=o.getValue())?void 0:p.range)||s,m="start"===n?Math.max(Math.min(m,r.end-h),0):Math.min(Math.max(m,r.start+h),i.getSequence().length);let y=i.getSequence().closestGridPosition(m);void 0!==e&&e.discard(),e=O().tempTransaction(e=>{let{stateEditors:t}=e;t.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(x(b({},i.address),{range:x(b({},r),{[n]:y}),enabled:u}))})},onDragEnd(t){t?null==e||e.commit():null==e||e.discard()}}}}),[t]),[l]=gx(a,s);Qb(l,"draggingPositionInSequenceEditor","start"===n?"w-resize":"e-resize");let u=Wh(o);return gj(l,null!=(r=null==u?void 0:u.range[n])?r:0),Rh(()=>{let e=o.getValue();if(!e)return null;let{enabled:r}=e,a=e.range[n],s=(0,gH.val)(t.clippedSpace.fromUnitSpace)(a);return(s<0||(0,gH.val)(t.clippedSpace.width)<s)&&(s=-1e4),yH.default.createElement(_H,x(b(b({ref:i},zM.includePositionSnapAttrs(a)),yj(a)),{className:"".concat(l&&"dragging"," ").concat(r&&"enabled"),enabled:r,type:n,style:{transform:"translate3d(".concat(s,"px, 0, 0)")}}),yH.default.createElement(xH,{type:n,enabled:r}),yH.default.createElement(kH,{type:n}),yH.default.createElement("svg",{viewBox:"0 0 9 18",xmlns:"http://www.w3.org/2000/svg"},yH.default.createElement("line",{x1:"4",y1:"6",x2:"4",y2:"12"}),yH.default.createElement("line",{x1:"6",y1:"6",x2:"6",y2:"12"})))},[t,i,o,l])}});var PH,DH,IH,TH,AH,zH,OH,FH,MH,jH,BH,RH,LH,NH,UH,VH,qH,HH,WH,ZH=k(()=>{PH=n(194),Qh(),M(),WF(),KH(),nx(),bx(),uH(),EM(),tv(),Th(),DH=P(Oh()),Zp(),EH(),CH(),Pv(),TH=Wp.div(IH||(IH=I(["\n  position: absolute;\n  height: ",'px;\n  left: 0;\n  right: 0;\n  box-sizing: border-box;\n  /* Use the "grab" cursor if the shift key is up, which is the one used on the top strip of the sequence editor */\n  cursor: ',";\n"])),()=>OH,e=>e.isShiftDown?"ew-resize":"move"),AH=e=>{let{layoutP:t}=e,[n,r]=Qy(null),i=zO(),a=(0,DH.useRef)(i);a.current=i;let o=(0,DH.useMemo)(()=>(0,PH.prism)(()=>{let{projectId:e,sheetId:n}=(0,PH.val)(t.sheet).address;return(0,PH.val)(O().atomP.ahistoric.projects.stateByProjectId[e].stateBySheetId[n].sequence.focusRange)}),[t]);gx(r,function(e,t){let[n,r]=(0,DH.useState)("none");return Qb("none"!==n,"dragging","creating"===n?"ew-resize":"move"),(0,DH.useMemo)(()=>({debugName:"FocusRangeZone",onDragStart(n){let[i,a]=n.shiftKey?["creating",{debugName:"FocusRangeZone/focusRangeCreationGestureHandlers",onDragStart(t){let n,r=(0,PH.val)(e.clippedSpace.toUnitSpace),i=(0,PH.val)(e.scaledSpace.toUnitSpace),a=(0,PH.val)(e.sheet),o=a.getSequence(),s=t.target.getBoundingClientRect(),l=r(t.clientX-s.left),u=i(hH.rangeStripMinWidth);return{onDrag(e){let t=i(e),r=l,s=l+t;[r,s]=[ms(r,0,o.length),ms(s,0,o.length)].map(e=>o.closestGridPosition(e)),s<r?[r,s]=[Math.max(Math.min(s,r-u),0),r]:e>0&&(s=Math.min(Math.max(s,r+u),o.length)),n&&n.discard(),n=O().tempTransaction(e=>{let{stateEditors:t}=e;t.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence.focusRange.set(x(b({},a.address),{range:{start:r,end:s},enabled:!0}))})},onDragEnd(e){e&&void 0!==n?n.commit():n&&n.discard()}}},lockCSSCursorTo:"ew-resize"}.onDragStart(n)]:["moving-panel",{debugName:"FocusRangeZone/panelMoveGestureHandlers",onDragStart(){let e,n=t.current,r=t.current.addBoundsHighlightLock();return{onDrag(t,r){let i=x(b({},n.dims),{top:ms(n.dims.top+r,0,window.innerHeight-Sv),left:ms(n.dims.left+t,-n.dims.width+Sv,window.innerWidth-Sv)}),a=TO(i,{width:window.innerWidth,height:window.innerHeight});null==e||e.discard(),e=O().tempTransaction(e=>{let{stateEditors:t}=e;t.studio.historic.panelPositions.setPanelPosition({position:a,panelId:n.panelId})})},onDragEnd(t){r(),t?null==e||e.commit():null==e||e.discard()}}},lockCSSCursorTo:"move"}.onDragStart(n)];return r(i),!1!==a&&{onDrag(e,t,n,r,i){a.onDrag(e,t,n,r,i)},onDragEnd(e){var t;r("none"),null==(t=a.onDragEnd)||t.call(a,e)}}}}),[e,t])}(t,a));let s=kM("Shift"),l=function(e){let[t,n]=(0,lH.useState)(!1);return(0,lH.useEffect)(()=>{if(n(!1),!e)return;let t=t=>{t.target===e?n(!0):n(!1)},r=()=>{n(!1)};return e.addEventListener("mouseenter",t),e.addEventListener("mousemove",t),e.addEventListener("mouseleave",r),()=>{n(!1),e.removeEventListener("mouseenter",t),e.removeEventListener("mousemove",t),e.removeEventListener("mouseleave",r)}},[e]),t}(r);return(0,DH.useEffect)(()=>{if(!s&&l)return a.current.addBoundsHighlightLock()},[!s&&l]),Rh(()=>DH.default.createElement(TH,{ref:n,isShiftDown:s},DH.default.createElement(mH,{layoutP:t}),DH.default.createElement(SH,{thumbType:"start",layoutP:t}),DH.default.createElement(SH,{thumbType:"end",layoutP:t})),[t,o,s])}}),KH=k(()=>{Qh(),zH=P(Oh()),Zp(),sH(),Tj(),Cv(),ZH(),OH=18,FH={backgroundColor:"#1f2120eb",borderColor:"#1c1e21"},jH=Wp.div(MH||(MH=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: ","px;\n  box-sizing: border-box;\n  background: ",";\n  border-bottom: 1px solid ",";\n  ",";\n"])),OH,FH.backgroundColor,FH.borderColor,av),BH=e=>{let{layoutP:t}=e,n=Wh(t.rightDims.width);return zH.default.createElement(zH.default.Fragment,null,zH.default.createElement(jH,b({},yj("hide")),zH.default.createElement(oH,{layoutP:t,width:n,height:OH}),zH.default.createElement(AH,{layoutP:t})))}}),GH=k(()=>{RH=P(Oh()),Zp(),Qh(),M(),Fx(),$C(),LH=e=>isFinite(e)&&e>0,UH=Wp.div(NH||(NH=I(["\n  display: flex;\n  gap: 8px;\n  padding: 4px 8px;\n  height: 28px;\n  align-items: center;\n"]))),qH=Wp.div(VH||(VH=I(["\n  ",";\n  white-space: nowrap;\n"])),NC),HH=e=>{let{deltaX:t}=e;return.25*t},WH=e=>{let{layoutP:t}=e,n=Wh(t.sheet),r=(0,RH.useMemo)(()=>{let e;return{temporarilySetValue(t){e&&(e.discard(),e=void 0),e=O().tempTransaction(e=>{let{stateEditors:r}=e;r.coreByProject.historic.sheetsById.sequence.setLength(x(b({},n.address),{length:t}))})},discardTemporaryValue(){e&&(e.discard(),e=void 0)},permanentlySetValue(t){e&&(e.discard(),e=void 0),O().transaction(e=>{let{stateEditors:r}=e;r.coreByProject.historic.sheetsById.sequence.setLength(x(b({},n.address),{length:t}))})}}},[t,n]),i=(0,RH.useRef)(null);return(0,RH.useLayoutEffect)(()=>{i.current.focus()},[]),Rh(()=>{let e=n.getSequence().length;return RH.default.createElement(UH,null,RH.default.createElement(qH,null,"Sequence length"),RH.default.createElement(Ox,x(b({value:e},r),{isValid:LH,inputRef:i,nudge:HH})))},[n,r,i])}});var XH,$H,YH,JH,QH,eW,tW,nW,rW,iW,aW,oW,sW,lW,uW,cW,dW,hW,fW,pW,mW,gW,yW,vW,_W,bW,xW,wW,kW,SW,EW,CW,PW,DW,IW,TW,AW,zW,OW,FW,MW,jW,BW,RW,LW,NW,UW,VW,qW,HW,WW,ZW,KW,GW,XW,$W,YW,JW=k(()=>{Qh(),XH=n(194),$H=P(Oh()),Zp(),OK(),KH(),tv(),bx(),M(),OE(),Tj(),Mw(),GH(),Cv(),ME(),YH={stripNormal:"#0000006c",stripActive:"#000000"},QH=Wp.div(JH||(JH=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 4px;\n  z-index: ",";\n  pointer-events: none;\n\n  &:after {\n    display: block;\n    content: ' ';\n    position: absolute;\n    /* top: ","px; */\n    top: 0;\n    bottom: 0;\n    left: -1px;\n    width: 1px;\n    background-color: ",";\n  }\n\n  &:hover:after,\n  &.dragging:after {\n    background-color: ",";\n  }\n"])),()=>pK.lengthIndicatorStrip,OH,YH.stripNormal,YH.stripActive),tW=Wp.div(eW||(eW=I(["\n  position: absolute;\n  top: ","px;\n  width: 100px;\n  left: -50px;\n  pointer-events: none;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  z-index: 1;\n"])),OH-15),rW=Wp.div(nW||(nW=I(["\n  margin-top: 8px;\n  font-size: 10px;\n  white-space: nowrap;\n  padding: 2px 8px;\n  border-radius: 2px;\n  ",";\n  cursor: ew-resize;\n  color: #464646;\n  background-color: #0000004d;\n  display: none;\n\n  ",":hover &, ",".dragging & {\n    display: block;\n    color: white;\n    background-color: ",";\n  }\n"])),av,QH,QH,YH.stripActive),aW=Wp.div(iW||(iW=I(["\n  font-size: 10px;\n  white-space: nowrap;\n  padding: 1px 2px;\n  border-radius: 2px;\n  ",";\n  justify-content: center;\n  align-items: center;\n  cursor: ew-resize;\n  color: #5d5d5d;\n  background-color: #191919;\n\n  ",":hover &, ",".dragging & {\n    color: white;\n    background-color: ",";\n\n    & > svg:first-child {\n      margin-right: -1px;\n    }\n  }\n\n  & > svg:first-child {\n    margin-right: -4px;\n  }\n"])),av,QH,QH,YH.stripActive),sW=Wp.div(oW||(oW=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  background-color: rgb(23 23 23 / 43%);\n  width: ","px;\n  z-index: ",";\n  transform-origin: left top;\n\n  ",".dragging ~ &, ",":hover ~ & {\n    background-color: rgb(23 23 23 / 60%);\n  }\n"])),1e3,()=>pK.lengthIndicatorCover,QH,QH),lW=e=>{let{layoutP:t}=e,[n,r]=Qy(null),[i]=function(e,t){let n=(0,$H.useRef)(t);n.current=t;let r=(0,$H.useMemo)(()=>({debugName:"LengthIndicator/useDragBulge",lockCSSCursorTo:"ew-resize",onDragStart(e){let t,r=n.current,i=(0,XH.val)(n.current.layoutP.sheet),a=i.getSequence().length,o=(0,XH.val)(r.layoutP.scaledSpace.toUnitSpace);return{onDrag(e,n,r){let s=o(e);t&&(t.discard(),t=void 0),t=O().tempTransaction(e=>{let{stateEditors:t}=e;t.coreByProject.historic.sheetsById.sequence.setLength(x(b({},i.address),{length:a+s}))})},onDragEnd(e){e?t&&t.commit():t&&t.discard()}}}}),[]),[i]=gx(e,r);return gj(i,-1),[i]}(r,{layoutP:t}),{node:a,toggle:o,close:s}=cE({debugName:"LengthIndicator"},()=>$H.default.createElement(zE,null,$H.default.createElement(WH,{layoutP:t,onRequestClose:s})));return Rh(()=>{let e,s,l=(0,XH.val)(t.sheet),u=(0,XH.val)(t.rightDims.height),c=l.getSequence(),d=c.length,h=d,f=(0,XH.val)(t.clippedSpace.fromUnitSpace)(h),p=(0,XH.val)(t.clippedSpace.width);return f>p?(s=0,e=0):(f<0&&(f=0),s=f,e=(p-f)/1e3),$H.default.createElement($H.default.Fragment,null,a,$H.default.createElement(QH,{style:{height:u+"px",transform:"translateX(".concat(0===s?-1e4:s,"px)")},className:i?"dragging":""},$H.default.createElement(tW,null,$H.default.createElement(aW,b({ref:n,onClick:e=>{o(e,r)}},yj("hide")),$H.default.createElement(pw,null),$H.default.createElement(mw,null)),$H.default.createElement(rW,null,"Sequence length:"," ",c.positionFormatter.formatBasic(d)))),$H.default.createElement(sW,{title:"Length",style:{height:u+"px",transform:"translateX(".concat(s,"px) scale(").concat(e,", 1)")}}))},[t,n,i,a])}}),QW=k(()=>{Qh(),uW=n(194),cW=P(Oh()),Zp(),sH(),OK(),KH(),Tj(),hW=Wp.div(dW||(dW=I(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  margin-top: 0px;\n"]))),pW=Wp.div(fW||(fW=I(["\n  position: absolute;\n  top: 16px;\n  font-size: ",";\n  color: ",";\n  text-align: center;\n  transform: translateX(-50%);\n  background: ",";\n  padding: 1px 8px;\n  font-variant-numeric: tabular-nums;\n  pointer-events: none;\n  z-index: ",";\n"])),tH.stampFontSize,tH.fullUnitStampColor,FH.backgroundColor,()=>pK.currentFrameStamp),gW=Wp.div(mW||(mW=I(["\n  position: absolute;\n  top: 5px;\n  left: -0px;\n  bottom: 0;\n  width: 0.5px;\n  background: rgba(100, 100, 100, 0.2);\n  pointer-events: none;\n"]))),yW=cW.default.memo(e=>{let{layoutP:t}=e,[n,r]=Wh(pj()),i=Wh(t.clippedSpace.fromUnitSpace),{sequence:a,formatter:o,clippedSpaceWidth:s}=Rh(()=>{let e=(0,uW.val)(t.sheet).getSequence(),n=(0,uW.val)(t.clippedSpace.width);return{sequence:e,formatter:e.positionFormatter,clippedSpaceWidth:n}},[t]);if(-1==n)return cW.default.createElement(cW.default.Fragment,null);let l=3===r?a.closestGridPosition(n):n,u=i(l),c=u>=0&&u<=s;return cW.default.createElement(cW.default.Fragment,null,cW.default.createElement(hW,null,cW.default.createElement(pW,{style:{opacity:c?1:0,transform:"translate3d(calc(".concat(u,"px - 50%), 0, 0)")}},o.formatForPlayhead(l)),cW.default.createElement(gW,{posType:r,style:{opacity:c?1:0,transform:"translate3d(".concat(u,"px, 0, 0)")}}))," ")}),vW=yW}),eZ=k(()=>{Qh(),_W=n(194),Fd(),Ym(),bW=P(Oh()),Zp(),OK(),Tj(),Cv(),bx(),wW=Wp.div(xW||(xW=I(["\n  --threadHeight: 6px;\n  --bg-inactive: #32353b;\n  --bg-active: #5b5c5d;\n  position: absolute;\n  height: 0;\n  width: 100%;\n  left: 12px;\n  /* bottom: 8px; */\n  z-index: ",";\n  ","\n"])),()=>pK.horizontalScrollbar,av),SW=Wp.div(kW||(kW=I(["\n  position: relative;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: var(--threadHeight);\n"]))),CW=Wp.div(EW||(EW=I(["\n  position: absolute;\n  height: 5px;\n  background: var(--bg-inactive);\n  cursor: ew-resize;\n  z-index: 2;\n\n  &:hover,\n  &:active {\n    background: var(--bg-active);\n  }\n\n  &:after {\n    ",";\n    display: block;\n    content: ' ';\n  }\n"])),Im("absolute","-4px")),DW=Wp.div(PW||(PW=I(["\n  position: absolute;\n  height: 5px;\n  width: 7px;\n  left: 0;\n  z-index: 2;\n  top: 0;\n  bottom: 0;\n  display: block;\n\n  &:hover:before {\n    background: var(--bg-active);\n  }\n\n  &:before {\n    ",";\n    display: block;\n    content: ' ';\n    background: var(--bg-inactive);\n    border-radius: 0 2px 2px 0;\n  }\n\n  &:after {\n    ",";\n    display: block;\n    content: ' ';\n  }\n"])),Im("absolute","0"),Im("absolute","-4px")),TW=Wp(DW)(IW||(IW=I(["\n  left: calc(-1 * 7px);\n  cursor: w-resize;\n  &:before {\n    transform: scaleX(-1);\n  }\n"]))),zW=Wp(DW)(AW||(AW=I(["\n  cursor: e-resize;\n  left: 0px;\n"]))),FW=Wp.div(OW||(OW=I(["\n  display: ",";\n  position: absolute;\n  top: -20px;\n  left: 4px;\n  padding: 0 4px;\n  transform: translateX(-50%);\n  background: #131d1f;\n  border-radius: 4px;\n  color: #fff;\n  font-size: 10px;\n  line-height: 18px;\n  text-align: center;\n\n  ",":hover &,\n  ",":hover &,\n  ",":hover ~ "," &,\n  ",":hover ~ "," & {\n    display: block;\n  }\n"])),e=>e.active?"block":"none",TW,zW,CW,TW,CW,zW),MW=e=>{let{layoutP:t}=e,n=(0,bW.useCallback)(e=>e.toFixed(2),[]),r=(0,bW.useMemo)(()=>(0,_W.prism)(()=>{let e=(0,_W.val)(t.rightDims.width)-25,n=(0,_W.val)(t.clippedSpace.range),r=(0,_W.val)(t.sheet).getSequence().length,i=Math.max(n.end,r);return{rightWidth:e,clippedSpaceRange:n,sequenceLength:r,assumedLengthOfSequence:i,rangeStartX:n.start/i*e,rangeEndX:n.end/i*e,bottom:(0,_W.val)(t.horizontalScrollbarDims.bottom)}}),[t]),{rangeStartX:i,rangeEndX:a,clippedSpaceRange:o,bottom:s}=Wh(r),[l,u]=(0,bW.useState)("nothing"),c=(0,bW.useMemo)(()=>{let e=(0,_W.val)(r),n=()=>{e=(0,_W.val)(r)},i=t=>t/e.rightWidth*e.assumedLengthOfSequence;return{onRangeDragStart:()=>(n(),{onDrag(n){u("both");let r=i(n),a=Od(e.clippedSpaceRange,e=>e+r);(0,_W.val)(t.clippedSpace.setRange)(a)},onDragEnd(){u("nothing")}}),onRangeStartDragStart:()=>(n(),{onDrag(n){u("start");let r=i(n),a={start:e.clippedSpaceRange.start+r,end:e.clippedSpaceRange.end};a.start>a.end-1&&(a.start=a.end-1),a.start<=0&&(a.start=0),(0,_W.val)(t.clippedSpace.setRange)(a)},onDragEnd(){u("nothing")}}),onRangeEndDragStart:()=>(n(),{onDrag(n){u("end");let r=i(n),a={start:e.clippedSpaceRange.start,end:e.clippedSpaceRange.end+r};a.end<a.start+1&&(a.end=a.start+1),a.end>=e.assumedLengthOfSequence&&(a.end=e.assumedLengthOfSequence),(0,_W.val)(t.clippedSpace.setRange)(a)},onDragEnd(){u("nothing")}})}},[t,r]),[d,h]=(0,bW.useState)(null);gx(d,{debugName:"HorizontalScrollbar/onRangeDrag",onDragStart:c.onRangeDragStart,lockCSSCursorTo:"ew-resize"});let[f,p]=(0,bW.useState)(null);gx(f,{debugName:"HorizontalScrollbar/onRangeStartDrag",onDragStart:c.onRangeStartDragStart,lockCSSCursorTo:"w-resize"});let[m,g]=(0,bW.useState)(null);return gx(m,{debugName:"HorizontalScrollbar/onRangeEndDrag",onDragStart:c.onRangeEndDragStart,lockCSSCursorTo:"e-resize"}),bW.default.createElement(wW,b({style:{bottom:s+8+"px"}},yj("hide")),bW.default.createElement(SW,null,bW.default.createElement(CW,{ref:h,style:{width:"".concat(a-i,"px"),transform:"translate3d(".concat(i,"px, 0, 0)")}}),bW.default.createElement(TW,{ref:p,style:{transform:"translate3d(".concat(i,"px, 0, 0)")}},bW.default.createElement(FW,{active:"both"===l||"start"===l},n(o.start))),bW.default.createElement(zW,{ref:g,style:{transform:"translate3d(".concat(a,"px, 0, 0)")}},bW.default.createElement(FW,{active:"both"===l||"end"===l},n(o.end)))))}}),tZ=k(()=>{jW=P(Oh()),Zp(),RW=Wp.div(BW||(BW=I(["\n  position: absolute;\n  inset: ","px;\n"])),e=>-1*e.room),LW=e=>jW.default.createElement(RW,{room:e.room})}),nZ=k(()=>{Zp(),Qh(),Fx(),$C(),NW=P(Oh()),UW=P(Oh()),VW=n(194),gs(),qW=e=>isFinite(e)&&e>=0,WW=Wp.div(HW||(HW=I(["\n  display: flex;\n  gap: 8px;\n  padding: 4px 8px;\n  height: 28px;\n  align-items: center;\n"]))),KW=Wp.div(ZW||(ZW=I(["\n  ",";\n  white-space: nowrap;\n"])),NC),GW=e=>{let{deltaX:t}=e;return.25*t},XW=e=>{let{layoutP:t,onRequestClose:n}=e,r=(0,VW.val)(t.sheet),i=r.getSequence(),a=(0,NW.useMemo)(()=>{let e,t=i.position;return{temporarilySetValue(t){e&&(e=void 0),e=ms(t,0,i.length),i.position=e},discardTemporaryValue(){e&&(e=void 0,i.position=t,n("discardTemporaryValue"))},permanentlySetValue(t){e&&(e=void 0),i.position=ms(t,0,i.length),n("permanentlySetValue")}}},[t,i]),o=(0,NW.useRef)(null);return(0,NW.useLayoutEffect)(()=>{o.current.focus()},[]),Rh(()=>{let e=r.getSequence(),t=Number((0,VW.val)(e.pointer.position).toFixed(3));return UW.default.createElement(WW,null,UW.default.createElement(KW,null,"Sequence position"),UW.default.createElement(Ox,x(b({value:t},a),{isValid:qW,inputRef:o,nudge:GW})))},[r,a,o])}}),rZ=k(()=>{$W="undefined"!=typeof navigator&&navigator.platform.toUpperCase().indexOf("MAC")>=0}),iZ=k(()=>{rZ(),YW=e=>$W?!0===e.metaKey:!0===e.ctrlKey});function aZ(){let e=O();(0,oZ.useEffect)(()=>{let t=t=>{let n=t.composedPath()[0];if(!n||"INPUT"!==n.tagName&&"TEXTAREA"!==n.tagName){if("z"===t.key||"Z"===t.key||"KeyZ"===t.code){if(!YW(t))return;!0===t.shiftKey?e.redo():e.undo()}else if("Space"!==t.code||t.shiftKey||t.metaKey||t.altKey||t.ctrlKey){if(!t.altKey||"\\"!==t.key&&"Backslash"!==t.code&&"IntlBackslash"!==t.code)return;e.transaction(e=>{let{stateEditors:t,drafts:n}=e;t.studio.ahistoric.setVisibilityState("everythingIsHidden"===n.ahistoric.visibilityState?"everythingIsVisible":"everythingIsHidden")})}else{if(!lZ)return;let e=function(){let e=Dh(S_().filter(e=>V(e)||H(e)).map(e=>H(e)?e.sheet:e))[0];if(e)return e.getSequence()}();if(!e)return;if(e.playing)e.pause();else{let{projectId:t,sheetId:n}=e.address,r=(0,sZ.prism)(()=>{let r=(0,sZ.val)(O().atomP.ahistoric.projects.stateByProjectId[t].stateBySheetId[n].sequence.focusRange);return sZ.prism.memo("shouldFollowFocusRange",()=>{let t=e.position;if(r){let e=t>=r.range.start&&t<=r.range.end;return!r.enabled||!!e}return!0},[])&&r&&r.enabled?{range:[r.range.start,r.range.end],isFollowingARange:!0}:{range:[0,(0,sZ.val)(e.pointer.length)],isFollowingARange:!1}}),i=e.playDynamicRange((0,sZ.prism)(()=>(0,sZ.val)(r).range),O().ticker),a=uZ(e);i.finally(()=>{a.set(void 0)}),a.set(r)}}t.preventDefault(),t.stopPropagation()}};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[])}var oZ,sZ,lZ,uZ,cZ,dZ=k(()=>{oZ=P(Oh()),M(),iZ(),D_(),sZ=n(194),zC(),lZ=!0,uZ=AC(e=>new sZ.Atom(void 0)),cZ=AC(e=>(0,sZ.prism)(()=>{let t=uZ(e).prism.getValue();if(t)return t.getValue().isFollowingARange;{let{projectId:t,sheetId:n}=e.address,r=(0,sZ.val)(O().atomP.ahistoric.projects.stateByProjectId[t].stateBySheetId[n].sequence.focusRange);if(!r||!r.enabled)return!1;let i=(0,sZ.val)(e.pointer.position);return i>=r.range.start&&i<=r.range.end}}))});var hZ,fZ,pZ,mZ,gZ,yZ,vZ,_Z,bZ,xZ,wZ,kZ,SZ,EZ,CZ,PZ,DZ,IZ,TZ,AZ,zZ,OZ,FZ,MZ,jZ=k(()=>{tZ(),bx(),tv(),Qh(),hZ=n(194),gs(),fZ=P(Oh()),Zp(),OK(),Tj(),Cv(),OE(),ME(),nZ(),dZ(),nx(),bP(),M(),xD(),FM(),Zj(),mZ=Wp.div(pZ||(pZ=I(["\n  --thumbColor: #00e0ff;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 5px;\n  height: 100%;\n  z-index: ",";\n  pointer-events: none;\n\n  display: ",";\n"])),()=>pK.playhead,e=>e.isVisible?"block":"none"),yZ=Wp.div(gZ||(gZ=I(["\n  position: absolute;\n  top: 8px;\n  width: 0;\n  height: calc(100% - 8px);\n  border-left: 1px solid #27e0fd;\n  z-index: 10;\n  pointer-events: none;\n\n  #pointer-root.draggingPositionInSequenceEditor &:not(.seeking) {\n    /* pointer-events: auto; */\n    /* cursor: var(","); */\n\n    &:after {\n      position: absolute;\n      inset: -8px;\n      display: block;\n      content: ' ';\n    }\n  }\n"])),Kb),_Z=Wp.div(vZ||(vZ=I(["\n  background-color: var(--thumbColor);\n  position: absolute;\n  width: 5px;\n  height: 13px;\n  top: -4px;\n  left: -2px;\n  z-index: 11;\n  cursor: ew-resize;\n  --sunblock-color: #1f2b2b;\n\n  ",";\n\n  ",".seeking > & {\n    pointer-events: none !important;\n  }\n\n  #pointer-root.draggingPositionInSequenceEditor\n    ",":not(.seeking)\n    > & {\n    pointer-events: auto;\n    cursor: var(",");\n  }\n\n  ",".playheadattachedtofocusrange > & {\n    top: -8px;\n    --sunblock-color: #005662;\n    &:before,\n    &:after {\n      border-bottom-width: 8px;\n    }\n  }\n\n  &:before {\n    position: absolute;\n    display: block;\n    content: ' ';\n    left: -2px;\n    width: 0;\n    height: 0;\n    border-bottom: 4px solid var(--sunblock-color);\n    border-left: 2px solid transparent;\n  }\n\n  &:after {\n    position: absolute;\n    display: block;\n    content: ' ';\n    right: -2px;\n    width: 0;\n    height: 0;\n    border-bottom: 4px solid var(--sunblock-color);\n    border-right: 2px solid transparent;\n  }\n"])),av,mZ,mZ,Kb,mZ),xZ=Wp.div(bZ||(bZ=I(["\n  position: absolute;\n  left: 1px;\n  right: 1px;\n  top: 13px;\n  border-top: 3px solid var(--thumbColor);\n  border-right: 1px solid transparent;\n  border-left: 1px solid transparent;\n  pointer-events: none;\n\n  /* ",".playheadattachedtofocusrange & {\n    top: 10px;\n    &:before,\n    &:after {\n      height: 15px;\n    }\n  } */\n\n  &:before {\n    position: absolute;\n    display: block;\n    content: ' ';\n    top: -4px;\n    left: -2px;\n    height: 8px;\n    width: 2px;\n    background: none;\n    border-radius: 0 100% 0 0;\n    border-top: 1px solid var(--thumbColor);\n    border-right: 1px solid var(--thumbColor);\n  }\n\n  &:after {\n    position: absolute;\n    display: block;\n    content: ' ';\n    top: -4px;\n    right: -2px;\n    height: 8px;\n    width: 2px;\n    background: none;\n    border-radius: 100% 0 0 0;\n    border-top: 1px solid var(--thumbColor);\n    border-left: 1px solid var(--thumbColor);\n  }\n"])),mZ),kZ=Wp.div(wZ||(wZ=I(["\n  display: none;\n  position: absolute;\n  top: -20px;\n  left: 4px;\n  padding: 0 2px;\n  transform: translateX(-50%);\n  background: #1a1a1a;\n  border-radius: 4px;\n  color: #fff;\n  font-size: 10px;\n  line-height: 18px;\n  text-align: center;\n  ",":hover &, ",".seeking & {\n    display: block;\n  }\n"])),_Z,mZ),SZ=e=>{let{layoutP:t}=e,[n,r]=Qy(null),{node:i,toggle:a,close:o}=cE({debugName:"Playhead"},()=>fZ.default.createElement(zE,null,fZ.default.createElement(XW,{layoutP:t,onRequestClose:o}))),s=(0,fZ.useMemo)(()=>({debugName:"RightOverlay/Playhead",onDragStart(){let e=(0,hZ.val)(t.sheet).getSequence(),i=e.position,o=(0,hZ.val)(t.scaledSpace.toUnitSpace),s=(0,hZ.val)(t.seeker.setIsSeeking);return s(!0),zj(),{onDrag(t,n,a){var s;let l=o(t);e.position=null!=(s=zM.checkIfMouseEventSnapToPos(a,{ignore:r}))?s:ms(i+l,0,e.length)},onDragEnd(e){s(!1),Oj()},onClick(e){a(e,n.current)}}}}),[t,r]),[l]=gx(r,s);Qb(l,"draggingPositionInSequenceEditor","ew-resize"),gj(Wh(t.seeker.isSeeking)||l,-1);let[u]=function(e,t){return yP(e,{menuItems:()=>[{label:"Place marker",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e,r=(0,hZ.val)(t.layoutP.sheet),i=r.getSequence();n.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:r.address,markers:[{id:gD(10),position:i.position}],snappingFunction:i.closestGridPosition})})}}]})}(r,{layoutP:t});return Rh(()=>{let e=(0,hZ.val)(t.seeker.isSeeking),r=(0,hZ.val)(t.sheet).getSequence(),a=(0,hZ.val)(cZ(r)),o=r.positionPrism.getValue(),s=(0,hZ.val)(t.clippedSpace.fromUnitSpace)(o),l=s>=0&&s<=(0,hZ.val)(t.clippedSpace.width);return fZ.default.createElement(fZ.default.Fragment,null,u,i,fZ.default.createElement(mZ,b({isVisible:l,style:{transform:"translate3d(".concat(s,"px, 0, 0)")},className:"".concat(e&&"seeking"," ").concat(a&&"playheadattachedtofocusrange")},yj("hide")),fZ.default.createElement(_Z,b({ref:n},zM.includePositionSnapAttrs(o)),fZ.default.createElement(LW,{room:8}),fZ.default.createElement(xZ,null),fZ.default.createElement(kZ,null,r.positionFormatter.formatForPlayhead(r.closestGridPosition(o)))),fZ.default.createElement(yZ,x(b({},zM.includePositionSnapAttrs(o)),{className:e?"seeking":""}))))},[t,n,i])}}),BZ=k(()=>{EZ=n(194),Qh(),M(),KH(),CZ=P(Oh()),Zp(),PZ=1e3,IZ=Wp.div(DZ||(DZ=I(["\n  position: absolute;\n  top: ","px;\n  left: 0;\n  opacity: 0.15;\n  width: ","px;\n  transform-origin: top left;\n  pointer-events: none;\n  background-color: ",";\n"])),OH,PZ,e=>e.enabled?"#000000":"transparent"),TZ=e=>{let{layoutP:t}=e,n=(0,CZ.useMemo)(()=>(0,EZ.prism)(()=>{let{projectId:e,sheetId:n}=(0,EZ.val)(t.sheet).address;return(0,EZ.val)(O().atomP.ahistoric.projects.stateByProjectId[e].stateBySheetId[n].sequence.focusRange)}),[t]);return Rh(()=>{let e=n.getValue();if(!e||!e.enabled)return null;let{range:r}=e,i=(0,EZ.val)(t.rightDims.height)-OH,a=(0,EZ.val)(t.clippedSpace.fromUnitSpace),o=(0,EZ.val)(t.clippedSpace.width),s=[];{let t,n,r=0,i=a(e.range.start);r>i?(n=0,t=0):(i>o&&(i=o),n=r,t=(i-r)/PZ),s.push({translateX:n,scaleX:t})}{let t,n,r=a(e.range.end);r>o?(n=0,t=0):(r<0&&(r=0),n=r,t=(o-r)/PZ),s.push({translateX:n,scaleX:t})}return CZ.default.createElement(CZ.default.Fragment,null,s.map((e,t)=>{let{translateX:n,scaleX:r}=e;return CZ.default.createElement(IZ,{key:"curtain-".concat(t),enabled:!0,style:{height:"".concat(i,"px"),transform:"translateX(".concat(n,"px) scaleX(").concat(r,")")}})}))},[t,n])}}),RZ=k(()=>{AZ=P(Oh()),Zp(),Qh(),M(),$C(),nk(),OZ=Wp.div(zZ||(zZ=I(["\n  display: flex;\n  gap: 8px;\n  /* padding: 4px 8px; */\n  height: 28px;\n  align-items: center;\n"]))),Wp.div(FZ||(FZ=I(["\n  ",";\n  white-space: nowrap;\n"])),NC),MZ=e=>{let{layoutP:t,marker:n}=e;var r;let i=Wh(t.sheet),a=(0,AZ.useMemo)(()=>{let e;return{temporarilySetValue(t){e&&(e.discard(),e=void 0),e=O().tempTransaction(e=>{let{stateEditors:r}=e;r.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:i.address,markerId:n.id,label:t})})},discardTemporaryValue(){e&&(e.discard(),e=void 0)},permanentlySetValue(t){e&&(e.discard(),e=void 0),O().transaction(e=>{let{stateEditors:r}=e;r.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.updateMarker({sheetAddress:i.address,markerId:n.id,label:t})})}}},[t,i]),o=(0,AZ.useRef)(null);return(0,AZ.useLayoutEffect)(()=>{o.current.focus()},[]),AZ.default.createElement(OZ,null,AZ.default.createElement(ek,x(b({value:null!=(r=n.label)?r:""},a),{isValid:()=>!0,inputRef:o})))}});var LZ,NZ,UZ,VZ,qZ,HZ,WZ,ZZ,KZ,GZ,XZ,$Z,YZ,JZ,QZ,eK,tK,nK,rK,iK,aK,oK,sK,lK,uK,cK,dK,hK,fK,pK,mK,gK,yK,vK,_K,bK,xK,wK,kK,SK,EK,CK,PK,DK,IK=k(()=>{LZ=n(194),Qh(),M(),nx(),bP(),tv(),NZ=P(Oh()),Zp(),Tj(),bx(),OK(),FM(),Dj(),Aj(),Zj(),OE(),ME(),RZ(),VZ=Wp.div(UZ||(UZ=I(['\n  position: absolute;\n  // below the sequence ruler "top bar"\n  top: 18px;\n  z-index: ',";\n"])),()=>pK.marker),HZ=Wp.div(qZ||(qZ=I(["\n  position: absolute;\n  ","\n  pointer-events: none;\n"])),aj(12,12)),WZ=NZ.default.memo(()=>NZ.default.createElement(HZ,{children:NZ.default.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 12 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},NZ.default.createElement("path",{d:"M12 5H0V7H2.71973L5.96237 10.2426L9.20501 7H12V5Z",fill:"#40AAA4"}))})),KZ=Wp.div(ZZ||(ZZ=I(["\n  z-index: 1;\n  cursor: ew-resize;\n\n  ","\n\n  // :not dragging marker to ensure that markers don't snap to other markers\n  // this works because only one marker track (so this technique is not used by keyframes...)\n  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) & {\n    ",'\n  }\n\n  // "All instances of this component <Mark/> inside #pointer-root when it has the .draggingPositionInSequenceEditor class"\n  // ref: https://styled-components.com/docs/basics#pseudoelements-pseudoselectors-and-nesting\n  #pointer-root.draggingPositionInSequenceEditor:not(.draggingMarker) &,\n  #pointer-root.draggingPositionInSequenceEditor\n    &.'," {\n    pointer-events: auto;\n    cursor: var(",");\n  }\n\n  &:hover\n    + ",',\n    // notice , "or" in CSS\n    &.',"\n    + "," {\n    ","\n  }\n"])),Sj.CSS,Sj.CSS_WHEN_SOMETHING_DRAGGING,Sj.BEING_DRAGGED_CLASS,Kb,HZ,Sj.BEING_DRAGGED_CLASS,HZ,aj(24,24)),GZ=e=>{let{layoutP:t,markerId:n}=e,r=Wh(t.sheet.address),i=Wh(O().atomP.historic.projects.stateByProjectId[r.projectId].stateBySheetId[r.sheetId].sequenceEditor.markerSet.byId[n]);if(!i)return null;let a=Wh(t.clippedSpace.width),o=Wh(t.clippedSpace.fromUnitSpace)(i.position),s=o<=0||o>a,l=s?-1e4:o,u=s?0:1;return NZ.default.createElement(VZ,{style:{transform:"translateX(".concat(l,"px) scale(").concat(u,")")}},NZ.default.createElement(XZ,{marker:i,layoutP:t}))},XZ=e=>{let{layoutP:t,marker:n}=e,r=Wh(t.sheet.address),[i,a]=Qy(null),[o]=function(e,t){return yP(e,{menuItems:()=>[{label:"Remove marker",callback:()=>{O().transaction(e=>{let{stateEditors:n}=e;n.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.removeMarker({sheetAddress:t.sheetAddress,markerId:t.markerId})})}}]})}(a,{sheetAddress:r,markerId:n.id}),[s]=function(e,t){let n=(0,NZ.useRef)(t);n.current=t;let r=(0,NZ.useMemo)(()=>({debugName:"MarkerDot/useDragMarker (".concat(t.marker.id,")"),onDragStart(r){let i,a=n.current.marker,o=(0,LZ.val)(t.layoutP.scaledSpace.toUnitSpace);return zj(),{onDrag(n,r,s){var l;let u=a,c=Math.max(null!=(l=zM.checkIfMouseEventSnapToPos(s,{ignore:e}))?l:u.position+o(n),0);null==i||i.discard(),i=O().tempTransaction(e=>{let{stateEditors:n}=e;n.studio.historic.projects.stateByProjectId.stateBySheetId.sequenceEditor.replaceMarkers({sheetAddress:(0,LZ.val)(t.layoutP.sheet.address),markers:[x(b({},u),{position:c})],snappingFunction:(0,LZ.val)(t.layoutP.sheet).getSequence().closestGridPosition})})},onDragEnd(e){e?null==i||i.commit():null==i||i.discard(),Oj()}}}}),[]),[i]=gx(e,r);return gj(i,t.marker.position),Qb(i,"draggingPositionInSequenceEditor draggingMarker","ew-resize"),[i]}(a,{layoutP:t,marker:n}),{node:l,toggle:u,close:c}=cE({debugName:"MarkerPopover"},()=>NZ.default.createElement(zE,null,NZ.default.createElement(MZ,{marker:n,layoutP:t,onRequestClose:c})));return NZ.default.createElement(NZ.default.Fragment,null,o,l,NZ.default.createElement(KZ,b({title:n.label?"Marker: ".concat(n.label):"Marker",ref:i,onClick:e=>{u(e,i.current)}},Sj.reactProps({isDragging:s,position:n.position}))),NZ.default.createElement(WZ,null))}}),TK=k(()=>{Qh(),M(),$Z=P(Oh()),IK(),YZ=e=>{let{layoutP:t}=e,n=Wh(t.sheet.address),r=O().atomP.historic.projects.stateByProjectId[n.projectId].stateBySheetId[n.sheetId].sequenceEditor.markerSet,i=Wh(r.allIds);return $Z.default.createElement($Z.default.Fragment,null,i&&Object.keys(i).map(e=>$Z.default.createElement(GZ,{key:e,layoutP:t,markerId:e})))}}),AK=k(()=>{OK(),Qh(),JZ=n(194),QZ=P(Oh()),Zp(),JW(),QW(),eZ(),jZ(),KH(),BZ(),TK(),tK=Wp.div(eK||(eK=I(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  z-index: ",";\n  overflow: visible;\n  pointer-events: none;\n"])),()=>pK.rightOverlay),nK=e=>{let{layoutP:t}=e;return Rh(()=>{let e=(0,JZ.val)(t.rightDims.width);return QZ.default.createElement(tK,{style:{width:e+"px"}},QZ.default.createElement(SZ,{layoutP:t}),QZ.default.createElement(MW,{layoutP:t}),QZ.default.createElement(vW,{layoutP:t}),QZ.default.createElement(BH,{layoutP:t}),QZ.default.createElement(YZ,{layoutP:t}),QZ.default.createElement(lW,{layoutP:t}),QZ.default.createElement(TZ,{layoutP:t}))},[t])}}),zK=k(()=>{rK=n(194),Qh(),M(),iK=P(Oh()),Zp(),Mw(),Tj(),oK=Wp.button(aK||(aK=I(["\n  outline: none;\n  background-color: #1c1d21;\n  border: 1px solid #191919;\n  border-radius: 2px;\n  display: flex;\n  bottom: 14px;\n  right: 8px;\n  z-index: 1;\n  position: absolute;\n\n  padding: 4px 8px;\n  display: flex;\n  color: #656d77;\n  line-height: 20px;\n  font-size: 10px;\n\n  &:hover {\n    color: white;\n  }\n\n  & > svg {\n    transition: transform 0.3s;\n    transform: rotateZ(0deg);\n  }\n\n  &:hover > svg {\n    transform: rotateZ(-20deg);\n  }\n\n  &.open > svg {\n    transform: rotateZ(-180deg);\n  }\n\n  &.open:hover > svg {\n    transform: rotateZ(-160deg);\n  }\n"]))),sK=e=>{let{layoutP:t}=e,n=Wh(t.graphEditorDims.isOpen),r=(0,iK.useCallback)(()=>{let e=(0,rK.val)(t.graphEditorDims.isOpen);O().transaction(t=>{let{stateEditors:n}=t;n.studio.historic.panels.sequenceEditor.graphEditor.setIsOpen({isOpen:!e})})},[t]);return iK.default.createElement(oK,b({onClick:r,title:"Toggle graph editor",className:n?"open":""},yj("hide")),iK.default.createElement(Ow,null))}}),OK=k(()=>{D_(),Qh(),JF(),lK=n(194),uK=P(Oh()),Zp(),xq(),HV(),Gq(),AK(),WF(),ZF(),XF(),Tj(),ne(),Th(),zK(),Pv(),dD(),dK=Wp(bF)(cK||(cK=I(["\n  z-index: ",";\n  box-shadow: 2px 2px 0 rgb(0 0 0 / 11%);\n"])),fv.sequenceEditorPanel),fK=Wp.div(hK||(hK=I(["\n  background-color: rgba(40, 43, 47, 0.99);\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  z-index: -1;\n  pointer-events: none;\n"]))),pK=(()=>{let e={rightBackground:0,scrollableArea:0,rightOverlay:0,lengthIndicatorCover:0,lengthIndicatorStrip:0,playhead:0,currentFrameStamp:0,marker:0,horizontalScrollbar:0},t=-1;for(let n of Object.keys(e))e[n]=t,t++;return e})(),gK=Wp(BO)(mK||(mK=I(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1;\n"]))),yK={edges:{left:{from:"screenLeft",distance:.1},right:{from:"screenRight",distance:.2},top:{from:"screenBottom",distance:.4},bottom:{from:"screenBottom",distance:.01}}},vK={width:800,height:200},_K=e=>uK.default.createElement(OO,{panelId:"sequenceEditor",defaultPosition:yK,minDims:vK},uK.default.createElement(bK,null)),bK=()=>{let{dims:e}=zO(),[t,n]=(0,uK.useState)(null);return DP(t),Rh(()=>{let r=lK.prism.memo("panelSize",()=>{let t=e.width,n=e.height;return{width:t,height:n,widthWithoutBorder:t-2,heightWithoutBorder:n-4,screenX:e.left,screenY:e.top}},[e]),i=Dh(S_().filter(e=>V(e)||H(e)).map(e=>H(e)?e.sheet:e));if(1!==Dh(i.map(e=>e.template)).length)return uK.default.createElement(uK.default.Fragment,null);let a=i[0];if(!a)return uK.default.createElement(uK.default.Fragment,null);let o=VF("panelSizeP",r).pointer,s=lK.prism.memo("key",()=>JSON.stringify(a.address),[a]),l=lK.prism.memo("layout",()=>Hq(a,o),[a,o]).getValue();if(0===(0,lK.val)(l.tree.children).length)return uK.default.createElement(uK.default.Fragment,null);let u=lK.prism.memo("containerRef",kK,[]),c=(0,lK.val)(l.graphEditorDims.isAvailable),d=(0,lK.val)(l.graphEditorDims.isOpen);return uK.default.createElement(dK,{ref:e=>{u(e),e!==t&&n(e)}},uK.default.createElement(fK,{style:{width:"".concat((0,lK.val)(l.leftDims.width),"px")}}),uK.default.createElement(bj,{layoutP:l},uK.default.createElement(xK,{layoutP:l}),uK.default.createElement(pq,{key:s+"-dopeSheet",layoutP:l}),d&&uK.default.createElement(IV,{key:s+"-graphEditor",layoutP:l}),c&&uK.default.createElement(sK,{layoutP:l}),uK.default.createElement(nK,{layoutP:l})))},[e,t])},xK=e=>{let{layoutP:t}=e;return Rh(()=>{let e=(0,lK.val)(t.sheet);return uK.default.createElement(gK,{style:{width:(0,lK.val)(t.leftDims.width)}},uK.default.createElement(kv,null,uK.default.createElement(gv,null,e.address.sheetId," "),uK.default.createElement(vv,null,":","\xa0"),uK.default.createElement(gv,null,e.address.sheetInstanceId," "),uK.default.createElement(vv,null,"\xa0",">","\xa0"),uK.default.createElement(gv,null,"Sequence")))},[t])},wK=_K,kK=()=>{let e=null,t={passive:!1,capture:!1},n=e=>{Math.abs(e.deltaY)<Math.abs(e.deltaX)&&(e.preventDefault(),e.stopPropagation())};return r=>{e!==r&&e&&e.removeEventListener("wheel",n,t),e=r,r&&r.addEventListener("wheel",n,t)}}}),FK=k(()=>{Fb(),HF(),SK=P(Oh()),M(),Qh(),YF(),OK(),EK=()=>{let e=Wh(O().paneManager.allPanesD),t=Object.entries(e).map(e=>{let[t,n]=e;return SK.default.createElement(NF,{key:"pane-".concat(t),paneInstance:n})});return SK.default.createElement(SK.default.Fragment,null,t,SK.default.createElement(Cb,null),SK.default.createElement(EO,null),SK.default.createElement(wK,null))}}),MK=k(()=>{Zp(),pA(),PK=Wp(MT)(CK||(CK=I(["\n  --popover-outer-stroke: #e11c1c;\n  --popover-inner-stroke: #2c1c1c;\n  --popover-bg: #2c1c1c;\n  pointer-events: none !important;\n"]))),DK=PK}),jK=S((e,t)=>{var n,r;n=[],r=[],t.exports=function(e,t,i){var a,o,s,l,u,c,d,h;if(e===t)return 0;if(a=e.length,o=t.length,0===a)return o;if(0===o)return a;for(i&&(e=e.toLowerCase(),t=t.toLowerCase()),d=0;d<a;)r[d]=e.charCodeAt(d),n[d]=++d;for(h=0;h<o;)for(s=t.charCodeAt(h),l=u=h++,d=-1;++d<a;)c=s===r[d]?u:u+1,u=n[d],n[d]=l=u>l?c>l?l+1:c:c>u?u+1:c;return l}}),BK=S((e,t)=>{var n=jK();t.exports=function(){var e,t,r,i,a,o=0,s=arguments[0],l=arguments[1],u=l.length,c=arguments[2];c&&(i=c.threshold,a=c.ignoreCase),void 0===i&&(i=0);for(var d=0;d<u;++d)(e=(t=a?n(s,l[d],!0):n(s,l[d]))>s.length?1-t/l[d].length:1-t/s.length)>o&&(o=e,r=l[d]);return o>=i?r:null}});var RK,LK=k(()=>{RK=P(BK())});function NK(e,t){return e.length<=t?e:e.substr(0,t-3)+"..."}var UK,VK,qK,HK,WK,ZK,KK,GK,XK,$K,YK,JK,QK,eG=k(()=>{}),tG=k(()=>{eG(),UK=e=>"string"==typeof e?'string("'.concat(NK(e,10),'")'):"number"==typeof e?"number(".concat(NK(String(e),10),")"):null===e?"null":void 0===e?"undefined":"boolean"==typeof e?String(e):Array.isArray(e)?"array":"object"==typeof e?"object":"unknown"}),nG=k(()=>{Zp(),Jy(),qK=Wp(Ny)(VK||(VK=I(["\n  display: flex;\n  height: fit-content;\n  backdrop-filter: blur(14px);\n  border-radius: 2px;\n"]))),HK=qK}),rG=k(()=>{Zp(),Cv(),WK=P(Oh()),fA(),qb(),Rz(),nG(),KK=Wp.button(ZK||(ZK=I(["\n  ",";\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 14px;\n  font-weight: 600;\n  width: 32px;\n  height: 32px;\n  outline: none;\n\n  color: #a8a8a9;\n\n  background: rgba(40, 43, 47, 0.8);\n  backdrop-filter: blur(14px);\n  border: none;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.08);\n  border-radius: 2px;\n\n  svg {\n    display: block;\n  }\n\n  &:hover {\n    background: rgba(59, 63, 69, 0.8);\n  }\n\n  &:active {\n    background: rgba(82, 88, 96, 0.8);\n  }\n\n  &.selected {\n    color: rgba(255, 255, 255, 0.8);\n    border-bottom: 1px solid rgba(255, 255, 255, 0.7);\n  }\n\n  // Don't blur if in a button group, because it already blurs. We need to blur\n  // on the group-level, otherwise we get seams.\n  "," > & {\n    backdrop-filter: none;\n    filter: none;\n    border-radius: 0;\n\n    &:first-child {\n      border-top-left-radius: 2px;\n      border-bottom-left-radius: 2px;\n    }\n\n    &:last-child {\n      border-bottom-right-radius: 2px;\n      border-top-right-radius: 2px;\n    }\n  }\n\n  @supports not (backdrop-filter: blur()) {\n    background: rgba(40, 43, 47, 0.95);\n  }\n"])),av,HK),GK=WK.default.forwardRef((e,t)=>{var n=e,{title:r}=n,i=w(n,["title"]);let[a,o]=DT({enabled:"string"==typeof r},()=>WK.default.createElement(iz,null,r));return WK.default.createElement(WK.default.Fragment,null,a,WK.default.createElement(KK,b({ref:Vb([o,t])},i))," ")}),XK=GK}),iG=k(()=>{$K=P(Oh()),rG(),Zp(),Cv(),JK=Wp(XK)(YK||(YK=I(["\n  ",";\n  & > svg {\n    width: 1em;\n    height: 1em;\n    pointer-events: none;\n  }\n"])),av),QK=e=>{let{config:t,testId:n}=e;var r;return $K.default.createElement(JK,{onClick:t.onClick,"data-testid":n,title:t.title,dangerouslySetInnerHTML:{__html:null!=(r=t.svgSource)?r:""}})}});function aG(e){let{value:t,label:n,icon:r,onClick:i,isSelected:a}=e;return oG.default.createElement(oG.default.Fragment,null,oG.default.createElement(XK,{forwardedAs:Ry,className:a?"selected":void 0,"aria-label":n,onClick:i,title:n},r))}var oG,sG,lG,uG,cG,dG,hG,fG,pG,mG,gG=k(()=>{oG=P(Oh()),Jy(),rG(),nG(),sG=e=>{let{value:t,onChange:n,options:r}=e;return oG.default.createElement(HK,null,r.map(e=>{let{label:r,icon:i,value:a}=e;return oG.default.createElement(aG,{key:a,value:a,isSelected:t===a,label:r,icon:i,onClick:()=>n(a)})}))}}),yG=k(()=>{lG=P(Oh()),Zp(),Cv(),gG(),cG=Wp.div(uG||(uG=I(["\n  ",";\n  & > svg {\n    width: 1em;\n    height: 1em;\n    pointer-events: none;\n  }\n"])),av),dG=e=>{let{config:t}=e;return lG.default.createElement(sG,{onChange:t.onChange,options:t.options.map(e=>{let{label:t,value:n,svgSource:r}=e;return{label:t,value:n,icon:lG.default.createElement(cG,{dangerouslySetInnerHTML:{__html:r}})}}),value:t.value})}}),vG=k(()=>{hG=P(Oh()),Zp(),Cv(),rG(),pP(),OE(),pG=Wp.div(fG||(fG=I(["\n  ",";\n  & > svg {\n    width: 1em;\n    height: 1em;\n    pointer-events: none;\n  }\n"])),av),mG=e=>{let{config:t}=e,n=(0,hG.useRef)(null),r=cE(()=>{let e=n.current.getBoundingClientRect();return{debugName:"ExtensionFlyoutMenu:"+t.label,constraints:{maxX:e.right,maxY:8,minX:e.left,minY:8},verticalGap:2}},()=>hG.default.createElement(aP,{items:t.items.map((e,t)=>({label:e.label,callback:()=>{var t;try{null==(t=e.onClick)||t.call(e)}catch(n){console.error(n)}}})),onRequestClose:()=>{r.close("clicked")}}));return hG.default.createElement(pG,null,r.node,hG.default.createElement(XK,{ref:n,onClick:e=>{r.open(e,n.current)}},t.label))}});var _G,bG,xG,wG,kG,SG,EG,CG,PG,DG,IG,TG,AG,zG,OG,FG,MG,jG,BG=k(()=>{LK(),tG(),_G=P(Oh()),iG(),yG(),vG(),bG=e=>_G.default.createElement(_G.default.Fragment,null,e.config.map((e,t)=>_G.default.createElement(wG,{config:e,key:t}))),xG={Icon:QK,Switch:dG,Flyout:mG},wG=e=>{let{config:t}=e,n=function(e){return xG[e]}(t.type);if(!n)throw new Error("No tool with tool.type ".concat(UK(t.type)," exists. Did you mean ").concat(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Did you mean ",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"?",i=(0,RK.default)(e,t,{threshold:.7});return i?n+JSON.stringify(i)+r:""}(t.type,Object.keys(xG))));return _G.default.createElement(n,{config:t})},kG=bG}),RG=k(()=>{SG=n(194),Qh(),M(),EG=P(Oh()),Zp(),BG(),PG=Wp.div(CG||(CG=I(["\n  height: 36px;\n  /* pointer-events: none; */\n\n  display: flex;\n  gap: 0.5rem;\n  justify-content: center;\n"]))),IG=Wp.div(DG||(DG=I(["\n  position: abolute;\n  height: 32px;\n  width: 1px;\n  background: #373b40;\n  opacity: 0.4;\n"]))),TG=e=>{let{extension:t,toolbarId:n}=e;var r;let i=(0,EG.useMemo)(()=>new SG.Atom([]),[]),a=null==(r=t.toolbars)?void 0:r[n];(0,EG.useLayoutEffect)(()=>{let e=null==a?void 0:a(i.set.bind(i),O().publicApi);if("function"==typeof e)return e},[t,n,a]);let o=Wh(i.prism);return EG.default.createElement(kG,{config:o})},AG=e=>{let{toolbarId:t,showLeftDivider:n}=e;var r;let i=[],a=Wh(O().atomP.ephemeral.extensions.byId),o=!1;for(let[,s]of Object.entries(a))!s||null==(r=s.toolbars)||!r[t]||(i.push(EG.default.createElement(EG.default.Fragment,{key:"extensionToolbar-"+s.id},o?EG.default.createElement(IG,null):void 0,EG.default.createElement(TG,{extension:s,toolbarId:t}))),o=!0);return 0===i.length?null:EG.default.createElement(PG,{"data-testid":"theatre-extensionToolbar-".concat(t)},n?EG.default.createElement(IG,null):void 0,i)}}),LG=k(()=>{Zp(),zG=P(Oh()),rG(),FG=Wp(XK)(OG||(OG=I(["\n  color: ",";\n\n  border-bottom: 1px solid\n    ",";\n"])),e=>{let{pinned:t}=e;return t?"rgba(255, 255, 255, 0.8)":"#A8A8A9"},e=>{let{pinned:t}=e;return t?"rgba(255, 255, 255, 0.7)":"rgba(255, 255, 255, 0.08)"}),MG=(0,zG.forwardRef)((e,t)=>{var n=e,{children:r,hint:i,pinned:a,icon:o,pinHintIcon:s,unpinHintIcon:l}=n,u=w(n,["children","hint","pinned","icon","pinHintIcon","unpinHintIcon"]);let[c,d]=(0,zG.useState)(!1),h=c||i;return zG.default.createElement(FG,x(b({},u),{pinned:a,ref:t,onMouseOver:()=>d(!0),onMouseOut:()=>d(!1)}),zG.default.createElement("div",{style:{pointerEvents:"none",width:"fit-content",height:"fit-content",inset:0}},h&&!a?s:h&&a?l:o),r)}),jG=MG});function NG(e){return UG.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),UG.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.732 4.048l-.792-.792L7.2 8l4.74 4.744.792-.792L8.781 8l3.951-3.952zm-3.932 0l-.792-.792L3.268 8l4.74 4.744.792-.792L4.848 8 8.8 4.048z",fill:"currentColor"}))}var UG,VG,qG=k(()=>{UG=P(Oh()),VG=NG});function HG(e){return WG.createElement("svg",b({width:16,height:16,viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),WG.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M3.694 3.765l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.951-3.951-3.951-3.952zm3.932 0l.792-.792 4.74 4.744-4.74 4.744-.792-.793 3.952-3.951-3.952-3.952z",fill:"currentColor"}))}var WG,ZG,KG,GG,XG,$G,YG,JG,QG,eX,tX,nX,rX,iX,aX,oX,sX,lX,uX,cX,dX,hX,fX,pX,mX,gX,yX,vX,_X,bX,xX,wX,kX,SX,EX,CX,PX,DX,IX,TX,AX,zX,OX,FX,MX,jX,BX=k(()=>{WG=P(Oh()),ZG=HG}),RX=k(()=>{Qh(),M(),KG=P(Oh()),Zp(),XG=Wp.div(GG||(GG=I(["\n  width: 138px;\n  border-radius: 2px;\n  background-color: rgba(42, 45, 50, 0.9);\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n  justify-content: flex-start;\n  box-shadow: 0px 1px 1px rgba(0, 0, 0, 0.25), 0px 2px 6px rgba(0, 0, 0, 0.15);\n  backdrop-filter: blur(14px);\n  pointer-events: auto;\n  // makes the edges of the item highlights match the rounded corners\n  overflow: hidden;\n\n  @supports not (backdrop-filter: blur()) {\n    background-color: rgba(42, 45, 50, 0.98);\n  }\n\n  color: rgba(255, 255, 255, 0.9);\n\n  & a {\n    // Fix colors of links to not be default\n    color: inherit;\n  }\n"]))),YG=Wp.div($G||($G=I(["\n  position: relative;\n  padding: 0px 12px;\n  font-weight: 400;\n  font-size: 11px;\n  height: 32px;\n  text-decoration: none;\n  user-select: none;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  cursor: default;\n"]))),QG=Wp(YG)(JG||(JG=I(["\n  &:before {\n    position: absolute;\n    display: block;\n    content: ' ';\n    inset: 3px;\n    border-radius: 3px;\n    background: rgba(255, 255, 255, 0.1);\n    opacity: 0;\n  }\n\n  &.secondary {\n    color: rgba(255, 255, 255, 0.5);\n  }\n\n  &:hover {\n    /* background-color: #398995; */\n    color: white !important;\n    &:before {\n      opacity: 1;\n    }\n  }\n"]))),tX=Wp(YG)(eX||(eX=I(["\n  height: auto;\n  min-height: 32px;\n  padding-top: 12px;\n  padding-bottom: 10px;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: stretch;\n  gap: 8px;\n  color: rgba(255, 255, 255, 0.5);\n"]))),rX=Wp.div(nX||(nX=I(["\n  font-weight: 600;\n"]))),aX=Wp.div(iX||(iX=I(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]))),sX=Wp.div(oX||(oX=I(["\n  margin-left: 2px;\n"]))),uX=Wp.div(lX||(lX=I(["\n  height: 1px;\n  margin: 0 2px;\n  background: rgba(255, 255, 255, 0.02);\n"]))),dX=Wp.div(cX||(cX=I(["\n  position: absolute;\n  width: 8px;\n  height: 8px;\n  background: #40aaa4;\n  right: 14px;\n  top: 12px;\n  border-radius: 50%;\n"]))),fX=(hX="0.7.2").match(/^[^\-]+/)[0],pX=KG.default.forwardRef((e,t)=>{let n=Wh(O().atomP.ahistoric.updateChecker.result.hasUpdates);return KG.default.createElement(XG,{ref:t},KG.default.createElement(QG,{as:"a",href:"https://www.theatrejs.com/docs/latest",className:"",target:"_blank"},"Docs"),KG.default.createElement(QG,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases",className:"",target:"_blank"},"Changelog"),KG.default.createElement(uX,null),KG.default.createElement(QG,{as:"a",href:"https://github.com/theatre-js/theatre",className:"",target:"_blank"},"Github"),KG.default.createElement(QG,{as:"a",href:"https://twitter.com/theatre_js",className:"",target:"_blank"},"Twitter"),KG.default.createElement(QG,{className:"",as:"a",href:"https://discord.gg/bm9f8F9Y9N",target:"_blank"},"Discord"),KG.default.createElement(uX,null),KG.default.createElement(tX,null,KG.default.createElement(rX,null,"Version"),KG.default.createElement(aX,null,KG.default.createElement(sX,null,hX," ",!0===n?"(outdated)":!1===n?"(latest)":""))),!0===n&&KG.default.createElement(KG.default.Fragment,null,KG.default.createElement(uX,null),KG.default.createElement(QG,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases".concat(encodeURIComponent(fX)),className:"",target:"_blank"},"Update",KG.default.createElement(dX,null)),KG.default.createElement(QG,{as:"a",href:"https://www.theatrejs.com/docs/latest/releases#".concat(encodeURIComponent(fX)),className:"",target:"_blank"},"What's new?")))}),mX=pX}),LX=k(()=>{Qh(),M(),gX=P(Oh()),Zp(),fA(),MK(),pA(),yX=n(194),RG(),LG(),x_(),qG(),BX(),rG(),OE(),RX(),Lz(),_X=Wp.div(vX||(vX=I(["\n  height: 36px;\n  pointer-events: none;\n\n  display: flex;\n  justify-content: space-between;\n  padding: 12px;\n"]))),xX=Wp.div(bX||(bX=I(["\n  color: white;\n  width: 14px;\n  height: 14px;\n  background: #d00;\n  border-radius: 4px;\n  text-align: center;\n  line-height: 14px;\n  font-weight: 600;\n  font-size: 8px;\n  position: relative;\n  left: -6px;\n  top: -11px;\n  margin-right: -14px;\n  box-shadow: 0 4px 6px -4px #00000059;\n"]))),kX=Wp.div(wX||(wX=I(["\n  display: flex;\n  gap: 8px;\n"]))),EX=Wp.div(SX||(SX=I(["\n  position: absolute;\n  background: ",";\n  width: 6px;\n  height: 6px;\n  border-radius: 50%;\n  right: -2px;\n  top: -2px;\n"])),e=>{let{type:t}=e;return"info"===t?"#40aaa4":"#f59e0b"}),Wp.div(CX||(CX=I(["\n  position: absolute;\n  height: 32px;\n  width: 1px;\n  background: #373b40;\n  opacity: 0.4;\n"]))),PX=!1,DX=()=>{var e,t,n;let r=Rh(()=>{let e=(0,yX.val)(O().atomP.ephemeral.coreByProject);return Object.entries(e).map(e=>{let[t,n]=e;return{projectId:t,state:n}}).filter(e=>{let{state:t}=e;return"browserStateIsNotBasedOnDiskState"===t.loadingState.type})},[]),[i,a]=DT({enabled:r.length>0,enterDelay:r.length>0?0:200},()=>r.length>0?gX.default.createElement(DK,null,1===r.length?'There is a state conflict in project "'.concat(r[0].projectId,'". Select the project in the outline below in order to fix it.'):"There are ".concat(r.length," projects that have state conflicts. They are highlighted in the outline below. ")):gX.default.createElement(MT,null,gX.default.createElement(gX.default.Fragment,null,"Outline"))),o=null==(e=Wh(O().atomP.ahistoric.pinOutline))||e,s=null==(t=Wh(O().atomP.ahistoric.pinDetails))||t,l=!0===Wh(O().atomP.ahistoric.updateChecker.result.hasUpdates),u=cE(()=>{let e=c.current.getBoundingClientRect();return{debugName:"More Menu",constraints:{maxX:e.right,maxY:8,minX:e.left-140,minY:8},verticalGap:2}},()=>gX.default.createElement(mX,null)),c=(0,gX.useRef)(null),d=(0,gX.useMemo)(()=>(window.__IS_VISUAL_REGRESSION_TESTING&&(PX||(PX=!0,console.warn("Visual regression testing enabled, so we're showing the updates badge unconditionally"))),!(!l&&!window.__IS_VISUAL_REGRESSION_TESTING)||l),[l]),{hasNotifications:h}=jz(),[f,p]=Fz();return gX.default.createElement(_X,null,gX.default.createElement(kX,null,i,gX.default.createElement(jG,{ref:a,"data-testid":"OutlinePanel-TriggerButton",onClick:()=>{O().transaction(e=>{let{stateEditors:t,drafts:n}=e;var r;t.studio.ahistoric.setPinOutline(!(null==(r=n.ahistoric.pinOutline)||r))})},icon:gX.default.createElement(Av,null),pinHintIcon:gX.default.createElement(ZG,null),unpinHintIcon:gX.default.createElement(VG,null),pinned:o}),r.length>0?gX.default.createElement(xX,null,r.length):null,gX.default.createElement(AG,{showLeftDivider:!0,toolbarId:"global"})),gX.default.createElement(kX,null,f,gX.default.createElement(jG,{ref:p,onClick:()=>{O().transaction(e=>{let{stateEditors:t,drafts:n}=e;var r;t.studio.ahistoric.setPinNotifications(!(null!=(r=n.ahistoric.pinNotifications)&&r))})},icon:gX.default.createElement(Yv,null),pinHintIcon:gX.default.createElement(Yv,null),unpinHintIcon:gX.default.createElement(Yv,null),pinned:null!=(n=Wh(O().atomP.ahistoric.pinNotifications))&&n},h&&gX.default.createElement(EX,{type:"warning"})),u.node,gX.default.createElement(XK,{ref:c,onClick:e=>{u.toggle(e,c.current)}},gX.default.createElement(qv,null),d&&gX.default.createElement(EX,{type:"info"})),gX.default.createElement(jG,{ref:a,onClick:()=>{O().transaction(e=>{let{stateEditors:t,drafts:n}=e;var r;t.studio.ahistoric.setPinDetails(!(null==(r=n.ahistoric.pinDetails)||r))})},icon:gX.default.createElement(Lv,null),pinHintIcon:gX.default.createElement(VG,null),unpinHintIcon:gX.default.createElement(ZG,null),pinned:s})))}}),NX=k(()=>{IX=n(194),Qh(),TX=P(Oh()),AX=P(Bh()),zX=new IX.Atom({set:{},byId:{}}),OX=1,FX=()=>{let e=OX++;return{mountOrRender:function(t,n,r){zX.reduce(i=>({byId:x(b({},i.byId),{[e]:{comp:t,props:n,portalNode:r}}),set:x(b({},i.set),{[e]:!0})}))},unmount:function(){zX.reduce(t=>{let n=b({},t.set),r=b({},t.byId);return delete n[e],{byId:r,set:n}})}}},MX=()=>{let e=Object.keys(Wh(zX.pointer.set));return TX.default.createElement(TX.default.Fragment,null,e.map(e=>TX.default.createElement(jX,{key:"id-"+e,id:e})))},jX=e=>{let{id:t}=e,{comp:n,portalNode:r,props:i}=Wh(zX.pointer.byId[t]);return(0,AX.createPortal)(TX.default.createElement(n,b({},i)),r)}});function UX(e){let t=O(),[n,r]=Qy(void 0),i=Dq();i.configureLogging({min:128,dev:XX,internal:XX});let a=i.getLogger().named("Theatre.js UIRoot");aZ();let o=Wh(t.atomP.ahistoric.visibilityState);return(0,qX.useEffect)(()=>("everythingIsHidden"===o&&console.warn("Theatre.js Studio is hidden. Use the keyboard shortcut 'alt + \\' to restore the studio, or call studio.ui.restore()."),()=>{}),[o]),Rh(()=>{let i=(0,VX.val)(t.atomP.ahistoric.visibilityState);return(0,VX.val)(t.atomP.ephemeral.initialised)?qX.default.createElement(rx,{logger:a},qX.default.createElement(ET,null,qX.default.createElement(lx,null,qX.default.createElement($X,null),qX.default.createElement(Gy.Provider,{value:r},qX.default.createElement(dv,{target:!0===window.__IS_VISUAL_REGRESSION_TESTING?void 0:e.containerShadow},qX.default.createElement(qX.default.Fragment,null,qX.default.createElement(WX,null),qX.default.createElement(KX,{className:"everythingIsHidden"===i?"invisible":""},qX.default.createElement(cv,{ref:n}),qX.default.createElement(DX,null),qX.default.createElement(EK,null),qX.default.createElement(Mz,null)))))))):null},[t,n,r])}var VX,qX,HX,WX,ZX,KX,GX,XX,$X,YX=k(()=>{M(),Qh(),VX=n(194),qX=P(Oh()),Zp(),FK(),LX(),tv(),Jy(),dZ(),nx(),PT(),px(),NX(),Cv(),Vq(),sx(),Lz(),WX="undefined"!=typeof window?Rf(HX||(HX=I(["\n  :host {\n    contain: strict;\n  }\n"]))):{},KX=Wp(ex)(ZX||(ZX=I(["\n  z-index: 50;\n  position: fixed;\n  inset: 0;\n\n  &.invisible {\n    pointer-events: none !important;\n    opacity: 0;\n    transform: translateX(1000000px);\n  }\n"]))),XX=/Playground.+Theatre\.js/.test(null!=(GX="undefined"!=typeof document?null==document?void 0:document.title:null)?GX:""),$X=()=>qX.default.createElement(MX,null)}),JX=S(e=>{var t=Bh();e.createRoot=t.createRoot,e.hydrateRoot=t.hydrateRoot}),QX={};E(QX,{default:()=>n$});var e$,t$,n$,r$,i$=k(()=>{YX(),e$=P(Oh()),t$=P(JX()),NX(),Cv(),RG(),n$=class{constructor(){D(this,"containerEl",document.createElement("div")),D(this,"_renderTimeout"),D(this,"_documentBodyUIIsRenderedIn"),D(this,"containerShadow"),this.containerEl.id="theatrejs-studio-root",this.containerEl.style.cssText="\n      position: fixed;\n      top: 0;\n      right: 0;\n      bottom: 0;\n      left: 0;\n      pointer-events: none;\n      z-index: 100;\n    ";this.containerShadow=(()=>{if(!0===window.__IS_VISUAL_REGRESSION_TESTING){let e=document.createElement("div");return e.id="theatrejs-faux-shadow-root",document.body.appendChild(e),e}return this.containerEl.attachShadow({mode:"open"})})()}render(){let e=()=>{document.body?(this._renderTimeout=void 0,this._documentBodyUIIsRenderedIn=document.body,this._documentBodyUIIsRenderedIn.appendChild(this.containerEl),t$.default.createRoot(this.containerShadow).render(e$.default.createElement(UX,{containerShadow:this.containerShadow}))):this._renderTimeout=setTimeout(e,5)};this._renderTimeout=setTimeout(e,10)}renderToolset(e,t){let n=FX();return n.mountOrRender((r=AG,e=>nv.default.createElement(hv,null,nv.default.createElement(r,b({},e)))),{toolbarId:e},t),n.unmount;var r}}}),a$=S(e=>{var t,n,r;function i(e,i,a,o,s,l){return i[s+o]===a[l+o]?{value:e[l+1][s+1].value,type:r}:e[l][s+1].value<e[l+1][s].value?{value:e[l][s+1].value+1,type:t}:{value:e[l+1][s].value+1,type:n}}e.compare=function(e,a){for(var o=e.length,s=a.length,l=function(e,t){for(var n=0,r=Math.min(e.length,t.length);n<r&&e[n]===t[n];)++n;return n}(e,a),u=l<o&&l<s?function(e,t){for(var n=e.length-1,r=t.length-1,i=Math.min(n,r),a=0;a<i&&e[n-a]===t[r-a];)++a;return a}(e,a):0,c=u+l-1,d=function(e,i){var a,o,s,l=[];for(s=l[i]=[],o=0;o<e;++o)s[o]={value:e-o,type:t};for(a=0;a<i;++a)l[a]=[],l[a][e]={value:i-a,type:n};return l[i][e]={value:0,type:r},l}(o-=c,s-=c),h=o-1;h>=0;--h)for(var f=s-1;f>=0;--f)d[f][h]=i(d,e,a,l,h,f);return{prefix:l,matrix:d,suffix:u}},e.reduce=function(e,i,a){var o,s,l,u,c=a.matrix,d=a.prefix;for(o=0;o<d;++o)i=e(i,r,o,o);for(l=o,d=c.length,o=0,s=0;o<d;)switch(u=c[o][s].type,i=e(i,u,o+l,s+l),u){case r:++o,++s;break;case t:++s;break;case n:++o}for(o+=l,s+=l,d=a.suffix,l=0;l<d;++l)i=e(i,r,o+l,s+l);return i},e.REMOVE=t=-1,e.ADD=n=1,e.EQUAL=r=0}),o$=S(e=>{e.cons=function(e,t){var n=t.length,r=new Array(n+1);r[0]=e;for(var i=0;i<n;++i)r[i+1]=t[i];return r},e.tail=function(e){for(var t=e.length-1,n=new Array(t),r=0;r<t;++r)n[r]=e[r+1];return n},e.map=function(e,t){for(var n=new Array(t.length),r=0;r<t.length;++r)n[r]=e(t[r]);return n}}),s$=S((e,t)=>{t.exports=function(e,t){var o,s,l,u;for(o=e.charAt(0)===r?1:0,s="",n.lastIndex=o;l=n.exec(e);)if(u=l[0],s+=e.slice(o,n.lastIndex-u.length),o=n.lastIndex,u===r){if(!1===t(s))return e;s=""}else s+=u===a?r:i;return s+=e.slice(o),t(s),e};var n=/\/|~1|~0/g,r="/",i="~",a="~1"}),l$=S(e=>{var t=s$();e.find=function(e,r,i,a){if("string"==typeof r){if(""===r)return{target:e,key:void 0};if(r===n)return{target:e,key:""};var o,s=e,l=void 0!==a;return t(r,function(t){if(null==e)return s=null,!1;o=Array.isArray(e)?l?function(e,t,n,r){var i=t;if(i<0)throw new Error("array index out of bounds "+i);if(void 0!==r&&"function"==typeof e&&(i=e(t,n,r),i<0))throw new Error("could not find patch context "+r);return i}(i,h(t),e,a):"-"===t?t:h(t):t,s=e,e=e[o]}),null===s?void 0:{target:s,key:o}}},e.join=function(e){return e.join(n)},e.absolute=function(e){return e[0]===n?e:n+e},e.parse=function(e){var n=[];return t(e,n.push.bind(n)),n},e.contains=function(e,t){return 0===t.indexOf(e)&&t[e.length]===n},e.encodeSegment=function(e){return e.replace(s,l).replace(r,i)},e.decodeSegment=function(e){return e.replace(a,n).replace(u,o)},e.parseArrayIndex=h,e.isValidArrayIndex=d;var n="/",r=/\//g,i="~1",a=/~1/g,o="~",s=/~/g,l="~0",u=/~0/g;var c=/^(0|[1-9]\d*)$/;function d(e){return c.test(e)}function h(e){if(d(e))return+e;throw new SyntaxError("invalid array index "+e)}}),u$=S((e,t)=>{function n(e){return null==e||"object"!=typeof e?e:Array.isArray(e)?function(e){for(var t=e.length,r=new Array(t),i=0;i<t;++i)r[i]=n(e[i]);return r}(e):function(e){for(var t,r=Object.keys(e),i={},a=0,o=r.length;a<o;++a)t=r[a],i[t]=n(e[t]);return i}(e)}t.exports=n}),c$=S((e,t)=>{function n(e,t){return e===t||(Array.isArray(e)&&Array.isArray(t)?function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!n(e[r],t[r]))return!1;return!0}(e,t):"object"==typeof e&&"object"==typeof t&&function(e,t){if(null===e&&null!==t||null!==e&&null===t)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(var a,o=0;o<r.length;++o)if(!((a=r[o])in t)||!n(e[a],t[a]))return!1;return!0}(e,t))}t.exports=n}),d$=S((e,t)=>{var n=l$();function r(e,t,n,r,i){var a=t.length-1,o=+t[a],s=+r[a],l=r.slice();return o>s||("add"===e.op||"copy"===e.op?l[a]=Math.max(0,s-i):"remove"===e.op&&(l[a]=Math.max(0,s+i))),l}function i(e){return"remove"===e.op?{op:e.op,path:e.path}:"copy"===e.op||"move"===e.op?{op:e.op,path:e.path,from:e.from}:{op:e.op,path:e.path,value:e.value}}t.exports=function(e,t){var a=n.parse(e.path),o=n.parse(t.path),s=function(e,t){var n=e.length,r=t.length;if(0===n||0===r||n<2&&r<2)return[];for(var i=n===r?n-1:Math.min(n,r),a=0;a<i&&e[a]===t[a];)++a;return e.slice(0,a)}(a,o),l=function(e,t,r){return n.isValidArrayIndex(e[r])&&n.isValidArrayIndex(t[r])}(a,o,s.length),u=i(e),c=i(t);return 0!==s.length||l?l?function(e,t,i,a){return t.length===a.length?function(e,t,r,i){var a,o=t.length-1,s=+t[o],l=+i[o];return s<l?"add"===e.op||"copy"===e.op?(a=i.slice(),a[o]=Math.max(0,l-1),r.path=n.absolute(n.join(a))):"remove"===e.op&&(a=i.slice(),a[o]=l+1,r.path=n.absolute(n.join(a))):"add"===r.op||"copy"===r.op?(a=t.slice(),a[o]=s+1,e.path=n.absolute(n.join(a))):s>l&&"remove"===r.op&&(a=t.slice(),a[o]=Math.max(0,s-1),e.path=n.absolute(n.join(a))),[r,e]}(e,t,i,a):(t.length>a.length?(t=r(i,a,e,t,-1),e.path=n.absolute(n.join(t))):(a=r(e,t,i,a,1),i.path=n.absolute(n.join(a))),[i,e])}(u,a,c,o):function(e,t,n){if(e.path===n.path)throw new TypeError("cannot commute "+e.op+","+n.op+" with identical object paths");return[n,e]}(u,0,c):[c,u]}}),h$=S((e,t)=>{function n(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}t.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n}),f$=S((e,t)=>{function n(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}t.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n}),p$=S((e,t)=>{function n(e){Error.call(this),this.name=this.constructor.name,this.message=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}t.exports=n,n.prototype=Object.create(Error.prototype),n.prototype.constructor=n}),m$=S(e=>{var t=l$(),n=u$(),r=c$(),i=d$(),a=o$(),o=h$(),s=f$(),l=p$(),u=t.find,c=t.parseArrayIndex;function d(e,t){var n=e.target;if(Array.isArray(n))if("-"===e.key)n.push(t);else{if(e.key>n.length)throw new s("target of add outside of array bounds");n.splice(e.key,0,t)}else{if(!g(n))throw new s("target of add must be an object or array "+e.key);n[e.key]=t}}function h(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute add,remove -> remove,add for same path");return i(e,t)}function f(e){var t,n=e.target;if(Array.isArray(n))return(t=n.splice(c(e.key),1))[0];if(g(n))return t=n[e.key],delete n[e.key],t;throw new s("target of remove must be an object or array")}function p(e){return void 0===e||null==e.target&&void 0!==e.key}function m(e){return void 0!==e.key&&void 0===e.target[e.key]}function g(e){return null!==e&&"object"==typeof e}e.test={apply:function(e,t,n){var i,a,s=u(e,t.path,n.findContext,t.context),l=s.target;if(Array.isArray(l)?(i=c(s.key),a=l[i]):a=void 0===s.key?s.target:s.target[s.key],!r(a,t.value))throw new o("test failed "+JSON.stringify(t));return e},inverse:function(e,t){return e.push(t),1},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute test,remove -> remove,test for same path");return"test"===t.op||"replace"===t.op?[t,e]:i(e,t)}},e.add={apply:function(e,t,r){var i=u(e,t.path,r.findContext,t.context);if(p(i))throw new s("path does not exist "+t.path);if(void 0===t.value)throw new s("missing value");var a=n(t.value);return void 0===i.key?a:(d(i,a),e)},inverse:function(e,t){var n=t.context;return void 0!==n&&(n={before:n.before,after:a.cons(t.value,n.after)}),e.push({op:"test",path:t.path,value:t.value,context:n}),e.push({op:"remove",path:t.path,context:n}),1},commute:h},e.remove={apply:function(e,t,n){var r=u(e,t.path,n.findContext,t.context);if(p(r)||void 0===r.target[r.key])throw new s("path does not exist "+t.path);return f(r),e},inverse:function(e,t,n,r){var i=r[n-1];if(void 0===i||"test"!==i.op||i.path!==t.path)throw new l("cannot invert remove w/o test");var o=i.context;return void 0!==o&&(o={before:o.before,after:a.tail(o.after)}),e.push({op:"add",path:i.path,value:i.value,context:o}),2},commute:function(e,t){return e.path===t.path&&"remove"===t.op?[t,e]:i(e,t)}},e.replace={apply:function(e,t,r){var i=u(e,t.path,r.findContext,t.context);if(p(i)||m(i))throw new s("path does not exist "+t.path);if(void 0===t.value)throw new s("missing value");var a=n(t.value);if(void 0===i.key)return a;var o=i.target;return Array.isArray(o)?o[c(i.key)]=a:o[i.key]=a,e},inverse:function(e,t,n,r){var i=r[n-1];if(void 0===i||"test"!==i.op||i.path!==t.path)throw new l("cannot invert replace w/o test");var o=i.context;return void 0!==o&&(o={before:o.before,after:a.cons(i.value,a.tail(o.after))}),e.push({op:"test",path:i.path,value:t.value}),e.push({op:"replace",path:i.path,value:i.value}),2},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute replace,remove -> remove,replace for same path");return"test"===t.op||"replace"===t.op?[t,e]:i(e,t)}},e.move={apply:function(e,n,r){if(t.contains(n.path,n.from))throw new s("move.from cannot be ancestor of move.path");var i=u(e,n.path,r.findContext,n.context),a=u(e,n.from,r.findContext,n.fromContext);return d(i,f(a)),e},inverse:function(e,t){return e.push({op:"move",path:t.from,context:t.fromContext,from:t.path,fromContext:t.context}),1},commute:function(e,t){if(e.path===t.path&&"remove"===t.op)throw new TypeError("Can't commute move,remove -> move,replace for same path");return i(e,t)}},e.copy={apply:function(e,t,r){var i=u(e,t.path,r.findContext,t.context),a=u(e,t.from,r.findContext,t.fromContext);if(p(a)||m(a))throw new s("copy.from must exist");var o,l=a.target;return o=Array.isArray(l)?l[c(a.key)]:l[a.key],d(i,n(o)),e},inverse:function(e,t){throw new l("cannot invert "+t.op)},commute:h}}),g$=S(e=>{var t=m$(),n=u$(),r=f$();e.apply=function(e,t,r){return a(e,n(t),r)},e.applyInPlace=a,e.clone=n,e.isValidObject=o,e.defaultHash=function(e){return o(e)||function(e){return"[object Array]"===Object.prototype.toString.call(e)}(e)?JSON.stringify(e):e};var i={};function a(e,n,a){if(a||(a=i),!Array.isArray(e))return n;for(var o,s,l=0;l<e.length;++l){if(s=e[l],void 0===(o=t[s.op]))throw new r("invalid op "+JSON.stringify(s));n=o.apply(n,s,a)}return n}function o(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}}),y$=S((e,t)=>{var n=m$();function r(e,t,r,i){var a=n[t.op];return void 0!==a&&"function"==typeof a.inverse?a.inverse(e,t,r,i):1}t.exports=function(e){var t,n,i=[];for(t=e.length-1;t>=0;t-=n)n=r(i,e[t],t,e);return i}}),v$=S(e=>{var t=a$(),n=o$(),r=g$(),i=y$(),a=l$().encodeSegment;e.diff=function(e,t,n){return l(e,t,"",function(e,t){return"object"==typeof e?{patch:t,hash:u(d,e.hash,s),makeContext:u(d,e.makeContext,c),invertible:!1!==e.invertible}:{patch:t,hash:u(d,e,s),makeContext:c,invertible:!0}}(n,[])).patch},e.patch=r.apply,e.patchInPlace=r.applyInPlace,e.inverse=i,e.clone=r.clone,e.InvalidPatchOperationError=f$(),e.TestFailedError=h$(),e.PatchNotInvertibleError=p$();var o=r.isValidObject,s=r.defaultHash;function l(e,r,i,s){return Array.isArray(e)&&Array.isArray(r)?function(e,r,i,a){var o=n.map(a.hash,e),s=n.map(a.hash,r),u=t.compare(o,s);return function(e,n,r,i,a){var o=0;return t.reduce(function(i,a,s,u){var c,d,h=i.patch,f=r+"/"+(u+o);return a===t.REMOVE?(c=h[h.length-1],d=i.makeContext(u,e),i.invertible&&h.push({op:"test",path:f,value:e[u],context:d}),void 0!==c&&"add"===c.op&&c.path===f?(c.op="replace",c.context=d):h.push({op:"remove",path:f,context:d}),o-=1):a===t.ADD?(h.push({op:"add",path:f,value:n[s],context:i.makeContext(u,e)}),o+=1):l(e[u],n[s],f,i),i},i,a)}(e,r,i,a,u)}(e,r,i,s):o(e)&&o(r)?function(e,t,n,r){var i,o,s=Object.keys(t),u=r.patch;for(i=s.length-1;i>=0;--i){o=s[i];var c=n+"/"+a(o);void 0!==e[o]?l(e[o],t[o],c,r):u.push({op:"add",path:c,value:t[o]})}for(s=Object.keys(e),i=s.length-1;i>=0;--i)if(o=s[i],void 0===t[o]){var d=n+"/"+a(o);r.invertible&&u.push({op:"test",path:d,value:e[o]}),u.push({op:"remove",path:d})}return r}(e,r,i,s):function(e,t,n,r){return e!==t&&(r.invertible&&r.patch.push({op:"test",path:n,value:e}),r.patch.push({op:"replace",path:n,value:t})),r}(e,r,i,s)}function u(e,t,n){return e(t)?t:n}function c(){}function d(e){return"function"==typeof e}}),_$=S((e,t)=>{t.exports=function(e,t){for(var n=0,r=t.length-1;n<r;n++){if(!e[t[n]])return null;e=e[t[n]]}return e}}),b$=S((e,t)=>{function n(e){return"~0"===e?"~":"/"}t.exports=function(e){var t=e.split("/");if(-1===e.indexOf("~"))return t;for(var r=0,i=t.length;r<i;r++)-1!==t[r].indexOf("~")&&(t[r]=t[r].replace(/~[01]/g,n));return t}}),x$=S((e,t)=>{var n=_$(),r=b$();t.exports=function(e,t){var i=r(t),a=i[i.length-1],o=n(e,i);return o?o[a]:void 0}}),w$=S((e,t)=>{t.exports=function e(t,n){if(t===n)return!0;if(!t||!n||"object"!=typeof t||"object"!=typeof n||t.length!==n.length)return!1;if(Array.isArray(t)){if(!Array.isArray(n))return!1;for(var r=0,i=t.length;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}var a=Object.keys(t);if(a.length!==Object.keys(n).length)return!1;for(var o=0,s=a.length;o<s;o++){var l=a[o];if(!e(t[l],n[l]))return!1}return!0}}),k$=S((e,t)=>{t.exports=function(e,t){if("-"===t)return e.length;for(var n=0,r=t.length;n<r;n++){var i=t.charCodeAt(n);if(57<i||i<48)return 1/0}return+t}}),S$=S((e,t)=>{var n=w$(),r=_$(),i=k$(),a=b$();t.exports=function(e,t,o,s){if("undefined"==typeof o)return"[op:add] require value, but got undefined";var l=a(t),u=l[l.length-1],c=r(e,l);if(null===c)return"[op:add] path not found: "+t;if(Array.isArray(c)){var d=i(c,u);if(c.length<d)return"[op:add] invalid array index: "+t;s(e,l).splice(d,0,o)}else n(c[u],o)||(s(e,l)[u]=o)}}),E$=S((e,t)=>{var n=_$(),r=k$(),i=b$();t.exports=function(e,t,a){var o=i(t),s=o[o.length-1],l=n(e,o);if(null===l)return"[op:remove] path not found: "+t;if(Array.isArray(l)){var u=r(l,s);if(l.length<=u)return"[op:remove] invalid array index: "+t;a(e,o).splice(u,1)}else delete a(e,o)[s]}}),C$=S((e,t)=>{var n=w$(),r=_$(),i=k$(),a=b$();t.exports=function(e,t,o,s){if("undefined"==typeof o)return"[op:replace] require value, but got undefined";var l=a(t),u=l[l.length-1],c=r(e,l);if(null===c)return"[op:replace] path not found: "+t;if(Array.isArray(c)){var d=i(c,u);if(c.length<=d)return"[op:replace] invalid array index: "+t;n(c[d],o)||s(e,l).splice(d,1,o)}else n(c[u],o)||(s(e,l)[u]=o)}}),P$=S((e,t)=>{var n=S$(),r=_$(),i=k$(),a=b$();t.exports=function(e,t,o,s){if(o!==t){var l=a(t),u=l[l.length-1],c=r(e,l);if(null===c)return"[op:move] path not found: "+t;var d=void 0;if(Array.isArray(c)){var h=i(c,u);if(c.length<=h)return"[op:move] invalid array index: "+o;d=c[h],s(e,l).splice(h,1)}else d=c[u],delete s(e,l)[u];return n(e,o,d,s)}}}),D$=S((e,t)=>{var n=_$(),r=b$(),i=S$();t.exports=function(e,t,a,o){var s=r(t),l=s[s.length-1],u=n(e,s);return null===u?"[op:copy] path not found: "+t:i(e,a,u[l],o)}}),I$=S((e,t)=>{var n=w$(),r=_$(),i=b$();t.exports=function(e,t,a){var o=i(t),s=o[o.length-1],l=r(e,o);return null===l?"[op:test] path not found: "+t:n(l[s],a)?void 0:"[op:test] not matched: "+JSON.stringify(l[s])+" "+JSON.stringify(a)}}),T$=S((e,t)=>{t.exports=function(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(var t=e.length,n=new Array(t),r=0;r<t;r++)n[r]=e[r];return n}for(var i=Object.keys(e),a={},o=0,s=i.length;o<s;o++){var l=i[o];a[l]=e[l]}return a}}),A$=S((e,t)=>{var n=x$(),r=S$(),i=E$(),a=C$(),o=P$(),s=D$(),l=I$(),u=w$(),c=T$(),d=b$();t.exports=function(e,t){return{get:function(t){return n(e,t)},add:function(n,i){return r(e,n,i,t)},remove:function(n){return i(e,n,t)},replace:function(n,r){return a(e,n,r,t)},move:function(n,r){return o(e,n,r,t)},copy:function(n,r){return s(e,n,r,t)},test:function(t,n){return l(e,t,n)},deepEqual:u,shallowCopy:c,toKeys:d}}}),z$=S((e,t)=>{t.exports=function(e,t,n,r){return r.error=n,r.partial?t[""]:e}}),O$=S((e,t)=>{t.exports=function(e){return!!e}}),F$=S((e,t)=>{t.exports=function(e){if(e)throw new TypeError(e)}}),M$=S((e,t)=>{var n=T$();t.exports=function(e,t){for(var r=0,i=t.length-1;r<i;r++)e=e[t[r]]=n(e[t[r]]);return e}}),j$=S((e,t)=>{var n=T$();function r(e,t,r){var i=e[t];return r.has(i)||(i=n(i),r.add(i)),i}t.exports=function(e,t,n){for(var i=0,a=t.length-1;i<a;i++)e=e[t[i]]=r(e,t[i],n);return e}}),B$=S((e,t)=>{var n=A$(),r=z$(),i=O$(),a=F$(),o=M$(),s=j$(),l=S$(),u=E$(),c=C$(),d=P$(),h=D$(),f=I$(),p=Set||function(){var e=[];return e.has=function(e){return-1!==this.indexOf(e)},e.add=function(e){this.push(e)},e};t.exports=function(e,t,m){if(0===t.length)return e;for(var g,y=(m=m||{}).strict?a:i,v=1===t.length?o:function(e){return function(t,n){return s(t,n,e)}}(new p),_={"":e},b=0,x=t.length;b<x;b++){var w=t[b];switch(w.op){case"add":if(y(l(_,""+w.path,w.value,v)))return r(e,_,w,m);break;case"remove":if(y(u(_,""+w.path,v)))return r(e,_,w,m);break;case"replace":if(y(c(_,""+w.path,w.value,v)))return r(e,_,w,m);break;case"move":if(y(d(_,""+w.from,""+w.path,v)))return r(e,_,w,m);break;case"copy":if(y(h(_,""+w.from,""+w.path,v)))return r(e,_,w,m);break;case"test":if(y(f(_,""+w.path,w.value)))return r(e,_,w,m);break;default:if(!m.custom||!m.custom[w.op])return y("[op:"+w.op+"] unknown"),r(e,_,w,m);if(g=g||n(_,v),y(m.custom[w.op](g,w,b,t)))return r(e,_,w,m)}}return _[""]}}),R$=S((e,t)=>{t.exports=B$()}),L$=S((n,o)=>{var s;window,s=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){i=!0,a=l}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._messageId=1,n._messages=new Map,n._worker=e,n._worker.onmessage=n._onMessage.bind(n),n._id=Math.ceil(1e7*Math.random()),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"terminate",value:function(){this._worker.terminate()}},{key:"isFree",value:function(){return 0===this._messages.size}},{key:"jobsLength",value:function(){return this._messages.size}},{key:"exec",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments[3];return new Promise(function(a,o){var s=n._messageId++;n._messages.set(s,[a,o,i]),n._worker.postMessage([s,t,e],r||[])})}},{key:"postMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];return new Promise(function(i,a){var o=t._messageId++;t._messages.set(o,[i,a,r]),t._worker.postMessage([o,e],n||[])})}},{key:"emit",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this._worker.postMessage({eventName:e,args:n})}},{key:"_onMessage",value:function(e){var n;if(!Array.isArray(e.data)&&e.data.eventName)return(n=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(n,[this,e.data.eventName].concat(a(e.data.args)));var r,i=(r=e.data,Array.isArray(r)?r:Array.from(r)),o=i[0],s=i.slice(1);if(1===o)this._onEvent.apply(this,a(s));else{if(0!==o)throw new Error("Wrong message type '"+o+"'");this._onResult.apply(this,a(s))}}},{key:"_onResult",value:function(e,t,n){var i=this._messages.get(e),a=r(i,2),o=a[0],s=a[1];return this._messages.delete(e),1===t?o(n):s(n)}},{key:"_onEvent",value:function(e,t,n){var i=this._messages.get(e),a=r(i,3)[2];a&&a(t,n)}}]),t}(n(2));e.exports=o},function(e,t,n){e.exports=function(){return n(3)('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function a(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var f=r(1),c=0,l=1,s=0,y=1,p="main",b=function(e){return"object"===(void 0===e?"undefined":i(e))&&"function"==typeof e.then&&"function"==typeof e.catch};var v=function e(t,r){u(this,e),this.payload=t,this.transferable=r};e.exports=function(e){var t,r,i,h=(i=e,(r=p)in(t={})?Object.defineProperty(t,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[r]=i,t),d=self.postMessage.bind(self),m=new(function(e){function t(){return u(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn\'t been initialised - super() hasn\'t been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),n(t,[{key:"emit",value:function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return d({eventName:e,args:r}),this}},{key:"emitLocally",value:function(e){for(var r,n=arguments.length,i=Array(n>1?n-1:0),a=1;a<n;a++)i[a-1]=arguments[a];(r=o(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"operation",value:function(e,t){return h[e]=t,this}}]),t}(f)),g=function(e,t,r){var n=function(t){t&&t instanceof v?w(e,y,t.payload,t.transferable):w(e,y,t)},o=function(t){w(e,s,{message:t.message,stack:t.stack})};try{var i=_(e,t,r);b(i)?i.then(n).catch(o):n(i)}catch(e){o(e)}},_=function(e,t,r){var n=h[r||p];if(!n)throw new Error("Not found handler for this request");return n(t,O.bind(null,e))},w=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];d([c,e,t,r],n)},O=function(e,t,r){if(!t)throw new Error("eventName is required");if("string"!=typeof t)throw new Error("eventName should be string");d([l,e,t,r])};return self.addEventListener("message",(function(e){var t=e.data;Array.isArray(t)?g.apply(void 0,a(t)):t&&t.eventName&&m.emitLocally.apply(m,[t.eventName].concat(a(t.args)))})),m},e.exports.TransferableResponse=v},function(e,t,r){"use strict";var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var o=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return n(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var o=!0,i=!1,a=void 0;try{for(var u,f=this.__listeners[e][Symbol.iterator]();!(o=(u=f.next()).done);o=!0){var c=u.value;c.apply(void 0,r)}}catch(e){i=!0,a=e}finally{try{!o&&f.return&&f.return()}finally{if(i)throw a}}return this}},{key:"once",value:function(e,t){var r=this,n=function n(){r.off(e,n),t.apply(void 0,arguments)};return this.on(e,n)}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((function(e){return e!==t})):[],this}}]),e}();e.exports=o},function(e,t,r){"use strict";r.r(t);var n=r(0);r.n(n)()().operation("binary",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsBinaryString(a)})}(e,t)).operation("buffer",async({blob:e,chunk:t})=>await function(e,t){return new Promise((r,n)=>{const o=new FileReader,i=t?Math.min(t,e.size):e.size,a=e.slice(0,i);o.onload=()=>r(o.result),o.onerror=n,o.readAsArrayBuffer(a)})}(e,t)).operation("compare",({buf1:e,buf2:t})=>(function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;const r=new DataView(e),n=new DataView(t);for(var o=e.byteLength;o--;)if(r.getUint8(o)!==n.getUint8(o))return!1;return!0})(e,t))}]);',null)}},function(e,t,n){var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}return r(e,[{key:"emit",value:function(e){if(!this.__listeners[e])return this;for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=!0,a=!1,o=void 0;try{for(var s,l=this.__listeners[e][Symbol.iterator]();!(i=(s=l.next()).done);i=!0)s.value.apply(void 0,n)}catch(u){a=!0,o=u}finally{try{!i&&l.return&&l.return()}finally{if(a)throw o}}return this}},{key:"once",value:function(e,t){var n=this;return this.on(e,function r(){n.off(e,r),t.apply(void 0,arguments)})}},{key:"on",value:function(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}},{key:"off",value:function(e,t){return this.__listeners[e]=t?this.__listeners[e].filter(function(e){return e!==t}):[],this}}]),e}();e.exports=i},function(e,t,n){var r=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var n;try{(n=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),n=n.getBlob()}catch(i){n=new Blob([e])}return new Worker(r.createObjectURL(n))}catch(i){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(i){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,n){n.r(t);var r=n(0),i=n.n(r),a=n(1),o=n.n(a);n.d(t,"workersEnabled",function(){return s}),n.d(t,"default",function(){return l});let s=!!window.Worker;class l{static toBinaryStringWithWorker(e,t){return T(this,null,function*(){let n=new i.a(new o.a),r=yield n.exec("binary",{blob:e,chunk:t});return n.terminate(),r})}static toBinaryStringWithoutWorker(e,t){return n=e,r=t,new Promise((e,t)=>{let i=new FileReader,a=r?Math.min(r,n.size):n.size,o=n.slice(0,a);i.onload=()=>e(i.result),i.onerror=t,i.readAsBinaryString(o)});var n,r}static toBinaryString(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||!s?this.toBinaryStringWithoutWorker(e,t):this.toBinaryStringWithWorker(e,t)}static toArrayBufferWithWorker(e,t){return T(this,null,function*(){let n=new i.a(new o.a),r=yield n.exec("buffer",{blob:e,chunk:t});return n.terminate(),r})}static toArrayBufferWithoutWorker(e,t){return n=e,r=t,new Promise((e,t)=>{let i=new FileReader,a=r?Math.min(r,n.size):n.size,o=n.slice(0,a);i.onload=()=>e(i.result),i.onerror=t,i.readAsArrayBuffer(o)});var n,r}static toArrayBuffer(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||!s?this.toArrayBufferWithoutWorker(e,t):this.toArrayBufferWithWorker(e,t)}static compareBuffersWithWorker(e,t){return T(this,null,function*(){if(e===t)return!0;let n=new i.a(new o.a),r=yield n.exec("compare",{buf1:e,buf2:t},[e,t]);return n.terminate(),r})}static compareBuffersWithoutWorker(e,t){return function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;let n=new DataView(e),r=new DataView(t);for(var i=e.byteLength;i--;)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}(e,t)}static compareBuffers(e,t){return arguments.length>2&&void 0!==arguments[2]&&!arguments[2]||!s?this.compareBuffersWithoutWorker(e,t):this.compareBuffersWithWorker(e,t)}static sizeEqual(e,t){return e.size===t.size}static typeEqual(e,t){return e.type===t.type}static magicNumbersEqual(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return T(this,null,function*(){if(e===t)return!0;let r=[24,16,14,12,8,6,4],[i,a]=yield Promise.all([this.toBinaryString(e,24,n),this.toBinaryString(t,24,n)]);for(let e of r)if(i.substring(0,e)===a.substring(0,e))return!0;return!1})}static bytesEqualWithBinaryString(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return T(this,null,function*(){if(e===t)return!0;let[i,a]=yield Promise.all([this.toBinaryString(e,n,r),this.toBinaryString(t,n,r)]);return i===a})}static bytesEqualWithArrayBuffer(e,t,n){let r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return T(this,null,function*(){if(e===t)return!0;let[i,a]=yield Promise.all([this.toArrayBuffer(e,n,r),this.toArrayBuffer(t,n,r)]);return this.compareBuffers(i,a,r)})}static isEqual(e,t){return T(this,arguments,function(e,t){var n=this;let{methods:r=["size","type","magic","byte"],byte:i="buffer",partial:a=!1,chunks:o=null,worker:s=!0}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){let l=null;for(let u of r){if(!1===l||a&&!0===l)break;switch(u){case"byte":case"bytes":case"content":o=o instanceof Array?o:[e.size],l=!0;for(let r of o){let a=!1;a="buffer"===i?yield n.bytesEqualWithArrayBuffer(e,t,r,s):yield n.bytesEqualWithBinaryString(e,t,r,s),a||(l=!1)}break;case"magic":case"headers":case"numbers":case"mime":l=yield n.magicNumbersEqual(e,t,s);break;case"size":case"sizes":l=n.sizeEqual(e,t);break;case"type":case"types":l=n.typeEqual(e,t);break;default:throw new Error("Blob-compare : Unknown comparison method")}}return l}()})}}}])},"object"==typeof n&&"object"==typeof o?o.exports=s():(i=[],void 0===(a="function"===typeof(r=s)?r.apply(t,i):r)||(e.exports=a))}),N$={};E(N$,{ToolbarDropdownSelect:()=>cQ,default:()=>hQ}),e.exports=(r$=N$,C(l({},"__esModule",{value:!0}),r$)),M(),L();var U$=n(194);ne();var V$=0,q$=class{constructor(e){this._studio=e,D(this,"_id"),D(this,"_state",{type:"Ready"}),this._id=String(V$++)}get status(){return this._state.type}reset(){let{_state:e}=this;if("Ready"!==e.type){if("Captured"!==e.type)throw"Committed"===e.type?new Error("This scrub is already committed and can't be reset."):new Error("This scrub is already discarded and can't be reset.");this._state={type:"Ready"},e.transaction.discard(),e.flagsTransaction.discard()}}commit(){let{_state:e}=this;if("Captured"!==e.type){if("Ready"===e.type)return void console.warn("Scrub is empty. Nothing to commit.");throw"Committed"===e.type?new Error("This scrub is already committed."):new Error("This scrub is already discarded and can't be comitted.")}e.transaction.commit(),e.flagsTransaction.discard(),this._state={type:"Committed"}}capture(e){if("Captured"===this._state.type&&this.reset(),"Ready"!==this._state.type)throw"Committed"===this._state.type?new Error("This scrub is already committed and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.commit()"):new Error("This scrub is already discarded and cannot capture again. If you wish to capture more, you can start a new studio.scrub() or do so before scrub.discard()");{let t=!0;try{this._state=b({type:"Captured"},this._capture(e)),t=!1}finally{t&&(console.error("This scrub's callback threw an error. We're undo-ing all of the changes made by this scrub, and marking it as discarded."),this._state={type:"Discarded"})}}}_capture(e){let t=[];return{transaction:this._studio.tempTransaction(n=>{let r=!0,i={set:(e,i)=>{if(!r)throw new Error("You seem to have called the scrub api after scrub.capture()");let{root:a,path:o}=(0,U$.getPointerParts)(e);if(!H(a))throw new Error("We can only scrub props of Sheet Objects for now");n.set(e,i),t.push(e)}};try{e(i)}finally{r=!1}}),flagsTransaction:this._studio.tempTransaction(e=>{let{stateEditors:n}=e;t.forEach(e=>{let{root:t,path:r}=(0,U$.getPointerParts)(e);H(t)&&j(t.template.getDefaultsAtPointer(e),(e,r)=>{n.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey.propsBeingScrubbed.flag(x(b({},t.address),{pathToProp:r}))},r)})})}}discard(){let{_state:e}=this;if("Captured"!==e.type&&"Ready"!==e.type)throw"Committed"===e.type?new Error("This scrub is already committed and can't be discarded."):new Error("This scrub is already discarded");"Captured"===e.type&&(e.transaction.discard(),e.flagsTransaction.discard()),this._state={type:"Discarded"}}},H$=n(194),W$="undefined"!=typeof window?Promise.resolve().then(()=>(i$(),QX)).then(e=>e.default):null,Z$=class{constructor(e){this.studio=e,D(this,"_rendered",!1),D(this,"_nonSSRBits",W$?W$.then(e=>new e):Promise.reject()),D(this,"ready",this._nonSSRBits.then(()=>{},()=>{}))}render(){this._rendered||(this._rendered=!0,this._nonSSRBits.then(e=>{e.render()}).catch(e=>{throw console.error(e),e}))}hide(){this.studio.transaction(e=>{let{drafts:t}=e;t.ahistoric.visibilityState="everythingIsHidden"})}restore(){this.render(),this.studio.transaction(e=>{let{drafts:t}=e;t.ahistoric.visibilityState="everythingIsVisible"})}get isHidden(){return"everythingIsHidden"===(0,H$.val)(this.studio.atomP.ahistoric.visibilityState)}renderToolset(e,t){let n=!1,r=null;return this._nonSSRBits.then(i=>{n||(r=i.renderToolset(e,t))}).catch(e=>{console.error(e)}),()=>{r?r():n||(n=!0)}}},K$=n(194);function G$(e){return e}var X$=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G$,n=n=>({type:e,payload:t(n)});return n.type=e,n.is=t=>t&&t.type&&t.type===e,n},$$=P(v$()),Y$=P(R$());ad();var J$,Q$=new Uint8Array(16);function eY(){if(!J$&&!(J$="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return J$(Q$)}var tY=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var nY,rY=function(e){return"string"==typeof e&&tY.test(e)},iY=[];for(nY=0;nY<256;++nY)iY.push((nY+256).toString(16).substr(1));var aY=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(iY[e[t+0]]+iY[e[t+1]]+iY[e[t+2]]+iY[e[t+3]]+"-"+iY[e[t+4]]+iY[e[t+5]]+"-"+iY[e[t+6]]+iY[e[t+7]]+"-"+iY[e[t+8]]+iY[e[t+9]]+"-"+iY[e[t+10]]+iY[e[t+11]]+iY[e[t+12]]+iY[e[t+13]]+iY[e[t+14]]+iY[e[t+15]]).toLowerCase();if(!rY(n))throw TypeError("Stringified UUID is invalid");return n};var oY=function(e,t,n){var r=(e=e||{}).random||(e.rng||eY)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=r[i];return t}return aY(r)},sY={replaceHistory:X$("@history/replaceHistory"),startHistoryFromScratch:X$("@history/startHistoryFromScratch"),undo:X$("@history/undo"),redo:X$("@history/redo")},lY={type:"@history/unknownAction",payload:""},uY={maxNumberOfCommits:100};function cY(e){return{currentCommitHash:void 0,commitsByHash:{},listOfCommitHashes:[],innerState:e}}Vq();var dY={ahistoric:{visibilityState:"everythingIsVisible",theTrigger:{position:{closestCorner:"bottomLeft",distanceFromHorizontalEdge:.02,distanceFromVerticalEdge:.02}},coreByProject:{},projects:{stateByProjectId:{}}},historic:{projects:{stateByProjectId:{}},autoKey:!0,coreByProject:{},panelInstanceDesceriptors:{}},ephemeral:{initialised:!1,coreByProject:{},projects:{stateByProjectId:{}},extensions:{byId:{},paneClasses:{}},showOutline:!1}},hY=X$("@storeBundle/replacePersistentState",e=>e),fY=X$("@storeBundle/reduceParts",e=>e),pY={historic:sY,replacePersistentState:hY,reduceParts:fY},mY=X$("@storeBundle/setInnerHistoricState",e=>e),gY=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uY,n=cY(e(void 0,lY));return function(r,i){return sY.startHistoryFromScratch.is(i)?cY(e(void 0,i.payload)):sY.replaceHistory.is(i)?i.payload:sY.undo.is(i)?r?function(e){if(void 0===e.currentCommitHash)return e;let t=e.listOfCommitHashes.findIndex(t=>t===e.currentCommitHash);if(-1===t)throw new Error("This should never happen");let n=e.commitsByHash[e.currentCommitHash],r=(0,Y$.default)(e.innerState,n.backwardDiff),i=t-1,a=-1===i?void 0:e.listOfCommitHashes[i];return x(b({},e),{currentCommitHash:a,innerState:r})}(r):n:sY.redo.is(i)?r?function(e){if(0===e.listOfCommitHashes.length)return e;let t=e.listOfCommitHashes.findIndex(t=>t===e.currentCommitHash);if(t===e.listOfCommitHashes.length-1)return e;let n=t+1,r=e.listOfCommitHashes[n],i=e.commitsByHash[r],a=(0,Y$.default)(e.innerState,i.forwardDiff);return x(b({},e),{currentCommitHash:r,innerState:a})}(r):n:r?function(e,t,n){if(t===e.innerState)return e;let r=function(e,t){let n=$$.default.diff(e,t,{invertible:!1}),r=$$.default.diff(t,e,{invertible:!1}),i=Date.now(),a=oY();return{forwardDiff:n,backwardDiff:r,timestamp:i,hash:a}}(e.innerState,t);if(0===r.forwardDiff.length)return e;let i=id(e.listOfCommitHashes),a={currentCommitHash:r.hash,commitsByHash:b({},e.commitsByHash),listOfCommitHashes:[...e.listOfCommitHashes],innerState:t};if(e.currentCommitHash!==i){let t=e.listOfCommitHashes.findIndex(t=>t===e.currentCommitHash);e.listOfCommitHashes.slice(t+1).forEach(e=>{delete a.commitsByHash[e]}),a.listOfCommitHashes.splice(t+1,a.listOfCommitHashes.length)}if(a.listOfCommitHashes.push(r.hash),a.commitsByHash[r.hash]=r,a.listOfCommitHashes.length>n.maxNumberOfCommits){let e=a.listOfCommitHashes.length-n.maxNumberOfCommits;a.listOfCommitHashes.slice(0,e).forEach(e=>{delete a.commitsByHash[e]}),a.listOfCommitHashes.splice(0,e)}return a}(r,e(r.innerState,i),t):cY(e(void 0,i))}}(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dY.historic,t=arguments.length>1?arguments[1]:void 0;return mY.is(t)?t.payload:e}),yY=(e,t)=>{if(hY.is(t)){let{historic:n,ahistoric:r}=t.payload;return{$persistent:{historic:n,ahistoric:r},ephemeral:(null==e?void 0:e.ephemeral)||dY.ephemeral}}if(e){let{historic:n,ahistoric:r}=e.$persistent,{ephemeral:i}=e;if(fY.is(t)){let a={historic:e.$persistent.historic.innerState,ahistoric:e.$persistent.ahistoric,ephemeral:e.ephemeral},o=t.payload(a);if(o===a)return e;n.innerState!==o.historic&&(n=gY(n,mY(o.historic))),r=o.ahistoric,i=o.ephemeral}else{let r=gY(n,t);if(r===n)return e;n=r}return{$persistent:n===e.$persistent.historic&&r===e.$persistent.ahistoric?e.$persistent:{historic:n,ahistoric:r},ephemeral:i}}return{$persistent:{historic:gY(void 0,{}),ahistoric:dY.ahistoric},ephemeral:dY.ephemeral}},vY=X$("@history/pushTempAction",e=>e),_Y=X$("@history/discardTempAction",e=>e),bY=X$("@history/commitTempAction",e=>e),xY=0,wY=(e,t)=>{if(e){let n,{tempActions:r,permanent:i}=e.$temps;if(vY.is(t))r=[...r,t];else if(bY.is(t)){let e=r.find(e=>e.payload.id===t.payload);e?(n=e.payload.originalAction,r=r.filter(e=>e.payload.id!==t.payload)):Bq.error("Comitting temp action group ".concat(t.payload," isn't possible as this group doesn't exist"))}else _Y.is(t)?r=r.filter(e=>e.payload.id!==t.payload):n=t;n&&(i=yY(e.$temps.permanent,n));let a={historic:i.$persistent.historic.innerState,ahistoric:i.$persistent.ahistoric,ephemeral:i.ephemeral};for(let e of r)a=e.payload.originalAction.payload(a);return b({$temps:{tempActions:r,permanent:i},$persistent:i.$persistent},a)}{let e=yY(void 0,t);return{$temps:{permanent:e,tempActions:[]},$persistent:e.$persistent,historic:e.$persistent.historic.innerState,ahistoric:e.$persistent.ahistoric,ephemeral:e.ephemeral}}};function kY(e,t){if("object"!=typeof e||null===e)return;if(0===t.length){for(let t of Object.keys(e))delete e[t];return}let n=t.slice(0,t.length-1),r=e,i=new WeakMap;for(let o of n){let e=r,t=e[o];if("object"!=typeof t||null===t)return;i.set(t,e),r=t}let a=t.slice().reverse();for(let o of a){if(delete r[o],Object.keys(r).length>0)return;r=i.get(r)}}function SY(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function EY(e){return!!e&&!!e[cJ]}function CY(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===dJ}(e)||Array.isArray(e)||!!e[uJ]||!!e.constructor[uJ]||AY(e)||zY(e))}function PY(e,t,n){void 0===n&&(n=!1),0===DY(e)?(n?Object.keys:hJ)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function DY(e){var t=e[cJ];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:AY(e)?2:zY(e)?3:0}function IY(e,t){return 2===DY(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function TY(e,t,n){var r=DY(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function AY(e){return aJ&&e instanceof Map}function zY(e){return oJ&&e instanceof Set}function OY(e){return e.o||e.t}function FY(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=fJ(e);delete t[cJ];for(var n=hJ(t),r=0;r<n.length;r++){var i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function MY(e,t){return void 0===t&&(t=!1),BY(e)||EY(e)||!CY(e)||(DY(e)>1&&(e.set=e.add=e.clear=e.delete=jY),Object.freeze(e),t&&PY(e,function(e,t){return MY(t,!0)},!0)),e}function jY(){SY(2)}function BY(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function RY(e){var t=pJ[e];return t||SY(18,e),t}function LY(){return rJ}function NY(e,t){t&&(RY("Patches"),e.u=[],e.s=[],e.v=t)}function UY(e){VY(e),e.p.forEach(HY),e.p=null}function VY(e){e===rJ&&(rJ=e.l)}function qY(e){return rJ={p:[],l:rJ,h:e,m:!0,_:0}}function HY(e){var t=e[cJ];0===t.i||1===t.i?t.j():t.O=!0}function WY(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||RY("ES5").S(t,e,r),r?(n[cJ].P&&(UY(t),SY(4)),CY(e)&&(e=ZY(t,e),t.l||GY(t,e)),t.u&&RY("Patches").M(n[cJ],e,t.u,t.s)):e=ZY(t,n,[]),UY(t),t.u&&t.v(t.u,t.s),e!==lJ?e:void 0}function ZY(e,t,n){if(BY(t))return t;var r=t[cJ];if(!r)return PY(t,function(i,a){return KY(e,r,t,i,a,n)},!0),t;if(r.A!==e)return t;if(!r.P)return GY(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=FY(r.k):r.o;PY(3===r.i?new Set(i):i,function(t,a){return KY(e,r,i,t,a,n)}),GY(e,i,!1),n&&e.u&&RY("Patches").R(r,n,e.u,e.s)}return r.o}function KY(e,t,n,r,i,a){if(EY(i)){var o=ZY(e,i,a&&t&&3!==t.i&&!IY(t.D,r)?a.concat(r):void 0);if(TY(n,r,o),!EY(o))return;e.m=!1}if(CY(i)&&!BY(i)){if(!e.h.F&&e._<1)return;ZY(e,i),t&&t.A.l||GY(e,i)}}function GY(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&MY(t,n)}function XY(e,t){var n=e[cJ];return(n?OY(n):e)[t]}function $Y(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function YY(e){e.P||(e.P=!0,e.l&&YY(e.l))}function JY(e){e.o||(e.o=FY(e.t))}function QY(e,t,n){var r=AY(t)?RY("MapSet").N(t,n):zY(t)?RY("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:LY(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,a=mJ;n&&(i=[r],a=gJ);var o=Proxy.revocable(i,a),s=o.revoke,l=o.proxy;return r.k=l,r.j=s,l}(t,n):RY("ES5").J(t,n);return(n?n.A:LY()).p.push(r),r}function eJ(e){return EY(e)||SY(22,e),function e(t){if(!CY(t))return t;var n,r=t[cJ],i=DY(t);if(r){if(!r.P&&(r.i<4||!RY("ES5").K(r)))return r.t;r.I=!0,n=tJ(t,i),r.I=!1}else n=tJ(t,i);return PY(n,function(t,i){r&&function(e,t){return 2===DY(e)?e.get(t):e[t]}(r.t,t)===i||TY(n,t,e(i))}),3===i?new Set(n):n}(e)}function tJ(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return FY(e)}bM(),bM(),xD();var nJ,rJ,iJ="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),aJ="undefined"!=typeof Map,oJ="undefined"!=typeof Set,sJ="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,lJ=iJ?Symbol.for("immer-nothing"):((nJ={})["immer-nothing"]=!0,nJ),uJ=iJ?Symbol.for("immer-draftable"):"__$immer_draftable",cJ=iJ?Symbol.for("immer-state"):"__$immer_state",dJ=""+Object.prototype.constructor,hJ="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,fJ=Object.getOwnPropertyDescriptors||function(e){var t={};return hJ(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},pJ={},mJ={get:function(e,t){if(t===cJ)return e;var n=OY(e);if(!IY(n,t))return function(e,t,n){var r,i=$Y(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!CY(r)?r:r===XY(e.t,t)?(JY(e),e.o[t]=QY(e.A.h,r,e)):r},has:function(e,t){return t in OY(e)},ownKeys:function(e){return Reflect.ownKeys(OY(e))},set:function(e,t,n){var r=$Y(OY(e),t);if(null!=r&&r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=XY(OY(e),t),a=null==i?void 0:i[cJ];if(a&&a.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||IY(e.t,t)))return!0;JY(e),YY(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==XY(e.t,t)||t in e.t?(e.D[t]=!1,JY(e),YY(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=OY(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}},defineProperty:function(){SY(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){SY(12)}},gJ={};PY(mJ,function(e,t){gJ[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),gJ.deleteProperty=function(e,t){return mJ.deleteProperty.call(this,e[0],t)},gJ.set=function(e,t,n){return mJ.set.call(this,e[0],t,n,e[0])};var yJ=function(){function e(e){var t=this;this.g=sJ,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return a.produce(e,function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))})}}var o;if("function"!=typeof n&&SY(6),void 0!==r&&"function"!=typeof r&&SY(7),CY(e)){var s=qY(t),l=QY(t,e,void 0),u=!0;try{o=n(l),u=!1}finally{u?UY(s):VY(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then(function(e){return NY(s,r),WY(e,s)},function(e){throw UY(s),e}):(NY(s,r),WY(o,s))}if(!e||"object"!=typeof e)return(o=n(e))===lJ?void 0:(void 0===o&&(o=e),t.F&&MY(o,!0),o);SY(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(i))})}:[t.produce(e,n,function(e,t){r=e,i=t}),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){CY(e)||SY(8),EY(e)&&(e=eJ(e));var t=qY(this),n=QY(this,e,void 0);return n[cJ].C=!0,VY(t),n},t.finishDraft=function(e,t){var n=(e&&e[cJ]).A;return NY(n,t),WY(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!sJ&&SY(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=RY("Patches").$;return EY(e)?i(e,t):this.produce(e,function(e){return i(e,t.slice(n+1))})},e}(),vJ=new yJ,_J=(vJ.produce,vJ.produceWithPatches.bind(vJ),vJ.setAutoFreeze.bind(vJ),vJ.setUseProxies.bind(vJ),vJ.applyPatches.bind(vJ),vJ.createDraft.bind(vJ)),bJ=vJ.finishDraft.bind(vJ);pd(),Ad(),dh(),bh(),xh(),HV(),Th(),ne();var xJ,wJ,kJ={create(e){let t={byId:{},allIds:{}};if(e)for(let[n,r]of e)t.byId[n]=r,t.allIds[n]=!0;return t},shallowCopy:e=>({byId:b({},null==e?void 0:e.byId),allIds:b({},null==e?void 0:e.allIds)}),add:(e,t,n)=>({byId:x(b({},null==e?void 0:e.byId),{[t]:n}),allIds:x(b({},null==e?void 0:e.allIds),{[t]:!0})}),merge(e){let t=kJ.create();for(let n=0;n<e.length;n++)t.byId=b(b({},t.byId),e[n].byId),t.allIds=b(b({},t.allIds),e[n].allIds);return t},remove(e,t){let n=kJ.shallowCopy(e);return delete n.allIds[t],delete n.byId[t],n},filter(e,t){let n=kJ.shallowCopy(e);for(let[r,i]of Object.entries(n.byId))t(i)||(delete n.allIds[r],delete n.byId[r]);return n}},SJ=e=>(xJ=e,wJ),EJ=()=>{if(void 0===xJ)throw new Error("Calling stateEditors outside of a transaction is not allowed.");return xJ};function CJ(){let e,t,n=new Promise((n,i)=>{e=e=>{n(e),r.status="resolved"},t=e=>{i(e),r.status="rejected"}}),r={resolve:e,reject:t,promise:n,status:"pending"};return r}(e=>{let t,n;(t=>{let n,r,i;(t=>{let n;let r,i;(n=t.panelPositions||(t.panelPositions={})).setPanelPosition=function(e){let t=EJ().historic;null!=t.panelPositions||(t.panelPositions={}),t.panelPositions[e.panelId]=e.position},(t=>{let n,r;t._ensure=function(){var e;return null!=(e=EJ().historic).panels||(e.panels={}),EJ().historic.panels},(t=>{let n;var r;t._ensure=function(){let t=e.studio.historic.panels._ensure();return null!=t.outlinePanel||(t.outlinePanel={}),t.outlinePanel},(r=n=t.selection||(t.selection={})).set=function(n){let r=[];for(let t of Dh(n))U(t)?r.push(b({type:"Project"},t.address)):V(t)?(r.push(b({type:"Sheet"},t.template.address)),e.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(t.address)):q(t)?r.push(b({type:"Sheet"},t.address)):H(t)?(r.push(b({type:"SheetObject"},t.template.address)),e.studio.historic.projects.stateByProjectId.stateBySheetId.setSelectedInstanceId(t.sheet.address)):Z(t)&&r.push(b({type:"SheetObject"},t.address));t._ensure().selection=r},r.unset=function(){t._ensure().selection=[]}})(n=t.outline||(t.outline={})),(t=>{let n;t._ensure=function(){let t=e.studio.historic.panels._ensure();return null!=t.sequenceEditor||(t.sequenceEditor={}),t.sequenceEditor},(n=t.graphEditor||(t.graphEditor={})).setIsOpen=function(e){(function(){let e=t._ensure();return null!=e.graphEditor||(e.graphEditor={height:.5,isOpen:!1}),e.graphEditor}()).isOpen=e.isOpen}})(r=t.sequenceEditor||(t.sequenceEditor={}))})(r=t.panels||(t.panels={})),(t=>{let n;(t=>{let n;t._ensure=function(e){let t=EJ().historic;return t.projects.stateByProjectId[e.projectId]||(t.projects.stateByProjectId[e.projectId]={stateBySheetId:{}}),t.projects.stateByProjectId[e.projectId]},(t=>{let n;t._ensure=function(t){let n=e.studio.historic.projects.stateByProjectId._ensure(t);return n.stateBySheetId[t.sheetId]||(n.stateBySheetId[t.sheetId]={selectedInstanceId:void 0,sequenceEditor:{selectedPropsByObject:{}}}),n.stateBySheetId[t.sheetId]},t.setSelectedInstanceId=function(t){e.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(t).selectedInstanceId=t.sheetInstanceId},(n=>{function r(t){let n=e.studio.historic.projects.stateByProjectId.stateBySheetId._ensure(t).sequenceEditor;return n.markerSet||(n.markerSet=kJ.create()),n.markerSet}n.addPropToGraphEditor=function(e){let{selectedPropsByObject:n}=t._ensure(e).sequenceEditor;n[e.objectKey]||(n[e.objectKey]={});let r=n[e.objectKey],i=vM(e.pathToProp),a=new Set(Object.keys(SV));for(let[t,s]of Object.entries(eJ(n)))for(let[e,n]of Object.entries(s))a.delete(n);let o=a.size>0?a.values().next().value:Object.keys(SV)[0];r[i]=o},n.removePropFromGraphEditor=function(e){let{selectedPropsByObject:n}=t._ensure(e).sequenceEditor;if(!n[e.objectKey])return;let r=n[e.objectKey],i=vM(e.pathToProp);r[i]&&kY(n,[e.objectKey,i])},n.replaceMarkers=function(e){let t=r(e.sheetAddress),n=e.markers.filter(e=>!!isFinite(e.position)).map(t=>x(b({},t),{position:e.snappingFunction(t.position)})),i=Id(n,"id"),a=kJ.filter(t,e=>e&&!i[e.id]),o=Id(Object.values(a.byId),"position");n.forEach(e=>{let{position:t}=e,n=o[t];n&&(a=kJ.remove(a,n.id))}),Object.assign(t,kJ.merge([a,kJ.create(n.map(e=>[e.id,e]))]))},n.removeMarker=function(e){let t=r(e.sheetAddress);Object.assign(t,kJ.remove(t,e.markerId))},n.updateMarker=function(e){let t=r(e.sheetAddress).byId[e.markerId];void 0!==t&&(t.label=e.label)}})(n=t.sequenceEditor||(t.sequenceEditor={}))})(n=t.stateBySheetId||(t.stateBySheetId={}))})(n=t.stateByProjectId||(t.stateByProjectId={}))})(i=t.projects||(t.projects={}))})(n=t.historic||(t.historic={})),(t=>{let n;t.setShowOutline=function(e){EJ().ephemeral.showOutline=e},(t=>{let n;(t=>{let n;t._ensure=function(e){let t=EJ().ephemeral;return t.projects.stateByProjectId[e.projectId]||(t.projects.stateByProjectId[e.projectId]={stateBySheetId:{}}),t.projects.stateByProjectId[e.projectId]},(t=>{let n;t._ensure=function(t){let n=e.studio.ephemeral.projects.stateByProjectId._ensure(t);return n.stateBySheetId[t.sheetId]||(n.stateBySheetId[t.sheetId]={stateByObjectKey:{}}),n.stateBySheetId[t.sheetId]},(t=>{let n;t._ensure=function(t){var n;let r=e.studio.ephemeral.projects.stateByProjectId.stateBySheetId._ensure(t).stateByObjectKey;return null!=r[n=t.objectKey]||(r[n]={}),r[t.objectKey]},(t=>{function n(t){let n=e.studio.ephemeral.projects.stateByProjectId.stateBySheetId.stateByObjectKey._ensure(t);return null!=n.valuesBeingScrubbed||(n.valuesBeingScrubbed={}),n.valuesBeingScrubbed}t._ensure=n,t.flag=function(e){ph(n(e),e.pathToProp,!0)}})(n=t.propsBeingScrubbed||(t.propsBeingScrubbed={}))})(n=t.stateByObjectKey||(t.stateByObjectKey={}))})(n=t.stateBySheetId||(t.stateBySheetId={}))})(n=t.stateByProjectId||(t.stateByProjectId={}))})(n=t.projects||(t.projects={}))})(r=t.ephemeral||(t.ephemeral={})),(t=>{let n;t.setPinOutline=function(e){EJ().ahistoric.pinOutline=e},t.setPinDetails=function(e){EJ().ahistoric.pinDetails=e},t.setPinNotifications=function(e){EJ().ahistoric.pinNotifications=e},t.setVisibilityState=function(e){EJ().ahistoric.visibilityState=e},t.setClipboardKeyframes=function(e){let t=yM(e.map(e=>e.pathToProp)),n=e.map(e=>{let{keyframe:n,pathToProp:r}=e;return{keyframe:n,pathToProp:r.slice(t.length)}}),r=EJ();r.ahistoric.clipboard?r.ahistoric.clipboard.keyframesWithRelativePaths=n:r.ahistoric.clipboard={keyframesWithRelativePaths:n}},(t=>{let n;(t=>{let n;var r;let i;t._ensure=function(e){let t=EJ().ahistoric;return t.projects.stateByProjectId[e.projectId]||(t.projects.stateByProjectId[e.projectId]={stateBySheetId:{}}),t.projects.stateByProjectId[e.projectId]},(r=n=t.collapsedItemsInOutline||(t.collapsedItemsInOutline={}))._ensure=function(t){let n=e.studio.ahistoric.projects.stateByProjectId._ensure(t);return n.collapsedItemsInOutline||(n.collapsedItemsInOutline={}),n.collapsedItemsInOutline},r.set=function(t){let n=e.studio.ahistoric.projects.stateByProjectId.collapsedItemsInOutline._ensure(t);t.isCollapsed?n[t.itemKey]=!0:delete n[t.itemKey]},(t=>{let n;t._ensure=function(t){let n=e.studio.ahistoric.projects.stateByProjectId._ensure(t);return n.stateBySheetId[t.sheetId]||(n.stateBySheetId[t.sheetId]={}),n.stateBySheetId[t.sheetId]},(t=>{let n;var r;let i;let a;t._ensure=function(t){let n=e.studio.ahistoric.projects.stateByProjectId.stateBySheetId._ensure(t);return n.sequence||(n.sequence={}),n.sequence},(r=n=t.focusRange||(t.focusRange={})).set=function(t){e.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(t).focusRange={range:t.range,enabled:t.enabled}},r.unset=function(t){e.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(t).focusRange=void 0},(i=t.clippedSpaceRange||(t.clippedSpaceRange={})).set=function(t){e.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(t).clippedSpaceRange=b({},t.range)},(t=>{t.set=function(t){let n=function(t){let n=e.studio.ahistoric.projects.stateByProjectId.stateBySheetId.sequence._ensure(t),r=n.collapsableItems;return r||(r=n.collapsableItems=kJ.create()),r}(t);Object.assign(n,kJ.add(n,t.studioSheetItemKey,{isCollapsed:t.isCollapsed}))}})(a=t.sequenceEditorCollapsableItems||(t.sequenceEditorCollapsableItems={}))})(n=t.sequence||(t.sequence={}))})(i=t.stateBySheetId||(t.stateBySheetId={}))})(n=t.stateByProjectId||(t.stateByProjectId={}))})(n=t.projects||(t.projects={}))})(i=t.ahistoric||(t.ahistoric={}))})(t=e.studio||(e.studio={})),(t=>{let n;(t=>{let n;let r;(n=t.revisionHistory||(t.revisionHistory={})).add=function(e){let t=EJ().historic.coreByProject[e.projectId].revisionHistory;t.unshift(e.revision),t.length>50&&(t.length=50)},(t=>{let n,r;t._ensure=function(e){let t=EJ().historic.coreByProject[e.projectId].sheetsById;return t[e.sheetId]||(t[e.sheetId]={staticOverrides:{byObject:{}}}),t[e.sheetId]},t.forgetObject=function(e){let t=EJ().historic.coreByProject[e.projectId].sheetsById[e.sheetId];if(!t)return;delete t.staticOverrides.byObject[e.objectKey];let n=t.sequence;n&&delete n.tracksByObject[e.objectKey]},t.forgetSheet=function(e){EJ().historic.coreByProject[e.projectId].sheetsById[e.sheetId]&&delete EJ().historic.coreByProject[e.projectId].sheetsById[e.sheetId]},(t=>{function n(t){let n=e.coreByProject.historic.sheetsById._ensure(t);return null!=n.sequence||(n.sequence={subUnitsPerUnit:30,length:10,type:"PositionalSequence",tracksByObject:{}}),n.sequence}function r(t){var n;let r=e.coreByProject.historic.sheetsById.sequence._ensure(t).tracksByObject;return null!=r[n=t.objectKey]||(r[n]={trackData:{},trackIdByPropPath:{}}),r[t.objectKey]}function i(e){return r(e).trackData[e.trackId]}function a(e){let t=i(e);if(t)return t.keyframes.find(t=>t.id===e.keyframeId)}function o(e){let t=i(e);if(!t)return;let n=eJ(t.keyframes),r=e.keyframes.filter(e=>!("number"==typeof e.value&&!isFinite(e.value)||!e.handles.every(e=>isFinite(e)))).map(t=>x(b({},t),{position:e.snappingFunction(t.position)})),a=Id(r,"id"),o=n.filter(e=>!a[e.id]),s=Id(o,"position");r.forEach(e=>{let{position:t}=e,n=s[t];n&&sh(o,n)});let l=gh([...o,...r],"position");t.keyframes=l}t._ensure=n,t.setLength=function(e){n(e).length=ms(parseFloat(e.length.toFixed(2)),.01,1/0)},t.setSubUnitsPerUnit=function(e){n(e).subUnitsPerUnit=ms(e.subUnitsPerUnit,1,v(2,12))},t.setPrimitivePropAsSequenced=function(e,t){let n=r(e),i=vM(e.pathToProp);if("string"==typeof n.trackIdByPropPath[i])return;let a=gD(10),o={type:"BasicKeyframedTrack",__debugName:"".concat(e.objectKey,":").concat(i),keyframes:[]};n.trackData[a]=o,n.trackIdByPropPath[i]=a},t.setPrimitivePropAsStatic=function(t){let n=r(t),i=vM(t.pathToProp),a=n.trackIdByPropPath[i];"string"==typeof a&&(delete n.trackIdByPropPath[i],delete n.trackData[a],e.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(t))},t.setCompoundPropAsStatic=function(t){let n=r(t);for(let e of Object.keys(n.trackIdByPropPath)){let r=JSON.parse(e);if(t.pathToProp.every((e,t)=>r[t]===e)){let t=n.trackIdByPropPath[e];if("string"!=typeof t)continue;delete n.trackIdByPropPath[e],delete n.trackData[t]}}e.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfCompoundProp(t)},t.setKeyframeAtPosition=function(e){let t=e.snappingFunction(e.position),n=i(e);if(!n)return;let{keyframes:r}=n,a=r.findIndex(e=>e.position===t);if(-1!==a){return void(r[a].value=e.value)}let o=fd(r,e=>e.position<t);if(-1===o)return void r.unshift({id:_D(),position:t,connectedRight:!0,handles:e.handles||[.5,1,.5,0],type:e.type||"bezier",value:e.value});let s=r[o];r.splice(o+1,0,{id:_D(),position:t,connectedRight:s.connectedRight,handles:e.handles||[.5,1,.5,0],type:e.type||"bezier",value:e.value})},t.unsetKeyframeAtPosition=function(e){let t=i(e);if(!t)return;let{keyframes:n}=t,r=n.findIndex(t=>t.position===e.position);-1!==r&&n.splice(r,1)},t.transformKeyframes=function(e){let t=i(e);if(!t)return;let n=eJ(t.keyframes).filter(t=>e.keyframeIds.includes(t.id)).map(t=>{let n=t.position,r=e.snappingFunction(function(e,t){let{scale:n,origin:r,translate:i}=t;return i+(r+(e-r)*n)}(n,e));return x(b({},t),{position:r})});o(x(b({},e),{keyframes:n}))},t.setTweenBetweenKeyframes=function(e){let t=i(e);t&&(t.keyframes=t.keyframes.map((n,r)=>{let i=t.keyframes[r-1],a=e.keyframeIds.includes(n.id),o=e.keyframeIds.includes(null==i?void 0:i.id);return a&&!o?x(b({},n),{handles:[n.handles[0],n.handles[1],e.handles[0],e.handles[1]]}):a&&o?x(b({},n),{handles:[e.handles[2],e.handles[3],e.handles[0],e.handles[1]]}):o?x(b({},n),{handles:[e.handles[2],e.handles[3],n.handles[2],n.handles[3]]}):n}))},t.setHandlesForKeyframe=function(e){var t,n,r,i,o,s,l,u;let c=a(e);c&&(c.handles=[null!=(n=null==(t=e.end)?void 0:t[0])?n:c.handles[0],null!=(i=null==(r=e.end)?void 0:r[1])?i:c.handles[1],null!=(s=null==(o=e.start)?void 0:o[0])?s:c.handles[2],null!=(u=null==(l=e.start)?void 0:l[1])?u:c.handles[3]])},t.deleteKeyframes=function(e){let t=i(e);t&&(t.keyframes=t.keyframes.filter(t=>-1===e.keyframeIds.indexOf(t.id)))},t.setKeyframeType=function(e){let t=a(e);t&&(t.type=e.keyframeType)},t.replaceKeyframes=o})(n=t.sequence||(t.sequence={})),(t=>{let n;(t=>{function n(t){var n;let r=e.coreByProject.historic.sheetsById._ensure(t).staticOverrides.byObject;return null!=r[n=t.objectKey]||(r[n]={}),r[t.objectKey]}t.setValueOfCompoundProp=function(e){let t=n(e);ph(t,e.pathToProp,e.value)},t.setValueOfPrimitiveProp=function(e){let t=n(e);ph(t,e.pathToProp,e.value)},t.unsetValueOfPrimitiveProp=function(t){let n=e.coreByProject.historic.sheetsById._ensure(t).staticOverrides.byObject[t.objectKey];n&&kY(n,t.pathToProp)}})(n=t.byObject||(t.byObject={}))})(r=t.staticOverrides||(t.staticOverrides={}))})(r=t.sheetsById||(t.sheetsById={}))})(n=t.historic||(t.historic={}))})(n=e.coreByProject||(e.coreByProject={}))})(wJ||(wJ={}));var PJ=n(194);as();var DJ=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:e),IJ=DJ,TJ="@@redux/INIT";function AJ(e,t,n){var r;if("function"==typeof t&&"undefined"==typeof n&&(n=t,t=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(AJ)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,a=t,o=[],s=o,l=!1;function u(){s===o&&(s=o.slice())}function c(){return a}function d(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return u(),s.push(e),function(){if(t){t=!1,u();var n=s.indexOf(e);s.splice(n,1)}}}function h(e){if(!is(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,a=i(a,e)}finally{l=!1}for(var t=o=s,n=0;n<t.length;n++){(0,t[n])()}return e}return h({type:TJ}),(r={dispatch:h,subscribe:d,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,h({type:TJ})}})[IJ]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(c())}return n(),{unsubscribe:t(n)}}})[IJ]=function(){return this},e},r}function zJ(e){let t=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}();return AJ(e.rootReducer,void 0,t)}Vq(),Qc();var OJ=new WeakMap,FJ=(e,t,n)=>{let r=MJ(n);!function(){let n=localStorage.getItem(r);if(n){let r,a=!0;try{r=JSON.parse(n),a=!1}catch(i){Bq.warn("Could not parse Theatre's persisted state. This must be a bug. Please report it.")}finally{a||(t=>{e.dispatch(pY.replacePersistentState(t))})(r),t()}}else t()}();let i=()=>{let t=e.getState().$persistent;t!==OJ.get(e)&&(OJ.set(e,t),localStorage.setItem(r,JSON.stringify(t)))};e.subscribe(Jc(i,1e3)),window&&window.addEventListener("beforeunload",i)};function MJ(e){return e+".persistent"}CT(),ne(),Bo(),Td(),L(),wP();var jJ=n(194);function BJ(e){if("boolean"==typeof e||"string"==typeof e||"number"==typeof e)return e;if(is(e)){let t={},n=!1;for(let[r,i]of Object.entries(e))void 0!==BJ(i)&&(t[r]=i,n=!0);if(n)return t}}function RJ(e,t,n){for(let[r,i]of Object.entries(e.props))if("compound"===i.type)RJ(i,[...t,r],n);else{if("enum"===i.type)throw new Error("Not yet implemented");n(i,[...t,r])}}function LJ(e,t,n){return{set:(n,r)=>{e();let i=BJ(r);if("undefined"==typeof i)return;let{root:a,path:o}=(0,jJ.getPointerParts)(n);if(H(a)){let e=a.template.getMapOfValidSequenceTracks_forStudio().getValue(),r=FC(a.template.staticConfig,o);if(!r)throw new Error("Object ".concat(a.address.objectKey," does not have a prop at ").concat(JSON.stringify(o)));let s=(n,r,i)=>{if(null==n)return;if(void 0===BJ(r.deserializeAndSanitize(n)))throw new Error("Invalid value ".concat(UK(n)," for object.props").concat(i.map(e=>"[".concat(JSON.stringify(e),"]")).join("")," is invalid"));let o=x(b({},a.address),{pathToProp:i}),s=jo(e,i);if("string"==typeof s){let e=a.sheet.getSequence();e.position=e.closestGridPosition(e.position),t.coreByProject.historic.sheetsById.sequence.setKeyframeAtPosition(x(b({},o),{trackId:s,position:e.position,value:n,snappingFunction:e.closestGridPosition,type:"bezier"}))}else t.coreByProject.historic.sheetsById.staticOverrides.byObject.setValueOfPrimitiveProp(x(b({},o),{value:n}))};if("compound"===r.type){let e=(0,jJ.getPointerParts)(n).path,t=e.length;RJ(r,e,(e,n)=>{let r=n.slice(t),a=xP(i,r);if("undefined"==typeof a)throw new Error("Property object.props".concat(n.map(e=>"[".concat(JSON.stringify(e),"]")).join("")," is required but not provided"));s(a,e,n)})}else{if("enum"===r.type)throw new Error("Enums aren't implemented yet");s(i,r,o)}}else{if(!W(a))throw new Error("Only setting props of SheetObject-s and sequences is supported in a transaction so far");{let[e]=o;if("subUnitsPerUnit"===e){if("number"!=typeof i||!Pd(i)||i<1)throw new Error("Value ".concat(i," is not an integer, which is required for setting sequence prop ").concat(e));t.coreByProject.historic.sheetsById.sequence.setSubUnitsPerUnit(x(b({},a.address),{subUnitsPerUnit:i}))}else{if("length"!==e)throw new Error("Setting sequence prop ".concat(e," is not supported"));if("number"!=typeof i||i<=.001)throw new Error("Value ".concat(i," is not a positive number, which is required for setting sequence prop ").concat(e));t.coreByProject.historic.sheetsById.sequence.setLength(x(b({},a.address),{length:i}))}}}},unset:n=>{e();let{root:r,path:i}=(0,jJ.getPointerParts)(n);if(!H(r))throw new Error("Only setting props of SheetObject-s is supported in a transaction so far");{let e=r.template.getMapOfValidSequenceTracks_forStudio().getValue(),a=xP(r.template.getDefaultValues().getValue(),i),o=FC(r.template.staticConfig,i),s=(n,i)=>{let a=x(b({},r.address),{pathToProp:i}),s=jo(e,i);"string"==typeof s?t.coreByProject.historic.sheetsById.sequence.unsetKeyframeAtPosition(x(b({},a),{trackId:s,position:r.sheet.getSequence().positionSnappedToGrid})):void 0!==o&&t.coreByProject.historic.sheetsById.staticOverrides.byObject.unsetValueOfPrimitiveProp(a)};"compound"===o.type?j(a,(e,t)=>{s(e,t)},(0,jJ.getPointerParts)(n).path):s(a,i)}},get drafts(){return e(),n},get stateEditors(){return t}}}GC(),Th(),tG();var NJ=class{constructor(){D(this,"_reduxStore"),D(this,"_atom"),D(this,"atomP"),this._reduxStore=zJ({rootReducer:wY,devtoolsOptions:{name:"Theatre.js Studio"}}),this._atom=function(e){let t=e.getState(),n=new PJ.Atom(t);return e.subscribe(()=>{let r=e.getState();n.set(r),t=r}),n}(this._reduxStore),this.atomP=this._atom.pointer}initialize(e){let t=CJ();return!0===e.usePersistentStorage?FJ(this._reduxStore,()=>{this.tempTransaction(e=>{let{drafts:t}=e;t.ephemeral.initialised=!0}).commit(),t.resolve()},e.persistenceKey):(this.tempTransaction(e=>{let{drafts:t}=e;t.ephemeral.initialised=!0}).commit(),t.resolve()),t.promise}getState(){return this._reduxStore.getState()}__experimental_clearPersistentStorage(e){return((e,t)=>{let n=MJ(t),r=e.getState().$persistent;localStorage.removeItem(n),OJ.set(e,r)})(this._reduxStore,e),this.getState()}__dev_startHistoryFromScratch(e){this._reduxStore.dispatch(pY.historic.startHistoryFromScratch(pY.reduceParts(t=>x(b({},t),{historic:e}))))}tempTransaction(e){let t,n=(()=>{let e=xY++;return{push:t=>vY({id:e,originalAction:t}),discard:()=>_Y(e),commit:()=>bY(e)}})(),r=n.push(pY.reduceParts(n=>{let r={historic:_J(n.historic),ahistoric:_J(n.ahistoric),ephemeral:_J(n.ephemeral)},i=!0,a=LJ(()=>{if(!i)throw new Error("You seem to have called the transaction api after studio.transaction() has finished running")},SJ(r),r);try{return e(a),i=!1,{historic:bJ(r.historic),ahistoric:bJ(r.ahistoric),ephemeral:bJ(r.ephemeral)}}catch(o){return t=o,n}finally{SJ(void 0)}}));if(this._reduxStore.dispatch(r),t)throw this._reduxStore.dispatch(n.discard()),t;return{commit:()=>{this._reduxStore.dispatch(n.commit())},discard:()=>{this._reduxStore.dispatch(n.discard())}}}undo(){this._reduxStore.dispatch(pY.historic.undo())}redo(){this._reduxStore.dispatch(pY.historic.redo())}createContentOfSaveFile(e){if(!this._reduxStore.getState().$persistent.historic.innerState.coreByProject[e])throw new Error("Project ".concat(e," has not been initialized."));let t=_T();this.tempTransaction(n=>{let{stateEditors:r}=n;r.coreByProject.historic.revisionHistory.add({projectId:e,revision:t})}).commit();let n=this._reduxStore.getState().$persistent.historic.innerState.coreByProject[e];return b({},n)}},UJ=n(194),VJ=class{constructor(){D(this,"_values",{})}get(e,t){if(this.has(e))return this._values[e];{let n=t();return this._values[e]=n,n}}has(e){return this._values.hasOwnProperty(e)}};ne(),D_(),M(),Th(),dZ();var qJ=class{constructor(e){D(this,"ui",{hide(){O().ui.hide()},get isHidden(){return O().ui.isHidden},restore(){O().ui.restore()},renderToolset:(e,t)=>O().ui.renderToolset(e,t)}),D(this,"_cache",new VJ),D(this,"__experimental",{__experimental_disblePlayPauseKeyboardShortcut(){lZ=!1},__experimental_enablePlayPauseKeyboardShortcut(){lZ=!0},__experimental_clearPersistentStorage:e=>O().clearPersistentStorage(e),__experimental_createContentOfSaveFileTyped:e=>O().createContentOfSaveFile(e)})}initialize(e){return O().initialize(e)}extend(e,t){O().extend(e,t)}transaction(e){return O().transaction(t=>{let{set:n,unset:r,stateEditors:i}=t;return e({set:n,unset:r,__experimental_forgetObject:e=>{if(!G(e))throw new Error("object in transactionApi.__experimental_forgetObject(object) must be the return type of sheet.object(...)");i.coreByProject.historic.sheetsById.forgetObject(e.address)},__experimental_forgetSheet:e=>{if(!K(e))throw new Error("sheet in transactionApi.__experimental_forgetSheet(sheet) must be the return type of project.sheet()");i.coreByProject.historic.sheetsById.forgetSheet(e.address)}})})}_getSelectionPrism(){return this._cache.get("_getSelectionPrism()",()=>(0,UJ.prism)(()=>S_().filter(e=>"Theatre_SheetObject"===e.type||"Theatre_Sheet"===e.type).map(e=>e.publicApi)))}_getSelection(){return this._getSelectionPrism().getValue()}setSelection(e){let t=[...e].filter(e=>G(e)||K(e)).map(e=>O().corePrivateAPI(e));O().transaction(e=>{let{stateEditors:n}=e;n.studio.historic.panels.outline.selection.set(t)})}onSelectionChange(e){let t=O();return this._getSelectionPrism().onChange(t.ticker,e,!0)}get selection(){return this._getSelection()}scrub(){return O().scrub()}getStudioProject(){let e=O().core;if(!e)throw new Error("You're calling studio.getStudioProject() before `@theatre/core` is loaded. To fix this:\n1. Check if `@theatre/core` is import/required in your bundle.\n2. Check the stack trace of this error and make sure the funciton that calls getStudioProject() is run after `@theatre/core` is loaded.");return O().getStudioProject(e)}debouncedScrub(){let e,t=Jc(()=>{let t=e;t&&(e=void 0,t.commit())},arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3);return{capture:n=>{e||(e=this.scrub());let r=!0;try{e.capture(n),r=!1}finally{if(r){let t=e;e=void 0,t.discard()}else t()}}}}createPane(e){return O().paneManager.createPane(e)}destroyPane(e){return O().paneManager.destroyPane(e)}createContentOfSaveFile(e){return O().createContentOfSaveFile(e)}};vD();var HJ=n(194),WJ=class{constructor(e){this._studio=e,D(this,"_cache",new VJ),this._instantiatePanesAsTheyComeIn()}_instantiatePanesAsTheyComeIn(){let e=this._getAllPanes();e.onStale(()=>{e.getValue()})}_getAllPanes(){return this._cache.get("_getAllPanels()",()=>(0,HJ.prism)(()=>{if(!(0,HJ.val)(this._studio.coreP))return{};let e=(0,HJ.val)(this._studio.atomP.historic.panelInstanceDesceriptors),t=(0,HJ.val)(this._studio.atomP.ephemeral.extensions.paneClasses),n={};for(let r of Object.values(e)){if(!r)continue;let e=t[r.paneClass];if(!e)continue;let{instanceId:i}=r,{extensionId:a,classDefinition:o}=e,s=HJ.prism.memo("instance-".concat(r.instanceId),()=>({extensionId:a,instanceId:i,definition:o}),[o]);n[i]=s}return n}))}get allPanesD(){return this._getAllPanes()}createPane(e){if(!this._studio.core)throw new Error("Can't create a pane because @theatre/core is not yet loaded");let t,n=(0,HJ.val)(this._studio.atomP.ephemeral.extensions.paneClasses[e].extensionId),r=(0,HJ.val)(this._studio.atomP.historic.panelInstanceDesceriptors);for(let i=1;i<1e3&&(t="".concat(e," #").concat(i),r[t]);i++);if(!n)throw new Error('Pane class "'.concat(e,'" is not registered.'));return this._studio.transaction(n=>{let{drafts:r}=n;r.historic.panelInstanceDesceriptors[t]={instanceId:t,paneClass:e}}),this._getAllPanes().getValue()[t]}destroyPane(e){if(!this._studio.core)throw new Error("Can't do this yet because @theatre/core is not yet loaded");this._studio.transaction(t=>{let{drafts:n}=t;delete n.historic.panelInstanceDesceriptors[e]})}},ZJ=n(194);M();var KJ=18e5;function GJ(){return T(this,null,function*(){if(!"0.7.2".match(/COMPAT/))for(yield XJ(500),yield function(){return T(this,null,function*(){let e=O().atomP.ahistoric.visibilityState;if("everythingIsVisible"===(0,ZJ.val)(e))return;let t=CJ(),n=(0,ZJ.pointerToPrism)(e).onStale(()=>{"everythingIsVisible"===(0,ZJ.val)(e)&&(n(),t.resolve(void 0))});return t.promise})}();;){let t=(0,ZJ.val)(O().atomP.ahistoric.updateChecker);if(t&&"error"!==t.result){let e=t.lastChecked,n=Date.now(),r=Math.abs(n-e);r<KJ&&(yield XJ(KJ-r))}try{let e=yield fetch(new Request("https://updates.theatrejs.com/updates/0.7.2"));if(!e.ok)throw new Error("HTTP Error ".concat(e.statusText));{let t=yield e.json();if(!$J(t))throw new Error("Bad response");O().transaction(e=>{let{drafts:n}=e;n.ahistoric.updateChecker={lastChecked:Date.now(),result:b({},t)}}),yield XJ(1e3)}}catch(e){yield XJ(36e5)}}})}var XJ=e=>new Promise(t=>setTimeout(t,e));function $J(e){if("object"!=typeof e)return!1;let t=e;return"boolean"==typeof t.hasUpdates&&(!0===t.hasUpdates&&"string"==typeof t.newVersion&&"string"==typeof t.releasePage||!1===t.hasUpdates)}var YJ,JJ=P(nf());function QJ(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function eQ(e,t){let n=indexedDB.open(e);n.onupgradeneeded=()=>n.result.createObjectStore(t);let r=QJ(n);return(e,n)=>r.then(r=>n(r.transaction(t,e).objectStore(t)))}function tQ(){return YJ||(YJ=eQ("keyval-store","keyval")),YJ}function nQ(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},QJ(e.transaction)}var rQ=e=>{let t=eQ("theatrejs-".concat(e),"default-store");return{set:(e,n)=>function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:tQ())("readwrite",n=>(n.put(t,e),QJ(n.transaction)))}(e,n,t),get:e=>function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:tQ())("readonly",t=>QJ(t.get(e)))}(e,t),del:e=>function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:tQ())("readwrite",t=>(t.delete(e),QJ(t.transaction)))}(e,t),keys:()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:tQ())("readonly",e=>{if(e.getAllKeys)return QJ(e.getAllKeys());let t=[];return nQ(e,e=>t.push(e.key)).then(()=>t)})}(t),entries:()=>function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tQ();return e("readonly",t=>{if(t.getAll&&t.getAllKeys)return Promise.all([QJ(t.getAllKeys()),QJ(t.getAll())]).then(e=>{let[t,n]=e;return t.map((e,t)=>[e,n[t]])});let n=[];return e("readonly",e=>nQ(e,e=>n.push([e.key,e.value])).then(()=>n))})}(t),values:()=>function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:tQ())("readonly",e=>{if(e.getAll)return QJ(e.getAll());let t=[];return nQ(e,e=>t.push(e.value)).then(()=>t)})}(t)}};Vz(),Lz();var iQ="theatre-0.4",aQ="__TheatreJS_StudioBundle",oQ=class{constructor(e){this._studio=e,D(this,"_coreBundle")}get type(){return"Theatre_StudioBundle"}registerCoreBundle(e){if(this._coreBundle)throw new Error("StudioBundle.coreBundle is already registered. This is a bug.");let t;this._coreBundle=e,e.getBitsForStudio(this._studio,e=>{t=e}),this._studio.setCoreBits(t)}},sQ=P(Oh());Zp();var lQ,uQ=Wp.div(lQ||(lQ=I([""]))),cQ=e=>sQ.default.createElement(uQ,null);Lz();var dQ=new class{constructor(){D(this,"ui"),D(this,"publicApi"),D(this,"address"),D(this,"_projectsProxy",new K$.PointerProxy(new K$.Atom({}).pointer)),D(this,"projectsP",this._projectsProxy.pointer),D(this,"_store",new NJ),D(this,"_corePrivateApi"),D(this,"_cache",new VJ),D(this,"paneManager"),D(this,"_coreAtom",new K$.Atom({})),D(this,"_initializedDeferred",CJ()),D(this,"_initializeFnCalled",!1),D(this,"_didWarnAboutNotInitializing",!1),D(this,"_coreBits"),D(this,"_rafDriver"),this.address={studioId:gD(10)},this.publicApi=new qJ(this),this.ui=new Z$(this),this._attachToIncomingProjects(),this.paneManager=new WJ(this),"undefined"!=typeof window&&setTimeout(()=>{this._initializeFnCalled||(console.error("You seem to have imported '@theatre/studio' but haven't initialized it. You can initialize the studio by:\n```\nimport studio from '@theatre/studio'\nstudio.initialize()\n```\n\n* If you didn't mean to import '@theatre/studio', this means that your bundler is not tree-shaking it. This is most likely a bundler misconfiguration.\n\n* If you meant to import '@theatre/studio' without showing its UI, you can do that by running:\n\n```\nimport studio from '@theatre/studio'\nstudio.initialize()\nstudio.ui.hide()\n```\n"),this._didWarnAboutNotInitializing=!0)},100)}get ticker(){if(!this._rafDriver)throw new Error("`studio.ticker` was read before studio.initialize() was called.");return this._rafDriver.ticker}get atomP(){return this._store.atomP}initialize(e){return T(this,null,function*(){if(!this._coreBits)throw new Error("You seem to have imported `@theatre/studio` without importing `@theatre/core`. Make sure to include an import of `@theatre/core` before calling `studio.initializer()`.");if(this._initializeFnCalled)return this._initializedDeferred.promise;this._initializeFnCalled=!0,this._didWarnAboutNotInitializing&&console.warn("You seem to have imported '@theatre/studio' but called `studio.initialize()` after some delay.\nTheatre.js projects remain in pending mode (won't play their sequences) until the studio is initialized, so you should place the `studio.initialize()` line right after the import line:\n\n```\nimport studio from '@theatre/studio'\n// ... and other imports\n\nstudio.initialize()\n```\n");let t={persistenceKey:iQ,usePersistentStorage:!0};if("string"==typeof(null==e?void 0:e.persistenceKey)&&(t.persistenceKey=e.persistenceKey),(!1===(null==e?void 0:e.usePersistentStorage)||"undefined"==typeof window)&&(t.usePersistentStorage=!1),null!=e&&e.__experimental_rafDriver){if("Theatre_RafDriver_PublicAPI"!==e.__experimental_rafDriver.type)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` must be either be undefined, or the return type of core.createRafDriver()");let t=this._coreBits.privateAPI(e.__experimental_rafDriver);if(!t)throw new Error("parameter `rafDriver` in `studio.initialize({__experimental_rafDriver})` seems to come from a different version of `@theatre/core` than the version that is attached to `@theatre/studio`");this._rafDriver=t}else this._rafDriver=this._coreBits.getCoreRafDriver();try{yield this._store.initialize(t)}catch(n){return void this._initializedDeferred.reject(n)}"undefined"!=typeof window&&(yield this.ui.ready),this._initializedDeferred.resolve(),this.ui.render(),GJ().catch(e=>{console.error(e)})})}get initialized(){return this._initializedDeferred.promise}_attachToIncomingProjects(){let e=(0,K$.pointerToPrism)(this.projectsP),t=e=>{for(let t of Object.values(e))t.isAttachedToStudio||t.attachToStudio(this)};e.onStale(()=>{t(e.getValue())}),t(e.getValue())}setCoreBits(e){this._coreBits=e,this._corePrivateApi=e.privateAPI,this._coreAtom.setByPointer(e=>e.core,e.coreExports),this._setProjectsP(e.projectsP)}_setProjectsP(e){this._projectsProxy.setPointer(e)}scrub(){return new q$(this)}tempTransaction(e){return this._store.tempTransaction(e)}transaction(e){return this.tempTransaction(e).commit()}__dev_startHistoryFromScratch(e){return this._store.__dev_startHistoryFromScratch(e)}get corePrivateAPI(){return this._corePrivateApi}get core(){return this._coreAtom.get().core}get coreP(){return this._coreAtom.pointer.core}extend(e,t){if(!e||"object"!=typeof e)throw new Error("Extensions must be JS objects");if("string"!=typeof e.id)throw new Error("extension.id must be a string");let n=!0===(null==t?void 0:t.__experimental_reconfigure),r=e.id,i=this._store.getState().ephemeral.extensions.byId[r];if(i&&!n){if(e===i||(0,JJ.default)(e,i))return;throw new Error('Extension id "'.concat(e.id,'" is already defined. If you mean to re-configure the extension, do it like this: studio.extend(extension, {__experimental_reconfigure: true})})'))}this.transaction(t=>{let{drafts:r}=t;var a,o;r.ephemeral.extensions.byId[e.id]=e;let s=r.ephemeral.extensions.paneClasses;n&&i&&(null==(a=i.panes)||a.forEach(e=>{delete s[e.class]})),null==(o=e.panes)||o.forEach(t=>{if("string"!=typeof t.class)throw new Error("pane.class must be a string");if(t.class.length<3)throw new Error("pane.class should be a string with 3 or more characters");let r=s[t.class];if(r){if(!n||r.extensionId!==e.id)throw new Error('Pane class "'.concat(t.class,'" already exists and is supplied by extension ').concat(r));console.warn('Pane class "'.concat(t.class,'" already exists. This is a bug in Theatre.js. Please report it at https://github.com/theatre-js/theatre/issues/new'))}s[t.class]={extensionId:e.id,classDefinition:t}})})}getStudioProject(e){return this._cache.get("getStudioProject",()=>e.getProject("Studio"))}getExtensionSheet(e,t){return this._cache.get("extensionSheet-"+e,()=>this.getStudioProject(t).sheet("Extension "+e))}undo(){this._store.undo()}redo(){this._store.redo()}createContentOfSaveFile(e){return this._store.createContentOfSaveFile(e)}createAssetStorage(e,t){return T(this,null,function*(){if("undefined"==typeof window)return{getAssetUrl:()=>"",createAsset:()=>Promise.resolve(null)};if(!("indexedDB"in window))return console.log("This browser doesn't support IndexedDB."),{getAssetUrl:e=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")},createAsset:e=>{throw new Error("IndexedDB is required by the default asset manager, but it's not supported by this browser. To use assets, please provide your own asset manager to the project config.")}};let n=rQ("".concat(e.address.projectId,"-assets")),r=Nz(e),i=yield n.keys();yield Promise.all(i.map(e=>T(this,null,function*(){r.includes(e)||(yield n.del(e))}))),yield Promise.all(i.map(r=>T(this,null,function*(){var i,a;let o="".concat(t,"/").concat(r);try{(yield fetch(o,{method:"HEAD"})).ok&&(yield n.del(r))}catch(s){kz.error("Failed to access assets","Failed to access assets at ".concat(null!=(a=null==(i=e.config.assets)?void 0:i.baseUrl)?a:"/",". This is likely due to a CORS issue."))}})));let a=new Map(yield n.entries()),o=new Map,s=e=>{let t=a.get(e);if(!t)throw new Error("Asset with id ".concat(e," not found"));return(e=>{if(o.has(e))return o.get(e);{let t=URL.createObjectURL(e);return o.set(e,t),t}})(t)};return{getAssetUrl:e=>a.has(e)?s(e):"".concat(t,"/").concat(e),createAsset:r=>T(this,null,function*(){var i,o,s;let l=Nz(e),u=!1;if(l.includes(r.name)){let n;try{n=null!=(i=a.get(r.name))?i:yield fetch("".concat(t,"/").concat(r.name)).then(e=>e.ok?e.blob():void 0)}catch(c){return kz.error("Failed to access assets","Failed to access assets at ".concat(null!=(s=null==(o=e.config.assets)?void 0:o.baseUrl)?s:"/",". This is likely due to a CORS issue.")),Promise.resolve(null)}if(n){if(u=yield(yield Promise.resolve().then(()=>P(L$()))).default.isEqual(r,n),u)return r.name;{let e=t=>{let n=prompt(t,r.name);return null!==n&&(""===n?e("Asset name cannot be empty. Please choose a different file name for this asset."):l.includes(n)?(console.log(l),e("An asset with this name already exists. Please choose a different file name for this asset.")):(r=new File([r],n,{type:r.type}),!0))};if(!e("An asset with this name already exists. Please choose a different file name for this asset."))return null}}}return a.set(r.name,r),yield n.set(r.name,r),r.name})}})}clearPersistentStorage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:iQ;this._store.__experimental_clearPersistentStorage(e)}};!function(e){F=e}(dQ);var hQ=dQ.publicApi;!function(){if("undefined"==typeof window)return;let e=window[aQ];if("undefined"!=typeof e)throw"object"==typeof e&&e&&"string"==typeof e.version?new Error("It seems that the module '@theatre/studio' is loaded more than once. This could have two possible causes:\n1. You might have two separate versions of Theatre.js in node_modules.\n2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.\n\nNote that it **is okay** to import '@theatre/studio' multiple times. But those imports should point to the same module."):new Error("The variable window.".concat(aQ," seems to be already set by a module other than @theatre/core."));let t=new oQ(dQ);window[aQ]=t;let n=window.__TheatreJS_CoreBundle;n&&null!==n&&"Theatre_CoreBundle"===n.type&&t.registerCoreBundle(n)}(),"undefined"!=typeof window&&(window.__TheatreJS_Notifications={notify:kz})},202(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function _(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,m(b,y.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,k={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,r){var i,a={},o=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)w.call(t,i)&&!S.hasOwnProperty(i)&&(a[i]=t[i]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];a.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===a[i]&&(a[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:s,props:a,_owner:k.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var P=/\/+/g;function D(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function I(e,t,i,a,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===a?"."+D(l,0):a,x(o)?(i="",null!=e&&(i=e.replace(P,"$&/")+"/"),I(o,t,i,"",function(e){return e})):null!=o&&(C(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(P,"$&/")+"/")+e)),t.push(o)),1;if(l=0,a=""===a?".":a+":",x(e))for(var u=0;u<e.length;u++){var c=a+D(s=e[u],u);l+=I(s,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(s=e.next()).done;)l+=I(s=s.value,t,i,c=a+D(s,u++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function T(e,t,n){if(null==e)return e;var r=[],i=0;return I(e,r,"","",function(e){return t.call(n,e,i++)}),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var z={current:null},O={transition:null},F={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:O,ReactCurrentOwner:k};function M(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:T,forEach:function(e,t,n){T(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return T(e,function(){t++}),t},toArray:function(e){return T(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=_,t.StrictMode=a,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),a=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=k.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)w.call(t,u)&&!S.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:a,ref:o,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=M,t.useCallback=function(e,t){return z.current.useCallback(e,t)},t.useContext=function(e){return z.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return z.current.useDeferredValue(e)},t.useEffect=function(e,t){return z.current.useEffect(e,t)},t.useId=function(){return z.current.useId()},t.useImperativeHandle=function(e,t,n){return z.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return z.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return z.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return z.current.useMemo(e,t)},t.useReducer=function(e,t,n){return z.current.useReducer(e,t,n)},t.useRef=function(e){return z.current.useRef(e)},t.useState=function(e){return z.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return z.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return z.current.useTransition()},t.version="18.3.1"},234(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<a(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var s=2*(r+1)-1,l=e[s],u=s+1,c=e[u];if(0>a(l,n))u<i&&0>a(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[s]=n,r=s);else{if(!(u<i&&0>a(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var u=[],c=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function x(e){if(g=!1,b(e),!m)if(null!==r(u))m=!0,O(w);else{var t=r(c);null!==t&&F(x,t.startTime-e)}}function w(e,n){m=!1,g&&(g=!1,v(C),C=-1),p=!0;var a=f;try{for(b(n),h=r(u);null!==h&&(!(h.expirationTime>n)||e&&!I());){var o=h.callback;if("function"===typeof o){h.callback=null,f=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(u)&&i(u),b(n)}else i(u);h=r(u)}if(null!==h)var l=!0;else{var d=r(c);null!==d&&F(x,d.startTime-n),l=!1}return l}finally{h=null,f=a,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,S=!1,E=null,C=-1,P=5,D=-1;function I(){return!(t.unstable_now()-D<P)}function T(){if(null!==E){var e=t.unstable_now();D=e;var n=!0;try{n=E(!0,e)}finally{n?k():(S=!1,E=null)}}else S=!1}if("function"===typeof _)k=function(){_(T)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,z=A.port2;A.port1.onmessage=T,k=function(){z.postMessage(null)}}else k=function(){y(T,0)};function O(e){E=e,S||(S=!0,k())}function F(e,n){C=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,O(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,a){var o=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?o+a:o:a=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:a,expirationTime:s=a+s,sortIndex:-1},a>o?(e.sortIndex=a,n(c,e),null===r(u)&&e===r(c)&&(g?(v(C),C=-1):g=!0,F(x,a-o))):(e.sortIndex=s,n(u,e),m||p||(m=!0,O(w))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391(e,t,n){"use strict";var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},458(e){function t(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=458,e.exports=t},579(e,t,n){"use strict";e.exports=n(153)},693(e,t,n){var r=n(736);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports.default=e.exports},730(e,t,n){"use strict";var r=n(43),i=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,a,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),P=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),z=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function M(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var j,B=Object.assign;function R(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var L=!1;function N(e,t){if(!e||L)return"";L=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),a=r.stack.split("\n"),o=i.length-1,s=a.length-1;1<=o&&0<=s&&i[o]!==a[s];)s--;for(;1<=o&&0<=s;o--,s--)if(i[o]!==a[s]){if(1!==o||1!==s)do{if(o--,0>--s||i[o]!==a[s]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=s);break}}}finally{L=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?R(e):""}function U(e){switch(e.tag){case 5:return R(e.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return e=N(e.type,!1);case 11:return e=N(e.type.render,!1);case 1:return e=N(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case w:return"Portal";case E:return"Profiler";case S:return"StrictMode";case I:return"Suspense";case T:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case P:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case D:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case z:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Z(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return B({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return B({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,de=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ce(e,t)})}:ce);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=B({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,ke=null,Se=null;function Ee(e){if(e=_i(e)){if("function"!==typeof we)throw Error(a(280));var t=e.stateNode;t&&(t=xi(t),we(e.stateNode,e.type,t))}}function Ce(e){ke?Se?Se.push(e):Se=[e]:ke=e}function Pe(){if(ke){var e=ke,t=Se;if(Se=ke=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function De(e,t){return e(t)}function Ie(){}var Te=!1;function Ae(e,t,n){if(Te)return e(t,n);Te=!0;try{return De(e,t,n)}finally{Te=!1,(null!==ke||null!==Se)&&(Ie(),Pe())}}function ze(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Oe=!1;if(c)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(ce){Oe=!1}function Me(e,t,n,r,i,a,o,s,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var je=!1,Be=null,Re=!1,Le=null,Ne={onError:function(e){je=!0,Be=e}};function Ue(e,t,n,r,i,a,o,s,l){je=!1,Be=null,Me.apply(Ne,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(a(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===r)return He(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,l=i.child;l;){if(l===n){s=!0,n=i,r=o;break}if(l===r){s=!0,r=i,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,r=i;break}if(l===r){s=!0,r=o,n=i;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Ze(e):null}function Ze(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ze(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Xe=i.unstable_shouldYield,$e=i.unstable_requestPaint,Ye=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Qe=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,at=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,a=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~i;0!==s?r=dt(s):0!==(a&=o)&&(r=dt(a))}else 0!==(o=n&~i)?r=dt(o):0!==a&&(r=dt(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(a=t&-t)||16===i&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,kt,St,Et,Ct=!1,Pt=[],Dt=null,It=null,Tt=null,At=new Map,zt=new Map,Ot=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mt(e,t){switch(e){case"focusin":case"focusout":Dt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Tt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zt.delete(t.pointerId)}}function jt(e,t,n,r,i,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&wt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Bt(e){var t=vi(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Et(e.priority,function(){kt(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Rt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_i(n))&&wt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Lt(e,t,n){Rt(e)&&n.delete(t)}function Nt(){Ct=!1,null!==Dt&&Rt(Dt)&&(Dt=null),null!==It&&Rt(It)&&(It=null),null!==Tt&&Rt(Tt)&&(Tt=null),At.forEach(Lt),zt.forEach(Lt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Nt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<Pt.length){Ut(Pt[0],e);for(var n=1;n<Pt.length;n++){var r=Pt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Dt&&Ut(Dt,e),null!==It&&Ut(It,e),null!==Tt&&Ut(Tt,e),At.forEach(t),zt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Bt(n),null===n.blockedOn&&Ot.shift()}var qt=b.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,r){var i=_t,a=qt.transition;qt.transition=null;try{_t=1,Kt(e,t,n,r)}finally{_t=i,qt.transition=a}}function Zt(e,t,n,r){var i=_t,a=qt.transition;qt.transition=null;try{_t=4,Kt(e,t,n,r)}finally{_t=i,qt.transition=a}}function Kt(e,t,n,r){if(Ht){var i=Xt(e,t,n,r);if(null===i)Hr(e,t,r,Gt,n),Mt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Dt=jt(Dt,e,t,n,r,i),!0;case"dragenter":return It=jt(It,e,t,n,r,i),!0;case"mouseover":return Tt=jt(Tt,e,t,n,r,i),!0;case"pointerover":var a=i.pointerId;return At.set(a,jt(At.get(a)||null,e,t,n,r,i)),!0;case"gotpointercapture":return a=i.pointerId,zt.set(a,jt(zt.get(a)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Mt(e,r),4&t&&-1<Ft.indexOf(e)){for(;null!==i;){var a=_i(i);if(null!==a&&xt(a),null===(a=Xt(e,t,n,r))&&Hr(e,t,r,Gt,n),a===i)break;i=a}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Gt=null;function Xt(e,t,n,r){if(Gt=null,null!==(e=vi(e=xe(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Qe:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Qt=null;function en(){if(Qt)return Qt;var e,t,n=Jt,r=n.length,i="value"in Yt?Yt.value:Yt.textContent,a=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[a-t];t++);return Qt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return B(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=an(un),dn=B({},un,{view:0,detail:0}),hn=an(dn),fn=B({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:En,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,sn=e.screenY-ln.screenY):sn=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),pn=an(fn),mn=an(B({},fn,{dataTransfer:0})),gn=an(B({},dn,{relatedTarget:0})),yn=an(B({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=B({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=an(vn),bn=an(B({},un,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kn[e])&&!!t[e]}function En(){return Sn}var Cn=B({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:En,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Pn=an(Cn),Dn=an(B({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),In=an(B({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:En})),Tn=an(B({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=B({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zn=an(An),On=[9,13,27,32],Fn=c&&"CompositionEvent"in window,Mn=null;c&&"documentMode"in document&&(Mn=document.documentMode);var jn=c&&"TextEvent"in window&&!Mn,Bn=c&&(!Fn||Mn&&8<Mn&&11>=Mn),Rn=String.fromCharCode(32),Ln=!1;function Nn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Wn(e,t,n,r){Ce(r),0<(t=Zr(t,"onChange")).length&&(n=new cn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Zn=null,Kn=null;function Gn(e){Rr(e,0)}function Xn(e){if(K(bi(e)))return e}function $n(e,t){if("change"===e)return t}var Yn=!1;if(c){var Jn;if(c){var Qn="oninput"in document;if(!Qn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Qn="function"===typeof er.oninput}Jn=Qn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Zn&&(Zn.detachEvent("onpropertychange",nr),Kn=Zn=null)}function nr(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Wn(t,Kn,e,xe(e)),Ae(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Zn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function ar(e,t){if("click"===e)return Xn(t)}function or(e,t){if("input"===e||"change"===e)return Xn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!sr(e[i],t[i]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,a=Math.min(r.start,i);r=void 0===r.end?a:Math.min(r.end,i),!e.extend&&a>r&&(i=r,r=a,a=i),i=cr(n,a);var o=cr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=c&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,_r=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Zr(yr,"onSelect")).length&&(t=new cn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wr={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},kr={},Sr={};function Er(e){if(kr[e])return kr[e];if(!wr[e])return e;var t,n=wr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return kr[e]=n[t];return e}c&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete wr.animationend.animation,delete wr.animationiteration.animation,delete wr.animationstart.animation),"TransitionEvent"in window||delete wr.transitionend.transition);var Cr=Er("animationend"),Pr=Er("animationiteration"),Dr=Er("animationstart"),Ir=Er("transitionend"),Tr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(e,t){Tr.set(e,t),l(t,[e])}for(var Or=0;Or<Ar.length;Or++){var Fr=Ar[Or];zr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}zr(Cr,"onAnimationEnd"),zr(Pr,"onAnimationIteration"),zr(Dr,"onAnimationStart"),zr("dblclick","onDoubleClick"),zr("focusin","onFocus"),zr("focusout","onBlur"),zr(Ir,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mr));function Br(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,l,u){if(Ue.apply(this,arguments),je){if(!je)throw Error(a(198));var c=Be;je=!1,Be=null,Re||(Re=!0,Le=c)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],l=s.instance,u=s.currentTarget;if(s=s.listener,l!==a&&i.isPropagationStopped())break e;Br(i,s,u),a=l}else for(o=0;o<r.length;o++){if(l=(s=r[o]).instance,u=s.currentTarget,s=s.listener,l!==a&&i.isPropagationStopped())break e;Br(i,s,u),a=l}}}if(Re)throw e=Le,Re=!1,Le=null,e}function Lr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function Nr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Ur]){e[Ur]=!0,o.forEach(function(t){"selectionchange"!==t&&(jr.has(t)||Nr(t,!1,e),Nr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,Nr("selectionchange",!1,t))}}function qr(e,t,n,r){switch($t(t)){case 1:var i=Wt;break;case 4:i=Zt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==s;){if(null===(o=vi(s)))return;if(5===(l=o.tag)||6===l){r=a=o;continue e}s=s.parentNode}}r=r.return}Ae(function(){var r=a,i=xe(n),o=[];e:{var s=Tr.get(e);if(void 0!==s){var l=cn,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=Pn;break;case"focusin":u="focus",l=gn;break;case"focusout":u="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=In;break;case Cr:case Pr:case Dr:l=yn;break;case Ir:l=Tn;break;case"scroll":l=hn;break;case"wheel":l=zn;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Dn}var c=0!==(4&t),d=!c&&"scroll"===e,h=c?null!==s?s+"Capture":null:s;c=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=ze(p,h))&&c.push(Wr(p,m,f)))),d)break;p=p.return}0<c.length&&(s=new l(s,u,null,n,i),o.push({event:s,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(u=n.relatedTarget||n.fromElement)||!vi(u)&&!u[pi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?vi(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Dn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?s:bi(l),f=null==u?s:bi(u),(s=new c(m,p+"leave",l,n,i)).target=d,s.relatedTarget=f,m=null,vi(i)===r&&((c=new c(h,p+"enter",u,n,i)).target=f,c.relatedTarget=d,m=c),d=m,l&&u)e:{for(h=u,p=0,f=c=l;f;f=Kr(f))p++;for(f=0,m=h;m;m=Kr(m))f++;for(;0<p-f;)c=Kr(c),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(c===h||null!==h&&c===h.alternate)break e;c=Kr(c),h=Kr(h)}c=null}else c=null;null!==l&&Gr(o,s,l,c,!1),null!==u&&null!==d&&Gr(o,d,u,c,!0)}if("select"===(l=(s=r?bi(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var g=$n;else if(Hn(s))if(Yn)g=or;else{g=ir;var y=rr}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=ar);switch(g&&(g=g(e,r))?Wn(o,g,n,i):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?bi(r):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,br(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":br(o,n,i)}var v;if(Fn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Vn?Nn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Bn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Vn&&(v=en()):(Jt="value"in(Yt=i)?Yt.value:Yt.textContent,Vn=!0)),0<(y=Zr(r,_)).length&&(_=new bn(_,e,null,n,i),o.push({event:_,listeners:y}),v?_.data=v:null!==(v=Un(n))&&(_.data=v))),(v=jn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Ln=!0,Rn);case"textInput":return(e=t.data)===Rn&&Ln?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Fn&&Nn(e,t)?(e=en(),Qt=Jt=Yt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Zr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}Rr(o,t)})}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Zr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,a=i.stateNode;5===i.tag&&null!==a&&(i=a,null!=(a=ze(e,n))&&r.unshift(Wr(e,a,i)),null!=(a=ze(e,t))&&r.push(Wr(e,a,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var a=t._reactName,o=[];null!==n&&n!==r;){var s=n,l=s.alternate,u=s.stateNode;if(null!==l&&l===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(l=ze(n,a))&&o.unshift(Wr(n,l,s)):i||null!=(l=ze(n,a))&&o.push(Wr(n,l,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Xr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace($r,"")}function Jr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(a(425))}function Qr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,ai="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ai?function(e){return ai.resolve(null).then(e).catch(si)}:ri;function si(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Vt(t)}function ui(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ci(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ci(e);null!==e;){if(n=e[hi])return n;e=ci(e)}return t}n=(e=n).parentNode}return null}function _i(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function xi(e){return e[fi]||null}var wi=[],ki=-1;function Si(e){return{current:e}}function Ei(e){0>ki||(e.current=wi[ki],wi[ki]=null,ki--)}function Ci(e,t){ki++,wi[ki]=e.current,e.current=t}var Pi={},Di=Si(Pi),Ii=Si(!1),Ti=Pi;function Ai(e,t){var n=e.type.contextTypes;if(!n)return Pi;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,a={};for(i in n)a[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ei(Ii),Ei(Di)}function Fi(e,t,n){if(Di.current!==Pi)throw Error(a(168));Ci(Di,t),Ci(Ii,n)}function Mi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(a(108,q(e)||"Unknown",i));return B({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Pi,Ti=Di.current,Ci(Di,e),Ci(Ii,Ii.current),!0}function Bi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Mi(e,t,Ti),r.__reactInternalMemoizedMergedChildContext=e,Ei(Ii),Ei(Di),Ci(Di,e)):Ei(Ii),Ci(Ii,n)}var Ri=null,Li=!1,Ni=!1;function Ui(e){null===Ri?Ri=[e]:Ri.push(e)}function Vi(){if(!Ni&&null!==Ri){Ni=!0;var e=0,t=_t;try{var n=Ri;for(_t=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ri=null,Li=!1}catch(i){throw null!==Ri&&(Ri=Ri.slice(e+1)),Ke(Qe,Vi),i}finally{_t=t,Ni=!1}}return null}var qi=[],Hi=0,Wi=null,Zi=0,Ki=[],Gi=0,Xi=null,$i=1,Yi="";function Ji(e,t){qi[Hi++]=Zi,qi[Hi++]=Wi,Wi=e,Zi=t}function Qi(e,t,n){Ki[Gi++]=$i,Ki[Gi++]=Yi,Ki[Gi++]=Xi,Xi=e;var r=$i;e=Yi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var a=32-ot(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,$i=1<<32-ot(t)+i|n<<i|r,Yi=a+e}else $i=1<<a|n<<i|r,Yi=e}function ea(e){null!==e.return&&(Ji(e,1),Qi(e,1,0))}function ta(e){for(;e===Wi;)Wi=qi[--Hi],qi[Hi]=null,Zi=qi[--Hi],qi[Hi]=null;for(;e===Xi;)Xi=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null,$i=Ki[--Gi],Ki[Gi]=null}var na=null,ra=null,ia=!1,aa=null;function oa(e,t){var n=Tu(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=ui(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xi?{id:$i,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Tu(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ua(e){if(ia){var t=ra;if(t){var n=t;if(!sa(e,t)){if(la(e))throw Error(a(418));t=ui(n.nextSibling);var r=na;t&&sa(e,t)?oa(r,n):(e.flags=-4097&e.flags|2,ia=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,ia=!1,na=e}}}function ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function da(e){if(e!==na)return!1;if(!ia)return ca(e),ia=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)oa(e,t),t=ui(t.nextSibling)}if(ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=ui(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?ui(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=ui(e.nextSibling)}function fa(){ra=na=null,ia=!1}function pa(e){null===aa?aa=[e]:aa.push(e)}var ma=b.ReactCurrentBatchConfig;function ga(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function va(e){return(0,e._init)(e._payload)}function _a(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=zu(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=ju(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var a=n.type;return a===k?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===z&&va(a)===t.type)?((r=i(t,n.props)).ref=ga(e,t,n),r.return=e,r):((r=Ou(n.type,n.key,n.props,null,e.mode,r)).ref=ga(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,a){return null===t||7!==t.tag?((t=Fu(n,e.mode,r,a)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=ju(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Ou(t.type,t.key,t.props,null,e.mode,n)).ref=ga(e,null,t),n.return=e,n;case w:return(t=Bu(t,e.mode,n)).return=e,t;case z:return h(e,(0,t._init)(t._payload),n)}if(te(t)||M(t))return(t=Fu(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?u(e,t,n,r):null;case w:return n.key===i?c(e,t,n,r):null;case z:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||M(n))return null!==i?null:d(e,t,n,r,null);ya(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case z:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||M(r))return d(t,e=e.get(n)||null,r,i,null);ya(t,r)}return null}function m(i,a,s,l){for(var u=null,c=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(i,d,s[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),a=o(y,a,m),null===c?u=y:c.sibling=y,c=y,d=g}if(m===s.length)return n(i,d),ia&&Ji(i,m),u;if(null===d){for(;m<s.length;m++)null!==(d=h(i,s[m],l))&&(a=o(d,a,m),null===c?u=d:c.sibling=d,c=d);return ia&&Ji(i,m),u}for(d=r(i,d);m<s.length;m++)null!==(g=p(d,i,m,s[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=o(g,a,m),null===c?u=g:c.sibling=g,c=g);return e&&d.forEach(function(e){return t(i,e)}),ia&&Ji(i,m),u}function g(i,s,l,u){var c=M(l);if("function"!==typeof c)throw Error(a(150));if(null==(l=c.call(l)))throw Error(a(151));for(var d=c=null,m=s,g=s=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=f(i,m,v.value,u);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),s=o(_,s,g),null===d?c=_:d.sibling=_,d=_,m=y}if(v.done)return n(i,m),ia&&Ji(i,g),c;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,u))&&(s=o(v,s,g),null===d?c=v:d.sibling=v,d=v);return ia&&Ji(i,g),c}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=o(v,s,g),null===d?c=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(i,e)}),ia&&Ji(i,g),c}return function e(r,a,o,l){if("object"===typeof o&&null!==o&&o.type===k&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case x:e:{for(var u=o.key,c=a;null!==c;){if(c.key===u){if((u=o.type)===k){if(7===c.tag){n(r,c.sibling),(a=i(c,o.props.children)).return=r,r=a;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===z&&va(u)===c.type){n(r,c.sibling),(a=i(c,o.props)).ref=ga(r,c,o),a.return=r,r=a;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===k?((a=Fu(o.props.children,r.mode,l,o.key)).return=r,r=a):((l=Ou(o.type,o.key,o.props,null,r.mode,l)).ref=ga(r,a,o),l.return=r,r=l)}return s(r);case w:e:{for(c=o.key;null!==a;){if(a.key===c){if(4===a.tag&&a.stateNode.containerInfo===o.containerInfo&&a.stateNode.implementation===o.implementation){n(r,a.sibling),(a=i(a,o.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Bu(o,r.mode,l)).return=r,r=a}return s(r);case z:return e(r,a,(c=o._init)(o._payload),l)}if(te(o))return m(r,a,o,l);if(M(o))return g(r,a,o,l);ya(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==a&&6===a.tag?(n(r,a.sibling),(a=i(a,o)).return=r,r=a):(n(r,a),(a=ju(o,r.mode,l)).return=r,r=a),s(r)):n(r,a)}}var ba=_a(!0),xa=_a(!1),wa=Si(null),ka=null,Sa=null,Ea=null;function Ca(){Ea=Sa=ka=null}function Pa(e){var t=wa.current;Ei(wa),e._currentValue=t}function Da(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ia(e,t){ka=e,Ea=Sa=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(_s=!0),e.firstContext=null)}function Ta(e){var t=e._currentValue;if(Ea!==e)if(e={context:e,memoizedValue:t,next:null},null===Sa){if(null===ka)throw Error(a(308));Sa=e,ka.dependencies={lanes:0,firstContext:e}}else Sa=Sa.next=e;return t}var Aa=null;function za(e){null===Aa?Aa=[e]:Aa.push(e)}function Oa(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,za(t)):(n.next=i.next,i.next=n),t.interleaved=n,Fa(e,r)}function Fa(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ma=!1;function ja(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ba(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ra(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function La(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Pl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Fa(e,n)}return null===(i=r.interleaved)?(t.next=t,za(r)):(t.next=i.next,i.next=t),r.interleaved=t,Fa(e,n)}function Na(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Ua(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?i=a=o:a=a.next=o,n=n.next}while(null!==n);null===a?i=a=t:a=a.next=t}else i=a=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Va(e,t,n,r){var i=e.updateQueue;Ma=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,u=l.next;l.next=null,null===o?a=u:o.next=u,o=l;var c=e.alternate;null!==c&&((s=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===s?c.firstBaseUpdate=u:s.next=u,c.lastBaseUpdate=l))}if(null!==a){var d=i.baseState;for(o=0,c=u=l=null,s=a;;){var h=s.lane,f=s.eventTime;if((r&h)===h){null!==c&&(c=c.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=B({},d,h);break e;case 2:Ma=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[s]:h.push(s))}else f={eventTime:f,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===c?(u=c=f,l=d):c=c.next=f,o|=h;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(h=s).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===c&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===a&&(i.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=d}}function qa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var Ha={},Wa=Si(Ha),Za=Si(Ha),Ka=Si(Ha);function Ga(e){if(e===Ha)throw Error(a(174));return e}function Xa(e,t){switch(Ci(Ka,t),Ci(Za,e),Ci(Wa,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Wa),Ci(Wa,t)}function $a(){Ei(Wa),Ei(Za),Ei(Ka)}function Ya(e){Ga(Ka.current);var t=Ga(Wa.current),n=le(t,e.type);t!==n&&(Ci(Za,e),Ci(Wa,n))}function Ja(e){Za.current===e&&(Ei(Wa),Ei(Za))}var Qa=Si(0);function eo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var to=[];function no(){for(var e=0;e<to.length;e++)to[e]._workInProgressVersionPrimary=null;to.length=0}var ro=b.ReactCurrentDispatcher,io=b.ReactCurrentBatchConfig,ao=0,oo=null,so=null,lo=null,uo=!1,co=!1,ho=0,fo=0;function po(){throw Error(a(321))}function mo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function go(e,t,n,r,i,o){if(ao=o,oo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ro.current=null===e||null===e.memoizedState?Qo:es,e=n(r,i),co){o=0;do{if(co=!1,ho=0,25<=o)throw Error(a(301));o+=1,lo=so=null,t.updateQueue=null,ro.current=ts,e=n(r,i)}while(co)}if(ro.current=Jo,t=null!==so&&null!==so.next,ao=0,lo=so=oo=null,uo=!1,t)throw Error(a(300));return e}function yo(){var e=0!==ho;return ho=0,e}function vo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===lo?oo.memoizedState=lo=e:lo=lo.next=e,lo}function _o(){if(null===so){var e=oo.alternate;e=null!==e?e.memoizedState:null}else e=so.next;var t=null===lo?oo.memoizedState:lo.next;if(null!==t)lo=t,so=e;else{if(null===e)throw Error(a(310));e={memoizedState:(so=e).memoizedState,baseState:so.baseState,baseQueue:so.baseQueue,queue:so.queue,next:null},null===lo?oo.memoizedState=lo=e:lo=lo.next=e}return lo}function bo(e,t){return"function"===typeof t?t(e):t}function xo(e){var t=_o(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=so,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=s=null,u=null,c=o;do{var d=c.lane;if((ao&d)===d)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=h,s=r):u=u.next=h,oo.lanes|=d,Ml|=d}c=c.next}while(null!==c&&c!==o);null===u?s=r:u.next=l,sr(r,t.memoizedState)||(_s=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,oo.lanes|=o,Ml|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wo(e){var t=_o(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(_s=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ko(){}function So(e,t){var n=oo,r=_o(),i=t(),o=!sr(r.memoizedState,i);if(o&&(r.memoizedState=i,_s=!0),r=r.queue,jo(Po.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==lo&&1&lo.memoizedState.tag){if(n.flags|=2048,Ao(9,Co.bind(null,n,r,i,t),void 0,null),null===Dl)throw Error(a(349));0!==(30&ao)||Eo(n,t,i)}return i}function Eo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Co(e,t,n,r){t.value=n,t.getSnapshot=r,Do(t)&&Io(e)}function Po(e,t,n){return n(function(){Do(t)&&Io(e)})}function Do(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Io(e){var t=Fa(e,1);null!==t&&tu(t,e,1,-1)}function To(e){var t=vo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bo,lastRenderedState:e},t.queue=e,e=e.dispatch=Go.bind(null,oo,e),[t.memoizedState,e]}function Ao(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=oo.updateQueue)?(t={lastEffect:null,stores:null},oo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zo(){return _o().memoizedState}function Oo(e,t,n,r){var i=vo();oo.flags|=e,i.memoizedState=Ao(1|t,n,void 0,void 0===r?null:r)}function Fo(e,t,n,r){var i=_o();r=void 0===r?null:r;var a=void 0;if(null!==so){var o=so.memoizedState;if(a=o.destroy,null!==r&&mo(r,o.deps))return void(i.memoizedState=Ao(t,n,a,r))}oo.flags|=e,i.memoizedState=Ao(1|t,n,a,r)}function Mo(e,t){return Oo(8390656,8,e,t)}function jo(e,t){return Fo(2048,8,e,t)}function Bo(e,t){return Fo(4,2,e,t)}function Ro(e,t){return Fo(4,4,e,t)}function Lo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function No(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4,4,Lo.bind(null,t,e),n)}function Uo(){}function Vo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function qo(e,t){var n=_o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&mo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&ao)?(e.baseState&&(e.baseState=!1,_s=!0),e.memoizedState=n):(sr(n,t)||(n=mt(),oo.lanes|=n,Ml|=n,e.baseState=!0),t)}function Wo(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var r=io.transition;io.transition={};try{e(!1),t()}finally{_t=n,io.transition=r}}function Zo(){return _o().memoizedState}function Ko(e,t,n){var r=eu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xo(e))$o(t,n);else if(null!==(n=Oa(e,t,n,r))){tu(n,e,r,Ql()),Yo(n,t,r)}}function Go(e,t,n){var r=eu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xo(e))$o(t,i);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,sr(s,o)){var l=t.interleaved;return null===l?(i.next=i,za(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Oa(e,t,i,r))&&(tu(n,e,r,i=Ql()),Yo(n,t,r))}}function Xo(e){var t=e.alternate;return e===oo||null!==t&&t===oo}function $o(e,t){co=uo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Yo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var Jo={readContext:Ta,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useInsertionEffect:po,useLayoutEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useMutableSource:po,useSyncExternalStore:po,useId:po,unstable_isNewReconciler:!1},Qo={readContext:Ta,useCallback:function(e,t){return vo().memoizedState=[e,void 0===t?null:t],e},useContext:Ta,useEffect:Mo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oo(4194308,4,Lo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Oo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Oo(4,2,e,t)},useMemo:function(e,t){var n=vo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=vo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ko.bind(null,oo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},vo().memoizedState=e},useState:To,useDebugValue:Uo,useDeferredValue:function(e){return vo().memoizedState=e},useTransition:function(){var e=To(!1),t=e[0];return e=Wo.bind(null,e[1]),vo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=oo,i=vo();if(ia){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Dl)throw Error(a(349));0!==(30&ao)||Eo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Mo(Po.bind(null,r,o,e),[e]),r.flags|=2048,Ao(9,Co.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=vo(),t=Dl.identifierPrefix;if(ia){var n=Yi;t=":"+t+"R"+(n=($i&~(1<<32-ot($i)-1)).toString(32)+n),0<(n=ho++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=fo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Ta,useCallback:Vo,useContext:Ta,useEffect:jo,useImperativeHandle:No,useInsertionEffect:Bo,useLayoutEffect:Ro,useMemo:qo,useReducer:xo,useRef:zo,useState:function(){return xo(bo)},useDebugValue:Uo,useDeferredValue:function(e){return Ho(_o(),so.memoizedState,e)},useTransition:function(){return[xo(bo)[0],_o().memoizedState]},useMutableSource:ko,useSyncExternalStore:So,useId:Zo,unstable_isNewReconciler:!1},ts={readContext:Ta,useCallback:Vo,useContext:Ta,useEffect:jo,useImperativeHandle:No,useInsertionEffect:Bo,useLayoutEffect:Ro,useMemo:qo,useReducer:wo,useRef:zo,useState:function(){return wo(bo)},useDebugValue:Uo,useDeferredValue:function(e){var t=_o();return null===so?t.memoizedState=e:Ho(t,so.memoizedState,e)},useTransition:function(){return[wo(bo)[0],_o().memoizedState]},useMutableSource:ko,useSyncExternalStore:So,useId:Zo,unstable_isNewReconciler:!1};function ns(e,t){if(e&&e.defaultProps){for(var n in t=B({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function rs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:B({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=eu(e),a=Ra(r,i);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(tu(t,e,i,r),Na(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ql(),i=eu(e),a=Ra(r,i);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=La(e,a,i))&&(tu(t,e,i,r),Na(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ql(),r=eu(e),i=Ra(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=La(e,i,r))&&(tu(t,e,r,n),Na(t,e,r))}};function as(e,t,n,r,i,a,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,a))}function os(e,t,n){var r=!1,i=Pi,a=t.contextType;return"object"===typeof a&&null!==a?a=Ta(a):(i=zi(t)?Ti:Di.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ai(e,i):Pi),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function ss(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},ja(e);var a=t.contextType;"object"===typeof a&&null!==a?i.context=Ta(a):(a=zi(t)?Ti:Di.current,i.context=Ai(e,a)),i.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(rs(e,t,a,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Va(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function us(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(a){i="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:i,digest:null}}function cs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ds(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var hs="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,n){(n=Ra(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Hl=r),ds(0,t)},n}function ps(e,t,n){(n=Ra(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){ds(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){ds(0,t),"function"!==typeof r&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new hs;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Su.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Ra(-1,1)).tag=2,La(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vs=b.ReactCurrentOwner,_s=!1;function bs(e,t,n,r){t.child=null===e?xa(t,null,n,r):ba(t,e.child,n,r)}function xs(e,t,n,r,i){n=n.render;var a=t.ref;return Ia(t,i),r=go(e,t,n,r,a,i),n=yo(),null===e||_s?(ia&&n&&ea(t),t.flags|=1,bs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function ws(e,t,n,r,i){if(null===e){var a=n.type;return"function"!==typeof a||Au(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ou(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ks(e,t,a,r,i))}if(a=e.child,0===(e.lanes&i)){var o=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return qs(e,t,i)}return t.flags|=1,(e=zu(a,r)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,n,r,i){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(_s=!1,t.pendingProps=r=a,0===(e.lanes&i))return t.lanes=e.lanes,qs(e,t,i);0!==(131072&e.flags)&&(_s=!0)}}return Cs(e,t,n,r,i)}function Ss(e,t,n){var r=t.pendingProps,i=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ci(zl,Al),Al|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ci(zl,Al),Al|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ci(zl,Al),Al|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ci(zl,Al),Al|=r;return bs(e,t,i,n),t.child}function Es(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cs(e,t,n,r,i){var a=zi(n)?Ti:Di.current;return a=Ai(t,a),Ia(t,i),n=go(e,t,n,r,a,i),r=yo(),null===e||_s?(ia&&r&&ea(t),t.flags|=1,bs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qs(e,t,i))}function Ps(e,t,n,r,i){if(zi(n)){var a=!0;ji(t)}else a=!1;if(Ia(t,i),null===t.stateNode)Vs(e,t),os(t,n,r),ls(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ta(u):u=Ai(t,u=zi(n)?Ti:Di.current);var c=n.getDerivedStateFromProps,d="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||l!==u)&&ss(t,o,r,u),Ma=!1;var h=t.memoizedState;o.state=h,Va(t,r,o,i),l=t.memoizedState,s!==r||h!==l||Ii.current||Ma?("function"===typeof c&&(rs(t,n,c,r),l=t.memoizedState),(s=Ma||as(t,n,s,r,h,l,u))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Ba(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:ns(t.type,s),o.props=u,d=t.pendingProps,h=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ta(l):l=Ai(t,l=zi(n)?Ti:Di.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==l)&&ss(t,o,r,l),Ma=!1,h=t.memoizedState,o.state=h,Va(t,r,o,i);var p=t.memoizedState;s!==d||h!==p||Ii.current||Ma?("function"===typeof f&&(rs(t,n,f,r),p=t.memoizedState),(u=Ma||as(t,n,u,r,h,p,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Ds(e,t,n,r,a,i)}function Ds(e,t,n,r,i,a){Es(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Bi(t,n,!1),qs(e,t,a);r=t.stateNode,vs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=ba(t,e.child,null,a),t.child=ba(t,null,s,a)):bs(e,t,s,a),t.memoizedState=r.state,i&&Bi(t,n,!0),t.child}function Is(e){var t=e.stateNode;t.pendingContext?Fi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fi(0,t.context,!1),Xa(e,t.containerInfo)}function Ts(e,t,n,r,i){return fa(),pa(i),t.flags|=256,bs(e,t,n,r),t.child}var As,zs,Os,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ms(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var r,i=t.pendingProps,o=Qa.current,s=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ci(Qa,1&o),null===e)return ua(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Mu(l,i,0,null),e=Fu(e,i,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ms(n),t.memoizedState=Fs,e):Bs(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,s){if(n)return 256&t.flags?(t.flags&=-257,Rs(e,t,s,r=cs(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Mu({mode:"visible",children:r.children},i,0,null),(o=Fu(o,i,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&ba(t,e.child,null,s),t.child.memoizedState=Ms(s),t.memoizedState=Fs,o);if(0===(1&t.mode))return Rs(e,t,s,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Rs(e,t,s,r=cs(o=Error(a(419)),r,void 0))}if(l=0!==(s&e.childLanes),_s||l){if(null!==(r=Dl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|s))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Fa(e,i),tu(r,e,i,-1))}return pu(),Rs(e,t,s,r=cs(Error(a(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Cu.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,ra=ui(i.nextSibling),na=t,ia=!0,aa=null,null!==e&&(Ki[Gi++]=$i,Ki[Gi++]=Yi,Ki[Gi++]=Xi,$i=e.id,Yi=e.overflow,Xi=t),t=Bs(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(s){s=i.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=zu(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=zu(r,s):(s=Fu(s,l,n,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Ms(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~n,t.memoizedState=Fs,i}return e=(s=e.child).sibling,i=zu(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Bs(e,t){return(t=Mu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Rs(e,t,n,r){return null!==r&&pa(r),ba(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ls(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Da(e.return,t,n)}function Ns(e,t,n,r,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i)}function Us(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;if(bs(e,t,r.children,n),0!==(2&(r=Qa.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ls(e,n,t);else if(19===e.tag)Ls(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ci(Qa,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===eo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ns(t,!1,i,n,a);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===eo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ns(t,!0,n,null,a);break;case"together":Ns(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=zu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=zu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!ia)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ws(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Zs(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ws(t),null;case 1:case 17:return zi(t.type)&&Oi(),Ws(t),null;case 3:return r=t.stateNode,$a(),Ei(Ii),Ei(Di),no(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(da(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(au(aa),aa=null))),Ws(t),null;case 5:Ja(t);var i=Ga(Ka.current);if(n=t.type,null!==e&&null!=t.stateNode)zs(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Ws(t),null}if(e=Ga(Wa.current),da(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[hi]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Lr("cancel",r),Lr("close",r);break;case"iframe":case"object":case"embed":Lr("load",r);break;case"video":case"audio":for(i=0;i<Mr.length;i++)Lr(Mr[i],r);break;case"source":Lr("error",r);break;case"img":case"image":case"link":Lr("error",r),Lr("load",r);break;case"details":Lr("toggle",r);break;case"input":$(r,o),Lr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Lr("invalid",r);break;case"textarea":ie(r,o),Lr("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,u,e),i=["children",""+u]):s.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Lr("scroll",r)}switch(n){case"input":Z(r),Q(r,o,!0);break;case"textarea":Z(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Qr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,As(e,t),t.stateNode=e;e:{switch(l=_e(n,r),n){case"dialog":Lr("cancel",e),Lr("close",e),i=r;break;case"iframe":case"object":case"embed":Lr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Mr.length;i++)Lr(Mr[i],e);i=r;break;case"source":Lr("error",e),i=r;break;case"img":case"image":case"link":Lr("error",e),Lr("load",e),i=r;break;case"details":Lr("toggle",e),i=r;break;case"input":$(e,r),i=X(e,r),Lr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=B({},r,{value:void 0}),Lr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Lr("invalid",e)}for(o in ve(n,i),u=i)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?ge(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&de(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&he(e,c):"number"===typeof c&&he(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Lr("scroll",e):null!=c&&_(e,o,c,l))}switch(n){case"input":Z(e),Q(e,r,!1);break;case"textarea":Z(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Qr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ws(t),null;case 6:if(e&&null!=t.stateNode)Os(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ga(Ka.current),Ga(Wa.current),da(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(o=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ws(t),null;case 13:if(Ei(Qa),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ia&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),fa(),t.flags|=98560,o=!1;else if(o=da(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(a(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(a(317));o[hi]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ws(t),o=!1}else null!==aa&&(au(aa),aa=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Qa.current)?0===Ol&&(Ol=3):pu())),null!==t.updateQueue&&(t.flags|=4),Ws(t),null);case 4:return $a(),null===e&&Vr(t.stateNode.containerInfo),Ws(t),null;case 10:return Pa(t.type._context),Ws(t),null;case 19:if(Ei(Qa),null===(o=t.memoizedState))return Ws(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Hs(o,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=eo(e))){for(t.flags|=128,Hs(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ci(Qa,1&Qa.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Ul&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=eo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ia)return Ws(t),null}else 2*Ye()-o.renderingStartTime>Ul&&1073741824!==n&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=Qa.current,Ci(Qa,r?1&n|2:1&n),t):(Ws(t),null);case 22:case 23:return cu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Al)&&(Ws(t),6&t.subtreeFlags&&(t.flags|=8192)):Ws(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Ks(e,t){switch(ta(t),t.tag){case 1:return zi(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $a(),Ei(Ii),Ei(Di),no(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Ja(t),null;case 13:if(Ei(Qa),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(Qa),null;case 4:return $a(),null;case 10:return Pa(t.type._context),null;case 22:case 23:return cu(),null;default:return null}}As=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},zs=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ga(Wa.current);var a,o=null;switch(n){case"input":i=X(e,i),r=X(e,r),o=[];break;case"select":i=B({},i,{value:void 0}),r=B({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Qr)}for(c in ve(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(s.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(a in l)!l.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&l[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(s.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Lr("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Os=function(e,t,n,r){n!==r&&(t.flags|=4)};var Gs=!1,Xs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Ys=null;function Js(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){ku(e,t,r)}else n.current=null}function Qs(e,t,n){try{n()}catch(r){ku(e,t,r)}}var el=!1;function tl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,void 0!==a&&Qs(t,n,a)}i=i.next}while(i!==r)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function rl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function il(e){var t=e.alternate;null!==t&&(e.alternate=null,il(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function sl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Qr));else if(4!==r&&null!==(e=e.child))for(sl(e,t,n),e=e.sibling;null!==e;)sl(e,t,n),e=e.sibling}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}var ul=null,cl=!1;function dl(e,t,n){for(n=n.child;null!==n;)hl(e,t,n),n=n.sibling}function hl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(it,n)}catch(s){}switch(n.tag){case 5:Xs||Js(n,t);case 6:var r=ul,i=cl;ul=null,dl(e,t,n),cl=i,null!==(ul=r)&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(cl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Vt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=cl,ul=n.stateNode.containerInfo,cl=!0,dl(e,t,n),ul=r,cl=i;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var a=i,o=a.destroy;a=a.tag,void 0!==o&&(0!==(2&a)||0!==(4&a))&&Qs(n,t,o),i=i.next}while(i!==r)}dl(e,t,n);break;case 1:if(!Xs&&(Js(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){ku(n,t,s)}dl(e,t,n);break;case 21:dl(e,t,n);break;case 22:1&n.mode?(Xs=(r=Xs)||null!==n.memoizedState,dl(e,t,n),Xs=r):dl(e,t,n);break;default:dl(e,t,n)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $s),t.forEach(function(t){var r=Pu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,cl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,cl=!0;break e}l=l.return}if(null===ul)throw Error(a(160));hl(o,s,i),ul=null,cl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){ku(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),gl(e),4&r){try{tl(3,e,e.return),nl(3,e)}catch(g){ku(e,e.return,g)}try{tl(5,e,e.return)}catch(g){ku(e,e.return,g)}}break;case 1:pl(t,e),gl(e),512&r&&null!==n&&Js(n,n.return);break;case 5:if(pl(t,e),gl(e),512&r&&null!==n&&Js(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){ku(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(i,o),_e(l,s);var c=_e(l,o);for(s=0;s<u.length;s+=2){var d=u[s],h=u[s+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):_(i,d,h,c)}switch(l){case"input":J(i,o);break;case"textarea":ae(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){ku(e,e.return,g)}}break;case 6:if(pl(t,e),gl(e),4&r){if(null===e.stateNode)throw Error(a(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){ku(e,e.return,g)}}break;case 3:if(pl(t,e),gl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(g){ku(e,e.return,g)}break;case 4:default:pl(t,e),gl(e);break;case 13:pl(t,e),gl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(Nl=Ye())),4&r&&fl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Xs=(c=Xs)||d,pl(t,e),Xs=c):pl(t,e),gl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&0!==(1&e.mode))for(Ys=e,d=e.child;null!==d;){for(h=Ys=d;null!==Ys;){switch(p=(f=Ys).child,f.tag){case 0:case 11:case 14:case 15:tl(4,f,f.return);break;case 1:Js(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){ku(r,n,g)}}break;case 5:Js(f,f.return);break;case 22:if(null!==f.memoizedState){bl(h);continue}}null!==p?(p.return=f,Ys=p):bl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=h.stateNode,s=void 0!==(u=h.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",s))}catch(g){ku(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(g){ku(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),gl(e),4&r&&fl(e);case 21:}}function gl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),ll(e,ol(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;sl(e,ol(e),o);break;default:throw Error(a(161))}}catch(s){ku(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,n){Ys=e,vl(e,t,n)}function vl(e,t,n){for(var r=0!==(1&e.mode);null!==Ys;){var i=Ys,a=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Gs;if(!o){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Gs;var u=Xs;if(Gs=o,(Xs=l)&&!u)for(Ys=i;null!==Ys;)l=(o=Ys).child,22===o.tag&&null!==o.memoizedState?xl(i):null!==l?(l.return=o,Ys=l):xl(i);for(;null!==a;)Ys=a,vl(a,t,n),a=a.sibling;Ys=i,Gs=s,Xs=u}_l(e)}else 0!==(8772&i.subtreeFlags)&&null!==a?(a.return=i,Ys=a):_l(e)}}function _l(e){for(;null!==Ys;){var t=Ys;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||nl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Xs)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ns(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&qa(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qa(t,s,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(a(163))}Xs||512&t.flags&&rl(t)}catch(f){ku(t,t.return,f)}}if(t===e){Ys=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ys=n;break}Ys=t.return}}function bl(e){for(;null!==Ys;){var t=Ys;if(t===e){Ys=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ys=n;break}Ys=t.return}}function xl(e){for(;null!==Ys;){var t=Ys;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{nl(4,t)}catch(l){ku(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){ku(t,i,l)}}var a=t.return;try{rl(t)}catch(l){ku(t,a,l)}break;case 5:var o=t.return;try{rl(t)}catch(l){ku(t,o,l)}}}catch(l){ku(t,t.return,l)}if(t===e){Ys=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ys=s;break}Ys=t.return}}var wl,kl=Math.ceil,Sl=b.ReactCurrentDispatcher,El=b.ReactCurrentOwner,Cl=b.ReactCurrentBatchConfig,Pl=0,Dl=null,Il=null,Tl=0,Al=0,zl=Si(0),Ol=0,Fl=null,Ml=0,jl=0,Bl=0,Rl=null,Ll=null,Nl=0,Ul=1/0,Vl=null,ql=!1,Hl=null,Wl=null,Zl=!1,Kl=null,Gl=0,Xl=0,$l=null,Yl=-1,Jl=0;function Ql(){return 0!==(6&Pl)?Ye():-1!==Yl?Yl:Yl=Ye()}function eu(e){return 0===(1&e.mode)?1:0!==(2&Pl)&&0!==Tl?Tl&-Tl:null!==ma.transition?(0===Jl&&(Jl=mt()),Jl):0!==(e=_t)?e:e=void 0===(e=window.event)?16:$t(e.type)}function tu(e,t,n,r){if(50<Xl)throw Xl=0,$l=null,Error(a(185));yt(e,n,r),0!==(2&Pl)&&e===Dl||(e===Dl&&(0===(2&Pl)&&(jl|=n),4===Ol&&ou(e,Tl)),nu(e,r),1===n&&0===Pl&&0===(1&t.mode)&&(Ul=Ye()+500,Li&&Vi()))}function nu(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-ot(a),s=1<<o,l=i[o];-1===l?0!==(s&n)&&0===(s&r)||(i[o]=ft(s,t)):l<=t&&(e.expiredLanes|=s),a&=~s}}(e,t);var r=ht(e,e===Dl?Tl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Li=!0,Ui(e)}(su.bind(null,e)):Ui(su.bind(null,e)),oi(function(){0===(6&Pl)&&Vi()}),n=null;else{switch(bt(r)){case 1:n=Qe;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Du(n,ru.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ru(e,t){if(Yl=-1,Jl=0,0!==(6&Pl))throw Error(a(327));var n=e.callbackNode;if(xu()&&e.callbackNode!==n)return null;var r=ht(e,e===Dl?Tl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mu(e,r);else{t=r;var i=Pl;Pl|=2;var o=fu();for(Dl===e&&Tl===t||(Vl=null,Ul=Ye()+500,du(e,t));;)try{yu();break}catch(l){hu(e,l)}Ca(),Sl.current=o,Pl=i,null!==Il?t=0:(Dl=null,Tl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=iu(e,i))),1===t)throw n=Fl,du(e,0),ou(e,r),nu(e,Ye()),n;if(6===t)ou(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!sr(a(),i))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mu(e,r))&&(0!==(o=pt(e))&&(r=o,t=iu(e,o))),1===t))throw n=Fl,du(e,0),ou(e,r),nu(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:bu(e,Ll,Vl);break;case 3:if(ou(e,r),(130023424&r)===r&&10<(t=Nl+500-Ye())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){Ql(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(bu.bind(null,e,Ll,Vl),t);break}bu(e,Ll,Vl);break;case 4:if(ou(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>i&&(i=s),r&=~o}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=ri(bu.bind(null,e,Ll,Vl),r);break}bu(e,Ll,Vl);break;default:throw Error(a(329))}}}return nu(e,Ye()),e.callbackNode===n?ru.bind(null,e):null}function iu(e,t){var n=Rl;return e.current.memoizedState.isDehydrated&&(du(e,t).flags|=256),2!==(e=mu(e,t))&&(t=Ll,Ll=n,null!==t&&au(t)),e}function au(e){null===Ll?Ll=e:Ll.push.apply(Ll,e)}function ou(e,t){for(t&=~Bl,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function su(e){if(0!==(6&Pl))throw Error(a(327));xu();var t=ht(e,0);if(0===(1&t))return nu(e,Ye()),null;var n=mu(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=iu(e,r))}if(1===n)throw n=Fl,du(e,0),ou(e,t),nu(e,Ye()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bu(e,Ll,Vl),nu(e,Ye()),null}function lu(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(Ul=Ye()+500,Li&&Vi())}}function uu(e){null!==Kl&&0===Kl.tag&&0===(6&Pl)&&xu();var t=Pl;Pl|=1;var n=Cl.transition,r=_t;try{if(Cl.transition=null,_t=1,e)return e()}finally{_t=r,Cl.transition=n,0===(6&(Pl=t))&&Vi()}}function cu(){Al=zl.current,Ei(zl)}function du(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Il)for(n=Il.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:$a(),Ei(Ii),Ei(Di),no();break;case 5:Ja(r);break;case 4:$a();break;case 13:case 19:Ei(Qa);break;case 10:Pa(r.type._context);break;case 22:case 23:cu()}n=n.return}if(Dl=e,Il=e=zu(e.current,null),Tl=Al=t,Ol=0,Fl=null,Bl=jl=Ml=0,Ll=Rl=null,null!==Aa){for(t=0;t<Aa.length;t++)if(null!==(r=(n=Aa[t]).interleaved)){n.interleaved=null;var i=r.next,a=n.pending;if(null!==a){var o=a.next;a.next=i,r.next=o}n.pending=r}Aa=null}return e}function hu(e,t){for(;;){var n=Il;try{if(Ca(),ro.current=Jo,uo){for(var r=oo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}uo=!1}if(ao=0,lo=so=oo=null,co=!1,ho=0,El.current=null,null===n||null===n.return){Ol=1,Fl=t,Il=null;break}e:{var o=e,s=n.return,l=n,u=t;if(t=Tl,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=gs(s);if(null!==p){p.flags&=-257,ys(p,s,l,0,t),1&p.mode&&ms(o,c,t),u=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){ms(o,c,t),pu();break e}u=Error(a(426))}else if(ia&&1&l.mode){var y=gs(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),ys(y,s,l,0,t),pa(us(u,l));break e}}o=u=us(u,l),4!==Ol&&(Ol=2),null===Rl?Rl=[o]:Rl.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ua(o,fs(0,u,t));break e;case 1:l=u;var v=o.type,_=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Wl||!Wl.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,Ua(o,ps(o,l,t));break e}}o=o.return}while(null!==o)}_u(n)}catch(b){t=b,Il===n&&null!==n&&(Il=n=n.return);continue}break}}function fu(){var e=Sl.current;return Sl.current=Jo,null===e?Jo:e}function pu(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Dl||0===(268435455&Ml)&&0===(268435455&jl)||ou(Dl,Tl)}function mu(e,t){var n=Pl;Pl|=2;var r=fu();for(Dl===e&&Tl===t||(Vl=null,du(e,t));;)try{gu();break}catch(i){hu(e,i)}if(Ca(),Pl=n,Sl.current=r,null!==Il)throw Error(a(261));return Dl=null,Tl=0,Ol}function gu(){for(;null!==Il;)vu(Il)}function yu(){for(;null!==Il&&!Xe();)vu(Il)}function vu(e){var t=wl(e.alternate,e,Al);e.memoizedProps=e.pendingProps,null===t?_u(e):Il=t,El.current=null}function _u(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Zs(n,t,Al)))return void(Il=n)}else{if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Il=n);if(null===e)return Ol=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Ol&&(Ol=5)}function bu(e,t,n){var r=_t,i=Cl.transition;try{Cl.transition=null,_t=1,function(e,t,n,r){do{xu()}while(null!==Kl);if(0!==(6&Pl))throw Error(a(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),a=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~a}}(e,o),e===Dl&&(Il=Dl=null,Tl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Zl||(Zl=!0,Du(tt,function(){return xu(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cl.transition,Cl.transition=null;var s=_t;_t=1;var l=Pl;Pl|=4,El.current=null,function(e,t){if(ei=Ht,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(x){n=null;break e}var s=0,l=-1,u=-1,c=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=s+i),h!==o||0!==r&&3!==h.nodeType||(u=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++c===i&&(l=s),f===o&&++d===r&&(u=s),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Ys=t;null!==Ys;)if(e=(t=Ys).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ys=e;else for(;null!==Ys;){t=Ys;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ns(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(a(163))}}catch(x){ku(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Ys=e;break}Ys=t.return}m=el,el=!1}(e,n),ml(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,yl(n,e,i),$e(),Pl=l,_t=s,Cl.transition=o}else e.current=n;if(Zl&&(Zl=!1,Kl=e,Gl=i),o=e.pendingLanes,0===o&&(Wl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),nu(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Hl,Hl=null,e;0!==(1&Gl)&&0!==e.tag&&xu(),o=e.pendingLanes,0!==(1&o)?e===$l?Xl++:(Xl=0,$l=e):Xl=0,Vi()}(e,t,n,r)}finally{Cl.transition=i,_t=r}return null}function xu(){if(null!==Kl){var e=bt(Gl),t=Cl.transition,n=_t;try{if(Cl.transition=null,_t=16>e?16:e,null===Kl)var r=!1;else{if(e=Kl,Kl=null,Gl=0,0!==(6&Pl))throw Error(a(331));var i=Pl;for(Pl|=4,Ys=e.current;null!==Ys;){var o=Ys,s=o.child;if(0!==(16&Ys.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Ys=c;null!==Ys;){var d=Ys;switch(d.tag){case 0:case 11:case 15:tl(8,d,o)}var h=d.child;if(null!==h)h.return=d,Ys=h;else for(;null!==Ys;){var f=(d=Ys).sibling,p=d.return;if(il(d),d===c){Ys=null;break}if(null!==f){f.return=p,Ys=f;break}Ys=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Ys=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Ys=s;else e:for(;null!==Ys;){if(0!==(2048&(o=Ys).flags))switch(o.tag){case 0:case 11:case 15:tl(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,Ys=v;break e}Ys=o.return}}var _=e.current;for(Ys=_;null!==Ys;){var b=(s=Ys).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Ys=b;else e:for(s=_;null!==Ys;){if(0!==(2048&(l=Ys).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(w){ku(l,l.return,w)}if(l===s){Ys=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Ys=x;break e}Ys=l.return}}if(Pl=i,Vi(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(it,e)}catch(w){}r=!0}return r}finally{_t=n,Cl.transition=t}}return!1}function wu(e,t,n){e=La(e,t=fs(0,t=us(n,t),1),1),t=Ql(),null!==e&&(yt(e,1,t),nu(e,t))}function ku(e,t,n){if(3===e.tag)wu(e,e,n);else for(;null!==t;){if(3===t.tag){wu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Wl||!Wl.has(r))){t=La(t,e=ps(t,e=us(n,e),1),1),e=Ql(),null!==t&&(yt(t,1,e),nu(t,e));break}}t=t.return}}function Su(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ql(),e.pingedLanes|=e.suspendedLanes&n,Dl===e&&(Tl&n)===n&&(4===Ol||3===Ol&&(130023424&Tl)===Tl&&500>Ye()-Nl?du(e,0):Bl|=n),nu(e,t)}function Eu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=Ql();null!==(e=Fa(e,t))&&(yt(e,t,n),nu(e,n))}function Cu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Eu(e,n)}function Pu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Eu(e,n)}function Du(e,t){return Ke(e,t)}function Iu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tu(e,t,n,r){return new Iu(e,t,n,r)}function Au(e){return!(!(e=e.prototype)||!e.isReactComponent)}function zu(e,t){var n=e.alternate;return null===n?((n=Tu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ou(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Au(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Fu(n.children,i,o,t);case S:s=8,i|=8;break;case E:return(e=Tu(12,n,t,2|i)).elementType=E,e.lanes=o,e;case I:return(e=Tu(13,n,t,i)).elementType=I,e.lanes=o,e;case T:return(e=Tu(19,n,t,i)).elementType=T,e.lanes=o,e;case O:return Mu(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:s=10;break e;case P:s=9;break e;case D:s=11;break e;case A:s=14;break e;case z:s=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Tu(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fu(e,t,n,r){return(e=Tu(7,e,r,t)).lanes=n,e}function Mu(e,t,n,r){return(e=Tu(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function ju(e,t,n){return(e=Tu(6,e,null,t)).lanes=n,e}function Bu(e,t,n){return(t=Tu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ru(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lu(e,t,n,r,i,a,o,s,l){return e=new Ru(e,t,n,s,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Tu(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ja(a),e}function Nu(e){if(!e)return Pi;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(zi(n))return Mi(e,n,t)}return t}function Uu(e,t,n,r,i,a,o,s,l){return(e=Lu(n,r,!0,e,0,a,0,s,l)).context=Nu(null),n=e.current,(a=Ra(r=Ql(),i=eu(n))).callback=void 0!==t&&null!==t?t:null,La(n,a,i),e.current.lanes=i,yt(e,i,r),nu(e,r),e}function Vu(e,t,n,r){var i=t.current,a=Ql(),o=eu(i);return n=Nu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Ra(a,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=La(i,t,o))&&(tu(e,i,o,a),Na(e,i,o)),o}function qu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Hu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Wu(e,t){Hu(e,t),(e=e.alternate)&&Hu(e,t)}wl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)_s=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return _s=!1,function(e,t,n){switch(t.tag){case 3:Is(t),fa();break;case 5:Ya(t);break;case 1:zi(t.type)&&ji(t);break;case 4:Xa(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ci(wa,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ci(Qa,1&Qa.current),t.flags|=128,null):0!==(n&t.child.childLanes)?js(e,t,n):(Ci(Qa,1&Qa.current),null!==(e=qs(e,t,n))?e.sibling:null);Ci(Qa,1&Qa.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Us(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ci(Qa,Qa.current),r)break;return null;case 22:case 23:return t.lanes=0,Ss(e,t,n)}return qs(e,t,n)}(e,t,n);_s=0!==(131072&e.flags)}else _s=!1,ia&&0!==(1048576&t.flags)&&Qi(t,Zi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Vs(e,t),e=t.pendingProps;var i=Ai(t,Di.current);Ia(t,n),i=go(null,t,r,e,i,n);var o=yo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zi(r)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,ja(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,r,e,n),t=Ds(null,t,r,!0,o,n)):(t.tag=0,ia&&o&&ea(t),bs(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Au(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===D)return 11;if(e===A)return 14}return 2}(r),e=ns(r,e),i){case 0:t=Cs(null,t,r,e,n);break e;case 1:t=Ps(null,t,r,e,n);break e;case 11:t=xs(null,t,r,e,n);break e;case 14:t=ws(null,t,r,ns(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Cs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 1:return r=t.type,i=t.pendingProps,Ps(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 3:e:{if(Is(t),null===e)throw Error(a(387));r=t.pendingProps,i=(o=t.memoizedState).element,Ba(e,t),Va(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ts(e,t,r,n,i=us(Error(a(423)),t));break e}if(r!==i){t=Ts(e,t,r,n,i=us(Error(a(424)),t));break e}for(ra=ui(t.stateNode.containerInfo.firstChild),na=t,ia=!0,aa=null,n=xa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===i){t=qs(e,t,n);break e}bs(e,t,r,n)}t=t.child}return t;case 5:return Ya(t),null===e&&ua(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,ni(r,i)?s=null:null!==o&&ni(r,o)&&(t.flags|=32),Es(e,t),bs(e,t,s,n),t.child;case 6:return null===e&&ua(t),null;case 13:return js(e,t,n);case 4:return Xa(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ba(t,null,r,n):bs(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xs(e,t,r,i=t.elementType===r?i:ns(r,i),n);case 7:return bs(e,t,t.pendingProps,n),t.child;case 8:case 12:return bs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,s=i.value,Ci(wa,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===i.children&&!Ii.current){t=qs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){s=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Ra(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),Da(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(a(341));s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),Da(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}bs(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Ia(t,n),r=r(i=Ta(i)),t.flags|=1,bs(e,t,r,n),t.child;case 14:return i=ns(r=t.type,t.pendingProps),ws(e,t,r,i=ns(r.type,i),n);case 15:return ks(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ns(r,i),Vs(e,t),t.tag=1,zi(r)?(e=!0,ji(t)):e=!1,Ia(t,n),os(t,r,i),ls(t,r,i,n),Ds(null,t,r,!0,e,n);case 19:return Us(e,t,n);case 22:return Ss(e,t,n)}throw Error(a(156,t.tag))};var Zu="function"===typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Gu(e){this._internalRoot=e}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $u(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yu(){}function Ju(e,t,n,r,i){var a=n._reactRootContainer;if(a){var o=a;if("function"===typeof i){var s=i;i=function(){var e=qu(o);s.call(e)}}Vu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var a=r;r=function(){var e=qu(o);a.call(e)}}var o=Uu(t,r,e,0,null,!1,0,"",Yu);return e._reactRootContainer=o,e[pi]=o.current,Vr(8===e.nodeType?e.parentNode:e),uu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var s=r;r=function(){var e=qu(l);s.call(e)}}var l=Lu(e,0,!1,null,0,!1,0,"",Yu);return e._reactRootContainer=l,e[pi]=l.current,Vr(8===e.nodeType?e.parentNode:e),uu(function(){Vu(t,l,n,r)}),l}(n,t,e,i,r);return qu(o)}Gu.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));Vu(e,t,null,null)},Gu.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uu(function(){Vu(null,e,null,null)}),t[pi]=null}},Gu.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Bt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),nu(t,Ye()),0===(6&Pl)&&(Ul=Ye()+500,Vi()))}break;case 13:uu(function(){var t=Fa(e,1);if(null!==t){var n=Ql();tu(t,e,1,n)}}),Wu(e,1)}},wt=function(e){if(13===e.tag){var t=Fa(e,134217728);if(null!==t)tu(t,e,134217728,Ql());Wu(e,134217728)}},kt=function(e){if(13===e.tag){var t=eu(e),n=Fa(e,t);if(null!==n)tu(n,e,t,Ql());Wu(e,t)}},St=function(){return _t},Et=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},we=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(a(90));K(r),J(r,i)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},De=lu,Ie=uu;var Qu={usingClientEntryPoint:!1,Events:[_i,bi,xi,Ce,Pe,lu]},ec={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tc={bundleType:ec.bundleType,version:ec.version,rendererPackageName:ec.rendererPackageName,rendererConfig:ec.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:ec.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nc.isDisabled&&nc.supportsFiber)try{it=nc.inject(tc),at=nc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Qu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xu(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Xu(e))throw Error(a(299));var n=!1,r="",i=Zu;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Lu(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uu(e)},t.hydrate=function(e,t,n){if(!$u(t))throw Error(a(200));return Ju(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Xu(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",s=Zu;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Uu(t,null,e,1,null!=n?n:null,i,0,o,s),e[pi]=t.current,Vr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Gu(t)},t.render=function(e,t,n){if(!$u(t))throw Error(a(200));return Ju(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$u(e))throw Error(a(40));return!!e._reactRootContainer&&(uu(function(){Ju(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=lu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$u(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Ju(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},736(e,t,n){var r=n(738).default,i=n(45);e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},738(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},853(e,t,n){"use strict";e.exports=n(234)},871(e,t,n){"use strict";e=n.nmd(e);var r,i=Object.create,a=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptor,l=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,d=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable,p=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,m=(e,t)=>{for(var n in t||(t={}))h.call(t,n)&&p(e,n,t[n]);if(c)for(var n of c(t))f.call(t,n)&&p(e,n,t[n]);return e},g=(e,t)=>o(e,l(t)),y=(e,t)=>function(){return t||(0,e[u(e)[0]])((t={exports:{}}).exports,t),t.exports},v=(e,t)=>{for(var n in t)a(e,n,{get:t[n],enumerable:!0})},_=(e,t,n,r)=>{if(t&&"object"===typeof t||"function"===typeof t)for(let i of u(t))h.call(e,i)||i===n||a(e,i,{get:()=>t[i],enumerable:!(r=s(t,i))||r.enumerable});return e},b=(e,t,n)=>(n=null!=e?i(d(e)):{},_(!t&&e&&e.__esModule?n:a(n,"default",{value:e,enumerable:!0}),e)),x=(e,t,n)=>(p(e,"symbol"!==typeof t?t+"":t,n),n),w=y({"../node_modules/timing-function/lib/UnitBezier.js"(e,t){t.exports=function(){function e(e,t,n,r){this.set(e,t,n,r)}return e.prototype.set=function(e,t,n,r){this._cx=3*e,this._bx=3*(n-e)-this._cx,this._ax=1-this._cx-this._bx,this._cy=3*t,this._by=3*(r-t)-this._cy,this._ay=1-this._cy-this._by},e.epsilon=1e-6,e.prototype._sampleCurveX=function(e){return((this._ax*e+this._bx)*e+this._cx)*e},e.prototype._sampleCurveY=function(e){return((this._ay*e+this._by)*e+this._cy)*e},e.prototype._sampleCurveDerivativeX=function(e){return(3*this._ax*e+2*this._bx)*e+this._cx},e.prototype._solveCurveX=function(e,t){var n,r,i,a,o,s;for(i=void 0,a=void 0,o=void 0,s=void 0,n=void 0,r=void 0,o=e,r=0;r<8;){if(s=this._sampleCurveX(o)-e,Math.abs(s)<t)return o;if(n=this._sampleCurveDerivativeX(o),Math.abs(n)<t)break;o-=s/n,r++}if((o=e)<(i=0))return i;if(o>(a=1))return a;for(;i<a;){if(s=this._sampleCurveX(o),Math.abs(s-e)<t)return o;e>s?i=o:a=o,o=.5*(a-i)+i}return o},e.prototype.solve=function(e,t){return this._sampleCurveY(this._solveCurveX(e,t))},e.prototype.solveSimple=function(e){return this._sampleCurveY(this._solveCurveX(e,1e-6))},e}()}}),k=y({"../node_modules/levenshtein-edit-distance/index.js"(e,t){var n,r;n=[],r=[],t.exports=function(e,t,i){var a,o,s,l,u,c,d,h;if(e===t)return 0;if(a=e.length,o=t.length,0===a)return o;if(0===o)return a;for(i&&(e=e.toLowerCase(),t=t.toLowerCase()),d=0;d<a;)r[d]=e.charCodeAt(d),n[d]=++d;for(h=0;h<o;)for(s=t.charCodeAt(h),l=u=h++,d=-1;++d<a;)c=s===r[d]?u:u+1,u=n[d],n[d]=l=u>l?c>l?l+1:c:c>u?u+1:c;return l}}}),S=y({"../node_modules/propose/propose.js"(e,t){var n=k();t.exports=function(){var e,t,r,i,a,o=0,s=arguments[0],l=arguments[1],u=l.length,c=arguments[2];c&&(i=c.threshold,a=c.ignoreCase),void 0===i&&(i=0);for(var d=0;d<u;++d)(e=(t=a?n(s,l[d],!0):n(s,l[d]))>s.length?1-t/l[d].length:1-t/s.length)>o&&(o=e,r=l[d]);return o>=i?r:null}}}),E=y({"../node_modules/fast-deep-equal/index.js"(e,t){t.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,a[i]))return!1;for(i=r;0!==i--;){var o=a[i];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}}}),C={};v(C,{createRafDriver:()=>xo,getProject:()=>bl,notify:()=>go,onChange:()=>wl,types:()=>zo,val:()=>kl}),e.exports=(r=C,_(a({},"__esModule",{value:!0}),r));var P={};v(P,{createRafDriver:()=>xo,getProject:()=>bl,notify:()=>go,onChange:()=>wl,types:()=>zo,val:()=>kl});var D=n(194),I=new class{constructor(){x(this,"atom",new D.Atom({projects:{}}))}add(e,t){this.atom.setByPointer(t=>t.projects[e],t)}get(e){return this.atom.get().projects[e]}has(e){return!!this.get(e)}},T=new WeakMap;function A(e){return T.get(e)}function z(e,t){T.set(e,t)}var O=[],F=Array.isArray,M="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,j="object"==typeof self&&self&&self.Object===Object&&self,B=M||j||Function("return this")(),R=B.Symbol,L=Object.prototype,N=L.hasOwnProperty,U=L.toString,V=R?R.toStringTag:void 0;var q=function(e){var t=N.call(e,V),n=e[V];try{e[V]=void 0;var r=!0}catch(a){}var i=U.call(e);return r&&(t?e[V]=n:delete e[V]),i},H=Object.prototype.toString;var W=function(e){return H.call(e)},Z=R?R.toStringTag:void 0;var K=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Z&&Z in Object(e)?q(e):W(e)};var G=function(e){return null!=e&&"object"==typeof e};var X=function(e){return"symbol"==typeof e||G(e)&&"[object Symbol]"==K(e)},$=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/;var J=function(e,t){if(F(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!X(e))||(Y.test(e)||!$.test(e)||null!=t&&e in Object(t))};var Q=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var ee=function(e){if(!Q(e))return!1;var t=K(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},te=B["__core-js_shared__"],ne=function(){var e=/[^.]+$/.exec(te&&te.keys&&te.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var re=function(e){return!!ne&&ne in e},ie=Function.prototype.toString;var ae=function(e){if(null!=e){try{return ie.call(e)}catch(t){}try{return e+""}catch(t){}}return""},oe=/^\[object .+?Constructor\]$/,se=Function.prototype,le=Object.prototype,ue=se.toString,ce=le.hasOwnProperty,de=RegExp("^"+ue.call(ce).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var he=function(e){return!(!Q(e)||re(e))&&(ee(e)?de:oe).test(ae(e))};var fe=function(e,t){return null==e?void 0:e[t]};var pe=function(e,t){var n=fe(e,t);return he(n)?n:void 0},me=pe(Object,"create");var ge=function(){this.__data__=me?me(null):{},this.size=0};var ye=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ve=Object.prototype.hasOwnProperty;var _e=function(e){var t=this.__data__;if(me){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return ve.call(t,e)?t[e]:void 0},be=Object.prototype.hasOwnProperty;var xe=function(e){var t=this.__data__;return me?void 0!==t[e]:be.call(t,e)};var we=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=me&&void 0===t?"__lodash_hash_undefined__":t,this};function ke(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ke.prototype.clear=ge,ke.prototype.delete=ye,ke.prototype.get=_e,ke.prototype.has=xe,ke.prototype.set=we;var Se=ke;var Ee=function(){this.__data__=[],this.size=0};var Ce=function(e,t){return e===t||e!==e&&t!==t};var Pe=function(e,t){for(var n=e.length;n--;)if(Ce(e[n][0],t))return n;return-1},De=Array.prototype.splice;var Ie=function(e){var t=this.__data__,n=Pe(t,e);return!(n<0)&&(n==t.length-1?t.pop():De.call(t,n,1),--this.size,!0)};var Te=function(e){var t=this.__data__,n=Pe(t,e);return n<0?void 0:t[n][1]};var Ae=function(e){return Pe(this.__data__,e)>-1};var ze=function(e,t){var n=this.__data__,r=Pe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Oe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Oe.prototype.clear=Ee,Oe.prototype.delete=Ie,Oe.prototype.get=Te,Oe.prototype.has=Ae,Oe.prototype.set=ze;var Fe=Oe,Me=pe(B,"Map");var je=function(){this.size=0,this.__data__={hash:new Se,map:new(Me||Fe),string:new Se}};var Be=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Re=function(e,t){var n=e.__data__;return Be(t)?n["string"==typeof t?"string":"hash"]:n.map};var Le=function(e){var t=Re(this,e).delete(e);return this.size-=t?1:0,t};var Ne=function(e){return Re(this,e).get(e)};var Ue=function(e){return Re(this,e).has(e)};var Ve=function(e,t){var n=Re(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function qe(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}qe.prototype.clear=je,qe.prototype.delete=Le,qe.prototype.get=Ne,qe.prototype.has=Ue,qe.prototype.set=Ve;var He=qe;function We(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(We.Cache||He),n}We.Cache=He;var Ze=We;var Ke=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ge=/\\(\\)?/g,Xe=function(e){var t=Ze(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ke,function(e,n,r,i){t.push(r?i.replace(Ge,"$1"):n||e)}),t});var $e=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},Ye=R?R.prototype:void 0,Je=Ye?Ye.toString:void 0;var Qe=function e(t){if("string"==typeof t)return t;if(F(t))return $e(t,e)+"";if(X(t))return Je?Je.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n};var et=function(e){return null==e?"":Qe(e)};var tt=function(e,t){return F(e)?e:J(e,t)?[e]:Xe(et(e))};var nt=function(e){if("string"==typeof e||X(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t};var rt=function(e,t){for(var n=0,r=(t=tt(t,e)).length;null!=e&&n<r;)e=e[nt(t[n++])];return n&&n==r?e:void 0};var it=function(e,t,n){var r=null==e?void 0:rt(e,t);return void 0===r?n:r};function at(e,t){return 0===t.length?e:it(e,t)}var ot=class{constructor(){x(this,"_values",{})}get(e,t){if(this.has(e))return this._values[e];{const n=t();return this._values[e]=n,n}}has(e){return this._values.hasOwnProperty(e)}},st=n(194),lt=function(){try{var e=pe(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();var ut=function(e,t,n){"__proto__"==t&&lt?lt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},ct=Object.prototype.hasOwnProperty;var dt=function(e,t,n){var r=e[t];ct.call(e,t)&&Ce(r,n)&&(void 0!==n||t in e)||ut(e,t,n)},ht=/^(?:0|[1-9]\d*)$/;var ft=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&ht.test(e))&&e>-1&&e%1==0&&e<t};var pt=function(e,t,n,r){if(!Q(e))return e;for(var i=-1,a=(t=tt(t,e)).length,o=a-1,s=e;null!=s&&++i<a;){var l=nt(t[i]),u=n;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(i!=o){var c=s[l];void 0===(u=r?r(c,l,s):void 0)&&(u=Q(c)?c:ft(t[i+1])?[]:{})}dt(s,l,u),s=s[l]}return e};var mt=function(e,t,n){return null==e?e:pt(e,t,n)},gt=new WeakMap;function yt(e){if(gt.has(e))return gt.get(e);const t="compound"===e.type?function(e){const t={};for(const[n,r]of Object.entries(e.props))t[n]=yt(r);return t}(e):"enum"===e.type?function(e){const t={$case:e.defaultCase};for(const[n,r]of Object.entries(e.cases))t[n]=yt(r);return t}(e):e.default;return gt.set(e,t),t}var vt=n(194),_t=b(w());function bt(e,t,n){return(0,vt.prism)(()=>{const r=(0,vt.val)(t),i=vt.prism.memo("driver",()=>r?"BasicKeyframedTrack"===r.type?function(e,t,n){return(0,vt.prism)(()=>{let e=vt.prism.ref("state",{started:!1}),r=e.current;const i=n.getValue();return(!r.started||i<r.validFrom||r.validTo<=i)&&(e.current=r=function(e,t,n){const r=t.getValue();if(0===n.keyframes.length)return{started:!0,validFrom:-1/0,validTo:1/0,der:xt};let i=0;for(;;){const e=n.keyframes[i];if(!e)return wt.error;const a=i===n.keyframes.length-1;if(r<e.position)return 0===i?wt.beforeFirstKeyframe(e):wt.error;if(e.position===r)return a?wt.lastKeyframe(e):wt.between(e,n.keyframes[i+1],t);if(i===n.keyframes.length-1)return wt.lastKeyframe(e);{const a=i+1;if(n.keyframes[a].position<=r){i=a;continue}return wt.between(e,n.keyframes[i+1],t)}}}(0,n,t)),r.der.getValue()})}(0,r,n):(e.logger.error("Track type not yet supported."),(0,vt.prism)(()=>{})):(0,vt.prism)(()=>{}),[r]);return i.getValue()})}var xt=(0,vt.prism)(()=>{});var wt={beforeFirstKeyframe:e=>({started:!0,validFrom:-1/0,validTo:e.position,der:(0,vt.prism)(()=>({left:e.value,progression:0}))}),lastKeyframe:e=>({started:!0,validFrom:e.position,validTo:1/0,der:(0,vt.prism)(()=>({left:e.value,progression:0}))}),between(e,t,n){if(!e.connectedRight)return{started:!0,validFrom:e.position,validTo:t.position,der:(0,vt.prism)(()=>({left:e.value,progression:0}))};const r=n=>(n-e.position)/(t.position-e.position);if(!e.type||"bezier"===e.type){const i=new _t.default(e.handles[2],e.handles[3],t.handles[0],t.handles[1]),a=(0,vt.prism)(()=>{const a=r(n.getValue()),o=i.solveSimple(a);return{left:e.value,right:t.value,progression:o}});return{started:!0,validFrom:e.position,validTo:t.position,der:a}}const i=(0,vt.prism)(()=>{const i=r(n.getValue()),a=Math.floor(i);return{left:e.value,right:t.value,progression:a}});return{started:!0,validFrom:e.position,validTo:t.position,der:i}},error:{started:!0,validFrom:-1/0,validTo:1/0,der:xt}};function kt(e,t,n){const r=n.get(e);if(r&&r.override===t)return r.merged;const i=m({},e);for(const a of Object.keys(t)){const r=t[a],o=e[a];i[a]="object"===typeof r&&"object"===typeof o?kt(o,r,n):void 0===r?o:r}return n.set(e,{override:t,merged:i}),i}function St(e,t){let n=e;for(const r of t)n=n[r];return n}var Et=n(194),Ct=n(194),Pt=n(194),Dt=/\s/;var It=function(e){for(var t=e.length;t--&&Dt.test(e.charAt(t)););return t},Tt=/^\s+/;var At=function(e){return e?e.slice(0,It(e)+1).replace(Tt,""):e},zt=/^[-+]0x[0-9a-f]+$/i,Ot=/^0b[01]+$/i,Ft=/^0o[0-7]+$/i,Mt=parseInt;var jt=function(e){if("number"==typeof e)return e;if(X(e))return NaN;if(Q(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Q(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=At(e);var n=Ot.test(e);return n||Ft.test(e)?Mt(e.slice(2),n?2:8):zt.test(e)?NaN:+e},Bt=1/0;var Rt=function(e){return e?(e=jt(e))===Bt||e===-1/0?17976931348623157e292*(e<0?-1:1):e===e?e:0:0===e?e:0};var Lt=function(e){var t=Rt(e),n=t%1;return t===t?n?t-n:t:0};var Nt=function(e){return e},Ut=pe(B,"WeakMap"),Vt=Object.create,qt=function(){function e(){}return function(t){if(!Q(t))return{};if(Vt)return Vt(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Ht=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t};var Wt=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e};var Zt=function(e,t,n,r){var i=!n;n||(n={});for(var a=-1,o=t.length;++a<o;){var s=t[a],l=r?r(n[s],e[s],s,n,e):void 0;void 0===l&&(l=e[s]),i?ut(n,s,l):dt(n,s,l)}return n};var Kt=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Gt=function(e){return null!=e&&Kt(e.length)&&!ee(e)},Xt=Object.prototype;var $t=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Xt)};var Yt=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r};var Jt=function(e){return G(e)&&"[object Arguments]"==K(e)},Qt=Object.prototype,en=Qt.hasOwnProperty,tn=Qt.propertyIsEnumerable,nn=Jt(function(){return arguments}())?Jt:function(e){return G(e)&&en.call(e,"callee")&&!tn.call(e,"callee")},rn=nn;var an=function(){return!1},on=t&&!t.nodeType&&t,sn=on&&e&&!e.nodeType&&e,ln=sn&&sn.exports===on?B.Buffer:void 0,un=(ln?ln.isBuffer:void 0)||an,cn={};cn["[object Float32Array]"]=cn["[object Float64Array]"]=cn["[object Int8Array]"]=cn["[object Int16Array]"]=cn["[object Int32Array]"]=cn["[object Uint8Array]"]=cn["[object Uint8ClampedArray]"]=cn["[object Uint16Array]"]=cn["[object Uint32Array]"]=!0,cn["[object Arguments]"]=cn["[object Array]"]=cn["[object ArrayBuffer]"]=cn["[object Boolean]"]=cn["[object DataView]"]=cn["[object Date]"]=cn["[object Error]"]=cn["[object Function]"]=cn["[object Map]"]=cn["[object Number]"]=cn["[object Object]"]=cn["[object RegExp]"]=cn["[object Set]"]=cn["[object String]"]=cn["[object WeakMap]"]=!1;var dn=function(e){return G(e)&&Kt(e.length)&&!!cn[K(e)]};var hn=function(e){return function(t){return e(t)}},fn=t&&!t.nodeType&&t,pn=fn&&e&&!e.nodeType&&e,mn=pn&&pn.exports===fn&&M.process,gn=function(){try{var e=pn&&pn.require&&pn.require("util").types;return e||mn&&mn.binding&&mn.binding("util")}catch(t){}}(),yn=gn&&gn.isTypedArray,vn=yn?hn(yn):dn,_n=Object.prototype.hasOwnProperty;var bn=function(e,t){var n=F(e),r=!n&&rn(e),i=!n&&!r&&un(e),a=!n&&!r&&!i&&vn(e),o=n||r||i||a,s=o?Yt(e.length,String):[],l=s.length;for(var u in e)!t&&!_n.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||ft(u,l))||s.push(u);return s};var xn=function(e,t){return function(n){return e(t(n))}},wn=xn(Object.keys,Object),kn=Object.prototype.hasOwnProperty;var Sn=function(e){if(!$t(e))return wn(e);var t=[];for(var n in Object(e))kn.call(e,n)&&"constructor"!=n&&t.push(n);return t};var En=function(e){return Gt(e)?bn(e):Sn(e)};var Cn=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},Pn=Object.prototype.hasOwnProperty;var Dn=function(e){if(!Q(e))return Cn(e);var t=$t(e),n=[];for(var r in e)("constructor"!=r||!t&&Pn.call(e,r))&&n.push(r);return n};var In=function(e){return Gt(e)?bn(e,!0):Dn(e)};var Tn=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},An=xn(Object.getPrototypeOf,Object),zn=Function.prototype,On=Object.prototype,Fn=zn.toString,Mn=On.hasOwnProperty,jn=Fn.call(Object);var Bn=function(e){if(!G(e)||"[object Object]"!=K(e))return!1;var t=An(e);if(null===t)return!0;var n=Mn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Fn.call(n)==jn};var Rn=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var a=Array(i);++r<i;)a[r]=e[r+t];return a};var Ln=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:Rn(e,t,n)},Nn=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Un=function(e){return Nn.test(e)};var Vn=function(e){return e.split("")},qn="\\ud800-\\udfff",Hn="["+qn+"]",Wn="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Zn="\\ud83c[\\udffb-\\udfff]",Kn="[^"+qn+"]",Gn="(?:\\ud83c[\\udde6-\\uddff]){2}",Xn="[\\ud800-\\udbff][\\udc00-\\udfff]",$n="(?:"+Wn+"|"+Zn+")"+"?",Yn="[\\ufe0e\\ufe0f]?",Jn=Yn+$n+("(?:\\u200d(?:"+[Kn,Gn,Xn].join("|")+")"+Yn+$n+")*"),Qn="(?:"+[Kn+Wn+"?",Wn,Gn,Xn,Hn].join("|")+")",er=RegExp(Zn+"(?="+Zn+")|"+Qn+Jn,"g");var tr=function(e){return e.match(er)||[]};var nr=function(e){return Un(e)?tr(e):Vn(e)};var rr=function(e,t,n){return e===e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e};var ir=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=jt(n))===n?n:0),void 0!==t&&(t=(t=jt(t))===t?t:0),rr(jt(e),t,n)};var ar=function(){this.__data__=new Fe,this.size=0};var or=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var sr=function(e){return this.__data__.get(e)};var lr=function(e){return this.__data__.has(e)};var ur=function(e,t){var n=this.__data__;if(n instanceof Fe){var r=n.__data__;if(!Me||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new He(r)}return n.set(e,t),this.size=n.size,this};function cr(e){var t=this.__data__=new Fe(e);this.size=t.size}cr.prototype.clear=ar,cr.prototype.delete=or,cr.prototype.get=sr,cr.prototype.has=lr,cr.prototype.set=ur;var dr=cr;var hr=function(e,t){return e&&Zt(t,En(t),e)};var fr=function(e,t){return e&&Zt(t,In(t),e)},pr=t&&!t.nodeType&&t,mr=pr&&e&&!e.nodeType&&e,gr=mr&&mr.exports===pr?B.Buffer:void 0,yr=gr?gr.allocUnsafe:void 0;var vr=function(e,t){if(t)return e.slice();var n=e.length,r=yr?yr(n):new e.constructor(n);return e.copy(r),r};var _r=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a};var br=function(){return[]},xr=Object.prototype.propertyIsEnumerable,wr=Object.getOwnPropertySymbols,kr=wr?function(e){return null==e?[]:(e=Object(e),_r(wr(e),function(t){return xr.call(e,t)}))}:br;var Sr=function(e,t){return Zt(e,kr(e),t)},Er=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Tn(t,kr(e)),e=An(e);return t}:br;var Cr=function(e,t){return Zt(e,Er(e),t)};var Pr=function(e,t,n){var r=t(e);return F(e)?r:Tn(r,n(e))};var Dr=function(e){return Pr(e,En,kr)};var Ir=function(e){return Pr(e,In,Er)},Tr=pe(B,"DataView"),Ar=pe(B,"Promise"),zr=pe(B,"Set"),Or="[object Map]",Fr="[object Promise]",Mr="[object Set]",jr="[object WeakMap]",Br="[object DataView]",Rr=ae(Tr),Lr=ae(Me),Nr=ae(Ar),Ur=ae(zr),Vr=ae(Ut),qr=K;(Tr&&qr(new Tr(new ArrayBuffer(1)))!=Br||Me&&qr(new Me)!=Or||Ar&&qr(Ar.resolve())!=Fr||zr&&qr(new zr)!=Mr||Ut&&qr(new Ut)!=jr)&&(qr=function(e){var t=K(e),n="[object Object]"==t?e.constructor:void 0,r=n?ae(n):"";if(r)switch(r){case Rr:return Br;case Lr:return Or;case Nr:return Fr;case Ur:return Mr;case Vr:return jr}return t});var Hr=qr,Wr=Object.prototype.hasOwnProperty;var Zr=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Wr.call(e,"index")&&(n.index=e.index,n.input=e.input),n},Kr=B.Uint8Array;var Gr=function(e){var t=new e.constructor(e.byteLength);return new Kr(t).set(new Kr(e)),t};var Xr=function(e,t){var n=t?Gr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)},$r=/\w*$/;var Yr=function(e){var t=new e.constructor(e.source,$r.exec(e));return t.lastIndex=e.lastIndex,t},Jr=R?R.prototype:void 0,Qr=Jr?Jr.valueOf:void 0;var ei=function(e){return Qr?Object(Qr.call(e)):{}};var ti=function(e,t){var n=t?Gr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var ni=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Gr(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return Xr(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return ti(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return Yr(e);case"[object Symbol]":return ei(e)}};var ri=function(e){return"function"!=typeof e.constructor||$t(e)?{}:qt(An(e))};var ii=function(e){return G(e)&&"[object Map]"==Hr(e)},ai=gn&&gn.isMap,oi=ai?hn(ai):ii;var si=function(e){return G(e)&&"[object Set]"==Hr(e)},li=gn&&gn.isSet,ui=li?hn(li):si,ci="[object Arguments]",di="[object Function]",hi="[object Object]",fi={};fi[ci]=fi["[object Array]"]=fi["[object ArrayBuffer]"]=fi["[object DataView]"]=fi["[object Boolean]"]=fi["[object Date]"]=fi["[object Float32Array]"]=fi["[object Float64Array]"]=fi["[object Int8Array]"]=fi["[object Int16Array]"]=fi["[object Int32Array]"]=fi["[object Map]"]=fi["[object Number]"]=fi[hi]=fi["[object RegExp]"]=fi["[object Set]"]=fi["[object String]"]=fi["[object Symbol]"]=fi["[object Uint8Array]"]=fi["[object Uint8ClampedArray]"]=fi["[object Uint16Array]"]=fi["[object Uint32Array]"]=!0,fi["[object Error]"]=fi[di]=fi["[object WeakMap]"]=!1;var pi=function e(t,n,r,i,a,o){var s,l=1&n,u=2&n,c=4&n;if(r&&(s=a?r(t,i,a,o):r(t)),void 0!==s)return s;if(!Q(t))return t;var d=F(t);if(d){if(s=Zr(t),!l)return Ht(t,s)}else{var h=Hr(t),f=h==di||"[object GeneratorFunction]"==h;if(un(t))return vr(t,l);if(h==hi||h==ci||f&&!a){if(s=u||f?{}:ri(t),!l)return u?Cr(t,fr(s,t)):Sr(t,hr(s,t))}else{if(!fi[h])return a?t:{};s=ni(t,h,l)}}o||(o=new dr);var p=o.get(t);if(p)return p;o.set(t,s),ui(t)?t.forEach(function(i){s.add(e(i,n,r,i,t,o))}):oi(t)&&t.forEach(function(i,a){s.set(a,e(i,n,r,a,t,o))});var m=d?void 0:(c?u?Ir:Dr:u?In:En)(t);return Wt(m||t,function(i,a){m&&(i=t[a=i]),dt(s,a,e(i,n,r,a,t,o))}),s};var mi=function(e){return pi(e,5)};var gi=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this};var yi=function(e){return this.__data__.has(e)};function vi(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new He;++t<n;)this.add(e[t])}vi.prototype.add=vi.prototype.push=gi,vi.prototype.has=yi;var _i=vi;var bi=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1};var xi=function(e,t){return e.has(t)};var wi=function(e,t,n,r,i,a){var o=1&n,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(e),c=a.get(t);if(u&&c)return u==t&&c==e;var d=-1,h=!0,f=2&n?new _i:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var p=e[d],m=t[d];if(r)var g=o?r(m,p,d,t,e,a):r(p,m,d,e,t,a);if(void 0!==g){if(g)continue;h=!1;break}if(f){if(!bi(t,function(e,t){if(!xi(f,t)&&(p===e||i(p,e,n,r,a)))return f.push(t)})){h=!1;break}}else if(p!==m&&!i(p,m,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h};var ki=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n};var Si=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n},Ei=R?R.prototype:void 0,Ci=Ei?Ei.valueOf:void 0;var Pi=function(e,t,n,r,i,a,o){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!a(new Kr(e),new Kr(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Ce(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ki;case"[object Set]":var l=1&r;if(s||(s=Si),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;r|=2,o.set(e,t);var c=wi(s(e),s(t),r,i,a,o);return o.delete(e),c;case"[object Symbol]":if(Ci)return Ci.call(e)==Ci.call(t)}return!1},Di=Object.prototype.hasOwnProperty;var Ii=function(e,t,n,r,i,a){var o=1&n,s=Dr(e),l=s.length;if(l!=Dr(t).length&&!o)return!1;for(var u=l;u--;){var c=s[u];if(!(o?c in t:Di.call(t,c)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var f=!0;a.set(e,t),a.set(t,e);for(var p=o;++u<l;){var m=e[c=s[u]],g=t[c];if(r)var y=o?r(g,m,c,t,e,a):r(m,g,c,e,t,a);if(!(void 0===y?m===g||i(m,g,n,r,a):y)){f=!1;break}p||(p="constructor"==c)}if(f&&!p){var v=e.constructor,_=t.constructor;v==_||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof _&&_ instanceof _||(f=!1)}return a.delete(e),a.delete(t),f},Ti="[object Arguments]",Ai="[object Array]",zi="[object Object]",Oi=Object.prototype.hasOwnProperty;var Fi=function(e,t,n,r,i,a){var o=F(e),s=F(t),l=o?Ai:Hr(e),u=s?Ai:Hr(t),c=(l=l==Ti?zi:l)==zi,d=(u=u==Ti?zi:u)==zi,h=l==u;if(h&&un(e)){if(!un(t))return!1;o=!0,c=!1}if(h&&!c)return a||(a=new dr),o||vn(e)?wi(e,t,n,r,i,a):Pi(e,t,l,n,r,i,a);if(!(1&n)){var f=c&&Oi.call(e,"__wrapped__"),p=d&&Oi.call(t,"__wrapped__");if(f||p){var m=f?e.value():e,g=p?t.value():t;return a||(a=new dr),i(m,g,n,r,a)}}return!!h&&(a||(a=new dr),Ii(e,t,n,r,i,a))};var Mi=function e(t,n,r,i,a){return t===n||(null==t||null==n||!G(t)&&!G(n)?t!==t&&n!==n:Fi(t,n,r,i,e,a))};var ji=function(e,t,n,r){var i=n.length,a=i,o=!r;if(null==e)return!a;for(e=Object(e);i--;){var s=n[i];if(o&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<a;){var l=(s=n[i])[0],u=e[l],c=s[1];if(o&&s[2]){if(void 0===u&&!(l in e))return!1}else{var d=new dr;if(r)var h=r(u,c,l,e,t,d);if(!(void 0===h?Mi(c,u,3,r,d):h))return!1}}return!0};var Bi=function(e){return e===e&&!Q(e)};var Ri=function(e){for(var t=En(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,Bi(i)]}return t};var Li=function(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}};var Ni=function(e){var t=Ri(e);return 1==t.length&&t[0][2]?Li(t[0][0],t[0][1]):function(n){return n===e||ji(n,e,t)}};var Ui=function(e,t){return null!=e&&t in Object(e)};var Vi=function(e,t,n){for(var r=-1,i=(t=tt(t,e)).length,a=!1;++r<i;){var o=nt(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&Kt(i)&&ft(o,i)&&(F(e)||rn(e))};var qi=function(e,t){return null!=e&&Vi(e,t,Ui)};var Hi=function(e,t){return J(e)&&Bi(t)?Li(nt(e),t):function(n){var r=it(n,e);return void 0===r&&r===t?qi(n,e):Mi(t,r,3)}};var Wi=function(e){return function(t){return null==t?void 0:t[e]}};var Zi=function(e){return function(t){return rt(t,e)}};var Ki=function(e){return J(e)?Wi(nt(e)):Zi(e)};var Gi=function(e){return"function"==typeof e?e:null==e?Nt:"object"==typeof e?F(e)?Hi(e[0],e[1]):Ni(e):Ki(e)};var Xi=function(e){return function(t,n,r){for(var i=-1,a=Object(t),o=r(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===n(a[l],l,a))break}return t}}();var $i=function(e,t){return e&&Xi(e,t,En)},Yi=function(){return B.Date.now()},Ji=Math.max,Qi=Math.min;var ea=function(e,t,n){var r,i,a,o,s,l,u=0,c=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,a=i;return r=i=void 0,u=t,o=e.apply(a,n)}function p(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-u>=a}function m(){var e=Yi();if(p(e))return g(e);s=setTimeout(m,function(e){var n=t-(e-l);return d?Qi(n,a-(e-u)):n}(e))}function g(e){return s=void 0,h&&r?f(e):(r=i=void 0,o)}function y(){var e=Yi(),n=p(e);if(r=arguments,i=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(m,t),c?f(e):o}(l);if(d)return clearTimeout(s),s=setTimeout(m,t),f(l)}return void 0===s&&(s=setTimeout(m,t)),o}return t=jt(t)||0,Q(n)&&(c=!!n.leading,a=(d="maxWait"in n)?Ji(jt(n.maxWait)||0,t):a,h="trailing"in n?!!n.trailing:h),y.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=l=i=s=void 0},y.flush=function(){return void 0===s?o:g(Yi())},y};var ta=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0};var na=function(e,t){return t.length<2?e:rt(e,Rn(t,0,-1))};var ra=function(e){return"number"==typeof e&&e==Lt(e)};var ia=function(e,t){var n={};return t=Gi(t,3),$i(e,function(e,r,i){ut(n,r,t(e,r,i))}),n};var aa=function(e,t){return t=tt(t,e),null==(e=na(e,t))||delete e[nt(ta(t))]},oa=Math.floor;var sa=function(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=oa(t/2))&&(e+=e)}while(t);return n},la=Wi("length"),ua="\\ud800-\\udfff",ca="["+ua+"]",da="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ha="\\ud83c[\\udffb-\\udfff]",fa="[^"+ua+"]",pa="(?:\\ud83c[\\udde6-\\uddff]){2}",ma="[\\ud800-\\udbff][\\udc00-\\udfff]",ga="(?:"+da+"|"+ha+")"+"?",ya="[\\ufe0e\\ufe0f]?",va=ya+ga+("(?:\\u200d(?:"+[fa,pa,ma].join("|")+")"+ya+ga+")*"),_a="(?:"+[fa+da+"?",da,pa,ma,ca].join("|")+")",ba=RegExp(ha+"(?="+ha+")|"+_a+va,"g");var xa=function(e){for(var t=ba.lastIndex=0;ba.test(e);)++t;return t};var wa=function(e){return Un(e)?xa(e):la(e)},ka=Math.ceil;var Sa=function(e,t){var n=(t=void 0===t?" ":Qe(t)).length;if(n<2)return n?sa(t,e):t;var r=sa(t,ka(e/wa(t)));return Un(t)?Ln(nr(r),0,e).join(""):r.slice(0,e)};var Ea=function(e,t,n){e=et(e);var r=(t=Lt(t))?wa(e):0;return t&&r<t?Sa(t-r,n)+e:e};var Ca=function(e,t){return null==e||aa(e,t)},Pa=class{constructor(e){x(this,"_cache",new ot),x(this,"_keepHotUntapDebounce"),z(this,e)}get type(){return"Theatre_SheetObject_PublicAPI"}get props(){return A(this).propsP}get sheet(){return A(this).sheet.publicApi}get project(){return A(this).sheet.project.publicApi}get address(){return m({},A(this).address)}_valuesPrism(){return this._cache.get("_valuesPrism",()=>{const e=A(this);return(0,Pt.prism)(()=>(0,Pt.val)(e.getValues().getValue()))})}onValuesChange(e,t){return wl(this._valuesPrism(),e,t)}get value(){const e=this._valuesPrism();if(!e.isHot){null!=this._keepHotUntapDebounce&&this._keepHotUntapDebounce.flush();const t=e.keepHot();this._keepHotUntapDebounce=ea(()=>{t(),this._keepHotUntapDebounce=void 0},5e3)}return this._keepHotUntapDebounce&&this._keepHotUntapDebounce(),e.getValue()}set initialValue(e){A(this).setInitialValue(e)}};function Da(e){const t=new WeakMap;return n=>(t.has(n)||t.set(n,e(n)),t.get(n))}function Ia(e){return"compound"===e.type||"enum"===e.type}function Ta(e,t){if(!e)return;const[n,...r]=t;if(void 0===n)return e;if(!Ia(e))return;return Ta("enum"===e.type?e.cases[n]:e.props[n],r)}function Aa(e){return!Ia(e)}var za=Da(e=>{if("enum"===e.type)throw new Error("Not implemented yet for enums");for(const t in e.props){const n=e.props[t];if(!Ia(n))return!0;if(za(n))return!0}return!1}),Oa=class{constructor(e,t,n){this.sheet=e,this.template=t,this.nativeObject=n,x(this,"$$isPointerToPrismProvider",!0),x(this,"address"),x(this,"publicApi"),x(this,"_initialValue",new Ct.Atom({})),x(this,"_cache",new ot),x(this,"_logger"),x(this,"_internalUtilCtx"),this._logger=e._logger.named("SheetObject",t.address.objectKey),this._logger._trace("creating object"),this._internalUtilCtx={logger:this._logger.utilFor.internal()},this.address=g(m({},t.address),{sheetInstanceId:e.address.sheetInstanceId}),this.publicApi=new Pa(this)}get type(){return"Theatre_SheetObject"}getValues(){return this._cache.get("getValues()",()=>(0,Ct.prism)(()=>{const e=kt((0,Ct.val)(this.template.getDefaultValues()),(0,Ct.val)(this._initialValue.pointer),Ct.prism.memo("withInitialCache",()=>new WeakMap,[]));let t,n=kt(e,(0,Ct.val)(this.template.getStaticValues()),Ct.prism.memo("withStatics",()=>new WeakMap,[]));{const e=Ct.prism.memo("seq",()=>this.getSequencedValues(),[]),r=Ct.prism.memo("withSeqsCache",()=>new WeakMap,[]);t=(0,Ct.val)((0,Ct.val)(e));n=kt(n,t,r)}return((e,t)=>{const n=Et.prism.memo(e,()=>new Et.Atom(t),[]);return n.set(t),n})("finalAtom",n).pointer}))}getValueByPointer(e){const t=(0,Ct.val)(this.getValues()),{path:n}=(0,Ct.getPointerParts)(e);return(0,Ct.val)(St(t,n))}pointerToPrism(e){const{path:t}=(0,Ct.getPointerParts)(e);return(0,Ct.prism)(()=>{const e=(0,Ct.val)(this.getValues());return(0,Ct.val)(St(e,t))})}getSequencedValues(){return(0,Ct.prism)(()=>{const e=Ct.prism.memo("tracksToProcess",()=>this.template.getArrayOfValidSequenceTracks(),[]),t=(0,Ct.val)(e),n=new Ct.Atom({}),r=(0,Ct.val)(this.template.configPointer);return Ct.prism.effect("processTracks",()=>{const e=[];for(const{trackId:i,pathToProp:a}of t){const t=this._trackIdToPrism(i),o=Ta(r,a),s=o.deserializeAndSanitize,l=o.interpolate,u=()=>{const e=t.getValue();if(!e)return n.setByPointer(e=>St(e,a),void 0);const r=s(e.left),i=void 0===r?o.default:r;if(void 0===e.right)return n.setByPointer(e=>St(e,a),i);const u=s(e.right),c=void 0===u?o.default:u;return n.setByPointer(e=>St(e,a),l(i,c,e.progression))},c=t.onStale(u);u(),e.push(c)}return()=>{for(const t of e)t()}},[r,...t]),n.pointer})}_trackIdToPrism(e){const t=this.template.project.pointers.historic.sheetsById[this.address.sheetId].sequence.tracksByObject[this.address.objectKey].trackData[e],n=this.sheet.getSequence().positionPrism;return bt(this._internalUtilCtx,t,n)}get propsP(){return this._cache.get("propsP",()=>(0,Ct.pointer)({root:this,path:[]}))}validateValue(e,t){}setInitialValue(e){this.validateValue(this.propsP,e),this._initialValue.set(e)}};function Fa(e){return function(t,n){return e(t,n())}}var Ma={_hmm:ja(524),_todo:ja(522),_error:ja(521),errorDev:ja(529),errorPublic:ja(545),_kapow:ja(268),_warn:ja(265),warnDev:ja(273),warnPublic:ja(289),_debug:ja(137),debugDev:ja(145),_trace:ja(73),traceDev:ja(81)};function ja(e){return Object.freeze({audience:Ba(e,8)?"internal":Ba(e,16)?"dev":"public",category:Ba(e,4)?"troubleshooting":Ba(e,2)?"todo":"general",level:Ba(e,512)?512:Ba(e,256)?256:Ba(e,128)?128:64})}function Ba(e,t){return(e&t)===t}function Ra(e,t){return(32===(32&t)||(16===(16&t)?e.dev:8===(8&t)&&e.internal))&&e.min<=t}var La={loggingConsoleStyle:!0,loggerConsoleStyle:!0,includes:Object.freeze({internal:!1,dev:!1,min:256}),filtered:function(){},include:function(){return{}},create:null,creatExt:null,named(e,t,n){return this.create({names:[...e.names,{name:t,key:n}]})},style:{bold:void 0,italic:void 0,cssMemo:new Map([["",""]]),collapseOnRE:/[a-z- ]+/g,color:void 0,collapsed(e){if(e.length<5)return e;const t=e.replace(this.collapseOnRE,"");return this.cssMemo.has(t)||this.cssMemo.set(t,this.css(e)),t},css(e){var t,n,r,i;const a=this.cssMemo.get(e);if(a)return a;let o="color:".concat(null!=(n=null==(t=this.color)?void 0:t.call(this,e))?n:"hsl(".concat((e.charCodeAt(0)+e.charCodeAt(e.length-1))%360,", 100%, 60%)"));return(null==(r=this.bold)?void 0:r.test(e))&&(o+=";font-weight:600"),(null==(i=this.italic)?void 0:i.test(e))&&(o+=";font-style:italic"),this.cssMemo.set(e,o),o}}};function Na(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:console;const t=g(m({},La),{includes:m({},La.includes)}),n={styled:qa.bind(t,e),noStyle:Ha.bind(t,e)},r=Va.bind(t);function i(){return t.loggingConsoleStyle&&t.loggerConsoleStyle?n.styled:n.noStyle}return t.create=i(),{configureLogger(e){var n;"console"===e?(t.loggerConsoleStyle=La.loggerConsoleStyle,t.create=i()):"console"===e.type?(t.loggerConsoleStyle=null!=(n=e.style)?n:La.loggerConsoleStyle,t.create=i()):"keyed"===e.type?(t.creatExt=t=>e.keyed(t.names),t.create=r):"named"===e.type&&(t.creatExt=Ua.bind(null,e.named),t.create=r)},configureLogging(e){var n,r,a,o,s;t.includes.dev=null!=(n=e.dev)?n:La.includes.dev,t.includes.internal=null!=(r=e.internal)?r:La.includes.internal,t.includes.min=null!=(a=e.min)?a:La.includes.min,t.include=null!=(o=e.include)?o:La.include,t.loggingConsoleStyle=null!=(s=e.consoleStyle)?s:La.loggingConsoleStyle,t.create=i()},getLogger:()=>t.create({names:[]})}}function Ua(e,t){const n=[];for(let{name:r,key:i}of t.names)n.push(null==i?r:"".concat(r," (").concat(i,")"));return e(n)}function Va(e){const t=m(m({},this.includes),this.include(e)),n=this.filtered,r=this.named.bind(this,e),i=this.creatExt(e),a=Ra(t,524),o=Ra(t,522),s=Ra(t,521),l=Ra(t,529),u=Ra(t,545),c=Ra(t,265),d=Ra(t,268),h=Ra(t,273),f=Ra(t,289),p=Ra(t,137),g=Ra(t,145),y=Ra(t,73),v=Ra(t,81),_=a?i.error.bind(i,Ma._hmm):n.bind(e,524),b=o?i.error.bind(i,Ma._todo):n.bind(e,522),x=s?i.error.bind(i,Ma._error):n.bind(e,521),w=l?i.error.bind(i,Ma.errorDev):n.bind(e,529),k=u?i.error.bind(i,Ma.errorPublic):n.bind(e,545),S=d?i.warn.bind(i,Ma._kapow):n.bind(e,268),E=c?i.warn.bind(i,Ma._warn):n.bind(e,265),C=h?i.warn.bind(i,Ma.warnDev):n.bind(e,273),P=f?i.warn.bind(i,Ma.warnPublic):n.bind(e,273),D=p?i.debug.bind(i,Ma._debug):n.bind(e,137),I=g?i.debug.bind(i,Ma.debugDev):n.bind(e,145),T=y?i.trace.bind(i,Ma._trace):n.bind(e,73),A=v?i.trace.bind(i,Ma.traceDev):n.bind(e,81),z={_hmm:_,_todo:b,_error:x,errorDev:w,errorPublic:k,_kapow:S,_warn:E,warnDev:C,warnPublic:P,_debug:D,debugDev:I,_trace:T,traceDev:A,lazy:{_hmm:a?Fa(_):_,_todo:o?Fa(b):b,_error:s?Fa(x):x,errorDev:l?Fa(w):w,errorPublic:u?Fa(k):k,_kapow:d?Fa(S):S,_warn:c?Fa(E):E,warnDev:h?Fa(C):C,warnPublic:f?Fa(P):P,_debug:p?Fa(D):D,debugDev:g?Fa(I):I,_trace:y?Fa(T):T,traceDev:v?Fa(A):A},named:r,utilFor:{internal:()=>({debug:z._debug,error:z._error,warn:z._warn,trace:z._trace,named:(e,t)=>z.named(e,t).utilFor.internal()}),dev:()=>({debug:z.debugDev,error:z.errorDev,warn:z.warnDev,trace:z.traceDev,named:(e,t)=>z.named(e,t).utilFor.dev()}),public:()=>({error:z.errorPublic,warn:z.warnPublic,debug(e,t){z._warn('(public "debug" filtered out) '.concat(e),t)},trace(e,t){z._warn('(public "trace" filtered out) '.concat(e),t)},named:(e,t)=>z.named(e,t).utilFor.public()})}};return z}function qa(e,t){const n=m(m({},this.includes),this.include(t)),r=[];let i="";for(let l=0;l<t.names.length;l++){const{name:e,key:n}=t.names[l];if(i+=" %c".concat(e),r.push(this.style.css(e)),null!=n){const e="%c#".concat(n);i+=e,r.push(this.style.css(e))}}const a=this.filtered,o=this.named.bind(this,t),s=[i,...r];return Wa(a,t,n,e,s,function(e){const t=e.slice(0);for(let n=1;n<t.length;n++)t[n]+=";background-color:#e0005a;padding:2px;color:white";return t}(s),o)}function Ha(e,t){const n=m(m({},this.includes),this.include(t));let r="";for(let a=0;a<t.names.length;a++){const{name:e,key:n}=t.names[a];r+=" ".concat(e),null!=n&&(r+="#".concat(n))}const i=[r];return Wa(this.filtered,t,n,e,i,i,this.named.bind(this,t))}function Wa(e,t,n,r,i,a,o){const s=Ra(n,524),l=Ra(n,522),u=Ra(n,521),c=Ra(n,529),d=Ra(n,545),h=Ra(n,265),f=Ra(n,268),p=Ra(n,273),m=Ra(n,289),g=Ra(n,137),y=Ra(n,145),v=Ra(n,73),_=Ra(n,81),b=s?r.error.bind(r,...i):e.bind(t,524),x=l?r.error.bind(r,...i):e.bind(t,522),w=u?r.error.bind(r,...i):e.bind(t,521),k=c?r.error.bind(r,...i):e.bind(t,529),S=d?r.error.bind(r,...i):e.bind(t,545),E=f?r.warn.bind(r,...a):e.bind(t,268),C=h?r.warn.bind(r,...i):e.bind(t,265),P=p?r.warn.bind(r,...i):e.bind(t,273),D=m?r.warn.bind(r,...i):e.bind(t,273),I=g?r.info.bind(r,...i):e.bind(t,137),T=y?r.info.bind(r,...i):e.bind(t,145),A=v?r.debug.bind(r,...i):e.bind(t,73),z=_?r.debug.bind(r,...i):e.bind(t,81),O={_hmm:b,_todo:x,_error:w,errorDev:k,errorPublic:S,_kapow:E,_warn:C,warnDev:P,warnPublic:D,_debug:I,debugDev:T,_trace:A,traceDev:z,lazy:{_hmm:s?Fa(b):b,_todo:l?Fa(x):x,_error:u?Fa(w):w,errorDev:c?Fa(k):k,errorPublic:d?Fa(S):S,_kapow:f?Fa(E):E,_warn:h?Fa(C):C,warnDev:p?Fa(P):P,warnPublic:m?Fa(D):D,_debug:g?Fa(I):I,debugDev:y?Fa(T):T,_trace:v?Fa(A):A,traceDev:_?Fa(z):z},named:o,utilFor:{internal:()=>({debug:O._debug,error:O._error,warn:O._warn,trace:O._trace,named:(e,t)=>O.named(e,t).utilFor.internal()}),dev:()=>({debug:O.debugDev,error:O.errorDev,warn:O.warnDev,trace:O.traceDev,named:(e,t)=>O.named(e,t).utilFor.dev()}),public:()=>({error:O.errorPublic,warn:O.warnPublic,debug(e,t){O._warn('(public "debug" filtered out) '.concat(e),t)},trace(e,t){O._warn('(public "trace" filtered out) '.concat(e),t)},named:(e,t)=>O.named(e,t).utilFor.public()})}};return O}var Za=Na(console,{_debug:function(){},_error:function(){}});Za.configureLogging({dev:!0,min:64});var Ka=Za.getLogger().named("Theatre.js (default logger)").utilFor.dev(),Ga=new WeakMap;function Xa(e,t,n){for(const[r,i]of Object.entries(t.props))if(!Ia(i)){const t=[...e,r];n.set(JSON.stringify(t),n.size),$a(t,i,n)}for(const[r,i]of Object.entries(t.props))if(Ia(i)){const t=[...e,r];n.set(JSON.stringify(t),n.size),$a(t,i,n)}}function $a(e,t,n){if("compound"===t.type)Xa(e,t,n);else{if("enum"===t.type)throw new Error("Enums aren't supported yet");n.set(JSON.stringify(e),n.size)}}function Ya(e){return"object"===typeof e&&null!==e&&0===Object.keys(e).length}var Ja=class{constructor(e,t,n,r,i){this.sheetTemplate=e,x(this,"address"),x(this,"type","Theatre_SheetObjectTemplate"),x(this,"_config"),x(this,"_temp_actions_atom"),x(this,"_cache",new ot),x(this,"project"),x(this,"pointerToSheetState"),x(this,"pointerToStaticOverrides"),this.address=g(m({},e.address),{objectKey:t}),this._config=new st.Atom(r),this._temp_actions_atom=new st.Atom(i),this.project=e.project,this.pointerToSheetState=this.sheetTemplate.project.pointers.historic.sheetsById[this.address.sheetId],this.pointerToStaticOverrides=this.pointerToSheetState.staticOverrides.byObject[this.address.objectKey]}get staticConfig(){return this._config.get()}get configPointer(){return this._config.pointer}get _temp_actions(){return this._temp_actions_atom.get()}get _temp_actionsPointer(){return this._temp_actions_atom.pointer}createInstance(e,t,n){return this._config.set(n),new Oa(e,this,t)}reconfigure(e){this._config.set(e)}_temp_setActions(e){this._temp_actions_atom.set(e)}getDefaultValues(){return this._cache.get("getDefaultValues()",()=>(0,st.prism)(()=>function(e){return yt(e)}((0,st.val)(this.configPointer))))}getStaticValues(){return this._cache.get("getStaticValues",()=>(0,st.prism)(()=>{var e;const t=null!=(e=(0,st.val)(this.pointerToStaticOverrides))?e:{};return(0,st.val)(this.configPointer).deserializeAndSanitize(t)||{}}))}getArrayOfValidSequenceTracks(){return this._cache.get("getArrayOfValidSequenceTracks",()=>(0,st.prism)(()=>{const e=this.project.pointers.historic.sheetsById[this.address.sheetId],t=(0,st.val)(e.sequence.tracksByObject[this.address.objectKey].trackIdByPropPath);if(!t)return O;const n=[];if(!t)return O;const r=(0,st.val)(this.configPointer),i=Object.entries(t);for(const[o,s]of i){const e=Qa(o);if(!e)continue;const t=Ta(r,e);t&&Aa(t)&&n.push({pathToProp:e,trackId:s})}const a=function(e){const t=Ga.get(e);if(t)return t;const n=new Map;return Ga.set(e,n),Xa([],e,n),n}(r);return n.sort((e,t)=>{const n=e.pathToProp,r=t.pathToProp;return a.get(JSON.stringify(n))>a.get(JSON.stringify(r))?1:-1}),0===n.length?O:n}))}getMapOfValidSequenceTracks_forStudio(){return this._cache.get("getMapOfValidSequenceTracks_forStudio",()=>(0,st.prism)(()=>{const e=(0,st.val)(this.getArrayOfValidSequenceTracks());let t={};for(const{pathToProp:n,trackId:r}of e)mt(t,n,r);return t}))}getStaticButNotSequencedOverrides(){return this._cache.get("getStaticButNotSequencedOverrides",()=>(0,st.prism)(()=>{const e=(0,st.val)(this.getStaticValues()),t=(0,st.val)(this.getArrayOfValidSequenceTracks()),n=mi(e);for(const{pathToProp:r}of t){Ca(n,r);let e=r.slice(0,-1);for(;e.length>0;){if(!Ya(at(n,e)))break;Ca(n,e),e=e.slice(0,-1)}}return Ya(n)?void 0:n}))}getDefaultsAtPointer(e){const{path:t}=(0,st.getPointerParts)(e);return at(this.getDefaultValues().getValue(),t)}};function Qa(e){try{return JSON.parse(e)}catch(t){return void Ka.warn("property ".concat(JSON.stringify(e)," cannot be parsed. Skipping."))}}var eo=n(194),to=Da(e=>JSON.stringify(e));b(S());var no=class extends Error{},ro=class extends no{},io=n(194),ao=n(194),oo=n(194),so=n(194);function lo(){let e,t;const n=new Promise((n,i)=>{e=e=>{n(e),r.status="resolved"},t=e=>{i(e),r.status="rejected"}}),r={resolve:e,reject:t,promise:n,status:"pending"};return r}var uo=()=>{},co=n(194),ho=class{constructor(){x(this,"_stopPlayCallback",uo),x(this,"_state",new co.Atom({position:0,playing:!1})),x(this,"statePointer"),this.statePointer=this._state.pointer}destroy(){}pause(){this._stopPlayCallback(),this.playing=!1,this._stopPlayCallback=uo}gotoPosition(e){this._updatePositionInState(e)}_updatePositionInState(e){this._state.setByPointer(e=>e.position,e)}getCurrentPosition(){return this._state.get().position}get playing(){return this._state.get().playing}set playing(e){this._state.setByPointer(e=>e.playing,e)}play(e,t,n,r,i){this.playing&&this.pause(),this.playing=!0;const a=t[1]-t[0];{const e=this.getCurrentPosition();e<t[0]||e>t[1]?"normal"===r||"alternate"===r?this._updatePositionInState(t[0]):"reverse"!==r&&"alternateReverse"!==r||this._updatePositionInState(t[1]):"normal"===r||"alternate"===r?e===t[1]&&this._updatePositionInState(t[0]):e===t[0]&&this._updatePositionInState(t[1])}const o=lo(),s=i.time,l=a*e;let u=this.getCurrentPosition()-t[0];"reverse"!==r&&"alternateReverse"!==r||(u=t[1]-this.getCurrentPosition());const c=i=>{const c=Math.max(i-s,0)/1e3,h=Math.min(c*n+u,l);if(h!==l){const e=Math.floor(h/a);let n=h/a%1*a;if("normal"!==r)if("reverse"===r)n=a-n;else{const t=e%2===0;"alternate"===r?t||(n=a-n):t&&(n=a-n)}this._updatePositionInState(n+t[0]),d()}else{if("normal"===r)this._updatePositionInState(t[1]);else if("reverse"===r)this._updatePositionInState(t[0]);else{const n=(e-1)%2===0;"alternate"===r?n?this._updatePositionInState(t[1]):this._updatePositionInState(t[0]):n?this._updatePositionInState(t[0]):this._updatePositionInState(t[1])}this.playing=!1,o.resolve(!0)}};this._stopPlayCallback=()=>{i.offThisOrNextTick(c),i.offNextTick(c),this.playing&&o.resolve(!1)};const d=()=>i.onNextTick(c);return i.onThisOrNextTick(c),o.promise}playDynamicRange(e,t){this.playing&&this.pause(),this.playing=!0;const n=lo(),r=e.keepHot();n.promise.then(r,r);let i=t.time;const a=t=>{const n=Math.max(t-i,0);i=t;const r=n/1e3,a=this.getCurrentPosition(),s=e.getValue();if(a<s[0]||a>s[1])this.gotoPosition(s[0]);else{let e=a+r;e>s[1]&&(e=s[0]+(e-s[1])),this.gotoPosition(e)}o()};this._stopPlayCallback=()=>{t.offThisOrNextTick(a),t.offNextTick(a),n.resolve(!1)};const o=()=>t.onNextTick(a);return t.onThisOrNextTick(a),n.promise}},fo=n(194),po="__TheatreJS_CoreBundle",mo=e=>function(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];switch(e){case"success":case"info":Ka.debug(r.slice(0,2).join("\n"));break;case"warning":Ka.warn(r.slice(0,2).join("\n"))}return"undefined"!==typeof window?null==(t=window.__TheatreJS_Notifications)?void 0:t.notify[e](...r):void 0},go={warning:mo("warning"),success:mo("success"),info:mo("info"),error:mo("error")};"undefined"!==typeof window&&(window.addEventListener("error",e=>{go.error("An error occurred","<pre>".concat(e.message,"</pre>\n\nSee **console** for details."))}),window.addEventListener("unhandledrejection",e=>{go.error("An error occurred","<pre>".concat(e.reason,"</pre>\n\nSee **console** for details."))}));var yo,vo=class{constructor(e,t,n){this._decodedBuffer=e,this._audioContext=t,this._nodeDestination=n,x(this,"_mainGain"),x(this,"_state",new fo.Atom({position:0,playing:!1})),x(this,"statePointer"),x(this,"_stopPlayCallback",uo),this.statePointer=this._state.pointer,this._mainGain=this._audioContext.createGain(),this._mainGain.connect(this._nodeDestination)}playDynamicRange(e,t){const n=lo();let r;this._playing&&this.pause(),this._playing=!0;const i=()=>{null==r||r(),r=this._loopInRange(e.getValue(),t).stop},a=e.onStale(i);return i(),this._stopPlayCallback=()=>{null==r||r(),a(),n.resolve(!1)},n.promise}_loopInRange(e,t){let n=this.getCurrentPosition();const r=e[1]-e[0];(n<e[0]||n>e[1]||n===e[1])&&this._updatePositionInState(e[0]),n=this.getCurrentPosition();const i=this._audioContext.createBufferSource();i.buffer=this._decodedBuffer,i.connect(this._mainGain),i.playbackRate.value=1,i.loop=!0,i.loopStart=e[0],i.loopEnd=e[1];const a=t.time;let o=n-e[0];i.start(0,n);const s=t=>{let n=(1*(Math.max(t-a,0)/1e3)+o)/r%1*r;this._updatePositionInState(n+e[0]),l()},l=()=>t.onNextTick(s);t.onThisOrNextTick(s);return{stop:()=>{i.stop(),i.disconnect(),t.offThisOrNextTick(s),t.offNextTick(s)}}}get _playing(){return this._state.get().playing}set _playing(e){this._state.setByPointer(e=>e.playing,e)}destroy(){}pause(){this._stopPlayCallback(),this._playing=!1,this._stopPlayCallback=uo}gotoPosition(e){this._updatePositionInState(e)}_updatePositionInState(e){this._state.reduce(t=>g(m({},t),{position:e}))}getCurrentPosition(){return this._state.get().position}play(e,t,n,r,i){this._playing&&this.pause(),this._playing=!0;let a=this.getCurrentPosition();const o=t[1]-t[0];if("normal"!==r)throw new ro('Audio-controlled sequences can only be played in the "normal" direction. '+"'".concat(r,"' given."));(a<t[0]||a>t[1]||a===t[1])&&this._updatePositionInState(t[0]),a=this.getCurrentPosition();const s=lo(),l=this._audioContext.createBufferSource();l.buffer=this._decodedBuffer,l.connect(this._mainGain),l.playbackRate.value=n,e>1e3&&(go.warning("Can't play sequences with audio more than 1000 times","The sequence will still play, but only 1000 times. The `iterationCount: ".concat(e,"` provided to `sequence.play()`\nis too high for a sequence with audio.\n\nTo fix this, either set `iterationCount` to a lower value, or remove the audio from the sequence."),[{url:"https://www.theatrejs.com/docs/latest/manual/audio",title:"Using Audio"},{url:"https://www.theatrejs.com/docs/latest/api/core#sequence.attachaudio",title:"Audio API"}]),e=1e3),e>1&&(l.loop=!0,l.loopStart=t[0],l.loopEnd=t[1]);const u=i.time;let c=a-t[0];const d=o*e;l.start(0,a,d-c);const h=e=>{const r=Math.max(e-u,0)/1e3,i=Math.min(r*n+c,d);if(i!==d){let e=i/o%1*o;this._updatePositionInState(e+t[0]),p()}else this._updatePositionInState(t[1]),this._playing=!1,f(),s.resolve(!0)},f=()=>{l.stop(),l.disconnect()};this._stopPlayCallback=()=>{f(),i.offThisOrNextTick(h),i.offNextTick(h),this._playing&&s.resolve(!1)};const p=()=>i.onNextTick(h);return i.onThisOrNextTick(h),s.promise}},_o=n(194),bo=0;function xo(e){var t;const n=new _o.Ticker({onActive(){var t;null==(t=null==e?void 0:e.start)||t.call(e)},onDormant(){var t;null==(t=null==e?void 0:e.stop)||t.call(e)}}),r={tick:e=>{n.tick(e)},id:bo++,name:null!=(t=null==e?void 0:e.name)?t:"CustomRafDriver-".concat(bo),type:"Theatre_RafDriver_PublicAPI"};return z(r,{type:"Theatre_RafDriver_PrivateAPI",publicApi:r,ticker:n,start:null==e?void 0:e.start,stop:null==e?void 0:e.stop}),r}function wo(){return yo||function(e){if(yo)throw new Error("`setCoreRafDriver()` is already called.");const t=A(e);yo=t}(function(){let e=null;const t=xo({name:"DefaultCoreRafDriver",start:()=>{if("undefined"!==typeof window){const n=r=>{t.tick(r),e=window.requestAnimationFrame(n)};e=window.requestAnimationFrame(n)}else t.tick(0),setTimeout(()=>t.tick(1),0)},stop:()=>{"undefined"!==typeof window&&null!==e&&window.cancelAnimationFrame(e)}});return t}()),yo}function ko(){return wo().ticker}var So=class{get type(){return"Theatre_Sequence_PublicAPI"}constructor(e){z(this,e)}play(e){const t=A(this);if(t._project.isReady()){const n=(null==e?void 0:e.rafDriver)?A(e.rafDriver).ticker:ko();return t.play(null!=e?e:{},n)}{0;const e=lo();return e.resolve(!0),e.promise}}pause(){A(this).pause()}get position(){return A(this).position}set position(e){A(this).position=e}__experimental_getKeyframes(e){return A(this).getKeyframesOfSimpleProp(e)}async attachAudio(e){const{audioContext:t,destinationNode:n,decodedBuffer:r,gainNode:i}=await async function(e){function t(){if(e.audioContext)return Promise.resolve(e.audioContext);const t=new AudioContext;return"running"===t.state||"undefined"===typeof window?Promise.resolve(t):new Promise(e=>{const n=()=>{t.resume().catch(e=>{console.error(e)})},r=["mousedown","keydown","touchstart"],i={capture:!0,passive:!1};r.forEach(e=>{window.addEventListener(e,n,i)}),t.addEventListener("statechange",()=>{"running"===t.state&&(r.forEach(e=>{window.removeEventListener(e,n,i)}),e(t))})})}async function n(){if(e.source instanceof AudioBuffer)return e.source;const t=lo();if("string"!==typeof e.source)throw new Error("Error validating arguments to sequence.attachAudio(). args.source must either be a string or an instance of AudioBuffer.");let n,i;try{n=await fetch(e.source)}catch(o){throw console.error(o),new Error("Could not fetch '".concat(e.source,"'. Network error logged above."))}try{i=await n.arrayBuffer()}catch(o){throw console.error(o),new Error("Could not read '".concat(e.source,"' as an arrayBuffer."))}let a;(await r).decodeAudioData(i,t.resolve,t.reject);try{a=await t.promise}catch(o){throw console.error(o),new Error("Could not decode ".concat(e.source," as an audio file."))}return a}const r=t(),i=n(),[a,o]=await Promise.all([r,i]),s=e.destinationNode||a.destination,l=a.createGain();return l.connect(s),{audioContext:a,decodedBuffer:o,gainNode:l,destinationNode:s}}(e),a=new vo(r,t,i);return A(this).replacePlaybackController(a),{audioContext:t,destinationNode:n,decodedBuffer:r,gainNode:i}}get pointer(){return A(this).pointer}};Co("Theatre_Project"),Co("Theatre_Sheet"),Co("Theatre_SheetTemplate");var Eo=Co("Theatre_SheetObject");Co("Theatre_Sequence"),Co("Theatre_SheetObjectTemplate"),Co("Theatre_Project_PublicAPI"),Co("Theatre_Sheet_PublicAPI"),Co("Theatre_SheetObject_PublicAPI");function Co(e){return t=>"object"===typeof t&&!!t&&t.type===e}var Po=class{constructor(e,t,n,r,i){this._project=e,this._sheet=t,this._lengthD=n,this._subUnitsPerUnitD=r,x(this,"address"),x(this,"publicApi"),x(this,"_playbackControllerBox"),x(this,"_prismOfStatePointer"),x(this,"_positionD"),x(this,"_positionFormatterD"),x(this,"_playableRangeD"),x(this,"pointer",(0,oo.pointer)({root:this,path:[]})),x(this,"$$isPointerToPrismProvider",!0),x(this,"_logger"),x(this,"closestGridPosition",e=>{const t=1/this.subUnitsPerUnit;return parseFloat((Math.round(e/t)*t).toFixed(3))}),this._logger=e._logger.named("Sheet",t.address.sheetId).named("Instance",t.address.sheetInstanceId),this.address=g(m({},this._sheet.address),{sequenceName:"default"}),this.publicApi=new So(this),this._playbackControllerBox=new ao.Atom(null!=i?i:new ho),this._prismOfStatePointer=(0,so.prism)(()=>this._playbackControllerBox.prism.getValue().statePointer),this._positionD=(0,so.prism)(()=>{const e=this._prismOfStatePointer.getValue();return(0,so.val)(e.position)}),this._positionFormatterD=(0,so.prism)(()=>{const e=(0,so.val)(this._subUnitsPerUnitD);return new Do(e)})}get type(){return"Theatre_Sequence"}pointerToPrism(e){const{path:t}=(0,io.getPointerParts)(e);if(0===t.length)return(0,so.prism)(()=>({length:(0,so.val)(this.pointer.length),playing:(0,so.val)(this.pointer.playing),position:(0,so.val)(this.pointer.position),subUnitsPerUnit:(0,so.val)(this.pointer.subUnitsPerUnit)}));if(t.length>1)return(0,so.prism)(()=>{});const[n]=t;return"length"===n?this._lengthD:"subUnitsPerUnit"===n?this._subUnitsPerUnitD:"position"===n?this._positionD:"playing"===n?(0,so.prism)(()=>(0,so.val)(this._prismOfStatePointer.getValue().playing)):(0,so.prism)(()=>{})}getKeyframesOfSimpleProp(e){const{path:t,root:n}=(0,io.getPointerParts)(e);if(!Eo(n))throw new ro("Argument prop must be a pointer to a SheetObject property");const r=(0,so.val)(this._project.pointers.historic.sheetsById[this._sheet.address.sheetId].sequence.tracksByObject[n.address.objectKey]);if(!r)return[];const{trackData:i,trackIdByPropPath:a}=r,o=a[to(t)];if(!o)return[];const s=i[o];return s?s.keyframes:[]}get positionFormatter(){return this._positionFormatterD.getValue()}get prismOfStatePointer(){return this._prismOfStatePointer}get length(){return this._lengthD.getValue()}get positionPrism(){return this._positionD}get position(){return this._playbackControllerBox.get().getCurrentPosition()}get subUnitsPerUnit(){return this._subUnitsPerUnitD.getValue()}get positionSnappedToGrid(){return this.closestGridPosition(this.position)}set position(e){let t=e;this.pause(),t>this.length&&(t=this.length);const n=this.length;this._playbackControllerBox.get().gotoPosition(t>n?n:t)}getDurationCold(){return this._lengthD.getValue()}get playing(){return(0,so.val)(this._playbackControllerBox.get().statePointer.playing)}_makeRangeFromSequenceTemplate(){return(0,so.prism)(()=>[0,(0,so.val)(this._lengthD)])}playDynamicRange(e,t){return this._playbackControllerBox.get().playDynamicRange(e,t)}async play(e,t){const n=this.length,r=e&&e.range?e.range:[0,n];const i=e&&"number"===typeof e.iterationCount?e.iterationCount:1;const a=e&&"undefined"!==typeof e.rate?e.rate:1;const o=e&&e.direction?e.direction:"normal";return await this._play(i,[r[0],r[1]],a,o,t)}_play(e,t,n,r,i){return this._playbackControllerBox.get().play(e,t,n,r,i)}pause(){this._playbackControllerBox.get().pause()}replacePlaybackController(e){this.pause();const t=this._playbackControllerBox.get();this._playbackControllerBox.set(e);const n=t.getCurrentPosition();t.destroy(),e.gotoPosition(n)}},Do=class{constructor(e){this._fps=e}formatSubUnitForGrid(e){const t=e%1,n=1/this._fps;return Math.round(t/n)+"f"}formatFullUnitForGrid(e){let t=e,n="";if(t>=Ao){n+=Math.floor(t/Ao)+"h",t%=Ao}if(t>=To){n+=Math.floor(t/To)+"m",t%=To}if(t>=Io){n+=Math.floor(t/Io)+"s",t%=Io}const r=1/this._fps;if(t>=r){n+=Math.floor(t/r)+"f",t%=r}return 0===n.length?"0s":n}formatForPlayhead(e){let t=e,n="";if(t>=Ao){const e=Math.floor(t/Ao);n+=Ea(e.toString(),2,"0")+"h",t%=Ao}if(t>=To){const e=Math.floor(t/To);n+=Ea(e.toString(),2,"0")+"m",t%=To}else n.length>0&&(n+="00m");if(t>=Io){const e=Math.floor(t/Io);n+=Ea(e.toString(),2,"0")+"s",t%=Io}else n+="00s";const r=1/this._fps;if(t>=r){const e=Math.round(t/r);n+=Ea(e.toString(),2,"0")+"f",t%=r}else if(t/r>.98){n+=Ea(1..toString(),2,"0")+"f",t%=r}else n+="00f";return 0===n.length?"00s00f":n}formatBasic(e){return e.toFixed(2)+"s"}},Io=1,To=60*Io,Ao=60*To,zo={};function Oo(e,t){return e.length<=t?e:e.substr(0,t-3)+"..."}v(zo,{boolean:()=>es,compound:()=>Vo,file:()=>qo,image:()=>Wo,number:()=>Ko,rgba:()=>Yo,string:()=>rs,stringLiteral:()=>as});var Fo=e=>"string"===typeof e?'string("'.concat(Oo(e,10),'")'):"number"===typeof e?"number(".concat(Oo(String(e),10),")"):null===e?"null":void 0===e?"undefined":"boolean"===typeof e?String(e):Array.isArray(e)?"array":"object"===typeof e?"object":"unknown";function Mo(e){return g(m({},e),{toString(){return function(e){let{removeAlphaIfOpaque:t=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(255*e.a|256).toString(16).slice(1),r=(255*e.r|256).toString(16).slice(1)+(255*e.g|256).toString(16).slice(1)+(255*e.b|256).toString(16).slice(1)+(t&&"ff"===n?"":n);return"#".concat(r)}(this,{removeAlphaIfOpaque:!0})}})}function jo(e){function t(e){return e>=.0031308?1.055*e**(1/2.4)-.055:12.92*e}return function(e){return Object.fromEntries(Object.entries(e).map(e=>{let[t,n]=e;return[t,ir(n,0,1)]}))}({r:t(e.r),g:t(e.g),b:t(e.b),a:e.a})}function Bo(e){function t(e){return e>=.04045?((e+.055)/1.055)**2.4:e/12.92}return{r:t(e.r),g:t(e.g),b:t(e.b),a:e.a}}function Ro(e){let t=.4122214708*e.r+.5363325363*e.g+.0514459929*e.b,n=.2119034982*e.r+.6806995451*e.g+.1073969566*e.b,r=.0883024619*e.r+.2817188376*e.g+.6299787005*e.b,i=Math.cbrt(t),a=Math.cbrt(n),o=Math.cbrt(r);return{L:.2104542553*i+.793617785*a-.0040720468*o,a:1.9779984951*i-2.428592205*a+.4505937099*o,b:.0259040371*i+.7827717662*a-.808675766*o,alpha:e.a}}var Lo=Symbol("TheatrePropType_Basic");function No(e){return"object"===typeof e&&!!e&&"TheatrePropType"===e[Lo]}function Uo(e){if("number"===typeof e)return Ko(e);if("boolean"===typeof e)return es(e);if("string"===typeof e)return rs(e);if("object"===typeof e&&e){if(No(e))return e;if(Bn(e))return Vo(e);throw new ro("This value is not a valid prop type: ".concat(Fo(e)))}throw new ro("This value is not a valid prop type: ".concat(Fo(e)))}var Vo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=function(e){const t={};for(const n of Object.keys(e)){const r=e[n];No(r)?t[n]=r:t[n]=Uo(r)}return t}(e),r=new WeakMap;return{type:"compound",props:n,valueType:null,[Lo]:"TheatrePropType",label:t.label,default:ia(n,e=>e.default),deserializeAndSanitize:e=>{if("object"!==typeof e||!e)return;if(r.has(e))return r.get(e);const t={};let i=!1;for(const[r,a]of Object.entries(n))if(Object.prototype.hasOwnProperty.call(e,r)){const n=a.deserializeAndSanitize(e[r]);null!=n&&(i=!0,t[r]=n)}return r.set(e,t),i?t:void 0}}},qo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"file",default:{type:"file",id:e},valueType:null,[Lo]:"TheatrePropType",label:t.label,interpolate:(e,n,r)=>{var i;return{type:"file",id:(null!=(i=t.interpolate)?i:ns)(e.id,n.id,r)}},deserializeAndSanitize:Ho}},Ho=e=>{if(!e)return;let t=!0;return"string"===typeof e.id||[null,void 0].includes(e.id)||(t=!1),"file"!==e.type&&(t=!1),t?e:void 0},Wo=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{type:"image",default:{type:"image",id:e},valueType:null,[Lo]:"TheatrePropType",label:t.label,interpolate:(e,n,r)=>{var i;return{type:"image",id:(null!=(i=t.interpolate)?i:ns)(e.id,n.id,r)}},deserializeAndSanitize:Zo}},Zo=e=>{if(!e)return;let t=!0;return"string"===typeof e.id||[null,void 0].includes(e.id)||(t=!1),"image"!==e.type&&(t=!1),t?e:void 0},Ko=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return g(m({type:"number",valueType:0,default:e,[Lo]:"TheatrePropType"},t||{}),{label:t.label,nudgeFn:null!=(n=t.nudgeFn)?n:os,nudgeMultiplier:"number"===typeof t.nudgeMultiplier?t.nudgeMultiplier:void 0,interpolate:$o,deserializeAndSanitize:Go(t.range)})},Go=e=>e?t=>{if("number"===typeof t&&isFinite(t))return ir(t,e[0],e[1])}:Xo,Xo=e=>"number"===typeof e&&isFinite(e)?e:void 0,$o=(e,t,n)=>e+n*(t-e),Yo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{r:0,g:0,b:0,a:1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={};for(const r of["r","g","b","a"])n[r]=Math.min(Math.max(e[r],0),1);return{type:"rgba",valueType:null,default:Mo(n),[Lo]:"TheatrePropType",label:t.label,interpolate:Qo,deserializeAndSanitize:Jo}},Jo=e=>{if(!e)return;let t=!0;for(const r of["r","g","b","a"])Object.prototype.hasOwnProperty.call(e,r)&&"number"===typeof e[r]||(t=!1);if(!t)return;const n={};for(const r of["r","g","b","a"])n[r]=Math.min(Math.max(e[r],0),1);return Mo(n)},Qo=(e,t,n)=>{const r=Ro(Bo(e)),i=Ro(Bo(t));return Mo(jo(function(e){let t=e.L+.3963377774*e.a+.2158037573*e.b,n=e.L-.1055613458*e.a-.0638541728*e.b,r=e.L-.0894841775*e.a-1.291485548*e.b,i=t*t*t,a=n*n*n,o=r*r*r;return{r:4.0767416621*i-3.3077115913*a+.2309699292*o,g:-1.2684380046*i+2.6097574011*a-.3413193965*o,b:-.0041960863*i-.7034186147*a+1.707614701*o,a:e.alpha}}({L:(1-n)*r.L+n*i.L,a:(1-n)*r.a+n*i.a,b:(1-n)*r.b+n*i.b,alpha:(1-n)*r.alpha+n*i.alpha})))},es=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return{type:"boolean",default:e,valueType:null,[Lo]:"TheatrePropType",label:t.label,interpolate:null!=(n=t.interpolate)?n:ns,deserializeAndSanitize:ts}},ts=e=>"boolean"===typeof e?e:void 0;function ns(e){return e}var rs=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return{type:"string",default:e,valueType:null,[Lo]:"TheatrePropType",label:t.label,interpolate:null!=(n=t.interpolate)?n:ns,deserializeAndSanitize:is}};function is(e){return"string"===typeof e?e:void 0}function as(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r,i;return{type:"stringLiteral",default:e,valuesAndLabels:m({},t),[Lo]:"TheatrePropType",valueType:null,as:null!=(r=n.as)?r:"menu",label:n.label,interpolate:null!=(i=n.interpolate)?i:ns,deserializeAndSanitize(e){if("string"===typeof e)return Object.prototype.hasOwnProperty.call(t,e)?e:void 0}}}var os=e=>{let{config:t,deltaX:n,deltaFraction:r,magnitude:i}=e;var a;const{range:o}=t;return t.nudgeMultiplier||!o||o.includes(1/0)||o.includes(-1/0)?n*i*(null!=(a=t.nudgeMultiplier)?a:1):r*(o[1]-o[0])*i};function ss(e,t){return e.replace(/^[\s\/]*/,"").replace(/[\s\/]*$/,"").replace(/\s*\/\s*/g," / ")}b(E());var ls,us,cs=class{get type(){return"Theatre_Sheet_PublicAPI"}constructor(e){z(this,e)}object(e,t,n){const r=A(this),i=ss(e),a=r.getObject(i),o=null==n?void 0:n.__actions__THIS_API_IS_UNSTABLE_AND_WILL_CHANGE_IN_THE_NEXT_VERSION;if(a)return o&&a.template._temp_setActions(o),a.publicApi;{const e=Vo(t);return r.createObject(i,null,e,o).publicApi}}__experimental_getExistingObject(e){const t=A(this),n=ss(e),r=t.getObject(n);return null==r?void 0:r.publicApi}get sequence(){return A(this).getSequence().publicApi}get project(){return A(this).project.publicApi}get address(){return m({},A(this).address)}detachObject(e){const t=A(this),n=ss(e,'sheet.deleteObject("'.concat(e,'")'));if(!t.getObject(n))return go.warning("Couldn't delete object \"".concat(n,'"'),'There is no object with key "'.concat(n,'".\n\nTo fix this, make sure you are calling `sheet.deleteObject("').concat(n,'")` with the correct key.')),void console.warn('Object key "'.concat(n,'" does not exist.'));t.deleteObject(n)}},ds=n(194),hs=class{constructor(e,t){this.template=e,this.instanceId=t,x(this,"_objects",new ds.Atom({})),x(this,"_sequence"),x(this,"address"),x(this,"publicApi"),x(this,"project"),x(this,"objectsP",this._objects.pointer),x(this,"type","Theatre_Sheet"),x(this,"_logger"),this._logger=e.project._logger.named("Sheet",t),this._logger._trace("creating sheet"),this.project=e.project,this.address=g(m({},e.address),{sheetInstanceId:this.instanceId}),this.publicApi=new cs(this)}createObject(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const i=this.template.getObjectTemplate(e,t,n,r).createInstance(this,t,n);return this._objects.setByPointer(t=>t[e],i),i}getObject(e){return this._objects.get()[e]}deleteObject(e){this._objects.reduce(t=>{const n=m({},t);return delete n[e],n})}getSequence(){if(!this._sequence){const e=(0,ds.prism)(()=>{const e=(0,ds.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.length);return fs(e)}),t=(0,ds.prism)(()=>{const e=(0,ds.val)(this.project.pointers.historic.sheetsById[this.address.sheetId].sequence.subUnitsPerUnit);return ps(e)});this._sequence=new Po(this.template.project,this,e,t)}return this._sequence}},fs=e=>"number"===typeof e&&isFinite(e)&&e>0?e:10,ps=e=>"number"===typeof e&&ra(e)&&e>=1&&e<=1e3?e:30,ms=class{constructor(e,t){this.project=e,x(this,"type","Theatre_SheetTemplate"),x(this,"address"),x(this,"_instances",new eo.Atom({})),x(this,"instancesP",this._instances.pointer),x(this,"_objectTemplates",new eo.Atom({})),x(this,"objectTemplatesP",this._objectTemplates.pointer),this.address=g(m({},e.address),{sheetId:t})}getInstance(e){let t=this._instances.get()[e];return t||(t=new hs(this,e),this._instances.setByPointer(t=>t[e],t)),t}getObjectTemplate(e,t,n,r){let i=this._objectTemplates.get()[e];return i||(i=new Ja(this,e,t,n,r),this._objectTemplates.setByPointer(t=>t[e],i)),i}},gs=n(194),ys=n(194),vs=e=>new Promise(t=>setTimeout(t,e));function _s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map(function(e){return"'"+e+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function bs(e){return!!e&&!!e[rl]}function xs(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===il}(e)||Array.isArray(e)||!!e[nl]||!!e.constructor[nl]||Cs(e)||Ps(e))}function ws(e,t,n){void 0===n&&(n=!1),0===ks(e)?(n?Object.keys:al)(e).forEach(function(r){n&&"symbol"==typeof r||t(r,e[r],e)}):e.forEach(function(n,r){return t(r,n,e)})}function ks(e){var t=e[rl];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:Cs(e)?2:Ps(e)?3:0}function Ss(e,t){return 2===ks(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Es(e,t,n){var r=ks(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function Cs(e){return Js&&e instanceof Map}function Ps(e){return Qs&&e instanceof Set}function Ds(e){return e.o||e.t}function Is(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=ol(e);delete t[rl];for(var n=al(t),r=0;r<n.length;r++){var i=n[r],a=t[i];!1===a.writable&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function Ts(e,t){return void 0===t&&(t=!1),zs(e)||bs(e)||!xs(e)||(ks(e)>1&&(e.set=e.add=e.clear=e.delete=As),Object.freeze(e),t&&ws(e,function(e,t){return Ts(t,!0)},!0)),e}function As(){_s(2)}function zs(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function Os(e){var t=sl[e];return t||_s(18,e),t}function Fs(){return us}function Ms(e,t){t&&(Os("Patches"),e.u=[],e.s=[],e.v=t)}function js(e){Bs(e),e.p.forEach(Ls),e.p=null}function Bs(e){e===us&&(us=e.l)}function Rs(e){return us={p:[],l:us,h:e,m:!0,_:0}}function Ls(e){var t=e[rl];0===t.i||1===t.i?t.j():t.O=!0}function Ns(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.g||Os("ES5").S(t,e,r),r?(n[rl].P&&(js(t),_s(4)),xs(e)&&(e=Us(t,e),t.l||qs(t,e)),t.u&&Os("Patches").M(n[rl],e,t.u,t.s)):e=Us(t,n,[]),js(t),t.u&&t.v(t.u,t.s),e!==tl?e:void 0}function Us(e,t,n){if(zs(t))return t;var r=t[rl];if(!r)return ws(t,function(i,a){return Vs(e,r,t,i,a,n)},!0),t;if(r.A!==e)return t;if(!r.P)return qs(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var i=4===r.i||5===r.i?r.o=Is(r.k):r.o;ws(3===r.i?new Set(i):i,function(t,a){return Vs(e,r,i,t,a,n)}),qs(e,i,!1),n&&e.u&&Os("Patches").R(r,n,e.u,e.s)}return r.o}function Vs(e,t,n,r,i,a){if(bs(i)){var o=Us(e,i,a&&t&&3!==t.i&&!Ss(t.D,r)?a.concat(r):void 0);if(Es(n,r,o),!bs(o))return;e.m=!1}if(xs(i)&&!zs(i)){if(!e.h.F&&e._<1)return;Us(e,i),t&&t.A.l||qs(e,i)}}function qs(e,t,n){void 0===n&&(n=!1),e.h.F&&e.m&&Ts(t,n)}function Hs(e,t){var n=e[rl];return(n?Ds(n):e)[t]}function Ws(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function Zs(e){e.P||(e.P=!0,e.l&&Zs(e.l))}function Ks(e){e.o||(e.o=Is(e.t))}function Gs(e,t,n){var r=Cs(t)?Os("MapSet").N(t,n):Ps(t)?Os("MapSet").T(t,n):e.g?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:Fs(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=r,a=ll;n&&(i=[r],a=ul);var o=Proxy.revocable(i,a),s=o.revoke,l=o.proxy;return r.k=l,r.j=s,l}(t,n):Os("ES5").J(t,n);return(n?n.A:Fs()).p.push(r),r}function Xs(e){return bs(e)||_s(22,e),function e(t){if(!xs(t))return t;var n,r=t[rl],i=ks(t);if(r){if(!r.P&&(r.i<4||!Os("ES5").K(r)))return r.t;r.I=!0,n=$s(t,i),r.I=!1}else n=$s(t,i);return ws(n,function(t,i){r&&function(e,t){return 2===ks(e)?e.get(t):e[t]}(r.t,t)===i||Es(n,t,e(i))}),3===i?new Set(n):n}(e)}function $s(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Is(e)}var Ys="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Js="undefined"!=typeof Map,Qs="undefined"!=typeof Set,el="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,tl=Ys?Symbol.for("immer-nothing"):((ls={})["immer-nothing"]=!0,ls),nl=Ys?Symbol.for("immer-draftable"):"__$immer_draftable",rl=Ys?Symbol.for("immer-state"):"__$immer_state",il=""+Object.prototype.constructor,al="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,ol=Object.getOwnPropertyDescriptors||function(e){var t={};return al(e).forEach(function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)}),t},sl={},ll={get:function(e,t){if(t===rl)return e;var n=Ds(e);if(!Ss(n,t))return function(e,t,n){var r,i=Ws(t,n);return i?"value"in i?i.value:null===(r=i.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!xs(r)?r:r===Hs(e.t,t)?(Ks(e),e.o[t]=Gs(e.A.h,r,e)):r},has:function(e,t){return t in Ds(e)},ownKeys:function(e){return Reflect.ownKeys(Ds(e))},set:function(e,t,n){var r=Ws(Ds(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var i=Hs(Ds(e),t),a=null==i?void 0:i[rl];if(a&&a.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,i)&&(void 0!==n||Ss(e.t,t)))return!0;Ks(e),Zs(e)}return e.o[t]===n&&"number"!=typeof n&&(void 0!==n||t in e.o)||(e.o[t]=n,e.D[t]=!0,!0)},deleteProperty:function(e,t){return void 0!==Hs(e.t,t)||t in e.t?(e.D[t]=!1,Ks(e),Zs(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Ds(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){_s(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){_s(12)}},ul={};ws(ll,function(e,t){ul[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),ul.deleteProperty=function(e,t){return ll.deleteProperty.call(this,e[0],t)},ul.set=function(e,t,n){return ll.set.call(this,e[0],t,n,e[0])};var cl=function(){function e(e){var t=this;this.g=el,this.F=!0,this.produce=function(e,n,r){if("function"==typeof e&&"function"!=typeof n){var i=n;n=e;var a=t;return function(e){var t=this;void 0===e&&(e=i);for(var r=arguments.length,o=Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return a.produce(e,function(e){var r;return(r=n).call.apply(r,[t,e].concat(o))})}}var o;if("function"!=typeof n&&_s(6),void 0!==r&&"function"!=typeof r&&_s(7),xs(e)){var s=Rs(t),l=Gs(t,e,void 0),u=!0;try{o=n(l),u=!1}finally{u?js(s):Bs(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then(function(e){return Ms(s,r),Ns(e,s)},function(e){throw js(s),e}):(Ms(s,r),Ns(o,s))}if(!e||"object"!=typeof e){if((o=n(e))===tl)return;return void 0===o&&(o=e),t.F&&Ts(o,!0),o}_s(21,e)},this.produceWithPatches=function(e,n){return"function"==typeof e?function(n){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.produceWithPatches(n,function(t){return e.apply(void 0,[t].concat(i))})}:[t.produce(e,n,function(e,t){r=e,i=t}),r,i];var r,i},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){xs(e)||_s(8),bs(e)&&(e=Xs(e));var t=Rs(this),n=Gs(this,e,void 0);return n[rl].C=!0,Bs(t),n},t.finishDraft=function(e,t){var n=(e&&e[rl]).A;return Ms(n,t),Ns(void 0,n)},t.setAutoFreeze=function(e){this.F=e},t.setUseProxies=function(e){e&&!el&&_s(20),this.g=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var i=Os("Patches").$;return bs(e)?i(e,t):this.produce(e,function(e){return i(e,t.slice(n+1))})},e}(),dl=new cl,hl=(dl.produce,dl.produceWithPatches.bind(dl),dl.setAutoFreeze.bind(dl),dl.setUseProxies.bind(dl),dl.applyPatches.bind(dl),dl.createDraft.bind(dl),dl.finishDraft.bind(dl),{currentProjectStateDefinitionVersion:"0.4.0"});async function fl(e,t,n){await vs(0),e.transaction(e=>{let{drafts:r}=e;var i;const a=t.address.projectId;function o(){r.ephemeral.coreByProject[a].loadingState={type:"loaded"}}r.ephemeral.coreByProject[a]={lastExportedObject:null,loadingState:{type:"loading"}},r.ahistoric.coreByProject[a]={ahistoricStuff:""};const s=null==(bs(l=r.historic)||_s(23,l),i=l[rl].t)?void 0:i.coreByProject[t.address.projectId];var l,u,c;s?n&&-1==s.revisionHistory.indexOf(n.revisionHistory[0])?(u=n,r.ephemeral.coreByProject[a].loadingState={type:"browserStateIsNotBasedOnDiskState",onDiskState:u}):o():n?(c=n,r.ephemeral.coreByProject[a].loadingState={type:"loaded"},r.historic.coreByProject[a]=c):(r.ephemeral.coreByProject[a].loadingState={type:"loaded"},r.historic.coreByProject[a]={sheetsById:{},definitionVersion:hl.currentProjectStateDefinitionVersion,revisionHistory:[]})})}function pl(){}function ml(e){var t,n;const r=(null==(t=null==e?void 0:e.logging)?void 0:t.internal)?null!=(n=e.logging.min)?n:256:1/0,i=r<=512,a=Na(void 0,{_debug:r<=128?console.debug.bind(console,"_coreLogger(TheatreInternalLogger) debug"):pl,_error:i?console.error.bind(console,"_coreLogger(TheatreInternalLogger) error"):pl});if(e){const{logger:t,logging:n}=e;t&&a.configureLogger(t),n?a.configureLogging(n):a.configureLogging({dev:!1})}return a.getLogger().named("Theatre")}var gl=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;var r;this.config=t,this.publicApi=n,x(this,"pointers"),x(this,"_pointerProxies"),x(this,"address"),x(this,"_studioReadyDeferred"),x(this,"_assetStorageReadyDeferred"),x(this,"_readyPromise"),x(this,"_sheetTemplates",new ys.Atom({})),x(this,"sheetTemplatesP",this._sheetTemplates.pointer),x(this,"_studio"),x(this,"assetStorage"),x(this,"type","Theatre_Project"),x(this,"_logger"),this._logger=ml({logging:{dev:!0}}).named("Project",e),this._logger.traceDev("creating project"),this.address={projectId:e};const i=new ys.Atom({ahistoric:{ahistoricStuff:""},historic:null!=(r=t.state)?r:{sheetsById:{},definitionVersion:hl.currentProjectStateDefinitionVersion,revisionHistory:[]},ephemeral:{loadingState:{type:"loaded"},lastExportedObject:null}});this._assetStorageReadyDeferred=lo(),this.assetStorage={getAssetUrl:e=>{var n;return"".concat(null==(n=t.assets)?void 0:n.baseUrl,"/").concat(e)},createAsset:()=>{throw new Error("Please wait for Project.ready to use assets.")}},this._pointerProxies={historic:new gs.PointerProxy(i.pointer.historic),ahistoric:new gs.PointerProxy(i.pointer.ahistoric),ephemeral:new gs.PointerProxy(i.pointer.ephemeral)},this.pointers={historic:this._pointerProxies.historic.pointer,ahistoric:this._pointerProxies.ahistoric.pointer,ephemeral:this._pointerProxies.ephemeral.pointer},I.add(e,this),this._studioReadyDeferred=lo(),this._readyPromise=Promise.all([this._studioReadyDeferred.promise,this._assetStorageReadyDeferred.promise]).then(()=>{}),t.state?setTimeout(()=>{this._studio||(this._studioReadyDeferred.resolve(void 0),this._assetStorageReadyDeferred.resolve(void 0),this._logger._trace("ready deferred resolved with no state"))},0):"undefined"===typeof window?console.error('Argument config.state in Theatre.getProject("'.concat(e,'", config) is empty. ')+"You can safely ignore this message if you're developing a Next.js/Remix project in development mode. But if you are shipping to your end-users, then you need to set config.state, otherwise your project's state will be empty and nothing will animate. Learn more at https://www.theatrejs.com/docs/latest/manual/projects#state"):setTimeout(()=>{if(!this._studio)throw new Error('Argument config.state in Theatre.getProject("'.concat(e,'", config) is empty. This is fine ')+"while you are using @theatre/core along with @theatre/studio. But since @theatre/studio "+'is not loaded, the state of project "'.concat(e,'" will be empty.\n\n')+"To fix this, you need to add @theatre/studio into the bundle and export the project's state. Learn how to do that at https://www.theatrejs.com/docs/latest/manual/projects#state\n")},1e3)}attachToStudio(e){if(this._studio){if(this._studio!==e)throw new Error("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId));console.warn("Project ".concat(this.address.projectId," is already attached to studio ").concat(this._studio.address.studioId))}else this._studio=e,e.initialized.then(async()=>{var t;await fl(e,this,this.config.state),this._pointerProxies.historic.setPointer(e.atomP.historic.coreByProject[this.address.projectId]),this._pointerProxies.ahistoric.setPointer(e.atomP.ahistoric.coreByProject[this.address.projectId]),this._pointerProxies.ephemeral.setPointer(e.atomP.ephemeral.coreByProject[this.address.projectId]),await e.createAssetStorage(this,null==(t=this.config.assets)?void 0:t.baseUrl).then(e=>{this.assetStorage=e,this._assetStorageReadyDeferred.resolve(void 0)}),this._studioReadyDeferred.resolve(void 0)}).catch(e=>{throw console.error(e),e})}get isAttachedToStudio(){return!!this._studio}get ready(){return this._readyPromise}isReady(){return"resolved"===this._studioReadyDeferred.status&&"resolved"===this._assetStorageReadyDeferred.status}getOrCreateSheet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=this._sheetTemplates.get()[e];return n||(n=new ms(this,e),this._sheetTemplates.reduce(t=>g(m({},t),{[e]:n}))),n.getInstance(t)}},yl=class{get type(){return"Theatre_Project_PublicAPI"}constructor(e){z(this,new gl(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},this))}get ready(){return A(this).ready}get isReady(){return A(this).isReady()}get address(){return m({},A(this).address)}getAssetUrl(e){if(this.isReady)return e.id?A(this).assetStorage.getAssetUrl(e.id):void 0;console.error("Calling `project.getAssetUrl()` before `project.ready` is resolved, will always return `undefined`. Either use `project.ready.then(() => project.getAssetUrl())` or `await project.ready` before calling `project.getAssetUrl()`.")}sheet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";const n=ss(e);return A(this).getOrCreateSheet(n,t).publicApi}},vl=(b(E()),n(194)),_l=n(194);function bl(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=I.get(e);if(n)return n.publicApi;const r=ml().named("Project",e);return t.state?(xl(e,t.state),r._debug("deep validated config.state on disk")):r._debug("no config.state"),new yl(e,t)}var xl=(e,t)=>{((e,t)=>{if(Array.isArray(t)||null==t||t.definitionVersion!==hl.currentProjectStateDefinitionVersion)throw new ro("Error validating conf.state in Theatre.getProject(".concat(JSON.stringify(e),", conf). The state seems to be formatted in a way that is unreadable to Theatre.js. Read more at https://www.theatrejs.com/docs/latest/manual/projects#state"))})(e,t)};function wl(e,t,n){const r=n?A(n).ticker:ko();if((0,vl.isPointer)(e)){return(0,_l.pointerToPrism)(e).onChange(r,t,!0)}if((0,_l.isPrism)(e))return e.onChange(r,t,!0);throw new Error("Called onChange(p) where p is neither a pointer nor a prism.")}function kl(e){if((0,vl.isPointer)(e))return(0,_l.pointerToPrism)(e).getValue();throw new Error("Called val(p) where p is not a pointer.")}var Sl=class{constructor(){x(this,"_studio")}get type(){return"Theatre_CoreBundle"}get version(){return"0.7.2"}getBitsForStudio(e,t){if(this._studio)throw new Error("@theatre/core is already attached to @theatre/studio");this._studio=e;t({projectsP:I.atom.pointer.projects,privateAPI:A,coreExports:P,getCoreRafDriver:wo})}};!function(){if("undefined"==typeof window)return;const e=window[po];if("undefined"!==typeof e)throw"object"===typeof e&&e&&"string"===typeof e.version?new Error("It seems that the module '@theatre/core' is loaded more than once. This could have two possible causes:\n1. You might have two separate versions of Theatre.js in node_modules.\n2. Or this might be a bundling misconfiguration, in case you're using a bundler like Webpack/ESBuild/Rollup.\n\nNote that it **is okay** to import '@theatre/core' multiple times. But those imports should point to the same module."):new Error("The variable window.".concat(po," seems to be already set by a module other than @theatre/core."));const t=new Sl;window[po]=t;const n=window.__TheatreJS_StudioBundle;n&&null!==n&&"Theatre_StudioBundle"===n.type&&n.registerCoreBundle(t)}()},897(e,t,n){var r=n(693);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}e.exports=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},950(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,r)=>(n.f[r](e,t),t),[])),n.u=e=>"static/js/"+e+"."+{453:"63a3c358",726:"8949fc63"}[e]+".chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="map-animator-v2:";n.l=(r,i,a,o)=>{if(e[r])e[r].push(i);else{var s,l;if(void 0!==a)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var d=u[c];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+a){s=d;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[i];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach(e=>e(n)),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}}})(),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="./",(()=>{n.b="undefined"!==typeof document&&document.baseURI||self.location.href;var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var a=new Promise((n,r)=>i=e[t]=[n,r]);r.push(i[2]=a);var o=n.p+n.u(t),s=new Error;n.l(o,r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",s.name="ChunkLoadError",s.type=a,s.request=o,i[1](s)}},"chunk-"+t,t)}};var t=(t,r)=>{var i,a,[o,s,l]=r,u=0;if(o.some(t=>0!==e[t])){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)l(n)}for(t&&t(r);u<o.length;u++)a=o[u],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkmap_animator_v2=self.webpackChunkmap_animator_v2||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),n.nc=void 0,(()=>{"use strict";var e=n(43),t=n(391);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=n(66),u=n.n(l);function c(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{l(r.next(e))}catch(t){a(t)}}function s(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}l((r=r.apply(e,t||[])).next())})}"function"===typeof SuppressedError&&SuppressedError;var d,h,f="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{};function p(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function m(){if(h)return d;h=1,d=function(){for(var t={},n=0;n<arguments.length;n++){var r=arguments[n];for(var i in r)e.call(r,i)&&(t[i]=r[i])}return t};var e=Object.prototype.hasOwnProperty;return d}var g,y,v,_,b,x,w,k={exports:{}};function S(){return g||(g=1,e=k,function(){var t={};e.exports=t,t.simpleFilter=function(e,n){return n.filter(function(n){return t.test(e,n)})},t.test=function(e,n){return null!==t.match(e,n)},t.match=function(e,t,n){n=n||{};var r,i=0,a=[],o=t.length,s=0,l=0,u=n.pre||"",c=n.post||"",d=n.caseSensitive&&t||t.toLowerCase();e=n.caseSensitive&&e||e.toLowerCase();for(var h=0;h<o;h++)r=t[h],d[h]===e[i]?(r=u+r+c,i+=1,l+=1+l):l=0,s+=l,a[a.length]=r;return i===e.length?(s=d===e?1/0:s,{rendered:a.join(""),score:s}):null},t.filter=function(e,n,r){return n&&0!==n.length?"string"!==typeof e?n:(r=r||{},n.reduce(function(n,i,a,o){var s=i;r.extract&&(s=r.extract(i));var l=t.match(e,s,r);return null!=l&&(n[n.length]={string:l.rendered,score:l.score,index:a,original:i}),n},[]).sort(function(e,t){var n=t.score-e.score;return n||e.index-t.index})):[]}}()),k.exports;var e}function E(){if(b)return _;b=1;var e=m(),t=S(),n=function(){if(v)return y;v=1;var e=function(e){return this.component=e,this.items=[],this.active=e.options.noInitialSelection?-1:0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,e.el.parentNode.insertBefore(this.wrapper,e.el.nextSibling),this};return e.prototype.show=function(){this.element.style.display="block"},e.prototype.hide=function(){this.element.style.display="none"},e.prototype.add=function(e){this.items.push(e)},e.prototype.clear=function(){this.items=[],this.active=this.component.options.noInitialSelection?-1:0},e.prototype.isEmpty=function(){return!this.items.length},e.prototype.isVisible=function(){return"block"===this.element.style.display},e.prototype.draw=function(){if(this.element.innerHTML="",0!==this.items.length){for(var e=0;e<this.items.length;e++)this.drawItem(this.items[e],this.active===e);this.show()}else this.hide()},e.prototype.drawItem=function(e,t){var n=document.createElement("li"),r=document.createElement("a");t&&(n.className+=" active"),r.innerHTML=e.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",function(){this.selectingListItem=!0}.bind(this)),n.addEventListener("mouseup",function(){this.handleMouseUp.call(this,e)}.bind(this))},e.prototype.handleMouseUp=function(e){this.selectingListItem=!1,this.component.value(e.original),this.clear(),this.draw()},e.prototype.move=function(e){this.active=e,this.draw()},e.prototype.previous=function(){this.move(this.active<=0?this.items.length-1:this.active-1)},e.prototype.next=function(){this.move(this.active>=this.items.length-1?0:this.active+1)},e.prototype.drawError=function(e){var t=document.createElement("li");t.innerHTML=e,this.element.appendChild(t),this.show()},y=e}(),r=function(t,r,i){return i=i||{},this.options=e({minLength:2,limit:5,filter:!0,hideOnBlur:!0,noInitialSelection:!0},i),this.el=t,this.data=r||[],this.list=new n(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",function(e){this.handleKeyUp(e.keyCode,e)}.bind(this),!1),this.el.addEventListener("keydown",function(e){this.handleKeyDown(e)}.bind(this)),this.el.addEventListener("focus",function(){this.handleFocus()}.bind(this)),this.el.addEventListener("blur",function(){this.handleBlur()}.bind(this)),this.el.addEventListener("paste",function(e){this.handlePaste(e)}.bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};return r.prototype.handleKeyUp=function(e,t){40!==e&&38!==e&&27!==e&&9!==e&&(13!==e?this.handleInputChange(this.el.value):this.list.items[this.list.active]&&(this.list.handleMouseUp(this.list.items[this.list.active]),t.stopPropagation()))},r.prototype.handleKeyDown=function(e){switch(e.keyCode){case 13:this.list.active>=0&&(this.list.selectingListItem=!0);break;case 9:this.list.isEmpty()||(this.list.isVisible()&&e.preventDefault(),this.value(this.list.active>=0?this.list.items[this.list.active].original:null),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next()}},r.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()},r.prototype.handlePaste=function(e){if(e.clipboardData)this.handleInputChange(e.clipboardData.getData("Text"));else{var t=this;setTimeout(function(){t.handleInputChange(e.target.value)},100)}},r.prototype.handleInputChange=function(e){this.query=this.normalize(e),this.list.clear(),this.query.length<this.options.minLength?this.list.draw():this.getCandidates(function(e){for(var t=0;t<e.length&&(this.list.add(e[t]),t!==this.options.limit-1);t++);this.list.draw()}.bind(this))},r.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1},r.prototype.update=function(e){this.data=e,this.handleKeyUp()},r.prototype.clear=function(){this.data=[],this.list.clear()},r.prototype.normalize=function(e){return e=e.toLowerCase()},r.prototype.match=function(e,t){return e.indexOf(t)>-1},r.prototype.value=function(e){if(this.selected=e,this.el.value=this.getItemValue(e||{place_name:this.query}),document.createEvent){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),this.el.dispatchEvent(t)}else this.el.fireEvent("onchange")},r.prototype.getCandidates=function(e){var n={pre:"<strong>",post:"</strong>",extract:function(e){return this.getItemValue(e)}.bind(this)};e(this.options.filter?t.filter(this.query,this.data,n).map(function(e){return{original:e.original,string:this.render(e.original,e.string)}}.bind(this)):this.data.map(function(e){return{original:e,string:this.render(e)}}.bind(this)))},r.prototype.getItemValue=function(e){return e},r.prototype.render=function(e,t){if(t)return t;for(var n=e.original?this.getItemValue(e.original):this.getItemValue(e),r=this.normalize(n),i=r.lastIndexOf(this.query);i>-1;){var a=i+this.query.length;n=n.slice(0,i)+"<strong>"+n.slice(i,a)+"</strong>"+n.slice(a),i=r.slice(0,i).lastIndexOf(this.query)}return n},r.prototype.renderError=function(e){this.list.drawError(e)},_=r}var C,P=p(function(){if(w)return x;w=1;var e=E();return x=e,"undefined"!==typeof window&&(window.Suggestions=e),x}()),D={exports:{}},I=D.exports;var T,A,z=function(){return C||(C=1,e=D,function(t,n,r){e.exports?e.exports=r():t.subtag=r()}(I,0,function(){var e=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function t(t){return t.match(e)||[]}function n(e){return{language:(e=t(e))[1]||"",extlang:e[2]||"",script:e[3]||"",region:e[4]||""}}function r(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!0})}function i(e,i,a){function o(n){return t(n)[e]||""}r(o,"pattern",i),r(n,a,o)}return i(1,/^[a-zA-Z]{2,3}$/,"language"),i(2,/^[a-zA-Z]{3}$/,"extlang"),i(3,/^[a-zA-Z]{4}$/,"script"),i(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),r(n,"split",function(e){return t(e).filter(function(e,t){return e&&t})}),n})),D.exports;var e}(),O=p(z);var F,M=function(){if(A)return T;A=1;var e=/^\s+|\s+$/g,t=/^[-+]0x[0-9a-f]+$/i,n=/^0b[01]+$/i,r=/^0o[0-7]+$/i,i=parseInt,a="object"==typeof f&&f&&f.Object===Object&&f,o="object"==typeof self&&self&&self.Object===Object&&self,s=a||o||Function("return this")(),l=Object.prototype.toString,u=Math.max,c=Math.min,d=function(){return s.Date.now()};function h(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function p(a){if("number"==typeof a)return a;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==l.call(e)}(a))return NaN;if(h(a)){var o="function"==typeof a.valueOf?a.valueOf():a;a=h(o)?o+"":o}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(e,"");var s=n.test(a);return s||r.test(a)?i(a.slice(2),s?2:8):t.test(a)?NaN:+a}return T=function(e,t,n){var r,i,a,o,s,l,f=0,m=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=r,a=i;return r=i=void 0,f=t,o=e.apply(a,n)}function _(e){var n=e-l;return void 0===l||n>=t||n<0||g&&e-f>=a}function b(){var e=d();if(_(e))return x(e);s=setTimeout(b,function(e){var n=t-(e-l);return g?c(n,a-(e-f)):n}(e))}function x(e){return s=void 0,y&&r?v(e):(r=i=void 0,o)}function w(){var e=d(),n=_(e);if(r=arguments,i=this,l=e,n){if(void 0===s)return function(e){return f=e,s=setTimeout(b,t),m?v(e):o}(l);if(g)return s=setTimeout(b,t),v(l)}return void 0===s&&(s=setTimeout(b,t)),o}return t=p(t)||0,h(n)&&(m=!!n.leading,a=(g="maxWait"in n)?u(p(n.maxWait)||0,t):a,y="trailing"in n?!!n.trailing:y),w.cancel=function(){void 0!==s&&clearTimeout(s),f=0,r=l=i=s=void 0},w.flush=function(){return void 0===s?o:x(d())},w}}(),j=p(M),B=p(m()),R={exports:{}};var L=function(){if(F)return R.exports;F=1;var e,t="object"===typeof Reflect?Reflect:null,n=t&&"function"===typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"===typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!==e};function i(){i.init.call(this)}R.exports=i,R.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,a),r(n)}function a(){"function"===typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}p(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&p(e,"error",t,n)}(e,i,{once:!0})})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,a,l,u;if(o(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),l=a[t]),void 0===l)l=a[t]=n,++e._eventsCount;else if("function"===typeof l?l=a[t]=r?[n,l]:[l,n]:r?l.unshift(n):l.push(n),(i=s(e))>0&&l.length>i&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=l.length,u=c,console&&console.warn&&console.warn(u)}return e}function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=u.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):f(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function f(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function p(e,t,n,r){if("function"===typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(a){r.once&&e.removeEventListener(t,i),n(a)})}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return s(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(void 0===l)return!1;if("function"===typeof l)n(l,this,t);else{var u=l.length,c=f(l,u);for(r=0;r<u;++r)n(c[r],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return o(t),this.on(e,c(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,c(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,i,a,s;if(o(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return d(this,e,!0)},i.prototype.rawListeners=function(e){return d(this,e,!1)},i.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},R.exports}();const N={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};var U={placeholder:{de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"\u05dc\u05d7\u05e4\u05e9",ja:"\u30b5\u30fc\u30c1",lv:"Mekl\u0113t",pt:"Procurar",sr:"\u041f\u0440\u0435\u0442\u0440\u0430\u0433\u0430",zh:"\u641c\u7d22",cs:"Vyhled\xe1v\xe1n\xed",hu:"Keres\xe9s",ka:"\u10eb\u10d8\u10d4\u10d1\u10d0",nb:"S\xf8ke",sk:"Vyh\u013ead\xe1vanie",th:"\u0e04\u0e49\u0e19\u0e2b\u0e32",fi:"Hae",is:"Leita",ko:"\uc218\uc0c9",pl:"Szukaj",sl:"Iskanje",fa:"\u062c\u0633\u062a\u062c\u0648",ru:"\u041f\u043e\u0438\u0441\u043a",es:"Buscar"},errorNoResults:{en:"No results found",de:"Keine Ergebnisse gefunden",es:"No hay resultados",fr:"Aucun r\xe9sultat trouv\xe9"},errorConnectionFailed:{en:"There was an error reaching the server",de:"Verbindung fehlgeschlagen",es:"Error al conectarse al servidor",fr:"Une erreur est survenue lors de la connexion au serveur"}};const V=/(-?\d+\.?\d*)[, ]+(-?\d+\.?\d*)[ ]*$/;class q{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(e,t,n)=>new P(e,t,n);this.options={zoom:16,flyTo:!0,trackProximity:!0,showResultsWhileTyping:!1,minLength:2,reverseGeocode:!1,limit:5,enableEventLogging:!0,marker:!0,popup:!1,maplibregl:void 0,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,proximityMinZoom:9,getItemValue:e=>void 0!=e.text?e.text:e.place_name,render:e=>{if(!("geometry"in e)){const t=e.text,n=t.toLowerCase().indexOf(this._typeahead.query.toLowerCase()),r=this._typeahead.query.length;return'<div class="maplibregl-ctrl-geocoder--suggestion"><svg class="maplibregl-ctrl-geocoder--suggestion-icon" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M22.8702 20.1258H21.4248L20.9125 19.6318C22.7055 17.546 23.785 14.8382 23.785 11.8925C23.785 5.32419 18.4608 0 11.8925 0C5.32419 0 0 5.32419 0 11.8925C0 18.4608 5.32419 23.785 11.8925 23.785C14.8382 23.785 17.546 22.7055 19.6318 20.9125L20.1258 21.4248V22.8702L29.2739 32L32 29.2739L22.8702 20.1258ZM11.8925 20.1258C7.33676 20.1258 3.65923 16.4483 3.65923 11.8925C3.65923 7.33676 7.33676 3.65923 11.8925 3.65923C16.4483 3.65923 20.1258 7.33676 20.1258 11.8925C20.1258 16.4483 16.4483 20.1258 11.8925 20.1258Z" fill="#687078"/></svg><div class="maplibregl-ctrl-geocoder--suggestion-info"><div class="maplibregl-ctrl-geocoder--suggestion-title">'+t.substring(0,n)+'<span class="maplibregl-ctrl-geocoder--suggestion-match">'+t.substring(n,n+r)+"</span>"+t.substring(n+r)+"</div></div></div>"}const t=e.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--result"><svg class="maplibregl-ctrl-geocoder--result-icon" viewBox="0 0 24 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0C5.36571 0 0 5.38676 0 12.0471C0 21.0824 12 32 12 32C12 32 24 21.0824 24 12.0471C24 5.38676 18.6343 0 12 0ZM12 16.3496C9.63428 16.3496 7.71429 14.4221 7.71429 12.0471C7.71429 9.67207 9.63428 7.74454 12 7.74454C14.3657 7.74454 16.2857 9.67207 16.2857 12.0471C16.2857 14.4221 14.3657 16.3496 12 16.3496Z" fill="#687078"/></svg><div><div class="maplibregl-ctrl-geocoder--result-title">'+t[0]+'</div><div class="maplibregl-ctrl-geocoder--result-address">'+t.splice(1,t.length).join(",")+"</div></div></div>"},popupRender:e=>{const t=e.place_name.split(",");return'<div class="maplibregl-ctrl-geocoder--suggestion popup-suggestion"><div class="maplibregl-ctrl-geocoder--suggestion-title popup-suggestion-title">'+t[0]+'</div><div class="maplibregl-ctrl-geocoder--suggestion-address popup-suggestion-address">'+t.splice(1,t.length).join(",")+"</div></div>"},showResultMarkers:!0,debounceSearch:200},this._eventEmitter=new L.EventEmitter,this.options=B({},this.options,t),this.fresh=!0,this.lastSelected=null,this.geocoderApi=e,this.typeaheadFactory=n}addTo(e){function t(e,t){if(!document.body.contains(t))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const n=e.onAdd();t.appendChild(n)}if(e instanceof HTMLElement)t(this,e);else if("string"==typeof e){const n=document.querySelectorAll(e);if(0===n.length)throw new Error("Element "+e+"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");t(this,n[0])}else{if(!("addControl"in e))throw new Error("Error: addTo must be a maplibre-gl-js map, an html element, or a CSS selector query for a single html element");e.addControl(this)}}onAdd(e){if(e&&"string"!=typeof e&&(this._map=e),this.setLanguage(),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this);const t=this.container=document.createElement("div");t.className="maplibregl-ctrl-geocoder maplibregl-ctrl maplibregl-ctrl-geocoder maplibregl-ctrl";const n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="search",this._inputEl.className="maplibregl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",j(this._onKeyDown,this.options.debounceSearch)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton);const r=document.createElement("div");r.classList.add("maplibregl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("type","button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="maplibregl-ctrl-geocoder--button";const i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');return this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),r.appendChild(this._clearEl),r.appendChild(this._loadingEl),t.appendChild(n),t.appendChild(this._inputEl),t.appendChild(r),this._typeahead=this.typeaheadFactory(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit,noInitialSelection:!0}),this.container.addEventListener("click",()=>{this._typeahead.update(this._typeahead.data)}),this.setRenderFunction(this.options.render),this._typeahead.getItemValue=this.options.getItemValue,this.mapMarker=null,this.resultMarkers=[],this._handleMarker=this._handleMarker.bind(this),this._handleResultMarkers=this._handleResultMarkers.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._maplibregl=this.options.maplibregl,!this._maplibregl&&this.options.marker&&(console.error("No maplibregl detected in options. Map markers are disabled. Please set options.maplibregl."),this.options.marker=!1)),t}createIcon(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n.setAttribute("class","maplibregl-ctrl-geocoder--icon maplibregl-ctrl-geocoder--icon-"+e),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width","18"),n.setAttribute("height","18"),"innerHTML"in n)n.innerHTML=t;else{const e=document.createElement("div");e.innerHTML="<svg>"+t.valueOf().toString()+"</svg>";const r=e.firstChild.firstChild;n.appendChild(r)}return n}onRemove(){return this.container.remove(),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this}_onPaste(e){const t=(e.clipboardData||window.clipboardData).getData("text");t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)}_onKeyDown(e){if("Escape"===e.key&&this.options.clearAndBlurOnEsc)return this._clear(e),void this._inputEl.blur();const t=this._inputEl.value;if(!t)return this.fresh=!0,"Tab"!==e.key&&this.clear(e),void(this._clearEl.style.display="none");if(!e.metaKey&&"Tab"!==e.key&&"Escape"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key&&"ArrowUp"!==e.key&&"ArrowDown"!==e.key){if("Enter"===e.key){if(this.options.showResultsWhileTyping)return void(null==this._typeahead.selected&&this.geocoderApi.getSuggestions?this._geocode(t,!0):null==this._typeahead.selected&&this.options.showResultMarkers&&this._fitBoundsForMarkers());this._typeahead.selected||this._geocode(t)}t.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(t)}}_showButton(){this._inputEl.value.length>0&&(this._clearEl.style.display="block")}_hideButton(){this._typeahead.selected&&(this._clearEl.style.display="none")}_onBlur(e){this.options.clearOnBlur&&this._clearOnBlur(e),this.options.collapsed&&this._collapse()}_onChange(){var e;const t=this._typeahead.selected;if(t)if("geometry"in t){if(JSON.stringify(t)!==this.lastSelected){if(this._clearEl.style.display="none",this.options.flyTo){let n;if(this._removeResultMarkers(),t.properties&&N[t.properties.short_code])n=B({},this.options.flyTo),this._map&&this._map.fitBounds(N[t.properties.short_code].bbox,n);else if(t.bbox){const e=t.bbox;n=B({},this.options.flyTo),this._map&&this._map.fitBounds([[e[0],e[1]],[e[2],e[3]]],n)}else{const r={zoom:this.options.zoom};n=B({},r,this.options.flyTo),t.center?n.center=t.center:"Point"===(null===(e=t.geometry)||void 0===e?void 0:e.type)&&t.geometry.coordinates&&(n.center=t.geometry.coordinates),this._map&&this._map.flyTo(n)}}this.options.marker&&this._maplibregl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._typeahead.selected=null,this._eventEmitter.emit("result",{result:t})}}else t.placeId?this._geocode(t.placeId,!0,!0):this._geocode(t.text,!0)}_getConfigForRequest(){return["bbox","limit","proximity","countries","types","language","reverseMode"].reduce((e,t)=>(this.options[t]&&(["countries","types","language"].indexOf(t)>-1?e[t]=this.options[t].split(/[\s,]+/):e[t]=this.options[t],"proximity"===t&&this.options[t]&&"number"===typeof this.options[t].longitude&&"number"===typeof this.options[t].latitude&&(e[t]=[this.options[t].longitude,this.options[t].latitude])),e),{})}_geocode(e){return c(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){t._loadingEl.style.display="block",t._eventEmitter.emit("loading",{query:e});const i=t._getConfigForRequest(),a=t._createGeocodeRequest(i,e,n,r),o=t.options.localGeocoder&&t.options.localGeocoder(e)||[];try{const r=yield a;yield t._handleGeocodeResponse(r,i,e,n,o)}catch(s){t._handleGeocodeErrorResponse(s,o)}return a}()})}_createGeocodeRequest(e,t,n,r){return this.options.localGeocoderOnly?Promise.resolve({}):this.options.reverseGeocode&&V.test(t)?this._createReverseGeocodeRequest(t,e):(e.query=t,this.geocoderApi.getSuggestions?n?this.geocoderApi.searchByPlaceId&&r?this.geocoderApi.searchByPlaceId(e):this.geocoderApi.forwardGeocode(e):this.geocoderApi.getSuggestions(e):this.geocoderApi.forwardGeocode(e))}_createReverseGeocodeRequest(e,t){const n=e.split(/[\s(,)?]+/).map(e=>parseFloat(e)).reverse();return t.query=n,t.limit=1,"proximity"in t&&delete t.proximity,this.geocoderApi.reverseGeocode(t)}_handleGeocodeResponse(e,t,n,r,i){return c(this,void 0,void 0,function*(){this._loadingEl.style.display="none";let a={};a=e||{type:"FeatureCollection",features:[]},a.config=t,this.fresh&&(this.fresh=!1),a.features=a.features?i.concat(a.features):i;const o=this.options.externalGeocoder&&this.options.externalGeocoder(n,a.features,t)||Promise.resolve([]);try{const e=yield o;a.features=a.features?e.concat(a.features):e}catch(l){}this.options.filter&&a.features.length&&(a.features=a.features.filter(this.options.filter));let s=[];s="suggestions"in a?a.suggestions:"place"in a?Array.isArray(a.place)?a.place:[a.place]:a.features,s.length?(this._clearEl.style.display="block",this._typeahead.update(s),(!this.options.showResultsWhileTyping||r)&&this.options.showResultMarkers&&(a.features.length>0||"place"in a)&&this._fitBoundsForMarkers(),this._eventEmitter.emit("results",a)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",a))})}_handleGeocodeErrorResponse(e,t){this._loadingEl.style.display="none",t.length&&this.options.localGeocoder?(this._clearEl.style.display="block",this._typeahead.update(t)):(this._clearEl.style.display="none",this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:t}),this._eventEmitter.emit("error",{error:e})}_clear(e){e&&e.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._clearEl.style.display="none",this._removeMarker(),this._removeResultMarkers(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0}clear(e){this._clear(e),this._inputEl.focus()}_clearOnBlur(e){e.relatedTarget&&this._clear(e)}_onQueryResult(e){if(!("features"in e))return;if(!e.features.length)return;const t=e.features[0];this._typeahead.selected=t,this._inputEl.value=t.place_name,this._onChange()}_updateProximity(){if(this._map)if(this._map.getZoom()>this.options.proximityMinZoom){const e=this._map.getCenter().wrap();this.setProximity({longitude:e.lng,latitude:e.lat})}else this.setProximity(null)}_collapse(){this._inputEl.value||this._inputEl===document.activeElement||this.container.classList.add("maplibregl-ctrl-geocoder--collapsed")}_unCollapse(){this.container.classList.remove("maplibregl-ctrl-geocoder--collapsed")}query(e){return c(this,void 0,void 0,function*(){const t=yield this._geocode(e);this._onQueryResult(t)})}_renderError(){const e="<div class='maplibre-gl-geocoder--error'>".concat(this._localize("errorConnectionFailed"),"</div>");this._renderMessage(e)}_renderNoResults(){const e="<div class='maplibre-gl-geocoder--error maplibre-gl-geocoder--no-results'>\n        ".concat(this._localize("errorNoResults"),"</div>");this._renderMessage(e)}_renderMessage(e){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(e)}_localize(e){const t=O.language(this.options.language.split(",")[0]);return this.options.language&&(null===U||void 0===U?void 0:U[e][t])?U[e][t]:U[e].en}_fitBoundsForMarkers(){var e;if(this._typeahead.data.length<1)return;const t=this._typeahead.data.filter(e=>"string"!==typeof e).slice(0,this.options.limit);if(this._clearEl.style.display="none",this.options.flyTo&&this._maplibregl&&this._map){const n=B({},{padding:100},this.options.flyTo),r=new this._maplibregl.LngLatBounds;for(const i of t)"geometry"in i&&"Point"===(null===(e=i.geometry)||void 0===e?void 0:e.type)&&r.extend(i.geometry.coordinates);this._map.fitBounds(r,n)}return t.length>0&&this._maplibregl&&this._handleResultMarkers(t),this}setInput(e){return this._inputEl.value=e,this._typeahead.selected=null,this._typeahead.clear(),e.length>=this.options.minLength&&this.options.showResultsWhileTyping&&this._geocode(e),this}setProximity(e){return this.options.proximity=e,this}getProximity(){return this.options.proximity}setRenderFunction(e){return e&&"function"==typeof e&&(this._typeahead.render=e),this}getRenderFunction(){return this._typeahead.render}setLanguage(e){return this.options.language=e||this.options.language||navigator.language,this}getLanguage(){return this.options.language}getZoom(){return this.options.zoom}setZoom(e){return this.options.zoom=e,this}getFlyTo(){return this.options.flyTo}setFlyTo(e){return this.options.flyTo=e,this}getPlaceholder(){return this.options.placeholder}setPlaceholder(e){return this.options.placeholder=e||(this.options.placeholder||this._localize("placeholder")),this._inputEl.placeholder=this.options.placeholder,this._inputEl.setAttribute("aria-label",this.options.placeholder),this}getBbox(){return this.options.bbox}setBbox(e){return this.options.bbox=e,this}getCountries(){return this.options.countries}setCountries(e){return this.options.countries=e,this}getTypes(){return this.options.types}setTypes(e){return this.options.types=e,this}getMinLength(){return this.options.minLength}setMinLength(e){return this.options.minLength=e,this._typeahead&&(this._typeahead.options.minLength=e),this}getLimit(){return this.options.limit}setLimit(e){return this.options.limit=e,this._typeahead&&(this._typeahead.options.limit=e),this}getFilter(){return this.options.filter}setFilter(e){return this.options.filter=e,this}setGeocoderApi(e){return this.geocoderApi=e,this}getGeocoderApi(){return this.geocoderApi}_handleMarker(e){var t;if(!this._map)return;this._removeMarker();const n=B({},{color:"#4668F2"},this.options.marker);this.mapMarker=new this._maplibregl.Marker(n);let r=null;if(this.options.popup){const t=B({},{},this.options.popup);r=new this._maplibregl.Popup(t).setHTML(this.options.popupRender(e))}return e.center?(this.mapMarker.setLngLat(e.center).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(r)):"Point"===(null===(t=e.geometry)||void 0===t?void 0:t.type)&&e.geometry.coordinates&&(this.mapMarker.setLngLat(e.geometry.coordinates).addTo(this._map),this.options.popup&&this.mapMarker.setPopup(r)),this}_removeMarker(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)}_handleResultMarkers(e){if(!this._map)return;this._removeResultMarkers();let t=B({},{color:"#4668F2"},this.options.showResultMarkers);for(const n of e){let e;if(this.options.showResultMarkers){this.options.showResultMarkers&&this.options.showResultMarkers.element&&(e=this.options.showResultMarkers.element.cloneNode(!0),t=B(t,{element:e}));const r=new this._maplibregl.Marker(B({},t,{element:e}));let i;if(this.options.popup){const e=B({},{},this.options.popup);i=new this._maplibregl.Popup(e).setHTML(this.options.popupRender(n))}n.center?(r.setLngLat(n.center).addTo(this._map),this.options.popup&&r.setPopup(i)):n.geometry&&n.geometry.type&&"Point"===n.geometry.type&&n.geometry.coordinates&&(r.setLngLat(n.geometry.coordinates).addTo(this._map),this.options.popup&&r.setPopup(i)),this.resultMarkers.push(r)}}return this}_removeResultMarkers(){this.resultMarkers&&this.resultMarkers.length>0&&(this.resultMarkers.forEach(function(e){e.remove()}),this.resultMarkers=[])}on(e,t){return this._eventEmitter.on(e,t),this}once(e){return new Promise(t=>{this._eventEmitter.once(e,t)})}off(e,t){return this._eventEmitter.removeListener(e,t),this}}function H(e,t,n){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}function W(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function Z(e,t,n){return e.set(W(e,t),n),n}function K(e,t){return e.get(W(e,t))}"https://unpkg.com/@ffmpeg/core@".concat("0.12.9","/dist/umd/ffmpeg-core.js");var G;!function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.FFPROBE="FFPROBE",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"}(G||(G={}));const X=(()=>{let e=0;return()=>e++})(),$=(new Error("unknown message type"),new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first")),Y=new Error("called FFmpeg.terminate()"),J=(new Error("failed to import ffmpeg-core.js"),["classWorkerURL"]);var Q,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap,ie=new WeakMap,ae=new WeakMap,oe=new WeakMap;class se{constructor(){var e=this;H(this,ee,null),H(this,te,{}),H(this,ne,{}),H(this,re,[]),H(this,ie,[]),a(this,"loaded",!1),H(this,ae,()=>{K(ee,this)&&(K(ee,this).onmessage=e=>{let{data:{id:t,type:n,data:r}}=e;switch(n){case G.LOAD:this.loaded=!0,K(te,this)[t](r);break;case G.MOUNT:case G.UNMOUNT:case G.EXEC:case G.FFPROBE:case G.WRITE_FILE:case G.READ_FILE:case G.DELETE_FILE:case G.RENAME:case G.CREATE_DIR:case G.LIST_DIR:case G.DELETE_DIR:K(te,this)[t](r);break;case G.LOG:K(re,this).forEach(e=>e(r));break;case G.PROGRESS:K(ie,this).forEach(e=>e(r));break;case G.ERROR:K(ne,this)[t](r)}delete K(te,this)[t],delete K(ne,this)[t]})}),H(this,oe,function(t){let{type:n,data:r}=t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0;return K(ee,e)?new Promise((t,o)=>{const s=X();K(ee,e)&&K(ee,e).postMessage({id:s,type:n,data:r},i),K(te,e)[s]=t,K(ne,e)[s]=o,null===a||void 0===a||a.addEventListener("abort",()=>{o(new DOMException("Message # ".concat(s," was aborted"),"AbortError"))},{once:!0})}):Promise.reject($)}),a(this,"load",function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{classWorkerURL:r}=t,i=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,J),{signal:a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K(ee,e)||(Z(ee,e,r?new Worker(n(458)(r),{type:"module"}):new Worker(new URL(n.p+n.u(726),n.b),{type:void 0})),K(ae,e).call(e)),K(oe,e).call(e,{type:G.LOAD,data:i},void 0,a)}),a(this,"exec",function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return K(oe,e).call(e,{type:G.EXEC,data:{args:t,timeout:n}},void 0,r)}),a(this,"ffprobe",function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return K(oe,e).call(e,{type:G.FFPROBE,data:{args:t,timeout:n}},void 0,r)}),a(this,"terminate",()=>{const e=Object.keys(K(ne,this));for(const t of e)K(ne,this)[t](Y),delete K(ne,this)[t],delete K(te,this)[t];K(ee,this)&&(K(ee,this).terminate(),Z(ee,this,null),this.loaded=!1)}),a(this,"writeFile",function(t,n){let{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=[];return n instanceof Uint8Array&&i.push(n.buffer),K(oe,e).call(e,{type:G.WRITE_FILE,data:{path:t,data:n}},i,r)}),a(this,"mount",(e,t,n)=>K(oe,this).call(this,{type:G.MOUNT,data:{fsType:e,options:t,mountPoint:n}},[])),a(this,"unmount",e=>K(oe,this).call(this,{type:G.UNMOUNT,data:{mountPoint:e}},[])),a(this,"readFile",function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"binary",{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return K(oe,e).call(e,{type:G.READ_FILE,data:{path:t,encoding:n}},void 0,r)}),a(this,"deleteFile",function(t){let{signal:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K(oe,e).call(e,{type:G.DELETE_FILE,data:{path:t}},void 0,n)}),a(this,"rename",function(t,n){let{signal:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return K(oe,e).call(e,{type:G.RENAME,data:{oldPath:t,newPath:n}},void 0,r)}),a(this,"createDir",function(t){let{signal:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K(oe,e).call(e,{type:G.CREATE_DIR,data:{path:t}},void 0,n)}),a(this,"listDir",function(t){let{signal:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K(oe,e).call(e,{type:G.LIST_DIR,data:{path:t}},void 0,n)}),a(this,"deleteDir",function(t){let{signal:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return K(oe,e).call(e,{type:G.DELETE_DIR,data:{path:t}},void 0,n)})}on(e,t){"log"===e?K(re,this).push(t):"progress"===e&&K(ie,this).push(t)}off(e,t){"log"===e?Z(re,this,K(re,this).filter(e=>e!==t)):"progress"===e&&Z(ie,this,K(ie,this).filter(e=>e!==t))}}!function(e){e.MEMFS="MEMFS",e.NODEFS="NODEFS",e.NODERAWFS="NODERAWFS",e.IDBFS="IDBFS",e.WORKERFS="WORKERFS",e.PROXYFS="PROXYFS"}(Q||(Q={}));const le=new Error("failed to get response body reader"),ue=new Error("failed to complete download"),ce=async function(e,t){let n=arguments.length>3?arguments[3]:void 0;const r=arguments.length>2&&void 0!==arguments[2]&&arguments[2]?await(async(e,t)=>{const n=await fetch(e);let r;try{var i;const a=parseInt(n.headers.get("Content-Length")||"-1"),o=null===(i=n.body)||void 0===i?void 0:i.getReader();if(!o)throw le;const s=[];let l=0;for(;;){const{done:n,value:r}=await o.read(),i=r?r.length:0;if(n){if(-1!=a&&a!==l)throw ue;t&&t({url:e,total:a,received:l,delta:i,done:n});break}s.push(r),l+=i,t&&t({url:e,total:a,received:l,delta:i,done:n})}const u=new Uint8Array(l);let c=0;for(const e of s)u.set(e,c),c+=e.length;r=u.buffer}catch(a){console.log("failed to send download progress event: ",a),r=await n.arrayBuffer(),t&&t({url:e,total:r.byteLength,received:r.byteLength,delta:0,done:!0})}return r})(e,n):await(await fetch(e)).arrayBuffer(),i=new Blob([r],{type:t});return URL.createObjectURL(i)};var de=n(871),he=n(195),fe=n.n(he),pe=n(159),me=n.n(pe),ge=n(579);fe().initialize();const ye=(0,de.getProject)("MapAnimator v2").sheet("Main Scene");let ve=!1;const _e=()=>{ve?(fe().ui.restore(),ve=!1):(fe().ui.hide(),ve=!0)},be={classic:'<svg viewBox="0 0 24 24" fill="%C" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" stroke="white" stroke-width="1"/></svg>',bubble:'<svg viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="96" height="46" rx="15" fill="%C" stroke="white" stroke-width="3"/><path d="M50 48 L40 60 L60 60 Z" fill="%C"/></svg>',square:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><rect x="2" y="2" width="20" height="20" rx="4" fill="%C" stroke="white" stroke-width="2"/><path d="M12 22l-4 4h8l-4-4z" fill="%C"/></svg>',flag:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 2v20" stroke="white" stroke-width="2"/><path d="M5 4h14l-4 5 4 5H5" fill="%C"/></svg>',dot:'<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="8" fill="%C" stroke="white" stroke-width="2"/></svg>'},xe=(e,t)=>Math.sqrt((t[0]-e[0])**2+(t[1]-e[1])**2),we=(e,t)=>{let[n,r]=t;return new Promise(t=>{e.once("render",()=>{const i=e.getCanvas(),a=document.createElement("canvas");a.width=n,a.height=r,a.getContext("2d").drawImage(i,0,0,n,r),a.toBlob(async e=>t(new Uint8Array(await e.arrayBuffer())),"image/png",.95)}),e.triggerRepaint()})};function ke(t){let{title:n,visible:r,onClose:i,defaultPos:a,children:o,footerChildren:s}=t;const[l,u]=(0,e.useState)(a||{x:20,y:80}),[c,d]=(0,e.useState)(!1),h=(0,e.useRef)(null);return(0,e.useEffect)(()=>{const e=e=>{h.current&&u({x:Math.max(0,h.current.px+e.clientX-h.current.mx),y:Math.max(0,h.current.py+e.clientY-h.current.my)})},t=()=>{h.current=null};return window.addEventListener("mousemove",e),window.addEventListener("mouseup",t),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("mouseup",t)}},[]),r?(0,ge.jsxs)("div",{className:"floating-panel",style:{left:l.x,top:l.y},children:[(0,ge.jsxs)("div",{className:"panel-header",onMouseDown:e=>{e.target.closest(".no-drag")||(h.current={mx:e.clientX,my:e.clientY,px:l.x,py:l.y})},children:[(0,ge.jsxs)("div",{className:"panel-title-row",children:[(0,ge.jsx)("span",{className:"panel-dot"}),(0,ge.jsx)("span",{className:"panel-title",children:n})]}),(0,ge.jsxs)("div",{className:"no-drag panel-controls",children:[(0,ge.jsx)("button",{className:"panel-ctrl-btn",onClick:()=>d(!c),children:c?"\u25bc":"\u25b2"}),(0,ge.jsx)("button",{className:"panel-ctrl-btn",onClick:i,children:"\xd7"})]})]}),!c&&(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsx)("div",{className:"panel-body",children:o}),s&&(0,ge.jsx)("div",{className:"panel-footer",children:s})]})]}):null}const Se=e=>{let{title:t,id:n,collapsed:r,onToggle:i,children:a}=e;return(0,ge.jsxs)("div",{className:"section-group",children:[(0,ge.jsxs)("div",{className:"section-header",onClick:()=>i(n),children:[(0,ge.jsx)("span",{className:"chevron",children:r?"\u25b6":"\u25bc"}),t]}),!r&&(0,ge.jsx)("div",{className:"section-body",children:a})]})};const Ee=function(){var t;const n=(0,e.useRef)(null),r=(0,e.useRef)(null),i=(0,e.useRef)(null),[a,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(!1),[d,h]=(0,e.useState)("Ready."),[f,p]=(0,e.useState)(!1),[m,g]=(0,e.useState)(!0),[y,v]=(0,e.useState)({}),[_,b]=(0,e.useState)({resolution:"1920x1080",mapStyle:"https://tiles.openfreemap.org/styles/bright",pathColor:"#ec4899",pathWidth:5,fps:30,exportDuration:3,animStart:0,animEnd:0,pathStart:0,pathEnd:0}),[x,w]=(0,e.useState)(null),[k,S]=(0,e.useState)(!1),E=e=>v(t=>s(s({},t),{},{[e]:!t[e]})),C=(0,e.useRef)([]),P=(0,e.useRef)([]),D=(0,e.useRef)(!1);(0,e.useEffect)(()=>{D.current=l},[l]);const I=(0,e.useRef)(new se),T=(0,e.useRef)(null),[A,z]=(0,e.useState)(!1),O=(0,e.useRef)(k);(0,e.useEffect)(()=>{O.current=k},[k]);const F=(0,e.useRef)(null),M=(0,e.useRef)({id:null,active:!1});(0,e.useEffect)(()=>{(async()=>{try{const e="https://unpkg.com/@ffmpeg/core@0.12.6/dist/umd";await I.current.load({coreURL:await ce("".concat(e,"/ffmpeg-core.js"),"text/javascript"),wasmURL:await ce("".concat(e,"/ffmpeg-core.wasm"),"application/wasm")}),z(!0)}catch(e){console.warn("FFmpeg load failed:",e)}})()},[]);const j=(0,e.useCallback)(function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C.current;null!==(e=r.current)&&void 0!==e&&e.getSource("route-source")&&(r.current.setPaintProperty("route-line","line-color",_.pathColor),r.current.setPaintProperty("route-line","line-width",parseFloat(_.pathWidth)),r.current.getSource("route-source").setData({type:"Feature",geometry:{type:"LineString",coordinates:t}}))},[_.pathColor,_.pathWidth]),B=(0,e.useCallback)(()=>{var e;if(null!==(e=r.current)&&void 0!==e&&e.getSource("pins-source")){const e=P.current.map(e=>({type:"Feature",geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{id:e.id,imageId:"pin-".concat(e.id),text:e.text||"",textScale:e.textScale||1,textOffsetX:e.textOffsetX||0,textOffsetY:e.textOffsetY||0,textColor:e.textColor||"#ffffff",fontFamily:e.fontFamily||"Inter, sans-serif"}}));console.log("Syncing pins layer with features:",e.length),r.current.getSource("pins-source").setData({type:"FeatureCollection",features:e})}else console.warn("pins-source not found!")},[]),R=(0,e.useCallback)(()=>{r.current&&(r.current.getSource("route-source")||(r.current.addSource("route-source",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),r.current.addLayer({id:"route-line",type:"line",source:"route-source",paint:{"line-color":_.pathColor,"line-width":parseFloat(_.pathWidth)}})),r.current.getSource("pins-source")||(r.current.addSource("pins-source",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),r.current.addLayer({id:"pins-icon-layer",type:"symbol",source:"pins-source",layout:{"icon-image":["get","imageId"],"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-anchor":"bottom"}}),r.current.addLayer({id:"pins-text-layer",type:"symbol",source:"pins-source",layout:{"text-field":["get","text"],"text-size":["*",12,["get","textScale"]],"text-anchor":"bottom","text-offset":["/",["get","textOffsetX"],10,"-",["/",["get","textOffsetY"],10],4.2],"text-allow-overlap":!0,"text-ignore-placement":!0},paint:{"text-color":"rgba(255,255,255,0)","text-halo-color":"rgba(0,0,0,0)","text-halo-width":0}})),j(),B())},[_.pathColor,_.pathWidth,j,B]),L=(0,e.useCallback)(()=>{if(!i.current)return;const[e,t]=_.resolution.split("x").map(Number);i.current.style.width=e+"px",i.current.style.height=t+"px";const n=i.current.parentElement,a=Math.min((n.clientWidth-40)/e,(n.clientHeight-40)/t);i.current.style.transform="scale(".concat(a,")"),requestAnimationFrame(()=>{var e;return null===(e=r.current)||void 0===e?void 0:e.resize()})},[_.resolution]);(0,e.useEffect)(()=>(window.addEventListener("resize",L),L(),()=>window.removeEventListener("resize",L)),[L]),(0,e.useEffect)(()=>{r.current&&(r.current.setStyle(_.mapStyle),r.current.once("styledata",R))},[_.mapStyle,R]),(0,e.useEffect)(()=>{if(r.current)return;r.current=new(u().Map)({container:n.current,style:_.mapStyle,center:[-46.633,-23.55],zoom:12,preserveDrawingBuffer:!0,antialias:!0,attributionControl:!1}),r.current.on("load",()=>{r.current.on("styleimagemissing",e=>{const t=document.createElement("canvas");t.width=1,t.height=1,r.current.hasImage(e.id)||r.current.addImage(e.id,t.getContext("2d").getImageData(0,0,1,1))});const e=new q({forwardGeocode:async e=>{try{const t=await fetch("https://nominatim.openstreetmap.org/search?q=".concat(e.query,"&format=geojson&addressdetails=1&limit=5"));return{features:(await t.json()).features.map(e=>s(s({},e),{},{place_name:e.properties.display_name,center:e.geometry.coordinates}))}}catch(t){return{features:[]}}}},{maplibregl:u()});r.current.addControl(e,"top-left"),R(),L()}),r.current.on("click",e=>{D.current&&(C.current.push([e.lngLat.lng,e.lngLat.lat]),j())}),r.current.on("mousedown","pins-icon-layer",e=>{e.preventDefault();const t=e.features[0];t&&(M.current={id:t.properties.id,active:!0},r.current.getCanvasContainer().style.cursor="grabbing")}),r.current.on("mousemove",e=>{if(M.current.active&&M.current.id){const t=M.current.id,n=P.current,r=n.findIndex(e=>e.id===t);-1!==r&&(n[r].lng=e.lngLat.lng,n[r].lat=e.lngLat.lat,B())}}),r.current.on("mouseup",()=>{M.current.active&&(M.current.active=!1,r.current.getCanvasContainer().style.cursor="",o([...P.current]))}),r.current.on("moveend",()=>{O.current&&T.current&&(clearTimeout(F.current),F.current=setTimeout(()=>{const e=r.current.getCenter();fe().transaction(t=>{let{set:n}=t;n(T.current.props,{lng:e.lng,lat:e.lat,zoom:r.current.getZoom(),pitch:r.current.getPitch(),bearing:r.current.getBearing(),pathProgress:1})})},300))});const e=r.current.getCenter();T.current=ye.object("Map",{lng:de.types.number(e.lng,{range:[-180,180]}),lat:de.types.number(e.lat,{range:[-90,90]}),zoom:de.types.number(r.current.getZoom(),{range:[0,24]}),pitch:de.types.number(r.current.getPitch(),{range:[0,85]}),bearing:de.types.number(r.current.getBearing(),{range:[-180,180]}),pathProgress:de.types.number(1,{range:[0,1]})}),T.current.onValuesChange(e=>{if(!r.current||f)return;const t="number"===typeof e.lng?e.lng:r.current.getCenter().lng,n="number"===typeof e.lat?e.lat:r.current.getCenter().lat,i="number"===typeof e.zoom?e.zoom:r.current.getZoom(),a="number"===typeof e.pitch?e.pitch:r.current.getPitch(),o="number"===typeof e.bearing?e.bearing:r.current.getBearing();r.current.jumpTo({center:[t,n],zoom:i,pitch:a,bearing:o}),C.current.length>1&&j(((e,t)=>{if(e.length<2||t<=0)return[];if(t>=.99)return e;const n=e.reduce((t,n,r)=>0===r?0:t+xe(e[r-1],n),0)*t;let r=0;const i=[];for(let a=0;a<e.length-1;a++){const t=e[a],o=e[a+1],s=xe(t,o);if(i.push(t),r+s>=n){const e=(n-r)/s;return i.push([t[0]+(o[0]-t[0])*e,t[1]+(o[1]-t[1])*e]),i}r+=s}return i})(C.current,e.pathProgress||0))})},[]);const N=(0,e.useCallback)(async e=>{if(r.current)try{const{data:t}=await(async e=>{const t=document.createElement("canvas"),n=t.getContext("2d"),r="bubble"===e.style?100:50,i=e.scale||1,a=window.devicePixelRatio||1,o=150*a,s=150*a,l=r*i*a,u=50*i*a;t.width=l+2*o,t.height=u+2*s;const c=new Image;c.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent((be[e.style]||be.classic).replace(/%C/g,e.color)),await new Promise(e=>c.onload=e);const d=o,h=s;if(n.drawImage(c,d,h,l,u),e.text){const t=12*i*(e.textScale||1)*a,r=e.fontFamily||"Inter, sans-serif";n.font="800 ".concat(t,"px ").concat(r),n.fillStyle=e.textColor||"#fff",n.textAlign="center",n.textBaseline="middle",n.shadowColor="rgba(0,0,0,0.8)",n.shadowBlur=2*a,n.strokeStyle="rgba(0,0,0,0.8)",n.lineWidth=2*a;const o=h+u/2.3,s=d+l/2+(e.textOffsetX||0)*a,c=o+(e.textOffsetY||0)*a;n.strokeText(e.text,s,c),n.fillText(e.text,s,c)}const f=h+u,p=document.createElement("canvas");p.width=t.width,p.height=f;const m=p.getContext("2d");return m.drawImage(t,0,0,t.width,f,0,0,t.width,f),{data:m.getImageData(0,0,p.width,p.height),w:p.width,h:p.height,style:e.style}})(e),n="pin-".concat(e.id);r.current.hasImage(n)&&r.current.removeImage(n),r.current.addImage(n,t),B(),r.current.triggerRepaint()}catch(t){console.error("Failed to create pin marker image:",t)}},[B]),U=async(e,t,n)=>{const r=["scale","textScale"].includes(t),i=["textOffsetX","textOffsetY"].includes(t);let a=n;r&&(a=parseFloat(n)),i&&(a=parseInt(n,10));const l=P.current.findIndex(t=>t.id===e);if(-1!==l){const n=s(s({},P.current[l]),{},{[t]:a});P.current[l]=n,await N(n),o(t=>t.map(t=>t.id===e?n:t))}},V=()=>_.resolution.split("x").map(Number),H=async e=>{const t=_.exportDuration>0?_.exportDuration:ye.sequence.length>0?ye.sequence.length:10;if(t<=0)throw new Error("Dura\xe7\xe3o inv\xe1lida (".concat(t.toFixed(2),"s)."));const n=Math.ceil(t*e),i=[];for(let a=0;a<=n;a++)ye.sequence.position=0+a/e,await new Promise(e=>setTimeout(e,60)),await new Promise(e=>r.current.isMoving()?r.current.once("idle",e):e()),i.push(await we(r.current,V())),h("Rendering: ".concat(Math.round(a/n*100),"%"));return i};return(0,ge.jsxs)("div",{className:"app-container",children:[f&&(0,ge.jsx)("div",{className:"render-overlay",children:(0,ge.jsxs)("div",{children:[(0,ge.jsx)("div",{className:"render-label",children:"RENDERING"}),(0,ge.jsx)("div",{className:"render-pct",children:(null===(t=d.match(/\d+%/))||void 0===t?void 0:t[0])||d})]})}),(0,ge.jsx)("div",{className:"side-toggle",onClick:()=>g(!m),title:m?"Hide":"Show",children:m?"\u25c0":"\u25b6"}),(0,ge.jsxs)(ke,{title:"Main Scene : default \u2192 Map",visible:m,onClose:()=>g(!1),defaultPos:{x:20,y:80},footerChildren:(0,ge.jsxs)(ge.Fragment,{children:[(0,ge.jsxs)("div",{className:"prop-row",style:{gap:"4px"},children:[(0,ge.jsx)("button",{className:"act-btn secondary",onClick:_e,children:"Studio"}),(0,ge.jsx)("button",{className:"act-btn secondary",onClick:()=>{if(!r.current||!T.current)return;const e=r.current.getCenter();fe().transaction(t=>{let{set:n}=t;n(T.current.props,{lng:e.lng,lat:e.lat,zoom:r.current.getZoom(),pitch:r.current.getPitch(),bearing:r.current.getBearing(),pathProgress:1})}),h("Captured!"),setTimeout(()=>h("Ready."),1500)},children:"Capture"}),(0,ge.jsx)("button",{className:"act-btn ".concat(k?"live-on":"live-off"),onClick:()=>S(!k),title:"Auto-capture map position on every move",children:k?"\u2b24 LIVE":"\u25cb LIVE"})]}),(0,ge.jsxs)("div",{className:"prop-row",style:{marginTop:"4px"},children:[(0,ge.jsx)("label",{children:"Export Len (s)"}),(0,ge.jsx)("input",{type:"number",min:"1",step:"0.5",value:_.exportDuration,onChange:e=>b(t=>s(s({},t),{},{exportDuration:parseFloat(e.target.value)||3})),style:{width:"60px"}})]}),(0,ge.jsxs)("div",{className:"prop-row",style:{gap:"4px",marginTop:"4px"},children:[(0,ge.jsx)("button",{className:"act-btn export-mp4",onClick:async()=>{if(!A)return void alert("FFmpeg still loading...");p(!0);const e=I.current;try{try{const t=await e.listDir("/");for(const n of t)n.isDir||await e.deleteFile(n.name).catch(()=>{})}catch(t){}h("Capturing frames...");const n=_.fps||30,r=await H(n);h("Writing frames...");for(let t=0;t<r.length;t++)await e.writeFile("f".concat(t.toString().padStart(5,"0"),".png"),r[t]);h("Encoding..."),await e.exec(["-framerate",String(n),"-i","f%05d.png","-c:v","libx264","-preset","ultrafast","-pix_fmt","yuv420p","-y","o.mp4"]);const i=await e.readFile("o.mp4"),a=URL.createObjectURL(new Blob([i.buffer],{type:"video/mp4"}));Object.assign(document.createElement("a"),{href:a,download:"map_".concat(Date.now(),".mp4")}).click(),h("Done! \ud83c\udf89"),setTimeout(()=>h("Ready."),3e3)}catch(n){console.error(n),alert("Export failed: ".concat(null===n||void 0===n?void 0:n.message))}finally{p(!1)}},disabled:!A||f,children:"\u25b6 MP4"}),(0,ge.jsx)("button",{className:"act-btn export-png",onClick:async()=>{p(!0);try{h("Capturing frames...");const e=_.fps||30,t=await H(e);h("Zipping...");const n=new(me()),r=n.folder("frames");t.forEach((e,t)=>r.file("f".concat(t.toString().padStart(5,"0"),".png"),e));const i=await n.generateAsync({type:"blob"}),a=URL.createObjectURL(i);Object.assign(document.createElement("a"),{href:a,download:"frames_".concat(Date.now(),".zip")}).click(),h("Done! \ud83c\udf89"),setTimeout(()=>h("Ready."),3e3)}catch(e){console.error(e),alert("PNG export failed: ".concat(null===e||void 0===e?void 0:e.message))}finally{p(!1)}},disabled:f,children:"\u2b1b PNG SEQ"})]}),"Ready."!==d&&!f&&(0,ge.jsx)("div",{className:"status-text",children:d})]}),children:[(0,ge.jsxs)(Se,{title:"Workspace",id:"ws",collapsed:y.ws,onToggle:E,children:[(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Format"}),(0,ge.jsxs)("select",{value:_.resolution,onChange:e=>b(t=>s(s({},t),{},{resolution:e.target.value})),children:[(0,ge.jsx)("option",{value:"1920x1080",children:"1920\xd71080"}),(0,ge.jsx)("option",{value:"1080x1920",children:"1080\xd71920"}),(0,ge.jsx)("option",{value:"1080x1080",children:"1080\xd71080"})]})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Style"}),(0,ge.jsxs)("select",{value:_.mapStyle,onChange:e=>b(t=>s(s({},t),{},{mapStyle:e.target.value})),children:[(0,ge.jsx)("option",{value:"https://tiles.openfreemap.org/styles/bright",children:"Bright"}),(0,ge.jsx)("option",{value:"https://tiles.openfreemap.org/styles/dark",children:"Dark"}),(0,ge.jsx)("option",{value:"https://tiles.openfreemap.org/styles/positron",children:"Positron"}),(0,ge.jsx)("option",{value:"https://tiles.openfreemap.org/styles/liberty",children:"Liberty"})]})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"FPS"}),(0,ge.jsx)("input",{type:"number",min:"10",max:"60",value:_.fps,onChange:e=>b(t=>s(s({},t),{},{fps:parseInt(e.target.value)}))})]})]}),(0,ge.jsxs)(Se,{title:"Drawing",id:"draw",collapsed:y.draw,onToggle:E,children:[(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Color"}),(0,ge.jsx)("input",{type:"color",value:_.pathColor,onChange:e=>{b(t=>s(s({},t),{},{pathColor:e.target.value})),j()}})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Width"}),(0,ge.jsx)("input",{type:"number",min:"1",max:"20",value:_.pathWidth,onChange:e=>b(t=>s(s({},t),{},{pathWidth:e.target.value}))})]}),(0,ge.jsxs)("div",{className:"prop-row",style:{gap:"4px"},children:[(0,ge.jsx)("button",{className:"panel-btn ".concat(l?"active":""),onClick:()=>c(!l),children:l?"LOCK PATH":"DRAW PATH"}),(0,ge.jsx)("button",{className:"panel-btn",onClick:()=>{C.current=[],j()},children:"CLEAR"})]})]}),(0,ge.jsxs)(Se,{title:"Pins",id:"pins",collapsed:y.pins,onToggle:E,children:[a.map(e=>(0,ge.jsx)("div",{className:"pin-card",style:{paddingBottom:"4px",borderBottom:"1px solid rgba(255,255,255,0.05)"},children:(0,ge.jsxs)("div",{className:"pin-row",children:[(0,ge.jsx)("input",{type:"color",value:e.color,onChange:t=>U(e.id,"color",t.target.value),className:"color-dot"}),(0,ge.jsx)("input",{type:"text",value:e.text,onChange:t=>U(e.id,"text",t.target.value),className:"pin-text-input"}),(0,ge.jsx)("button",{className:"pin-del",onClick:()=>w(e.id),style:{color:"#bbb"},children:"\u2699\ufe0f"}),(0,ge.jsx)("button",{className:"pin-del",onClick:()=>(e=>{var t;P.current=P.current.filter(t=>t.id!==e),o(t=>t.filter(t=>t.id!==e)),x===e&&w(null),null!==(t=r.current)&&void 0!==t&&t.hasImage("pin-".concat(e))&&r.current.removeImage("pin-".concat(e)),B()})(e.id),children:"\xd7"})]})},e.id)),(0,ge.jsx)("div",{className:"prop-row",children:(0,ge.jsx)("button",{className:"panel-btn",onClick:async()=>{const e=r.current.getCenter(),t={id:Date.now(),lng:e.lng,lat:e.lat,text:"Pin",color:"#ec4899",scale:1,style:"bubble",textScale:1,textOffsetX:0,textOffsetY:0,textColor:"#ffffff",fontFamily:"Inter, sans-serif",marker:null};P.current.push(t),await N(t),o(e=>[...e,t])},children:"+ ADD PIN"})})]})]}),x&&a.find(e=>e.id===x)&&(()=>{const e=a.find(e=>e.id===x);return(0,ge.jsx)(ke,{title:"Properties: ".concat(e.text||"Pin"),visible:!0,onClose:()=>w(null),defaultPos:{x:window.innerWidth-300,y:80},children:(0,ge.jsxs)("div",{style:{padding:"8px 0"},children:[(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Style"}),(0,ge.jsxs)("select",{value:e.style,onChange:t=>U(e.id,"style",t.target.value),children:[(0,ge.jsx)("option",{value:"bubble",children:"Bubble"}),(0,ge.jsx)("option",{value:"classic",children:"Pin"}),(0,ge.jsx)("option",{value:"square",children:"Square"}),(0,ge.jsx)("option",{value:"flag",children:"Flag"}),(0,ge.jsx)("option",{value:"dot",children:"Dot"})]})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Pin Scale"}),(0,ge.jsx)("input",{type:"number",min:"0.5",max:"3",step:"0.1",value:e.scale,onChange:t=>U(e.id,"scale",t.target.value)})]}),(0,ge.jsx)("div",{className:"prop-hint",style:{marginTop:"8px",color:"#888"},children:"Text Settings"}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Text Color"}),(0,ge.jsx)("input",{type:"color",value:e.textColor||"#ffffff",onChange:t=>U(e.id,"textColor",t.target.value)})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Font"}),(0,ge.jsxs)("select",{value:e.fontFamily||"Inter, sans-serif",onChange:t=>U(e.id,"fontFamily",t.target.value),children:[(0,ge.jsx)("option",{value:"Inter, sans-serif",children:"Inter"}),(0,ge.jsx)("option",{value:"Arial, sans-serif",children:"Arial"}),(0,ge.jsx)("option",{value:"'Courier New', monospace",children:"Courier New"}),(0,ge.jsx)("option",{value:"'Times New Roman', serif",children:"Times New Roman"}),(0,ge.jsx)("option",{value:"'Comic Sans MS', cursive",children:"Comic Sans"}),(0,ge.jsx)("option",{value:"'Trebuchet MS', sans-serif",children:"Trebuchet MS"}),(0,ge.jsx)("option",{value:"Impact, sans-serif",children:"Impact"})]})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Text Scale"}),(0,ge.jsx)("input",{type:"number",min:"0.5",max:"5",step:"0.1",value:e.textScale||1,onChange:t=>U(e.id,"textScale",t.target.value)})]}),(0,ge.jsxs)("div",{className:"prop-row",children:[(0,ge.jsx)("label",{children:"Offset X/Y"}),(0,ge.jsx)("input",{type:"number",step:"1",value:e.textOffsetX||0,onChange:t=>U(e.id,"textOffsetX",t.target.value),style:{width:"40%"}}),(0,ge.jsx)("input",{type:"number",step:"1",value:e.textOffsetY||0,onChange:t=>U(e.id,"textOffsetY",t.target.value),style:{width:"40%"}})]})]})})})(),(0,ge.jsx)("div",{className:"map-viewport",children:(0,ge.jsx)("div",{ref:i,className:"map-container",children:(0,ge.jsx)("div",{ref:n,className:"map-element"})})})]})},Ce=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:a,getTTFB:o}=t;n(e),r(e),i(e),a(e),o(e)})},Pe=console.error;console.error=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];"string"===typeof t[0]&&t[0].includes("ResizeObserver loop")||Pe.apply(console,t)};t.createRoot(document.getElementById("root")).render((0,ge.jsx)(e.StrictMode,{children:(0,ge.jsx)(Ee,{})})),Ce()})()})();
//# sourceMappingURL=main.bb93aad4.js.map